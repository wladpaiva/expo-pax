<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet_en.css" title="Style">
</head>
<body>
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span>/*<a name="line.1"></a>
<span class="sourceLineNo">002</span> * ===========================================================================================<a name="line.2"></a>
<span class="sourceLineNo">003</span> * = COPYRIGHT<a name="line.3"></a>
<span class="sourceLineNo">004</span> *          PAX Computer Technology (Shenzhen) Co., Ltd. PROPRIETARY INFORMATION<a name="line.4"></a>
<span class="sourceLineNo">005</span> *   This software is supplied under the terms of a license agreement or nondisclosure<a name="line.5"></a>
<span class="sourceLineNo">006</span> *   agreement with PAX Computer Technology (Shenzhen) Co., Ltd. and may not be copied or<a name="line.6"></a>
<span class="sourceLineNo">007</span> *   disclosed except in accordance with the terms in that agreement.<a name="line.7"></a>
<span class="sourceLineNo">008</span> *     Copyright (C) 2017-2023 PAX Computer Technology (Shenzhen) Co., Ltd. All rights reserved.<a name="line.8"></a>
<span class="sourceLineNo">009</span> * Description: // Detail description about the function of this module,<a name="line.9"></a>
<span class="sourceLineNo">010</span> *             // interfaces with the other modules, and dependencies.<a name="line.10"></a>
<span class="sourceLineNo">011</span> * Revision History:<a name="line.11"></a>
<span class="sourceLineNo">012</span> * Date                         Author                        Action<a name="line.12"></a>
<span class="sourceLineNo">013</span> * 2017/04/01                   PAX                     Create/Add/Modify/Delete<a name="line.13"></a>
<span class="sourceLineNo">014</span> * ===========================================================================================<a name="line.14"></a>
<span class="sourceLineNo">015</span> */<a name="line.15"></a>
<span class="sourceLineNo">016</span><a name="line.16"></a>
<span class="sourceLineNo">017</span>package com.pax.dal;<a name="line.17"></a>
<span class="sourceLineNo">018</span><a name="line.18"></a>
<span class="sourceLineNo">019</span>import android.view.View;<a name="line.19"></a>
<span class="sourceLineNo">020</span><a name="line.20"></a>
<span class="sourceLineNo">021</span>import com.pax.dal.entity.DUKPTResult;<a name="line.21"></a>
<span class="sourceLineNo">022</span>import com.pax.dal.entity.EAesCheckMode;<a name="line.22"></a>
<span class="sourceLineNo">023</span>import com.pax.dal.entity.EAlgorithmType;<a name="line.23"></a>
<span class="sourceLineNo">024</span>import com.pax.dal.entity.ECheckMode;<a name="line.24"></a>
<span class="sourceLineNo">025</span>import com.pax.dal.entity.ECryptOperate;<a name="line.25"></a>
<span class="sourceLineNo">026</span>import com.pax.dal.entity.ECryptOpt;<a name="line.26"></a>
<span class="sourceLineNo">027</span>import com.pax.dal.entity.EDUKPTDesMode;<a name="line.27"></a>
<span class="sourceLineNo">028</span>import com.pax.dal.entity.EDUKPTMacMode;<a name="line.28"></a>
<span class="sourceLineNo">029</span>import com.pax.dal.entity.EDUKPTPinMode;<a name="line.29"></a>
<span class="sourceLineNo">030</span>import com.pax.dal.entity.EFuncKeyMode;<a name="line.30"></a>
<span class="sourceLineNo">031</span>import com.pax.dal.entity.EIdKeycCalcMode;<a name="line.31"></a>
<span class="sourceLineNo">032</span>import com.pax.dal.entity.EKeyCode;<a name="line.32"></a>
<span class="sourceLineNo">033</span>import com.pax.dal.entity.EPedDesMode;<a name="line.33"></a>
<span class="sourceLineNo">034</span>import com.pax.dal.entity.EPedKeyType;<a name="line.34"></a>
<span class="sourceLineNo">035</span>import com.pax.dal.entity.EPedMacMode;<a name="line.35"></a>
<span class="sourceLineNo">036</span>import com.pax.dal.entity.EPedType;<a name="line.36"></a>
<span class="sourceLineNo">037</span>import com.pax.dal.entity.EPinBlockMode;<a name="line.37"></a>
<span class="sourceLineNo">038</span>import com.pax.dal.entity.EUartPort;<a name="line.38"></a>
<span class="sourceLineNo">039</span>import com.pax.dal.entity.KeyInfo;<a name="line.39"></a>
<span class="sourceLineNo">040</span>import com.pax.dal.entity.RSAKeyInfo;<a name="line.40"></a>
<span class="sourceLineNo">041</span>import com.pax.dal.entity.RSAPinKey;<a name="line.41"></a>
<span class="sourceLineNo">042</span>import com.pax.dal.entity.RSARecoverInfo;<a name="line.42"></a>
<span class="sourceLineNo">043</span>import com.pax.dal.entity.SM2KeyPair;<a name="line.43"></a>
<span class="sourceLineNo">044</span>import com.pax.dal.exceptions.EPedDevException;<a name="line.44"></a>
<span class="sourceLineNo">045</span>import com.pax.dal.exceptions.PedDevException;<a name="line.45"></a>
<span class="sourceLineNo">046</span><a name="line.46"></a>
<span class="sourceLineNo">047</span>import java.util.LinkedHashMap;<a name="line.47"></a>
<span class="sourceLineNo">048</span><a name="line.48"></a>
<span class="sourceLineNo">049</span>/**<a name="line.49"></a>
<span class="sourceLineNo">050</span> *  &lt;div class="zh"&gt;关于 PED的API。 如果开启权限检查，需在AndroidManifest下添加权限:"com.pax.permission.PED"&lt;/div&gt;<a name="line.50"></a>
<span class="sourceLineNo">051</span> *  &lt;div class="en"&gt;API for PED. If permission check is enabled, you need to add permission under AndroidManifest: "com.pax.permission.PED".&lt;/div&gt;<a name="line.51"></a>
<span class="sourceLineNo">052</span> */<a name="line.52"></a>
<span class="sourceLineNo">053</span>public interface IPed {<a name="line.53"></a>
<span class="sourceLineNo">054</span><a name="line.54"></a>
<span class="sourceLineNo">055</span>    /**<a name="line.55"></a>
<span class="sourceLineNo">056</span>     * &lt;div class="zh"&gt; 设置输入PIN监听器。仅支持{@link EPedType#INTERNAL} 类型 &lt;/div&gt;<a name="line.56"></a>
<span class="sourceLineNo">057</span>     * &lt;div class="en"&gt; Set the input PIN listener. {@link EPedType#INTERNAL} only is supported &lt;/div&gt;<a name="line.57"></a>
<span class="sourceLineNo">058</span>     * @param listener<a name="line.58"></a>
<span class="sourceLineNo">059</span>     *            {@link IPedInputPinListener}<a name="line.59"></a>
<span class="sourceLineNo">060</span>     *<a name="line.60"></a>
<span class="sourceLineNo">061</span>     */<a name="line.61"></a>
<span class="sourceLineNo">062</span>    public void setInputPinListener(IPedInputPinListener listener);<a name="line.62"></a>
<span class="sourceLineNo">063</span><a name="line.63"></a>
<span class="sourceLineNo">064</span>    /**<a name="line.64"></a>
<span class="sourceLineNo">065</span>     * &lt;div class="zh"&gt; 写入一个密钥，包括TLK，TMK和TWK的写入、发散，并可以选择使用KCV验证密钥正确性。<a name="line.65"></a>
<span class="sourceLineNo">066</span>     * &lt;p&gt;<a name="line.66"></a>
<span class="sourceLineNo">067</span>     * 当写入PED_TLK时，PED首先格式化，清除所有已经下载的密钥，再写入PED_TLK。 当明文写入密钥时，srcKeyIndex=0。<a name="line.67"></a>
<span class="sourceLineNo">068</span>     * 对于{@link EPedType#EXTERNAL_TYPEA}需要调用{@link IPed#setExMode}设置exMode。TMK和TDK只能以明文方式写入。TPK、TAK可以以明文或者密文的方式写入，但写入密文时不校验。<a name="line.68"></a>
<span class="sourceLineNo">069</span>     * 支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。<a name="line.69"></a>
<span class="sourceLineNo">070</span>     * &lt;/p&gt;<a name="line.70"></a>
<span class="sourceLineNo">071</span>     * &lt;/div&gt;<a name="line.71"></a>
<span class="sourceLineNo">072</span>     * &lt;div class="en"&gt; Write in one key includes write in and divergent of TLK, TMK and TWK. And use KCV to check the<a name="line.72"></a>
<span class="sourceLineNo">073</span>     * key correction.<a name="line.73"></a>
<span class="sourceLineNo">074</span>     * &lt;p&gt;<a name="line.74"></a>
<span class="sourceLineNo">075</span>     * When write PED_TLK,PED will format ,clear all the key has been downloaded,then write in PED_TLK.<a name="line.75"></a>
<span class="sourceLineNo">076</span>     * When srckeyindex = 0, the plaintext key is written. For {@link EPedType#EXTERNAL_TYPEA}, you need to call {@link IPed#setExMode} to setExMode.<a name="line.76"></a>
<span class="sourceLineNo">077</span>     * TMK and TDK can only be written in plaintext. TPK and TAK can be written in plaintext or ciphertext, but the ciphertext is not checked.<a name="line.77"></a>
<span class="sourceLineNo">078</span>     * {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.<a name="line.78"></a>
<span class="sourceLineNo">079</span>     * &lt;/p&gt;<a name="line.79"></a>
<span class="sourceLineNo">080</span>     * &lt;/div&gt;<a name="line.80"></a>
<span class="sourceLineNo">081</span>     *<a name="line.81"></a>
<span class="sourceLineNo">082</span>     * @param srcKeyType<a name="line.82"></a>
<span class="sourceLineNo">083</span>     *            {@link EPedKeyType} &lt;div class="zh"&gt;<a name="line.83"></a>
<span class="sourceLineNo">084</span>     *            &lt;p&gt;<a name="line.84"></a>
<span class="sourceLineNo">085</span>     *            原密钥类型<a name="line.85"></a>
<span class="sourceLineNo">086</span>     *            &lt;/p&gt;<a name="line.86"></a>
<span class="sourceLineNo">087</span>     *            &lt;ul&gt;<a name="line.87"></a>
<span class="sourceLineNo">088</span>     *            &lt;li&gt;{@link EPedKeyType#TLK}&lt;/li&gt;<a name="line.88"></a>
<span class="sourceLineNo">089</span>     *            &lt;li&gt;{@link EPedKeyType#TMK}/{@link EPedKeyType#SM4_TMK}&lt;/li&gt;<a name="line.89"></a>
<span class="sourceLineNo">090</span>     *            &lt;li&gt;{@link EPedKeyType#TPK}&lt;/li&gt;<a name="line.90"></a>
<span class="sourceLineNo">091</span>     *            &lt;li&gt;{@link EPedKeyType#TAK}&lt;/li&gt;<a name="line.91"></a>
<span class="sourceLineNo">092</span>     *            &lt;li&gt;{@link EPedKeyType#TDK}&lt;/li&gt;<a name="line.92"></a>
<span class="sourceLineNo">093</span>     *            &lt;/ul&gt;<a name="line.93"></a>
<span class="sourceLineNo">094</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.94"></a>
<span class="sourceLineNo">095</span>     *            &lt;p&gt;<a name="line.95"></a>
<span class="sourceLineNo">096</span>     *            Source Key Type<a name="line.96"></a>
<span class="sourceLineNo">097</span>     *            &lt;/p&gt;<a name="line.97"></a>
<span class="sourceLineNo">098</span>     *            &lt;ul&gt;<a name="line.98"></a>
<span class="sourceLineNo">099</span>     *            &lt;li&gt;TLK - Terminal Loading Key&lt;/li&gt;<a name="line.99"></a>
<span class="sourceLineNo">100</span>     *            &lt;li&gt;TMK - Terminal Master Key&lt;/li&gt;<a name="line.100"></a>
<span class="sourceLineNo">101</span>     *            &lt;li&gt;TPK -Transaction PIN Key&lt;/li&gt;<a name="line.101"></a>
<span class="sourceLineNo">102</span>     *            &lt;li&gt;TAK -Transaction Mac Key&lt;/li&gt;<a name="line.102"></a>
<span class="sourceLineNo">103</span>     *            &lt;li&gt;TDK -Terminal Des Key&lt;/li&gt;<a name="line.103"></a>
<span class="sourceLineNo">104</span>     *            &lt;/ul&gt;<a name="line.104"></a>
<span class="sourceLineNo">105</span>     *            &lt;/div&gt;<a name="line.105"></a>
<span class="sourceLineNo">106</span>     *<a name="line.106"></a>
<span class="sourceLineNo">107</span>     *<a name="line.107"></a>
<span class="sourceLineNo">108</span>     * @param srcKeyIndex<a name="line.108"></a>
<span class="sourceLineNo">109</span>     *            &lt;div class="zh"&gt;<a name="line.109"></a>
<span class="sourceLineNo">110</span>     *            &lt;p&gt;<a name="line.110"></a>
<span class="sourceLineNo">111</span>     *            原密钥索引<a name="line.111"></a>
<span class="sourceLineNo">112</span>     *            &lt;/p&gt;<a name="line.112"></a>
<span class="sourceLineNo">113</span>     *            &lt;ul&gt;<a name="line.113"></a>
<span class="sourceLineNo">114</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TLK}时, srcKeyIndex=1有效&lt;/li&gt;<a name="line.114"></a>
<span class="sourceLineNo">115</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TMK}/{@link EPedKeyType#SM4_TMK}/{@link EPedKeyType#TPK}/<a name="line.115"></a>
<span class="sourceLineNo">116</span>     *            {@link EPedKeyType#TAK}/ {@link EPedKeyType#TDK}时, srcKeyIndex=[1~100]有效&lt;/li&gt;<a name="line.116"></a>
<span class="sourceLineNo">117</span>     *            &lt;/ul&gt;<a name="line.117"></a>
<span class="sourceLineNo">118</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.118"></a>
<span class="sourceLineNo">119</span>     *            &lt;p&gt;<a name="line.119"></a>
<span class="sourceLineNo">120</span>     *            Source Key Index<a name="line.120"></a>
<span class="sourceLineNo">121</span>     *            &lt;/p&gt;<a name="line.121"></a>
<span class="sourceLineNo">122</span>     *            &lt;ul&gt;<a name="line.122"></a>
<span class="sourceLineNo">123</span>     *            &lt;li&gt;when srcKeyType=TLK, srcKeyIndex=1&lt;/li&gt;<a name="line.123"></a>
<span class="sourceLineNo">124</span>     *            &lt;li&gt;when srcKeyType=TMK/SM4_TMK/TPK/TAK/TDK, srcKeyIndex=[1~100]&lt;/li&gt;<a name="line.124"></a>
<span class="sourceLineNo">125</span>     *            &lt;/ul&gt;<a name="line.125"></a>
<span class="sourceLineNo">126</span>     *            &lt;/div&gt;<a name="line.126"></a>
<span class="sourceLineNo">127</span>     *<a name="line.127"></a>
<span class="sourceLineNo">128</span>     * @param destKeyType<a name="line.128"></a>
<span class="sourceLineNo">129</span>     *            {@link EPedKeyType} &lt;div class="zh"&gt;<a name="line.129"></a>
<span class="sourceLineNo">130</span>     *            &lt;p&gt;<a name="line.130"></a>
<span class="sourceLineNo">131</span>     *            目的密钥类型<a name="line.131"></a>
<span class="sourceLineNo">132</span>     *            &lt;/p&gt;<a name="line.132"></a>
<span class="sourceLineNo">133</span>     *            &lt;ul&gt;<a name="line.133"></a>
<span class="sourceLineNo">134</span>     *            &lt;li&gt;{@link EPedKeyType#TLK}&lt;/li&gt;<a name="line.134"></a>
<span class="sourceLineNo">135</span>     *              &lt;li&gt;{@link EPedKeyType#TMK}/{@link EPedKeyType#SM4_TMK}&lt;/li&gt;<a name="line.135"></a>
<span class="sourceLineNo">136</span>     *              &lt;li&gt;{@link EPedKeyType#TPK}/{@link EPedKeyType#SM4_TPK}&lt;/li&gt;<a name="line.136"></a>
<span class="sourceLineNo">137</span>     *              &lt;li&gt;{@link EPedKeyType#TAK}/{@link EPedKeyType#SM4_TAK}&lt;/li&gt;<a name="line.137"></a>
<span class="sourceLineNo">138</span>     *              &lt;li&gt;{@link EPedKeyType#TDK}/{@link EPedKeyType#SM4_TDK}&lt;/li&gt;<a name="line.138"></a>
<span class="sourceLineNo">139</span>     *              &lt;li&gt;{@link EPedKeyType#PPAD_TPK}，仅支持明文写入。&lt;/li&gt;<a name="line.139"></a>
<span class="sourceLineNo">140</span>     *            &lt;/ul&gt;<a name="line.140"></a>
<span class="sourceLineNo">141</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.141"></a>
<span class="sourceLineNo">142</span>     *            &lt;p&gt;<a name="line.142"></a>
<span class="sourceLineNo">143</span>     *            Destination Key Type<a name="line.143"></a>
<span class="sourceLineNo">144</span>     *            &lt;/p&gt;<a name="line.144"></a>
<span class="sourceLineNo">145</span>     *              &lt;li&gt;{@link EPedKeyType#TLK}&lt;/li&gt;<a name="line.145"></a>
<span class="sourceLineNo">146</span>     *              &lt;li&gt;{@link EPedKeyType#TMK}/{@link EPedKeyType#SM4_TMK}&lt;/li&gt;<a name="line.146"></a>
<span class="sourceLineNo">147</span>     *              &lt;li&gt;{@link EPedKeyType#TPK}/{@link EPedKeyType#SM4_TPK}&lt;/li&gt;<a name="line.147"></a>
<span class="sourceLineNo">148</span>     *              &lt;li&gt;{@link EPedKeyType#TAK}/{@link EPedKeyType#SM4_TAK}&lt;/li&gt;<a name="line.148"></a>
<span class="sourceLineNo">149</span>     *              &lt;li&gt;{@link EPedKeyType#TDK}/{@link EPedKeyType#SM4_TDK}&lt;/li&gt;<a name="line.149"></a>
<span class="sourceLineNo">150</span>     *              &lt;li&gt;{@link EPedKeyType#PPAD_TPK}, Only supports plain text writing.&lt;/li&gt;<a name="line.150"></a>
<span class="sourceLineNo">151</span>     *            &lt;/div&gt;<a name="line.151"></a>
<span class="sourceLineNo">152</span>     *<a name="line.152"></a>
<span class="sourceLineNo">153</span>     * @param destkeyIndex<a name="line.153"></a>
<span class="sourceLineNo">154</span>     *            &lt;div class="zh"&gt;<a name="line.154"></a>
<span class="sourceLineNo">155</span>     *            &lt;p&gt;<a name="line.155"></a>
<span class="sourceLineNo">156</span>     *            目的密钥索引<a name="line.156"></a>
<span class="sourceLineNo">157</span>     *            &lt;/p&gt;<a name="line.157"></a>
<span class="sourceLineNo">158</span>     *            &lt;ul&gt;<a name="line.158"></a>
<span class="sourceLineNo">159</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TLK}时, destkeyIndex=1有效&lt;/li&gt;<a name="line.159"></a>
<span class="sourceLineNo">160</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TMK}/{@link EPedKeyType#SM4_TMK}/{@link EPedKeyType#TPK}/<a name="line.160"></a>
<span class="sourceLineNo">161</span>     *            {@link EPedKeyType#SM4_TPK}/{@link EPedKeyType#TAK}/{@link EPedKeyType#SM4_TAK}/<a name="line.161"></a>
<span class="sourceLineNo">162</span>     *            {@link EPedKeyType#TDK}/{@link EPedKeyType#SM4_TDK}时, destkeyIndex=[1~100]有效&lt;/li&gt;<a name="line.162"></a>
<span class="sourceLineNo">163</span>     *            &lt;/ul&gt;<a name="line.163"></a>
<span class="sourceLineNo">164</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.164"></a>
<span class="sourceLineNo">165</span>     *            &lt;p&gt;<a name="line.165"></a>
<span class="sourceLineNo">166</span>     *            Destination Key Index<a name="line.166"></a>
<span class="sourceLineNo">167</span>     *            &lt;/p&gt;<a name="line.167"></a>
<span class="sourceLineNo">168</span>     *            reference srcKeyIndex {@link IPed#writeKey} &lt;/div&gt;<a name="line.168"></a>
<span class="sourceLineNo">169</span>     *<a name="line.169"></a>
<span class="sourceLineNo">170</span>     * @param destKeyValue<a name="line.170"></a>
<span class="sourceLineNo">171</span>     *            &lt;div class="zh"&gt;<a name="line.171"></a>
<span class="sourceLineNo">172</span>     *            &lt;p&gt;<a name="line.172"></a>
<span class="sourceLineNo">173</span>     *            密钥明文或密文<a name="line.173"></a>
<span class="sourceLineNo">174</span>     *            &lt;/p&gt;<a name="line.174"></a>
<span class="sourceLineNo">175</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.175"></a>
<span class="sourceLineNo">176</span>     *            &lt;p&gt;<a name="line.176"></a>
<span class="sourceLineNo">177</span>     *            Cryptograph or Plaintext<a name="line.177"></a>
<span class="sourceLineNo">178</span>     *            &lt;/p&gt;<a name="line.178"></a>
<span class="sourceLineNo">179</span>     *            &lt;/div&gt;<a name="line.179"></a>
<span class="sourceLineNo">180</span>     *<a name="line.180"></a>
<span class="sourceLineNo">181</span>     * @param checkMode<a name="line.181"></a>
<span class="sourceLineNo">182</span>     *            {@link ECheckMode} &lt;div class="zh"&gt;<a name="line.182"></a>
<span class="sourceLineNo">183</span>     *            &lt;p&gt;<a name="line.183"></a>
<span class="sourceLineNo">184</span>     *            校验模式<a name="line.184"></a>
<span class="sourceLineNo">185</span>     *            &lt;/p&gt;<a name="line.185"></a>
<span class="sourceLineNo">186</span>     *            &lt;ul&gt;<a name="line.186"></a>
<span class="sourceLineNo">187</span>     *            &lt;li&gt;{@link ECheckMode#KCV_NONE}&lt;/li&gt;<a name="line.187"></a>
<span class="sourceLineNo">188</span>     *            &lt;li&gt;{@link ECheckMode#KCV_ENCRYPT_0}&lt;/li&gt;<a name="line.188"></a>
<span class="sourceLineNo">189</span>     *            &lt;li&gt;{@link ECheckMode#KCV_ENCRYPT_FIX_DATA}&lt;/li&gt;<a name="line.189"></a>
<span class="sourceLineNo">190</span>     *            &lt;li&gt;{@link ECheckMode#KCV_MAC_INPUT_DATA}&lt;/li&gt;<a name="line.190"></a>
<span class="sourceLineNo">191</span>     *            &lt;li&gt;{@link ECheckMode#KCV_SM4_ENCRYPT_0}&lt;/li&gt;<a name="line.191"></a>
<span class="sourceLineNo">192</span>     *            &lt;/ul&gt;<a name="line.192"></a>
<span class="sourceLineNo">193</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.193"></a>
<span class="sourceLineNo">194</span>     *            &lt;p&gt;<a name="line.194"></a>
<span class="sourceLineNo">195</span>     *            Check Mode<a name="line.195"></a>
<span class="sourceLineNo">196</span>     *            &lt;/p&gt;<a name="line.196"></a>
<span class="sourceLineNo">197</span>     *            &lt;ul&gt;<a name="line.197"></a>
<span class="sourceLineNo">198</span>     *            &lt;li&gt;When checkMode=KCV_NONE -No Check&lt;/li&gt;<a name="line.198"></a>
<span class="sourceLineNo">199</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_0 -Perform DES/TDES encryption on 8 bytes 0x00, and use first 4 bytes<a name="line.199"></a>
<span class="sourceLineNo">200</span>     *            as KCV.&lt;/li&gt;<a name="line.200"></a>
<span class="sourceLineNo">201</span>     *<a name="line.201"></a>
<span class="sourceLineNo">202</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_FIX_DATA -Perform parity check first, then perform DES/TDES encryption<a name="line.202"></a>
<span class="sourceLineNo">203</span>     *            on 8 bytes―\x12\x34\x56\x78\x90\x12\x34\x56, and use first 4 bytes as KCV.&lt;/li&gt;<a name="line.203"></a>
<span class="sourceLineNo">204</span>     *<a name="line.204"></a>
<span class="sourceLineNo">205</span>     *            &lt;li&gt;When iCheckMode=KCV_MAC_INPUT_DATA -Send in data KcvData, use source key to perform specified mode<a name="line.205"></a>
<span class="sourceLineNo">206</span>     *            of MAC on [aucDesKeyValue +KcvData], and use the 8 bytes result as KCV.&lt;/li&gt;<a name="line.206"></a>
<span class="sourceLineNo">207</span>     *<a name="line.207"></a>
<span class="sourceLineNo">208</span>     *            &lt;li&gt;When iCheckMode=KCV_SM4_ENCRYPT_0 -Perform TDES encryption on 16 bytes 0x00 by SM4, and use first<a name="line.208"></a>
<span class="sourceLineNo">209</span>     *            4 bytes as KCV.&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;<a name="line.209"></a>
<span class="sourceLineNo">210</span>     *<a name="line.210"></a>
<span class="sourceLineNo">211</span>     * @param checkBuf<a name="line.211"></a>
<span class="sourceLineNo">212</span>     *            &lt;div class="zh"&gt;<a name="line.212"></a>
<span class="sourceLineNo">213</span>     *            &lt;p&gt;<a name="line.213"></a>
<span class="sourceLineNo">214</span>     *            校验数据缓冲区<a name="line.214"></a>
<span class="sourceLineNo">215</span>     *            &lt;/p&gt;<a name="line.215"></a>
<span class="sourceLineNo">216</span>     *            &lt;ul&gt;<a name="line.216"></a>
<span class="sourceLineNo">217</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_NONE}时 checkBuf的值无效,系统认为不验证KCV,可以为null&lt;/li&gt;<a name="line.217"></a>
<span class="sourceLineNo">218</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_ENCRYPT_0},4字节的kcv&lt;/li&gt;<a name="line.218"></a>
<span class="sourceLineNo">219</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_ENCRYPT_FIX_DATA},4字节的kcv&lt;/li&gt;<a name="line.219"></a>
<span class="sourceLineNo">220</span>     *            &lt;li&gt;当iCheckMode={@link ECheckMode#KCV_MAC_INPUT_DATA}时按以下规则提供checkBuf:<a name="line.220"></a>
<span class="sourceLineNo">221</span>     *            &lt;p&gt;<a name="line.221"></a>
<span class="sourceLineNo">222</span>     *            checkBuf[0]= KcvData长度(KcvDataLen)<a name="line.222"></a>
<span class="sourceLineNo">223</span>     *            &lt;/p&gt;<a name="line.223"></a>
<span class="sourceLineNo">224</span>     *            &lt;p&gt;<a name="line.224"></a>
<span class="sourceLineNo">225</span>     *            checkBuf+1: KcvData<a name="line.225"></a>
<span class="sourceLineNo">226</span>     *            &lt;/p&gt;<a name="line.226"></a>
<span class="sourceLineNo">227</span>     *            &lt;p&gt;<a name="line.227"></a>
<span class="sourceLineNo">228</span>     *            checkBuf[1+KcvDataLen]=MAC运算模式,参考{@link #getMac(byte, byte[], EPedMacMode)}中的mode参数<a name="line.228"></a>
<span class="sourceLineNo">229</span>     *            &lt;/p&gt;<a name="line.229"></a>
<span class="sourceLineNo">230</span>     *            &lt;p&gt;<a name="line.230"></a>
<span class="sourceLineNo">231</span>     *            checkBuf[2+KcvDataLen]=KCV长度<a name="line.231"></a>
<span class="sourceLineNo">232</span>     *            &lt;/p&gt;<a name="line.232"></a>
<span class="sourceLineNo">233</span>     *            &lt;p&gt;<a name="line.233"></a>
<span class="sourceLineNo">234</span>     *            checkBuf[3+KcvDataLen]是KCV的值<a name="line.234"></a>
<span class="sourceLineNo">235</span>     *            &lt;/p&gt;<a name="line.235"></a>
<span class="sourceLineNo">236</span>     *            &lt;/li&gt;<a name="line.236"></a>
<span class="sourceLineNo">237</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_SM4_ENCRYPT_0},4字节的kcv&lt;/li&gt;<a name="line.237"></a>
<span class="sourceLineNo">238</span>     *            &lt;/ul&gt;<a name="line.238"></a>
<span class="sourceLineNo">239</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.239"></a>
<span class="sourceLineNo">240</span>     *            &lt;p&gt;<a name="line.240"></a>
<span class="sourceLineNo">241</span>     *            Check Data Buffer<a name="line.241"></a>
<span class="sourceLineNo">242</span>     *            &lt;/p&gt;<a name="line.242"></a>
<span class="sourceLineNo">243</span>     *            &lt;ul&gt;<a name="line.243"></a>
<span class="sourceLineNo">244</span>     *            &lt;li&gt;When checkMode=KCV_NONE -PED wont check KCV, this data is no meaning.&lt;/li&gt;<a name="line.244"></a>
<span class="sourceLineNo">245</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_0 -4 bytes key check value&lt;/li&gt;<a name="line.245"></a>
<span class="sourceLineNo">246</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_FIX_DATA -4 bytes key check value&lt;/li&gt;<a name="line.246"></a>
<span class="sourceLineNo">247</span>     *            &lt;li&gt;When iCheckMode=KCV_MAC_INPUT_DATA - checkBuf as follows: checkBuf[0] = length of KcvData<a name="line.247"></a>
<span class="sourceLineNo">248</span>     *            checkBuf+1: kcvData checkBuf[1+kcvDataLen]: MAC computation mode<a name="line.248"></a>
<span class="sourceLineNo">249</span>     *            {@link #getMac(byte, byte[], EPedMacMode)} checkBuf[2+kcvDataLen]:KCV length<a name="line.249"></a>
<span class="sourceLineNo">250</span>     *            checkBuf[3+kcvDataLen]:KCV Value&lt;/li&gt;<a name="line.250"></a>
<span class="sourceLineNo">251</span>     *            &lt;li&gt;When checkMode=KCV_SM4_ENCRYPT_0 -4 bytes key check value&lt;/li&gt;<a name="line.251"></a>
<span class="sourceLineNo">252</span>     *            &lt;/ul&gt;<a name="line.252"></a>
<span class="sourceLineNo">253</span>     *            &lt;/div&gt;<a name="line.253"></a>
<span class="sourceLineNo">254</span>     *<a name="line.254"></a>
<span class="sourceLineNo">255</span>     * @throws PedDevException<a name="line.255"></a>
<span class="sourceLineNo">256</span>     */<a name="line.256"></a>
<span class="sourceLineNo">257</span>    public void writeKey(EPedKeyType srcKeyType, byte srcKeyIndex, EPedKeyType destKeyType, byte destkeyIndex,<a name="line.257"></a>
<span class="sourceLineNo">258</span>            byte[] destKeyValue, ECheckMode checkMode, byte[] checkBuf) throws PedDevException;<a name="line.258"></a>
<span class="sourceLineNo">259</span><a name="line.259"></a>
<span class="sourceLineNo">260</span>    /**<a name="line.260"></a>
<span class="sourceLineNo">261</span>     * &lt;div class="zh"&gt; 写入TIK，并可以选择使用KCV验证密钥正确性。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.261"></a>
<span class="sourceLineNo">262</span>     * &lt;div class="en"&gt; Write in TIK, and can check the key correction by using KCV. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.262"></a>
<span class="sourceLineNo">263</span>     *<a name="line.263"></a>
<span class="sourceLineNo">264</span>     * @param groupIndex<a name="line.264"></a>
<span class="sourceLineNo">265</span>     *            &lt;div class="zh"&gt; [1~100] DUKPT密钥组索引号 &lt;/div&gt; &lt;div class="en"&gt; [1~100]DUKPT key group id &lt;/div&gt;<a name="line.265"></a>
<span class="sourceLineNo">266</span>     *<a name="line.266"></a>
<span class="sourceLineNo">267</span>     * @param srcKeyIndex<a name="line.267"></a>
<span class="sourceLineNo">268</span>     *            &lt;div class="zh"&gt; [0~1] 保护密钥的密钥索引。0表示明文写入。 &lt;/div&gt; &lt;div class="en"&gt; [0~1] The index of the key protecting the key. 0 means writing in plaintext.<a name="line.268"></a>
<span class="sourceLineNo">269</span>     *            &lt;/div&gt;<a name="line.269"></a>
<span class="sourceLineNo">270</span>     *<a name="line.270"></a>
<span class="sourceLineNo">271</span>     * @param keyValue<a name="line.271"></a>
<span class="sourceLineNo">272</span>     *            &lt;div class="zh"&gt; TIK的明文或者密文。srcKeyIdx为0时表示明文写入。DUKPT算法支持8/16字节长度的密钥。&lt;/div&gt;<a name="line.272"></a>
<span class="sourceLineNo">273</span>     *            &lt;div class="en"&gt; The plaintext or ciphertext of TIK. When srcKeyIdx is 0, it means writing plain text. The DUKPT algorithm supports keys with a length of 8/16 bytes. &lt;/div&gt;<a name="line.273"></a>
<span class="sourceLineNo">274</span>     *<a name="line.274"></a>
<span class="sourceLineNo">275</span>     * @param ksn<a name="line.275"></a>
<span class="sourceLineNo">276</span>     *            &lt;div class="zh"&gt; 指向初始化KSN &lt;/div&gt; &lt;div class="en"&gt; Point to KSN initialization. &lt;/div&gt;<a name="line.276"></a>
<span class="sourceLineNo">277</span>     *<a name="line.277"></a>
<span class="sourceLineNo">278</span>     * @param checkMode<a name="line.278"></a>
<span class="sourceLineNo">279</span>     *            &lt;div class="zh"&gt; {@link ECheckMode} &lt;/div&gt; &lt;div class="en"&gt; reference {@link IPed#writeKey} checkMode<a name="line.279"></a>
<span class="sourceLineNo">280</span>     *            &lt;/div&gt;<a name="line.280"></a>
<span class="sourceLineNo">281</span>     * @param checkBuf<a name="line.281"></a>
<span class="sourceLineNo">282</span>     *            &lt;div class="zh"&gt; 参考{@link IPed#writeKey}关于checkBuf说明 &lt;/div&gt; &lt;div class="en"&gt; reference<a name="line.282"></a>
<span class="sourceLineNo">283</span>     *            {@link IPed#writeKey} the information about checkBuf &lt;/div&gt;<a name="line.283"></a>
<span class="sourceLineNo">284</span>     *<a name="line.284"></a>
<span class="sourceLineNo">285</span>     * @throws PedDevException<a name="line.285"></a>
<span class="sourceLineNo">286</span>     */<a name="line.286"></a>
<span class="sourceLineNo">287</span>    public void writeTIK(byte groupIndex, byte srcKeyIndex, byte[] keyValue, byte[] ksn, ECheckMode checkMode,<a name="line.287"></a>
<span class="sourceLineNo">288</span>            byte[] checkBuf) throws PedDevException;<a name="line.288"></a>
<span class="sourceLineNo">289</span><a name="line.289"></a>
<span class="sourceLineNo">290</span>    /**<a name="line.290"></a>
<span class="sourceLineNo">291</span>     * &lt;div class="zh"&gt; 指定的时限内，扫描键盘上输入的PIN并输出PIN BLOCK加密数据块。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.291"></a>
<span class="sourceLineNo">292</span>     * &lt;div class="en"&gt; Scan the keyboard PIN entry and output the PIN BLOCK encrypted data block in a specific time.{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported. &lt;/div&gt;<a name="line.292"></a>
<span class="sourceLineNo">293</span>     *<a name="line.293"></a>
<span class="sourceLineNo">294</span>     *<a name="line.294"></a>
<span class="sourceLineNo">295</span>     * @param keyIndex<a name="line.295"></a>
<span class="sourceLineNo">296</span>     *            &lt;div class="zh"&gt; [1~100] TPK的索引 &lt;/div&gt; &lt;div class="en"&gt; [1~100] TPK index &lt;/div&gt;<a name="line.296"></a>
<span class="sourceLineNo">297</span>     *<a name="line.297"></a>
<span class="sourceLineNo">298</span>     * @param expPinLen<a name="line.298"></a>
<span class="sourceLineNo">299</span>     *            &lt;div class="zh"&gt; &lt;p&gt;当IPed为{@link EPedType#INTERNAL}:0~12的枚举集合<a name="line.299"></a>
<span class="sourceLineNo">300</span>     *            可输入的合法密码长度字符串，应用程序把允许的密码长度全部枚举出来，并且用"，"号隔开每个长度，如允许输入4、6位密码并且允许无密码直接按确认，则该字符串应该设置为"0,4,6"。<a name="line.300"></a>
<span class="sourceLineNo">301</span>     *            若枚举0长度则示意可以不输任何数字而直接按确认键返回。&lt;/p&gt; &lt;p&gt;当IPed为{@link EPedType#EXTERNAL_TYPEA}:PIN长度在expPinLen中的最小值和最大值区间。如果mode = EPinBlockMode.ISO9564_0时,当最小长度不为0时,允许按"确认"退出 。&lt;/p&gt; &lt;/div&gt;<a name="line.301"></a>
<span class="sourceLineNo">302</span>     *            &lt;div class="en"&gt;&lt;p&gt;When IPed is {@link EPedType#INTERNAL}:Enumeration of 0-12.The enter password string with legal length. Application enumerates of all possible lengths of PIN. ","will be used to separate each<a name="line.302"></a>
<span class="sourceLineNo">303</span>     *            number of length. If no PIN,or 4 or 6 digits of PIN are allowed, the string will be set as "0,4,6". 0 means that no PIN is required, and pressing "Enter" will return.&lt;p&gt;<a name="line.303"></a>
<span class="sourceLineNo">304</span>     *            &lt;p&gt;When IPed is {@link EPedType#EXTERNAL_TYPEA}:The PIN length is between the minimum and maximum values in expPinLen. If mode = EPinBlockMode.ISO9564_0, press "ok" to exit when the minimum length is not 0.&lt;/p&gt; &lt;/div&gt;<a name="line.304"></a>
<span class="sourceLineNo">305</span>     *<a name="line.305"></a>
<span class="sourceLineNo">306</span>     * @param dataIn<a name="line.306"></a>
<span class="sourceLineNo">307</span>     *            &lt;div class="zh"&gt;<a name="line.307"></a>
<span class="sourceLineNo">308</span>     *            &lt;ul&gt;<a name="line.308"></a>
<span class="sourceLineNo">309</span>     *            &lt;li&gt;当mode={@link EPinBlockMode#ISO9564_0}时, DataIn指向卡号移位后生成的16位主帐号。&lt;/li&gt;<a name="line.309"></a>
<span class="sourceLineNo">310</span>     *            &lt;li&gt;当mode={@link EPinBlockMode#ISO9564_1}时, DataIn被忽略.接口内部采用随机数填充PINBlock。&lt;/li&gt;<a name="line.310"></a>
<span class="sourceLineNo">311</span>     *            &lt;li&gt;当mode={@link EPinBlockMode#ISO9564_3}时, DataIn指向位移后的16位PAN。&lt;/li&gt;<a name="line.311"></a>
<span class="sourceLineNo">312</span>     *            &lt;li&gt;当mode={@link EPinBlockMode#HKEPS}时, 为交易流水号ISN [6 Bytes,ASCII码]&lt;/li&gt;<a name="line.312"></a>
<span class="sourceLineNo">313</span>     *            &lt;/ul&gt;<a name="line.313"></a>
<span class="sourceLineNo">314</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.314"></a>
<span class="sourceLineNo">315</span>     *            &lt;ul&gt;<a name="line.315"></a>
<span class="sourceLineNo">316</span>     *            &lt;li&gt;When mode=ISO9564_0, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.316"></a>
<span class="sourceLineNo">317</span>     *            &lt;li&gt;When mode=ISO9564_1, DataIn is ignored. The interface uses random numbers to fill PINBlock internally.&lt;/li&gt;<a name="line.317"></a>
<span class="sourceLineNo">318</span>     *            &lt;li&gt;When mode=ISO9564_3, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.318"></a>
<span class="sourceLineNo">319</span>     *            &lt;li&gt;When mode=HKEPS, dataIn is ISN [6 Bytes, ASCII code]&lt;/li&gt;<a name="line.319"></a>
<span class="sourceLineNo">320</span>     *            &lt;/ul&gt;<a name="line.320"></a>
<span class="sourceLineNo">321</span>     *            &lt;/div&gt;<a name="line.321"></a>
<span class="sourceLineNo">322</span>     *<a name="line.322"></a>
<span class="sourceLineNo">323</span>     * @param mode<a name="line.323"></a>
<span class="sourceLineNo">324</span>     *            {@link EPinBlockMode} &lt;div class="zh"&gt; PIN BLOCK的格式<a name="line.324"></a>
<span class="sourceLineNo">325</span>     *            &lt;ul&gt;<a name="line.325"></a>
<span class="sourceLineNo">326</span>     *            &lt;li&gt;{@link EPinBlockMode#ISO9564_0}&lt;/li&gt;<a name="line.326"></a>
<span class="sourceLineNo">327</span>     *            &lt;li&gt;{@link EPinBlockMode#ISO9564_1}&lt;/li&gt;<a name="line.327"></a>
<span class="sourceLineNo">328</span>     *            &lt;li&gt;{@link EPinBlockMode#ISO9564_3}&lt;/li&gt;<a name="line.328"></a>
<span class="sourceLineNo">329</span>     *            &lt;li&gt;{@link EPinBlockMode#HKEPS}&lt;/li&gt;<a name="line.329"></a>
<span class="sourceLineNo">330</span>     *            &lt;/ul&gt;<a name="line.330"></a>
<span class="sourceLineNo">331</span>     *            &lt;/div&gt; &lt;div class="en"&gt; PIN BLOCK Format<a name="line.331"></a>
<span class="sourceLineNo">332</span>     *            &lt;ul&gt;<a name="line.332"></a>
<span class="sourceLineNo">333</span>     *            &lt;li&gt;ISO9564_0&lt;/li&gt;<a name="line.333"></a>
<span class="sourceLineNo">334</span>     *            &lt;li&gt;ISO9564_1&lt;/li&gt;<a name="line.334"></a>
<span class="sourceLineNo">335</span>     *            &lt;li&gt;ISO9564_3&lt;/li&gt;<a name="line.335"></a>
<span class="sourceLineNo">336</span>     *            &lt;li&gt;HKEPS -EPS PINBLOCK Format&lt;/li&gt;<a name="line.336"></a>
<span class="sourceLineNo">337</span>     *            &lt;/ul&gt;<a name="line.337"></a>
<span class="sourceLineNo">338</span>     *            &lt;/div&gt;<a name="line.338"></a>
<span class="sourceLineNo">339</span>     *<a name="line.339"></a>
<span class="sourceLineNo">340</span>     * @param timeoutMs<a name="line.340"></a>
<span class="sourceLineNo">341</span>     *            &lt;div class="zh"&gt;<a name="line.341"></a>
<span class="sourceLineNo">342</span>     *            &lt;p&gt;<a name="line.342"></a>
<span class="sourceLineNo">343</span>     *            输入PIN的超时时间,单位：毫秒 最大值为300000ms<a name="line.343"></a>
<span class="sourceLineNo">344</span>     *            &lt;/p&gt;<a name="line.344"></a>
<span class="sourceLineNo">345</span>     *            &lt;p&gt;<a name="line.345"></a>
<span class="sourceLineNo">346</span>     *            0:表示没有超时时间，PED不做超时控制<a name="line.346"></a>
<span class="sourceLineNo">347</span>     *            &lt;/p&gt;<a name="line.347"></a>
<span class="sourceLineNo">348</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.348"></a>
<span class="sourceLineNo">349</span>     *            &lt;p&gt;<a name="line.349"></a>
<span class="sourceLineNo">350</span>     *            The timeout of PIN entry [unit:ms] Maximum is 300000ms.<a name="line.350"></a>
<span class="sourceLineNo">351</span>     *            &lt;/p&gt;<a name="line.351"></a>
<span class="sourceLineNo">352</span>     *            &lt;p&gt;<a name="line.352"></a>
<span class="sourceLineNo">353</span>     *            0: No timeout time, not doing timeout control for PED.<a name="line.353"></a>
<span class="sourceLineNo">354</span>     *            &lt;/p&gt;<a name="line.354"></a>
<span class="sourceLineNo">355</span>     *            &lt;/div&gt;<a name="line.355"></a>
<span class="sourceLineNo">356</span>     *<a name="line.356"></a>
<span class="sourceLineNo">357</span>     * @return &lt;div class="zh"&gt; 返回pinBlock，如果bypass 返回NULL &lt;/div&gt; &lt;div class="en"&gt; Return pinBlock byte array, if<a name="line.357"></a>
<span class="sourceLineNo">358</span>     *         bypass,return NULL. &lt;/div&gt;<a name="line.358"></a>
<span class="sourceLineNo">359</span>     *<a name="line.359"></a>
<span class="sourceLineNo">360</span>     * @throws PedDevException<a name="line.360"></a>
<span class="sourceLineNo">361</span>     */<a name="line.361"></a>
<span class="sourceLineNo">362</span>    public byte[] getPinBlock(byte keyIndex, String expPinLen, byte[] dataIn, EPinBlockMode mode, int timeoutMs)<a name="line.362"></a>
<span class="sourceLineNo">363</span>            throws PedDevException;<a name="line.363"></a>
<span class="sourceLineNo">364</span><a name="line.364"></a>
<span class="sourceLineNo">365</span>    /**<a name="line.365"></a>
<span class="sourceLineNo">366</span>     * &lt;div class="zh"&gt; 用KeyIdx指定的MAC密钥对DataIn进行mode指定的算法进行MAC运算，将8字节的MAC结果返回 外置A类PED需要除了设置PinBlockMode外还需要调用setExMode<a name="line.366"></a>
<span class="sourceLineNo">367</span>     * {@link IPed#setExMode}设置exMode exMode默认为-1,表示TAK长度为16字节,如果TAK长度为16字节则可以使用该默认值 。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。&lt;/div&gt;<a name="line.367"></a>
<span class="sourceLineNo">368</span>     * &lt;div class="en"&gt; To use KeyIdx MAC key calculate the DataIn following the specified Mode algorithm, return the 8 bytes MAC result.<a name="line.368"></a>
<span class="sourceLineNo">369</span>     * {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.369"></a>
<span class="sourceLineNo">370</span>     *<a name="line.370"></a>
<span class="sourceLineNo">371</span>     * @param keyIndex<a name="line.371"></a>
<span class="sourceLineNo">372</span>     *            &lt;div class="zh"&gt; [1~100] TAK的索引 &lt;/div&gt; &lt;div class="en"&gt; [1~100] TAK index &lt;/div&gt;<a name="line.372"></a>
<span class="sourceLineNo">373</span>     *<a name="line.373"></a>
<span class="sourceLineNo">374</span>     * @param dataIn<a name="line.374"></a>
<span class="sourceLineNo">375</span>     *            &lt;div class="zh"&gt; 长度&lt;=1024 MAC运算的数据包的长度[输入],长度 不为8字节整除,则自动补"\x00" &lt;/div&gt; &lt;div class="en"&gt; The data<a name="line.375"></a>
<span class="sourceLineNo">376</span>     *            length less than or equal to 1024 bytes If the length not multiple by 8, 0x00 will be padding<a name="line.376"></a>
<span class="sourceLineNo">377</span>     *            automatically. &lt;/div&gt;<a name="line.377"></a>
<span class="sourceLineNo">378</span>     *<a name="line.378"></a>
<span class="sourceLineNo">379</span>     * @param mode<a name="line.379"></a>
<span class="sourceLineNo">380</span>     *            &lt;div class="zh"&gt;<a name="line.380"></a>
<span class="sourceLineNo">381</span>     *            &lt;ul&gt;<a name="line.381"></a>
<span class="sourceLineNo">382</span>     *            &lt;li&gt;{@link EPedMacMode#MODE_00}&lt;/li&gt;<a name="line.382"></a>
<span class="sourceLineNo">383</span>     *            &lt;li&gt;{@link EPedMacMode#MODE_01}&lt;/li&gt;<a name="line.383"></a>
<span class="sourceLineNo">384</span>     *            &lt;li&gt;{@link EPedMacMode#MODE_02}&lt;/li&gt;<a name="line.384"></a>
<span class="sourceLineNo">385</span>     *            &lt;li&gt;{@link EPedMacMode#MODE_03}&lt;/li&gt;<a name="line.385"></a>
<span class="sourceLineNo">386</span>     *            &lt;li&gt;{@link EPedMacMode#MODE_05}&lt;/li&gt;<a name="line.386"></a>
<span class="sourceLineNo">387</span>     *            &lt;li&gt;{@link EPedMacMode#MODE_06}&lt;/li&gt;<a name="line.387"></a>
<span class="sourceLineNo">388</span>     *            &lt;/ul&gt;<a name="line.388"></a>
<span class="sourceLineNo">389</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.389"></a>
<span class="sourceLineNo">390</span>     *            &lt;ul&gt;<a name="line.390"></a>
<span class="sourceLineNo">391</span>     *            &lt;li&gt;MODE_00 -Doing DES/TDES encryption for BLOCK1 by usingMAC key. Doing DES/TDES encryption again by<a name="line.391"></a>
<span class="sourceLineNo">392</span>     *            using TAK when and after bitwise XOR the previous encryption result with BLOCK2. Processing in turn to<a name="line.392"></a>
<span class="sourceLineNo">393</span>     *            get the 8 bytes encryption result.&lt;/li&gt;<a name="line.393"></a>
<span class="sourceLineNo">394</span>     *            &lt;li&gt;MODE_01 -Doing bitwise XOR for BLOCK1 and BLOCK2; Do bitwise XOR again by using previous XOR<a name="line.394"></a>
<span class="sourceLineNo">395</span>     *            result with BLOCK3. Do it in turn and finally get the 8 bytes XOR result. Using TAK to process<a name="line.395"></a>
<span class="sourceLineNo">396</span>     *            DES/TDES encryption for the result&lt;/li&gt;<a name="line.396"></a>
<span class="sourceLineNo">397</span>     *            &lt;li&gt;MODE_02 -ANSIX9.19 standard, Do DES encryption for BLOCK1 by using TAK (only take the first 8<a name="line.397"></a>
<span class="sourceLineNo">398</span>     *            bytes of key). The encryption result wills bitwise XOR with BLOCK2,and then doing DES encryption by<a name="line.398"></a>
<span class="sourceLineNo">399</span>     *            using TAK again. Do it in turn and get the 8 bytes encryption result. Using DES/TDES to encrypt in the<a name="line.399"></a>
<span class="sourceLineNo">400</span>     *            last time.&lt;/li&gt;<a name="line.400"></a>
<span class="sourceLineNo">401</span>     *            &lt;li&gt;MODE_03 -CMAC algorithm. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.401"></a>
<span class="sourceLineNo">402</span>     *            &lt;li&gt;MODE_05 -HMAC-SHA256 algorithm. KSN does not automatically increase by 1. Other values retain the extended MAC algorithm.&lt;/li&gt;<a name="line.402"></a>
<span class="sourceLineNo">403</span>     *            &lt;li&gt;MODE_06 -APACS70OWF MAC calculation of mac key.&lt;/li&gt;<a name="line.403"></a>
<span class="sourceLineNo">404</span>     *            &lt;/ul&gt;<a name="line.404"></a>
<span class="sourceLineNo">405</span>     *            &lt;/div&gt;<a name="line.405"></a>
<span class="sourceLineNo">406</span>     *<a name="line.406"></a>
<span class="sourceLineNo">407</span>     * @return &lt;div class="zh"&gt; 返回MAC结果。当mode等于HMAC-SHA256算法是，输出长度为32字节。其他为8字节。&lt;/div&gt;<a name="line.407"></a>
<span class="sourceLineNo">408</span>     * &lt;div class="en"&gt; return the MAC data。When the mode is equal to the HMAC-SHA256 algorithm, the output length is 32 bytes. Others are 8 bytes.&lt;/div&gt;<a name="line.408"></a>
<span class="sourceLineNo">409</span>     *<a name="line.409"></a>
<span class="sourceLineNo">410</span>     * @throws PedDevException<a name="line.410"></a>
<span class="sourceLineNo">411</span>     */<a name="line.411"></a>
<span class="sourceLineNo">412</span><a name="line.412"></a>
<span class="sourceLineNo">413</span>    public byte[] getMac(byte keyIndex, byte[] dataIn, EPedMacMode mode) throws PedDevException;<a name="line.413"></a>
<span class="sourceLineNo">414</span><a name="line.414"></a>
<span class="sourceLineNo">415</span>    /**<a name="line.415"></a>
<span class="sourceLineNo">416</span>     * &lt;div class="zh"&gt; 使用TDK对DataInLen长度的数据进行DES/TDES运算，使用DES或TDES根据密钥的长度而定。<a name="line.416"></a>
<span class="sourceLineNo">417</span>     * 外置A类PED需要调用setExMode {@link IPed#setExMode}设置exMode exMode默认为-1,表示TDK长度为16字节,如果TDK长度为16字节则可以使用该默认值。<a name="line.417"></a>
<span class="sourceLineNo">418</span>     * 支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.418"></a>
<span class="sourceLineNo">419</span>     * &lt;div class="en"&gt; To use TDK encrypt or decrypt data by DES/TDES. Using DES or TDES depends on the key length.<a name="line.419"></a>
<span class="sourceLineNo">420</span>     * {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.420"></a>
<span class="sourceLineNo">421</span>     *<a name="line.421"></a>
<span class="sourceLineNo">422</span>     * @param keyIndex<a name="line.422"></a>
<span class="sourceLineNo">423</span>     *            &lt;div class="zh"&gt; [1~100] TDK或者TXK的索引 。&lt;/div&gt; &lt;div class="en"&gt; [1~100] TDK or TXK index.&lt;/div&gt;<a name="line.423"></a>
<span class="sourceLineNo">424</span>     *<a name="line.424"></a>
<span class="sourceLineNo">425</span>     * @param datain<a name="line.425"></a>
<span class="sourceLineNo">426</span>     *            &lt;div class="zh"&gt; 待运算的数据,数据长度 &lt;=8k字节, 必须能被8字节整除 &lt;/div&gt; &lt;div class="en"&gt; the data to be calculated.The<a name="line.426"></a>
<span class="sourceLineNo">427</span>     *            data length &lt;=8k bytes, must be divisible by 8 bytes &lt;/div&gt;<a name="line.427"></a>
<span class="sourceLineNo">428</span>     *<a name="line.428"></a>
<span class="sourceLineNo">429</span>     * @param mode<a name="line.429"></a>
<span class="sourceLineNo">430</span>     *            {@link EPedDesMode}<a name="line.430"></a>
<span class="sourceLineNo">431</span>     *<a name="line.431"></a>
<span class="sourceLineNo">432</span>     * @return &lt;div class="zh"&gt; 运算后的数据 。&lt;/div&gt; &lt;div class="en"&gt; The data which have been calculated. &lt;/div&gt;<a name="line.432"></a>
<span class="sourceLineNo">433</span>     *<a name="line.433"></a>
<span class="sourceLineNo">434</span>     * @throws PedDevException<a name="line.434"></a>
<span class="sourceLineNo">435</span>     */<a name="line.435"></a>
<span class="sourceLineNo">436</span>    public byte[] calcDes(byte keyIndex, byte[] datain, EPedDesMode mode) throws PedDevException;<a name="line.436"></a>
<span class="sourceLineNo">437</span><a name="line.437"></a>
<span class="sourceLineNo">438</span>    /**<a name="line.438"></a>
<span class="sourceLineNo">439</span>     * &lt;div class="zh"&gt; 使用TDK对DataInLen长度的数据进行DES/TDES运算，使用DES或TDES根据密钥的长度而定。<a name="line.439"></a>
<span class="sourceLineNo">440</span>     * 外置A类PED需要调用setExMode {@link IPed#setExMode}设置exMode exMode默认为-1,表示TDK长度为16字节,如果TDK长度为16字节则可以使用该默认值 。<a name="line.440"></a>
<span class="sourceLineNo">441</span>     * 支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。&lt;/div&gt;<a name="line.441"></a>
<span class="sourceLineNo">442</span>     * &lt;div class="en"&gt; To use TDK encrypt or decrypt data by DES/TDES. Using DES or TDES depends on the key length.<a name="line.442"></a>
<span class="sourceLineNo">443</span>     * {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported. &lt;/div&gt;<a name="line.443"></a>
<span class="sourceLineNo">444</span>     *<a name="line.444"></a>
<span class="sourceLineNo">445</span>     * @param keyIndex<a name="line.445"></a>
<span class="sourceLineNo">446</span>     *            &lt;div class="zh"&gt; [1~100] TDK的索引 &lt;/div&gt; &lt;div class="en"&gt; [1~100] TDK index &lt;/div&gt;<a name="line.446"></a>
<span class="sourceLineNo">447</span>     *<a name="line.447"></a>
<span class="sourceLineNo">448</span>     * @param initvector<a name="line.448"></a>
<span class="sourceLineNo">449</span>     *            &lt;div class="zh"&gt;使用CBC 模式进行加解密运算时需要用到，若InitVector为NULL，则默认为8字节的全0x00。 使用ECB加解密时不需要，可以为NULL。 &lt;/div&gt; &lt;div<a name="line.449"></a>
<span class="sourceLineNo">450</span>     *            class="en"&gt; ECB mode: init vector is null .CBC mode: init vector, 8 bytes. &lt;/div&gt;<a name="line.450"></a>
<span class="sourceLineNo">451</span>     *<a name="line.451"></a>
<span class="sourceLineNo">452</span>     * @param dataIn<a name="line.452"></a>
<span class="sourceLineNo">453</span>     *            &lt;div class="zh"&gt; 待运算的数据,数据长度除ECB模式和CBC最大支持8k字节,其他模式最大支持2048字节。 必须能被8字节整除 &lt;/div&gt; &lt;div class="en"&gt; the data to be calculated.<a name="line.453"></a>
<span class="sourceLineNo">454</span>     *            The data length except the ECB and CBC mode supports a maximum of 8k bytes, and the other modes support a maximum of 2048 bytes. must be divisible by 8 bytes &lt;/div&gt;<a name="line.454"></a>
<span class="sourceLineNo">455</span>     *<a name="line.455"></a>
<span class="sourceLineNo">456</span>     * @param mode<a name="line.456"></a>
<span class="sourceLineNo">457</span>     *            &lt;div class="zh"&gt;<a name="line.457"></a>
<span class="sourceLineNo">458</span>     *            &lt;ul&gt;<a name="line.458"></a>
<span class="sourceLineNo">459</span>     *            &lt;li&gt;0: ECB模式解密&lt;/li&gt;<a name="line.459"></a>
<span class="sourceLineNo">460</span>     *            &lt;li&gt;1: ECB模式加密&lt;/li&gt;<a name="line.460"></a>
<span class="sourceLineNo">461</span>     *            &lt;li&gt;2: CBC模式解密&lt;/li&gt;<a name="line.461"></a>
<span class="sourceLineNo">462</span>     *            &lt;li&gt;3: CBC模式加密&lt;/li&gt;<a name="line.462"></a>
<span class="sourceLineNo">463</span>     *            &lt;li&gt;4: OFB模式解密&lt;/li&gt;<a name="line.463"></a>
<span class="sourceLineNo">464</span>     *            &lt;li&gt;5: OFB模式加密&lt;/li&gt;<a name="line.464"></a>
<span class="sourceLineNo">465</span>     *            &lt;li&gt;6: CFB8模式解密&lt;/li&gt;<a name="line.465"></a>
<span class="sourceLineNo">466</span>     *            &lt;li&gt;7: CFB8模式加密&lt;/li&gt;<a name="line.466"></a>
<span class="sourceLineNo">467</span>     *            &lt;/ul&gt;<a name="line.467"></a>
<span class="sourceLineNo">468</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.468"></a>
<span class="sourceLineNo">469</span>     *            &lt;ul&gt;<a name="line.469"></a>
<span class="sourceLineNo">470</span>     *            &lt;li&gt;0: DECRYPT#ECB&lt;/li&gt;<a name="line.470"></a>
<span class="sourceLineNo">471</span>     *            &lt;li&gt;1: ENCRYPT#ECB&lt;/li&gt;<a name="line.471"></a>
<span class="sourceLineNo">472</span>     *            &lt;li&gt;2: DECRYPT#CBC&lt;/li&gt;<a name="line.472"></a>
<span class="sourceLineNo">473</span>     *            &lt;li&gt;3: ENCRYPT#CBC&lt;/li&gt;<a name="line.473"></a>
<span class="sourceLineNo">474</span>     *            &lt;li&gt;4: DECRYPT#OFB&lt;/li&gt;<a name="line.474"></a>
<span class="sourceLineNo">475</span>     *            &lt;li&gt;5: ENCRYPT#OFB&lt;/li&gt;<a name="line.475"></a>
<span class="sourceLineNo">476</span>     *            &lt;li&gt;6: DECRYPT#CFB8&lt;/li&gt;<a name="line.476"></a>
<span class="sourceLineNo">477</span>     *            &lt;li&gt;7: ENCRYPT#CFB8&lt;/li&gt;<a name="line.477"></a>
<span class="sourceLineNo">478</span>     *            &lt;/ul&gt;<a name="line.478"></a>
<span class="sourceLineNo">479</span>     *            &lt;/div&gt;<a name="line.479"></a>
<span class="sourceLineNo">480</span>     *<a name="line.480"></a>
<span class="sourceLineNo">481</span>     * @return &lt;div class="zh"&gt; 返回运算后的数据 &lt;/div&gt; &lt;div class="en"&gt; the data after calculation. &lt;/div&gt;<a name="line.481"></a>
<span class="sourceLineNo">482</span>     *<a name="line.482"></a>
<span class="sourceLineNo">483</span>     * @throws PedDevException<a name="line.483"></a>
<span class="sourceLineNo">484</span>     * @since V2.04.00<a name="line.484"></a>
<span class="sourceLineNo">485</span>     */<a name="line.485"></a>
<span class="sourceLineNo">486</span>    public byte[] calcDes(byte keyIndex, byte[] initvector, byte[] dataIn, byte mode) throws PedDevException;<a name="line.486"></a>
<span class="sourceLineNo">487</span><a name="line.487"></a>
<span class="sourceLineNo">488</span>    /**<a name="line.488"></a>
<span class="sourceLineNo">489</span>     * &lt;div class="zh"&gt; 在PED上输入PIN，并使DUKPT的PIN密钥计算PINBlock。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。&lt;/div&gt;<a name="line.489"></a>
<span class="sourceLineNo">490</span>     * &lt;div class="en"&gt; PINBlock Input the PIN on PED,and use the PINkey of DUKPT to calculate the PINBlock.<a name="line.490"></a>
<span class="sourceLineNo">491</span>     * {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.491"></a>
<span class="sourceLineNo">492</span>     *<a name="line.492"></a>
<span class="sourceLineNo">493</span>     * @param groupIndex<a name="line.493"></a>
<span class="sourceLineNo">494</span>     *            &lt;div class="zh"&gt; [1~100] DUKPT密钥组索引号 &lt;/div&gt; &lt;div class="en"&gt; [1~100] DUKPT key group id &lt;/div&gt;<a name="line.494"></a>
<span class="sourceLineNo">495</span>     *<a name="line.495"></a>
<span class="sourceLineNo">496</span>     * @param expPinLen<a name="line.496"></a>
<span class="sourceLineNo">497</span>     *            &lt;div class="zh"&gt; 0~12的枚举集合<a name="line.497"></a>
<span class="sourceLineNo">498</span>     *            可输入的合法密码长度字符串，应用程序把允许的密码长度全部枚举出来，并且用"，"号隔开每个长度，如允许输入4、6位密码并且允许无密码直接按确认，则该字符串应该设置为"0,4,6"。<a name="line.498"></a>
<span class="sourceLineNo">499</span>     *            若枚举0长度则示意可以不输任何数字而直接按确认键返回。但对于外置C类密键，最小输入长度为4 &lt;/div&gt; &lt;div class="en"&gt; Enumeration of 0-12.The enter password string with<a name="line.499"></a>
<span class="sourceLineNo">500</span>     *            legal length. Application enumerates of all possible lengths of PIN. ","will be used to separate each<a name="line.500"></a>
<span class="sourceLineNo">501</span>     *            number of length. If no PIN,or 4 or 6 digits of PIN are allowed, the string will be set as "0,4,6". 0<a name="line.501"></a>
<span class="sourceLineNo">502</span>     *            means that no PIN is required, and pressing "Enter" will return. For type-c, the legal Enumeration is 4-12&lt;/div&gt;<a name="line.502"></a>
<span class="sourceLineNo">503</span>     *<a name="line.503"></a>
<span class="sourceLineNo">504</span>     * @param dataIn<a name="line.504"></a>
<span class="sourceLineNo">505</span>     *            &lt;div class="zh"&gt;<a name="line.505"></a>
<span class="sourceLineNo">506</span>     *            &lt;ul&gt;<a name="line.506"></a>
<span class="sourceLineNo">507</span>     *            &lt;li&gt;当mode={@link EDUKPTPinMode#ISO9564_0_INC}时, DataIn指向卡号移位后生成的16位主帐号。&lt;/li&gt;<a name="line.507"></a>
<span class="sourceLineNo">508</span>     *            &lt;li&gt;当mode={@link EDUKPTPinMode#ISO9564_1_INC}/{@link EDUKPTPinMode#ISO9564_1}时,<a name="line.508"></a>
<span class="sourceLineNo">509</span>     *             DataIn被忽略,接口内部采用随机数填充PINBlock。&lt;/li&gt;<a name="line.509"></a>
<span class="sourceLineNo">510</span>     *            &lt;li&gt;当mode={@link EDUKPTPinMode#ISO9564_2_INC}/{@link EDUKPTPinMode#ISO9564_2}时,<a name="line.510"></a>
<span class="sourceLineNo">511</span>     *             DataIn指向位移后的16位PAN&lt;/li&gt;<a name="line.511"></a>
<span class="sourceLineNo">512</span>     *            &lt;li&gt;当mode={@link EDUKPTPinMode#HKEPS_INC}时, 为交易流水号ISN [6 Bytes,ASCII码]&lt;/li&gt;<a name="line.512"></a>
<span class="sourceLineNo">513</span>     *            &lt;li&gt;对于type-c密码键盘,dataIn指向卡号移位后生成的16位主帐号&lt;/li&gt;<a name="line.513"></a>
<span class="sourceLineNo">514</span>     *<a name="line.514"></a>
<span class="sourceLineNo">515</span>     *            &lt;/ul&gt;<a name="line.515"></a>
<span class="sourceLineNo">516</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.516"></a>
<span class="sourceLineNo">517</span>     *            &lt;ul&gt;<a name="line.517"></a>
<span class="sourceLineNo">518</span>     *            &lt;li&gt;When mode={@link EDUKPTPinMode#ISO9564_0_INC}, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.518"></a>
<span class="sourceLineNo">519</span>     *            &lt;li&gt;When mode={@link EDUKPTPinMode#ISO9564_1_INC}/{@link EDUKPTPinMode#ISO9564_1},DataIn is ignored. The interface uses random numbers to fill PINBlock internally.&lt;/li&gt;<a name="line.519"></a>
<span class="sourceLineNo">520</span>     *            &lt;li&gt;When mode={@link EDUKPTPinMode#ISO9564_2_INC}/{@link EDUKPTPinMode#ISO9564_2},DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.520"></a>
<span class="sourceLineNo">521</span>     *            &lt;li&gt;When mode={@link EDUKPTPinMode#HKEPS_INC}, dataIn is ISN [6 Bytes, ASCII code]&lt;/li&gt;<a name="line.521"></a>
<span class="sourceLineNo">522</span>     *           &lt;li&gt;For type-c, dataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.522"></a>
<span class="sourceLineNo">523</span>     *            &lt;/ul&gt;<a name="line.523"></a>
<span class="sourceLineNo">524</span>     *            &lt;/div&gt;<a name="line.524"></a>
<span class="sourceLineNo">525</span>     *<a name="line.525"></a>
<span class="sourceLineNo">526</span>     * @param mode<a name="line.526"></a>
<span class="sourceLineNo">527</span>     *            {@link EDUKPTPinMode}<a name="line.527"></a>
<span class="sourceLineNo">528</span>     *            &lt;li&gt;Not used for type-c&lt;/li&gt;<a name="line.528"></a>
<span class="sourceLineNo">529</span>     * @param timeoutMs<a name="line.529"></a>
<span class="sourceLineNo">530</span>     *            &lt;div class="zh"&gt;<a name="line.530"></a>
<span class="sourceLineNo">531</span>     *            &lt;p&gt;<a name="line.531"></a>
<span class="sourceLineNo">532</span>     *            输入PIN的超时时间,单位：毫秒 最大值为300000ms<a name="line.532"></a>
<span class="sourceLineNo">533</span>     *            &lt;/p&gt;<a name="line.533"></a>
<span class="sourceLineNo">534</span>     *            &lt;p&gt;<a name="line.534"></a>
<span class="sourceLineNo">535</span>     *            0:表示没有超时时间，PED不做超时控制<a name="line.535"></a>
<span class="sourceLineNo">536</span>     *            &lt;/p&gt;<a name="line.536"></a>
<span class="sourceLineNo">537</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.537"></a>
<span class="sourceLineNo">538</span>     *            &lt;p&gt;<a name="line.538"></a>
<span class="sourceLineNo">539</span>     *            The timeout of PIN entry [unit:ms] Maximum is 300000ms.<a name="line.539"></a>
<span class="sourceLineNo">540</span>     *            &lt;/p&gt;<a name="line.540"></a>
<span class="sourceLineNo">541</span>     *            &lt;p&gt;<a name="line.541"></a>
<span class="sourceLineNo">542</span>     *            0: No timeout time, not doing timeout control for PED.<a name="line.542"></a>
<span class="sourceLineNo">543</span>     *            &lt;/p&gt;<a name="line.543"></a>
<span class="sourceLineNo">544</span>     *            &lt;/div&gt;<a name="line.544"></a>
<span class="sourceLineNo">545</span>     *<a name="line.545"></a>
<span class="sourceLineNo">546</span>     * @return DUKPTResult {@link DUKPTResult}<a name="line.546"></a>
<span class="sourceLineNo">547</span>     * @throws PedDevException<a name="line.547"></a>
<span class="sourceLineNo">548</span>     */<a name="line.548"></a>
<span class="sourceLineNo">549</span>    public DUKPTResult getDUKPTPin(byte groupIndex, String expPinLen, byte[] dataIn, EDUKPTPinMode mode, int timeoutMs)<a name="line.549"></a>
<span class="sourceLineNo">550</span>            throws PedDevException;<a name="line.550"></a>
<span class="sourceLineNo">551</span><a name="line.551"></a>
<span class="sourceLineNo">552</span>    /**<a name="line.552"></a>
<span class="sourceLineNo">553</span>     * &lt;div class="zh"&gt; 使用DUKPT的MAC密钥计算MAC。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.553"></a>
<span class="sourceLineNo">554</span>     * &lt;div class="en"&gt; Use MAC Key to calculate MAC. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.554"></a>
<span class="sourceLineNo">555</span>     *<a name="line.555"></a>
<span class="sourceLineNo">556</span>     * @param groupIndex<a name="line.556"></a>
<span class="sourceLineNo">557</span>     *            &lt;div class="zh"&gt; [1~100] DUKPT密钥组索引号 &lt;/div&gt; &lt;div class="en"&gt; [1~100] DUKPT key group index id &lt;/div&gt;<a name="line.557"></a>
<span class="sourceLineNo">558</span>     *<a name="line.558"></a>
<span class="sourceLineNo">559</span>     * @param dataIn<a name="line.559"></a>
<span class="sourceLineNo">560</span>     *            &lt;div class="zh"&gt; 指向需要计算MAC的数据内容&lt;/div&gt; &lt;div class="en"&gt;  The MAC data content needs to be calculated&lt;/div&gt;<a name="line.560"></a>
<span class="sourceLineNo">561</span>     *<a name="line.561"></a>
<span class="sourceLineNo">562</span>     * @param mode<a name="line.562"></a>
<span class="sourceLineNo">563</span>     *            {@link EDUKPTMacMode}<a name="line.563"></a>
<span class="sourceLineNo">564</span>     *            &lt;div class="zh"&gt;备注：20，22，40，42模式可以支持最大输入8k大小的输入数据，其他模式维持原来最大1k的输入数据&lt;/div&gt;<a name="line.564"></a>
<span class="sourceLineNo">565</span>     *            &lt;div class="en"&gt;Note: In 20, 22, 40, and 42 modes, the maximum size of input data can be 8 KB. In other modes, the maximum size of input data can be 1 KB&lt;/div&gt;<a name="line.565"></a>
<span class="sourceLineNo">566</span>     * @return {@link DUKPTResult}<a name="line.566"></a>
<span class="sourceLineNo">567</span>     * @throws PedDevException<a name="line.567"></a>
<span class="sourceLineNo">568</span>     */<a name="line.568"></a>
<span class="sourceLineNo">569</span>    public DUKPTResult getDUKPTMac(byte groupIndex, byte[] dataIn, EDUKPTMacMode mode) throws PedDevException;<a name="line.569"></a>
<span class="sourceLineNo">570</span><a name="line.570"></a>
<span class="sourceLineNo">571</span>    /**<a name="line.571"></a>
<span class="sourceLineNo">572</span>     * &lt;div class="zh"&gt; 获取密钥的KCV值，以供对话双方进行密钥验证，用指定的密钥及算法对一段数据进行加密，并返回部分数据密文。仅支持{@link EPedType#INTERNAL} 类型 。&lt;/div&gt;<a name="line.572"></a>
<span class="sourceLineNo">573</span>     * &lt;div class="en"&gt; Getting value of KCV for key verification of to side, using specific key and algorithm to encrypt data, and then return part of cryptograph.<a name="line.573"></a>
<span class="sourceLineNo">574</span>     * {@link EPedType#INTERNAL} only is supported. &lt;/div&gt;<a name="line.574"></a>
<span class="sourceLineNo">575</span>     *<a name="line.575"></a>
<span class="sourceLineNo">576</span>     * @param type<a name="line.576"></a>
<span class="sourceLineNo">577</span>     *            {@link EPedKeyType}<a name="line.577"></a>
<span class="sourceLineNo">578</span>     * @param keyIndex<a name="line.578"></a>
<span class="sourceLineNo">579</span>     *            &lt;div class="zh"&gt; 密钥的索引号<a name="line.579"></a>
<span class="sourceLineNo">580</span>     *            &lt;ul&gt;<a name="line.580"></a>
<span class="sourceLineNo">581</span>     *            &lt;li&gt;如果type={@link EPedKeyType#TLK}, keyIndex只能为1&lt;/li&gt;<a name="line.581"></a>
<span class="sourceLineNo">582</span>     *            &lt;li&gt;如果type={@link EPedKeyType#TMK}/{@link EPedKeyType#TPK}/{@link EPedKeyType#TAK}/<a name="line.582"></a>
<span class="sourceLineNo">583</span>     *            {@link EPedKeyType#TDK} , 取值[1~100]&lt;/li&gt;<a name="line.583"></a>
<span class="sourceLineNo">584</span>     *            &lt;li&gt;如果type={@link EPedKeyType#TIK},取值[1~100]&lt;/li&gt;<a name="line.584"></a>
<span class="sourceLineNo">585</span>     *            &lt;/ul&gt;<a name="line.585"></a>
<span class="sourceLineNo">586</span>     *            &lt;/div&gt; &lt;div class="en"&gt; key index<a name="line.586"></a>
<span class="sourceLineNo">587</span>     *            &lt;ul&gt;<a name="line.587"></a>
<span class="sourceLineNo">588</span>     *            &lt;li&gt;If type=TLK, keyIndex can only be 1.&lt;/li&gt;<a name="line.588"></a>
<span class="sourceLineNo">589</span>     *            &lt;li&gt;If type=TMK/TPK/TAK/TDK , can select from [1~100].&lt;/li&gt;<a name="line.589"></a>
<span class="sourceLineNo">590</span>     *            &lt;li&gt;If type=TIK,can select from [1~100].&lt;/li&gt;<a name="line.590"></a>
<span class="sourceLineNo">591</span>     *            &lt;/ul&gt;<a name="line.591"></a>
<span class="sourceLineNo">592</span>     *            &lt;/div&gt;<a name="line.592"></a>
<span class="sourceLineNo">593</span>     *<a name="line.593"></a>
<span class="sourceLineNo">594</span>     * @param checkMode<a name="line.594"></a>
<span class="sourceLineNo">595</span>     *            &lt;div class="zh"&gt;<a name="line.595"></a>
<span class="sourceLineNo">596</span>     *            &lt;ul&gt;<a name="line.596"></a>
<span class="sourceLineNo">597</span>     *            &lt;li&gt;checkMode=0x00时， 使用该密钥对一段数据进行DES/TDES加密运算，生成的密文的前4个字节即为KCV,该模式适用于PED_TLK/ PED_TMK/ PED_TAK/ PED_TPK/ PED_TDK/ PED_PPAD_TXK。&lt;/li&gt;<a name="line.597"></a>
<span class="sourceLineNo">598</span>     *            &lt;li&gt;checkMode=0x00时， 返回注入密钥时写入的KCV值。该模式适用于PED_TIK/ PED_AES_TIK。&lt;/li&gt;<a name="line.598"></a>
<span class="sourceLineNo">599</span>     *            &lt;li&gt;checkMode=0x03时， 使用该密钥对一段数据进行CMAC加密运算，生成的密文的前5个字节即为KCV。该模式适用于PED_TLK/ PED_TMK/ PED_TAK/ PED_TPK/ PED_TDK/ PED_PPAD_TXK/ PED_AES_TLK/ PED_AES_TMK/ PED_AES_TAK/ PED_AES_TPK/ PED_AES_TDK。&lt;/li&gt;<a name="line.599"></a>
<span class="sourceLineNo">600</span>     *            &lt;li&gt;checkMode=0x04时， 使用该密钥对一段数据进行SM4加密运算，生成的密文的前4个字节即为KCV。该模式适用于PED_SM4_TMK/ PED_SM4_TAK/ PED_SM4_TPK/ PED_ SM4_TDK。&lt;/li&gt;<a name="line.600"></a>
<span class="sourceLineNo">601</span>     *            &lt;/ul&gt;<a name="line.601"></a>
<span class="sourceLineNo">602</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.602"></a>
<span class="sourceLineNo">603</span>     *            &lt;ul&gt;<a name="line.603"></a>
<span class="sourceLineNo">604</span>     *            &lt;li&gt;When checkMode=0x00, use this key pair to do DES/TDES entryption for a block of data, the first 4<a name="line.604"></a>
<span class="sourceLineNo">605</span>     *            bytes of the generated ciphertext is KCV.&lt;/li&gt;<a name="line.605"></a>
<span class="sourceLineNo">606</span>     *            &lt;li&gt;When checkMode=0x00, the KCV value written during key injection is returned. This mode is suitable<a name="line.606"></a>
<span class="sourceLineNo">607</span>     *            for PED_TIK/ PED_AES_TIK.&lt;/li&gt;<a name="line.607"></a>
<span class="sourceLineNo">608</span>     *            &lt;li&gt;When checkMode=0x03, use this key to do CMAC encryption operation for a block of data, and the first<a name="line.608"></a>
<span class="sourceLineNo">609</span>     *            5 bytes of the generated ciphertext are KCV. This mode is suitable for PED_TLK/ PED_TMK/ PED_TAK/ PED_TPK/<a name="line.609"></a>
<span class="sourceLineNo">610</span>     *            PED_TDK/ PED_PPAD_TXK/ PED_AES_TLK/ PED_AES_TMK/ PED_AES_TAK/ PED_AES_TPK/ PED_AES_TDK.&lt;/li&gt;<a name="line.610"></a>
<span class="sourceLineNo">611</span>     *            &lt;li&gt;When checkMode=0x04, use this key to do SM4 encryption operation for a block of data, and the first<a name="line.611"></a>
<span class="sourceLineNo">612</span>     *            4 bytes of the generated ciphertext are KCV. This mode is suitable for PED_SM4_TMK/ PED_SM4_TAK/ PED_SM4_TPK/ PED_ SM4_TDK.&lt;/li&gt;<a name="line.612"></a>
<span class="sourceLineNo">613</span>     *            &lt;/ul&gt;<a name="line.613"></a>
<span class="sourceLineNo">614</span>     *            &lt;/div&gt;<a name="line.614"></a>
<span class="sourceLineNo">615</span>     *<a name="line.615"></a>
<span class="sourceLineNo">616</span>     * @param checkBuf<a name="line.616"></a>
<span class="sourceLineNo">617</span>     *            &lt;div class="zh"&gt;<a name="line.617"></a>
<span class="sourceLineNo">618</span>     *            &lt;ul&gt;<a name="line.618"></a>
<span class="sourceLineNo">619</span>     *            &lt;li&gt;当checkMode =0x00/0x04时, 指向需运算的数据,进行运算的数据必须是8/16的倍数&lt;/li&gt;<a name="line.619"></a>
<span class="sourceLineNo">620</span>     *            &lt;/ul&gt;<a name="line.620"></a>
<span class="sourceLineNo">621</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.621"></a>
<span class="sourceLineNo">622</span>     *            &lt;ul&gt;<a name="line.622"></a>
<span class="sourceLineNo">623</span>     *            &lt;li&gt;When checkMode=0x00/0x04, The data needing to compute must be a multiple of 8/16.&lt;/li&gt;<a name="line.623"></a>
<span class="sourceLineNo">624</span>     *            &lt;/ul&gt;<a name="line.624"></a>
<span class="sourceLineNo">625</span>     *            &lt;/div&gt;<a name="line.625"></a>
<span class="sourceLineNo">626</span>     *<a name="line.626"></a>
<span class="sourceLineNo">627</span>     * @return &lt;div class="zh"&gt;<a name="line.627"></a>
<span class="sourceLineNo">628</span>     *         &lt;ul&gt;<a name="line.628"></a>
<span class="sourceLineNo">629</span>     *         &lt;li&gt;当checkMode = 0x00/0x04时，若KeyType为PED_TIK/PED_AES_TIK，返回的KCV值为pedWriteTIK/pedAesDukptWriteTIK接口写入时的KCV值。<a name="line.629"></a>
<span class="sourceLineNo">630</span>     *         （如果pedWriteTIK注入密钥时不带KCV校验值，将返回对8个字节的0x00进行DES/TDES加密，得到的密文的前4个字节KCV校验值。<a name="line.630"></a>
<span class="sourceLineNo">631</span>     *         如果pedAesDukptWriteTIK注入密钥时不带KCV校验值，将返回对16个字节的0x00进行CMAC加密，得到的密文的前5个字节KCV校验值。）<a name="line.631"></a>
<span class="sourceLineNo">632</span>     *         其他返回4个字节长度的KCV。&lt;/li&gt;<a name="line.632"></a>
<span class="sourceLineNo">633</span>     *         &lt;li&gt;当checkMode = 0x03时，将返回对16个字节的0x00进行CMAC加密，得到的密文的前5个字节KCV校验值。&lt;/li&gt;<a name="line.633"></a>
<span class="sourceLineNo">634</span>     *         &lt;/ul&gt;<a name="line.634"></a>
<span class="sourceLineNo">635</span>     *         &lt;/div&gt; &lt;div class="en"&gt;<a name="line.635"></a>
<span class="sourceLineNo">636</span>     *         &lt;ul&gt;<a name="line.636"></a>
<span class="sourceLineNo">637</span>     *         &lt;li&gt;When checkMode = 0x00/0x04, if KeyType is PED_TIK/PED_AES_TIK, the return value KCV is the KCV value that wrote in pedWriteTIK/pedAesDukptWriteTIK interface.<a name="line.637"></a>
<span class="sourceLineNo">638</span>     *         (If pedWriteTIK injects the key without KCV check value, it will return the KCV check value of the first 4 bytes of the ciphertext obtained by performing DES/TDES encryption on the 8 bytes of 0x00.<a name="line.638"></a>
<span class="sourceLineNo">639</span>     *         If pedAesDukptWriteTIK injects the key without KCV check value, it will return the KCV check value of the first 5 bytes of the ciphertext obtained by CMAC encryption on 16 bytes of 0x00.)<a name="line.639"></a>
<span class="sourceLineNo">640</span>     *         Others return a KCV of 4 bytes.&lt;/li&gt;<a name="line.640"></a>
<span class="sourceLineNo">641</span>     *         &lt;li&gt;When checkMode = 0x03, it will return the KCV check value of the first 5 bytes of the ciphertext obtained by performing CMAC encryption on 16 bytes of 0x00.&lt;/li&gt;<a name="line.641"></a>
<span class="sourceLineNo">642</span>     *         &lt;/ul&gt;<a name="line.642"></a>
<span class="sourceLineNo">643</span>     *         &lt;/div&gt;<a name="line.643"></a>
<span class="sourceLineNo">644</span>     *<a name="line.644"></a>
<span class="sourceLineNo">645</span>     * @throws PedDevException<a name="line.645"></a>
<span class="sourceLineNo">646</span>     */<a name="line.646"></a>
<span class="sourceLineNo">647</span>    public byte[] getKCV(EPedKeyType type, byte keyIndex, byte checkMode, byte[] checkBuf) throws PedDevException;<a name="line.647"></a>
<span class="sourceLineNo">648</span><a name="line.648"></a>
<span class="sourceLineNo">649</span>    /**<a name="line.649"></a>
<span class="sourceLineNo">650</span>     * &lt;div class="zh"&gt; 使用指定密钥类型的密钥索引所在的密钥明文与一串数据进行异或，得到密钥写入到同一类型密钥区的指定索引位置 。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.650"></a>
<span class="sourceLineNo">651</span>     * &lt;div class="en"&gt; Use the plaintext key specified by the source key index and the key type to do exclusive-or with the input data, and write the<a name="line.651"></a>
<span class="sourceLineNo">652</span>     * result to the location specified by the destination key index with the same key type. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.652"></a>
<span class="sourceLineNo">653</span>     *<a name="line.653"></a>
<span class="sourceLineNo">654</span>     * @param type<a name="line.654"></a>
<span class="sourceLineNo">655</span>     *            &lt;div class="zh"&gt;<a name="line.655"></a>
<span class="sourceLineNo">656</span>     *            &lt;ul&gt;<a name="line.656"></a>
<span class="sourceLineNo">657</span>     *            &lt;li&gt;{@link EPedKeyType#TMK}&lt;/li&gt;<a name="line.657"></a>
<span class="sourceLineNo">658</span>     *            &lt;li&gt;{@link EPedKeyType#TPK}&lt;/li&gt;<a name="line.658"></a>
<span class="sourceLineNo">659</span>     *            &lt;li&gt;{@link EPedKeyType#TAK}&lt;/li&gt;<a name="line.659"></a>
<span class="sourceLineNo">660</span>     *            &lt;li&gt;{@link EPedKeyType#TDK}&lt;/li&gt;<a name="line.660"></a>
<span class="sourceLineNo">661</span>     *            &lt;/ul&gt;<a name="line.661"></a>
<span class="sourceLineNo">662</span>     *            &lt;/div&gt; &lt;div class="en"&gt; {@link EPedKeyType} Reference {@link IPed#writeKey} srcKeyType,but not<a name="line.662"></a>
<span class="sourceLineNo">663</span>     *            applicative for TIK/TLK. &lt;/div&gt;<a name="line.663"></a>
<span class="sourceLineNo">664</span>     *<a name="line.664"></a>
<span class="sourceLineNo">665</span>     * @param srcKeyIndex<a name="line.665"></a>
<span class="sourceLineNo">666</span>     *            &lt;div class="zh"&gt; 源密钥索引号 &lt;/div&gt; &lt;div class="en"&gt; The source key index &lt;/div&gt;<a name="line.666"></a>
<span class="sourceLineNo">667</span>     *<a name="line.667"></a>
<span class="sourceLineNo">668</span>     * @param destKeyIndex<a name="line.668"></a>
<span class="sourceLineNo">669</span>     *            &lt;div class="zh"&gt; 目的密钥索引号 &lt;/div&gt; &lt;div class="en"&gt; The destination key index &lt;/div&gt;<a name="line.669"></a>
<span class="sourceLineNo">670</span>     *<a name="line.670"></a>
<span class="sourceLineNo">671</span>     * @param xorData<a name="line.671"></a>
<span class="sourceLineNo">672</span>     *            &lt;div class="zh"&gt; 需要异或的字符串，长度与密钥长度一致 &lt;/div&gt; &lt;div class="en"&gt; The input data to be used in exclusive-or,<a name="line.672"></a>
<span class="sourceLineNo">673</span>     *            length of it is same as the key. &lt;/div&gt;<a name="line.673"></a>
<span class="sourceLineNo">674</span>     *<a name="line.674"></a>
<span class="sourceLineNo">675</span>     * @param checkMode<a name="line.675"></a>
<span class="sourceLineNo">676</span>     *            &lt;div class="zh"&gt; {@link ECheckMode} 保留扩展，应用程序可以设置为空 &lt;/div&gt; &lt;div class="en"&gt; {@link ECheckMode}<a name="line.676"></a>
<span class="sourceLineNo">677</span>     *            reserved for extension ,application can set it as null &lt;/div&gt;<a name="line.677"></a>
<span class="sourceLineNo">678</span>     *<a name="line.678"></a>
<span class="sourceLineNo">679</span>     * @param checkBuf<a name="line.679"></a>
<span class="sourceLineNo">680</span>     *            &lt;div class="zh"&gt; 保留扩展，应用程序可以设置为空 &lt;/div&gt; &lt;div class="en"&gt; reserved for extension ,application can set<a name="line.680"></a>
<span class="sourceLineNo">681</span>     *            it as null &lt;/div&gt;<a name="line.681"></a>
<span class="sourceLineNo">682</span>     *<a name="line.682"></a>
<span class="sourceLineNo">683</span>     * @throws PedDevException<a name="line.683"></a>
<span class="sourceLineNo">684</span>     */<a name="line.684"></a>
<span class="sourceLineNo">685</span>    public void writeKeyVar(EPedKeyType type, byte srcKeyIndex, byte destKeyIndex, byte[] xorData,<a name="line.685"></a>
<span class="sourceLineNo">686</span>            ECheckMode checkMode, byte[] checkBuf) throws PedDevException;<a name="line.686"></a>
<span class="sourceLineNo">687</span><a name="line.687"></a>
<span class="sourceLineNo">688</span>    /**<a name="line.688"></a>
<span class="sourceLineNo">689</span>     * &lt;div class="zh"&gt; 获取PED的版本。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.689"></a>
<span class="sourceLineNo">690</span>     * &lt;div class="en"&gt; Get the PED version information. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.690"></a>
<span class="sourceLineNo">691</span>     *<a name="line.691"></a>
<span class="sourceLineNo">692</span>     *<a name="line.692"></a>
<span class="sourceLineNo">693</span>     * @return &lt;div class="zh"&gt; PED 版本 &lt;/div&gt; &lt;div class="en"&gt; PED Version &lt;/div&gt;<a name="line.693"></a>
<span class="sourceLineNo">694</span>     *<a name="line.694"></a>
<span class="sourceLineNo">695</span>     * @throws PedDevException<a name="line.695"></a>
<span class="sourceLineNo">696</span>     */<a name="line.696"></a>
<span class="sourceLineNo">697</span>    public String getVersion() throws PedDevException;<a name="line.697"></a>
<span class="sourceLineNo">698</span><a name="line.698"></a>
<span class="sourceLineNo">699</span>    /**<a name="line.699"></a>
<span class="sourceLineNo">700</span>     * &lt;div class="zh"&gt; 清空TDES MK/SK DUKPT, AES MK/SK DUKPT, SM2等密钥。仅支持{@link EPedType#INTERNAL} 类型。&lt;br/&gt;<a name="line.700"></a>
<span class="sourceLineNo">701</span>     *              注：定制密钥不清除;因兼容性问题,不清除RSA密钥&lt;/div&gt;<a name="line.701"></a>
<span class="sourceLineNo">702</span>     * &lt;div class="en"&gt;Clear TDES MK/SK DUKPT, AES MK/SK DUKPT, SM2 keys. {@link EPedType#INTERNAL} only is supported.&lt;br/&gt;<a name="line.702"></a>
<span class="sourceLineNo">703</span>     *              Note: Customized keys are not cleared; due to compatibility issues, RSA keys are not cleared&lt;/div&gt;<a name="line.703"></a>
<span class="sourceLineNo">704</span>     *<a name="line.704"></a>
<span class="sourceLineNo">705</span>     * @return &lt;div class="zh"&gt;<a name="line.705"></a>
<span class="sourceLineNo">706</span>     *         &lt;ul&gt;<a name="line.706"></a>
<span class="sourceLineNo">707</span>     *         &lt;li&gt;true-擦除成功&lt;/li&gt;<a name="line.707"></a>
<span class="sourceLineNo">708</span>     *         &lt;li&gt;false-擦除失败&lt;/li&gt;<a name="line.708"></a>
<span class="sourceLineNo">709</span>     *         &lt;/ul&gt;<a name="line.709"></a>
<span class="sourceLineNo">710</span>     *         &lt;/div&gt; &lt;div class="en"&gt;<a name="line.710"></a>
<span class="sourceLineNo">711</span>     *         &lt;ul&gt;<a name="line.711"></a>
<span class="sourceLineNo">712</span>     *         &lt;li&gt;true -- Clear success&lt;/li&gt;<a name="line.712"></a>
<span class="sourceLineNo">713</span>     *         &lt;li&gt;false -- Clear failure&lt;/li&gt;<a name="line.713"></a>
<span class="sourceLineNo">714</span>     *         &lt;/ul&gt;<a name="line.714"></a>
<span class="sourceLineNo">715</span>     *         &lt;/div&gt;<a name="line.715"></a>
<span class="sourceLineNo">716</span>     *<a name="line.716"></a>
<span class="sourceLineNo">717</span>     * @throws PedDevException<a name="line.717"></a>
<span class="sourceLineNo">718</span>     */<a name="line.718"></a>
<span class="sourceLineNo">719</span>    public boolean erase() throws PedDevException;<a name="line.719"></a>
<span class="sourceLineNo">720</span><a name="line.720"></a>
<span class="sourceLineNo">721</span>    /**<a name="line.721"></a>
<span class="sourceLineNo">722</span>     * &lt;div class="zh"&gt; 设置两次计算PINBlock或者计算MAC之间最小间隔时间<a name="line.722"></a>
<span class="sourceLineNo">723</span>     * PINBLOCK间隔时间的计算方式：默认为120秒那只能调用4次，即tpkIntervalTimeMs默认值为30秒，调用该函数重新设置后，限制为4*<a name="line.723"></a>
<span class="sourceLineNo">724</span>     * tpkIntervalTimeMs时间内只能调用4次。比如传入的tpkIntervalTimeMs为20000(ms)，则80秒内只能调用4次。<a name="line.724"></a>
<span class="sourceLineNo">725</span>     * MAC间隔时间的计算方式：限制为两次计算MAC的间隔时间必须大于等于TAKIntervalTimeMs；比如传入的TAKIntervalTimeMs为20000(ms)，则20秒内只能调用1次。<a name="line.725"></a>
<span class="sourceLineNo">726</span>     * 仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.726"></a>
<span class="sourceLineNo">727</span>     * &lt;div class="en"&gt; Set the minimum time interval of calculating the PINBlock or MAC twice. PINBLOCK interval is<a name="line.727"></a>
<span class="sourceLineNo">728</span>     * calculated as below: When the default time is 120 seconds, it can only be called 4 times, that is, the default<a name="line.728"></a>
<span class="sourceLineNo">729</span>     * value of tpkIntervalTimeMs is 30 seconds, after resetting by calling this function, it is limited to call 4 times<a name="line.729"></a>
<span class="sourceLineNo">730</span>     * during the time of 4* tpkIntervalTimeMs. For example, if the incoming tpkIntervalTimeMs value is 20000(ms), it<a name="line.730"></a>
<span class="sourceLineNo">731</span>     * can be called 4 times within 80 seconds.MAC interval calculation: limit to two calculations, MAC interval time<a name="line.731"></a>
<span class="sourceLineNo">732</span>     * must be greater than or equal to TAKIntervalTimeMs; for example, the incoming TAKIntervalTimeMs is 20000 (MS),<a name="line.732"></a>
<span class="sourceLineNo">733</span>     * then 20 seconds can only call 1 times. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.733"></a>
<span class="sourceLineNo">734</span>     *<a name="line.734"></a>
<span class="sourceLineNo">735</span>     *<a name="line.735"></a>
<span class="sourceLineNo">736</span>     * @param tpkIntervalTimeMs<a name="line.736"></a>
<span class="sourceLineNo">737</span>     *            &lt;div class="zh"&gt;<a name="line.737"></a>
<span class="sourceLineNo">738</span>     *            &lt;ul&gt;<a name="line.738"></a>
<span class="sourceLineNo">739</span>     *            &lt;li&gt;tpkIntervalTimeMs=0:使用默认值(30000ms)&lt;/li&gt;<a name="line.739"></a>
<span class="sourceLineNo">740</span>     *            &lt;li&gt;tpkIntervalTimeMs&gt;0:间隔时间(单位:毫秒)&lt;/li&gt;<a name="line.740"></a>
<span class="sourceLineNo">741</span>     *            &lt;li&gt;tpkIntervalTimeMs=0xffffffff:当前设置不被改变&lt;/li&gt;<a name="line.741"></a>
<span class="sourceLineNo">742</span>     *            &lt;/ul&gt;<a name="line.742"></a>
<span class="sourceLineNo">743</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.743"></a>
<span class="sourceLineNo">744</span>     *            &lt;ul&gt;<a name="line.744"></a>
<span class="sourceLineNo">745</span>     *            &lt;li&gt;tpkIntervalTimeMs=0:Use the default value(30000 ms)&lt;/li&gt;<a name="line.745"></a>
<span class="sourceLineNo">746</span>     *            &lt;li&gt;tpkIntervalTimeMs=0xffffffff:No change of current setting.&lt;/li&gt;<a name="line.746"></a>
<span class="sourceLineNo">747</span>     *            &lt;/ul&gt;<a name="line.747"></a>
<span class="sourceLineNo">748</span>     *            &lt;/div&gt;<a name="line.748"></a>
<span class="sourceLineNo">749</span>     *<a name="line.749"></a>
<span class="sourceLineNo">750</span>     * @param takIntervalTimeMs<a name="line.750"></a>
<span class="sourceLineNo">751</span>     *            &lt;div class="zh"&gt;<a name="line.751"></a>
<span class="sourceLineNo">752</span>     *            &lt;ul&gt;<a name="line.752"></a>
<span class="sourceLineNo">753</span>     *            &lt;li&gt;tpkIntervalTimeMs=0:使用默认值(0ms)&lt;/li&gt;<a name="line.753"></a>
<span class="sourceLineNo">754</span>     *            &lt;li&gt;tpkIntervalTimeMs&gt;0:间隔时间(单位:毫秒)&lt;/li&gt;<a name="line.754"></a>
<span class="sourceLineNo">755</span>     *            &lt;li&gt;tpkIntervalTimeMs=0xffffffff:当前设置不被改变&lt;/li&gt;<a name="line.755"></a>
<span class="sourceLineNo">756</span>     *            &lt;/ul&gt;<a name="line.756"></a>
<span class="sourceLineNo">757</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.757"></a>
<span class="sourceLineNo">758</span>     *            &lt;ul&gt;<a name="line.758"></a>
<span class="sourceLineNo">759</span>     *            &lt;li&gt;tpkIntervalTimeMs=0:Use the default value(0 uint:ms)&lt;/li&gt;<a name="line.759"></a>
<span class="sourceLineNo">760</span>     *            &lt;li&gt;tpkIntervalTimeMs大于0:Interval time(uint:ms)&lt;/li&gt;<a name="line.760"></a>
<span class="sourceLineNo">761</span>     *            &lt;li&gt;tpkIntervalTimeMs=0xffffffff:No change of current setting.&lt;/li&gt;<a name="line.761"></a>
<span class="sourceLineNo">762</span>     *            &lt;/ul&gt;<a name="line.762"></a>
<span class="sourceLineNo">763</span>     *            &lt;/div&gt;<a name="line.763"></a>
<span class="sourceLineNo">764</span>     *<a name="line.764"></a>
<span class="sourceLineNo">765</span>     * @throws PedDevException<a name="line.765"></a>
<span class="sourceLineNo">766</span>     */<a name="line.766"></a>
<span class="sourceLineNo">767</span>    public void setIntervalTime(int tpkIntervalTimeMs, int takIntervalTimeMs) throws PedDevException;<a name="line.767"></a>
<span class="sourceLineNo">768</span><a name="line.768"></a>
<span class="sourceLineNo">769</span>    /**<a name="line.769"></a>
<span class="sourceLineNo">770</span>     * &lt;div class="zh"&gt; 设定某些功能键的功能。 PED上电后,CLEAR键的默认功能为,持卡人输入PIN时,按CLEAR键,清除已输入的PIN。 可以通过该函数来设置CLEAR键的不同功能。<a name="line.770"></a>
<span class="sourceLineNo">771</span>     * 仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt;<a name="line.771"></a>
<span class="sourceLineNo">772</span>     * &lt;div class="en"&gt; Setting some functions of function key. When PED is power on, the default function of CLEAR button is<a name="line.772"></a>
<span class="sourceLineNo">773</span>     * when card holder is typing in PIN, pressing the CLEAR button can clear input PIN. It is allowed to set different<a name="line.773"></a>
<span class="sourceLineNo">774</span>     * functions for CLEAR button by using this function. {@link EPedType#INTERNAL} only is supported. &lt;/div&gt;<a name="line.774"></a>
<span class="sourceLineNo">775</span>     *<a name="line.775"></a>
<span class="sourceLineNo">776</span>     * @param mode<a name="line.776"></a>
<span class="sourceLineNo">777</span>     *            {@link EFuncKeyMode}<a name="line.777"></a>
<span class="sourceLineNo">778</span>     * @throws PedDevException<a name="line.778"></a>
<span class="sourceLineNo">779</span>     */<a name="line.779"></a>
<span class="sourceLineNo">780</span>    public void setFunctionKey(EFuncKeyMode mode) throws PedDevException;<a name="line.780"></a>
<span class="sourceLineNo">781</span><a name="line.781"></a>
<span class="sourceLineNo">782</span>    /**<a name="line.782"></a>
<span class="sourceLineNo">783</span>     * &lt;div class="zh"&gt; 1.注入RSA密钥到PED &lt;br/&gt;<a name="line.783"></a>
<span class="sourceLineNo">784</span>     * 2.PED最多支持10组RSA密钥,目前最长只支持256字节长的RSA密钥。 &lt;br/&gt;<a name="line.784"></a>
<span class="sourceLineNo">785</span>     * 3.存储的RSA密钥是公钥还是私钥由密钥的指数长度决定,当密钥指数和模等长时,是私钥。 &lt;br/&gt;<a name="line.785"></a>
<span class="sourceLineNo">786</span>     * 4.PED通过PedWriteRsaKey注入RSA密钥。 &lt;br/&gt;<a name="line.786"></a>
<span class="sourceLineNo">787</span>     * 5.通过PedRSARecover使用已注入的密钥进行RSA运算。 &lt;br/&gt;<a name="line.787"></a>
<span class="sourceLineNo">788</span>     * 6.任何时候,RSA密钥可以进行重写。 &lt;br/&gt;<a name="line.788"></a>
<span class="sourceLineNo">789</span>     * 仅支持{@link EPedType#INTERNAL} 类型。<a name="line.789"></a>
<span class="sourceLineNo">790</span>     * &lt;/div&gt; &lt;div class="en"&gt;<a name="line.790"></a>
<span class="sourceLineNo">791</span>     * &lt;p&gt;<a name="line.791"></a>
<span class="sourceLineNo">792</span>     * 1. Import RSA to the PED<a name="line.792"></a>
<span class="sourceLineNo">793</span>     * &lt;/p&gt;<a name="line.793"></a>
<span class="sourceLineNo">794</span>     * &lt;p&gt;<a name="line.794"></a>
<span class="sourceLineNo">795</span>     * 2. PED can support 10 sets of RSA Key at most, current can supports a maximum length of 256 bytes RSA key.<a name="line.795"></a>
<span class="sourceLineNo">796</span>     * &lt;/p&gt;<a name="line.796"></a>
<span class="sourceLineNo">797</span>     * &lt;p&gt;<a name="line.797"></a>
<span class="sourceLineNo">798</span>     * 3. Whether the stored RSA is the public key or private key will be determined by the exponent length. If the<a name="line.798"></a>
<span class="sourceLineNo">799</span>     * length of key exponent is equal to modulus, it is a private key.<a name="line.799"></a>
<span class="sourceLineNo">800</span>     * &lt;/p&gt;<a name="line.800"></a>
<span class="sourceLineNo">801</span>     * &lt;p&gt;<a name="line.801"></a>
<span class="sourceLineNo">802</span>     * 4. PED uses PedWriteRsaKey to Import RSA key.<a name="line.802"></a>
<span class="sourceLineNo">803</span>     * &lt;/p&gt;<a name="line.803"></a>
<span class="sourceLineNo">804</span>     * &lt;p&gt;<a name="line.804"></a>
<span class="sourceLineNo">805</span>     * 5. Use the imported key to do the RSA operation by calling PedRsaRecover.<a name="line.805"></a>
<span class="sourceLineNo">806</span>     * &lt;/p&gt;<a name="line.806"></a>
<span class="sourceLineNo">807</span>     * &lt;p&gt;<a name="line.807"></a>
<span class="sourceLineNo">808</span>     * 6. RSA key can be rewritten at any time<a name="line.808"></a>
<span class="sourceLineNo">809</span>     * &lt;/p&gt;<a name="line.809"></a>
<span class="sourceLineNo">810</span>     * {@link EPedType#INTERNAL} only is supported.<a name="line.810"></a>
<span class="sourceLineNo">811</span>     * &lt;/div&gt;<a name="line.811"></a>
<span class="sourceLineNo">812</span>     *<a name="line.812"></a>
<span class="sourceLineNo">813</span>     * @param rsaKeyIndex<a name="line.813"></a>
<span class="sourceLineNo">814</span>     *            &lt;div class="zh"&gt; 密钥索引[1~10] &lt;/div&gt; &lt;div class="en"&gt; Key Index [1~10] &lt;/div&gt;<a name="line.814"></a>
<span class="sourceLineNo">815</span>     *<a name="line.815"></a>
<span class="sourceLineNo">816</span>     * @param info<a name="line.816"></a>
<span class="sourceLineNo">817</span>     *            {@link RSAKeyInfo}<a name="line.817"></a>
<span class="sourceLineNo">818</span>     * @throws PedDevException<a name="line.818"></a>
<span class="sourceLineNo">819</span>     */<a name="line.819"></a>
<span class="sourceLineNo">820</span>    public void writeRSAKey(byte rsaKeyIndex, RSAKeyInfo info) throws PedDevException;<a name="line.820"></a>
<span class="sourceLineNo">821</span><a name="line.821"></a>
<span class="sourceLineNo">822</span>    /**<a name="line.822"></a>
<span class="sourceLineNo">823</span>     * &lt;div class="zh"&gt; 用存储在PED的RSA密钥进行数据RSA数据运算。<a name="line.823"></a>
<span class="sourceLineNo">824</span>     * &lt;br&gt;注意: 1.该函数对dataIn进行RSA加解密运算，运算结果输出到RSARecoverInfo<a name="line.824"></a>
<span class="sourceLineNo">825</span>     * &lt;br&gt;2.当rsaKeyIndex指定的密钥为私钥时，如果dataIn是对应公钥的加密密文，则RSARecoverInfo为dataIn的明文，否则RSARecoverInfo为dataIn的RSA密文；<a name="line.825"></a>
<span class="sourceLineNo">826</span>     * &lt;br&gt;3.当rsaKeyIndex指定的密钥为公钥时，如果dataIn是对应私钥的加密密文，则RSARecoverInfo为dataIn的明文，否则RSARecoverInfo为dataIn的RSA密文；<a name="line.826"></a>
<span class="sourceLineNo">827</span>     * &lt;br&gt;4.该方法可实现长度不超过4096bits的RSA运算。&lt;/div&gt;<a name="line.827"></a>
<span class="sourceLineNo">828</span>     * &lt;div class="en"&gt; Using the RSA key stored in PED to do the RSA data operation.<a name="line.828"></a>
<span class="sourceLineNo">829</span>     * &lt;br&gt;Note: 1. This function performs RSA encryption and decryption operation on dataIn, and the operation result is output to RSARecoverInfo<a name="line.829"></a>
<span class="sourceLineNo">830</span>     * &lt;br&gt;2. When the key specified by rsaKeyIndex is a private key, if dataIn is the encrypted ciphertext corresponding to the public key, then RSARecoverInfo is the plaintext of dataIn, otherwise RSARecoverInfo is the RSA ciphertext of dataIn;<a name="line.830"></a>
<span class="sourceLineNo">831</span>     * &lt;br&gt;3. When the key specified by rsaKeyIndex is a public key, if dataIn is the encrypted ciphertext corresponding to the private key, then RSARecoverInfo is the plaintext of dataIn, otherwise RSARecoverInfo is the RSA ciphertext of dataIn;<a name="line.831"></a>
<span class="sourceLineNo">832</span>     * &lt;br&gt;4. This method can realize the RSA operation whose length does not exceed 4096bits.&lt;/div&gt;<a name="line.832"></a>
<span class="sourceLineNo">833</span>     *<a name="line.833"></a>
<span class="sourceLineNo">834</span>     * @param rsaKeyIndex<a name="line.834"></a>
<span class="sourceLineNo">835</span>     *            &lt;div class="zh"&gt; 密钥索引[1~10] &lt;/div&gt; &lt;div class="en"&gt; Key Index [1~10] &lt;/div&gt;<a name="line.835"></a>
<span class="sourceLineNo">836</span>     *<a name="line.836"></a>
<span class="sourceLineNo">837</span>     * @param dataIn<a name="line.837"></a>
<span class="sourceLineNo">838</span>     *            &lt;div class="zh"&gt; 被加解密的数据，和模等长 &lt;/div&gt; &lt;div class="en"&gt; The encrypted/decrypted data, which has the same<a name="line.838"></a>
<span class="sourceLineNo">839</span>     *            length as the modulus. &lt;/div&gt;<a name="line.839"></a>
<span class="sourceLineNo">840</span>     *<a name="line.840"></a>
<span class="sourceLineNo">841</span>     * @return {@link RSARecoverInfo}<a name="line.841"></a>
<span class="sourceLineNo">842</span>     * @throws PedDevException<a name="line.842"></a>
<span class="sourceLineNo">843</span>     */<a name="line.843"></a>
<span class="sourceLineNo">844</span>    public RSARecoverInfo RSARecover(byte rsaKeyIndex, byte[] dataIn) throws PedDevException;<a name="line.844"></a>
<span class="sourceLineNo">845</span><a name="line.845"></a>
<span class="sourceLineNo">846</span>    /**<a name="line.846"></a>
<span class="sourceLineNo">847</span>     * &lt;div class="zh"&gt; 使用DUKPT的MAC密钥或DES密钥，对输入缓存内数据进行加密或解密。 仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.847"></a>
<span class="sourceLineNo">848</span>     * &lt;div class="en"&gt; Use MAC key or DES key of DUKPT to encrypt or decrypt the data in the input buffer. {@link EPedType#INTERNAL} only is supported. &lt;/div&gt;<a name="line.848"></a>
<span class="sourceLineNo">849</span>     *<a name="line.849"></a>
<span class="sourceLineNo">850</span>     * @param groupIndex<a name="line.850"></a>
<span class="sourceLineNo">851</span>     *            &lt;div class="zh"&gt; [1~100] DUKPT密钥组索引号 &lt;/div&gt; &lt;div class="en"&gt; [1~100] DUKPT group ID &lt;/div&gt;<a name="line.851"></a>
<span class="sourceLineNo">852</span>     *<a name="line.852"></a>
<span class="sourceLineNo">853</span>     * @param keyVarType<a name="line.853"></a>
<span class="sourceLineNo">854</span>     *            &lt;div class="zh"&gt;<a name="line.854"></a>
<span class="sourceLineNo">855</span>     *            &lt;ul&gt;<a name="line.855"></a>
<span class="sourceLineNo">856</span>     *              &lt;li&gt;0x00: 使用请求和应答MAC密钥。&lt;/li&gt;<a name="line.856"></a>
<span class="sourceLineNo">857</span>     *              &lt;li&gt;0x01: 使用DUKPT DES密钥运算。&lt;/li&gt;<a name="line.857"></a>
<span class="sourceLineNo">858</span>     *              &lt;li&gt;0x02: 使用DUKPT PIN密钥做ECB加密。mode只能为{@link EDUKPTDesMode#ECB_ENCRYPTION}。&lt;/li&gt;<a name="line.858"></a>
<span class="sourceLineNo">859</span>     *              &lt;li&gt;0x03: 使用应答 MAC 密钥。仅支持加密模式，mode只能为{@link EDUKPTDesMode#ECB_ENCRYPTION}或{@link EDUKPTDesMode#CBC_ENCRYPTION}。&lt;/li&gt;<a name="line.859"></a>
<span class="sourceLineNo">860</span>     *              &lt;li&gt;0x04: 使用应答 DES 密钥。仅支持加密模式，mode只能为{@link EDUKPTDesMode#ECB_ENCRYPTION}或{@link EDUKPTDesMode#CBC_ENCRYPTION}。&lt;/li&gt;<a name="line.860"></a>
<span class="sourceLineNo">861</span>     *             &lt;/ul&gt;<a name="line.861"></a>
<span class="sourceLineNo">862</span>     *            &lt;/div&gt;<a name="line.862"></a>
<span class="sourceLineNo">863</span>     *            &lt;div class="en"&gt;<a name="line.863"></a>
<span class="sourceLineNo">864</span>     *             &lt;ul&gt;<a name="line.864"></a>
<span class="sourceLineNo">865</span>     *              &lt;li&gt;0x00: Use request and response MAC key.&lt;/li&gt;<a name="line.865"></a>
<span class="sourceLineNo">866</span>     *              &lt;li&gt;0x01: Use DUKPT DES key operation.&lt;/li&gt;<a name="line.866"></a>
<span class="sourceLineNo">867</span>     *              &lt;li&gt;0x02: Use DUKPT PIN key to do the ECB encryption. mode can only be {@link EDUKPTDesMode#ECB_ENCRYPTION}.&lt;/li&gt;<a name="line.867"></a>
<span class="sourceLineNo">868</span>     *              &lt;li&gt;0x03: Use the response MAC key. Only encryption mode is supported, mode can only be {@link EDUKPTDesMode#ECB_ENCRYPTION} or {@link EDUKPTDesMode#CBC_ENCRYPTION}.&lt;/li&gt;<a name="line.868"></a>
<span class="sourceLineNo">869</span>     *              &lt;li&gt;0x04: Use the response DES key. Only encryption mode is supported, mode can only be {@link EDUKPTDesMode#ECB_ENCRYPTION} or {@link EDUKPTDesMode#CBC_ENCRYPTION}.&lt;/li&gt;<a name="line.869"></a>
<span class="sourceLineNo">870</span>     *             &lt;/ul&gt;<a name="line.870"></a>
<span class="sourceLineNo">871</span>     *            &lt;/div&gt;<a name="line.871"></a>
<span class="sourceLineNo">872</span>     *<a name="line.872"></a>
<span class="sourceLineNo">873</span>     * @param iv<a name="line.873"></a>
<span class="sourceLineNo">874</span>     *            &lt;div class="zh"&gt; 8字节初始向量，CBC加解密时需要，如果传入NULL，将默认用“\x00\x00\x00\x00\x00\x00\x00\x00”作为初始向量 &lt;/div&gt; &lt;div<a name="line.874"></a>
<span class="sourceLineNo">875</span>     *            class="en"&gt; 8 bytes initialization vector, used for CBC encryption or decryption. If set it to NULL,<a name="line.875"></a>
<span class="sourceLineNo">876</span>     *            it will use “\x00\x00\x00\x00\x00\x00\x00\x00” as the initialization vector by default. &lt;/div&gt;<a name="line.876"></a>
<span class="sourceLineNo">877</span>     *<a name="line.877"></a>
<span class="sourceLineNo">878</span>     * @param dataIn<a name="line.878"></a>
<span class="sourceLineNo">879</span>     *            &lt;div class="zh"&gt; 指向需要进行运算的数据, 数据长度&lt;=8192，8整除 &lt;/div&gt; &lt;div class="en"&gt; Point to the data which need to<a name="line.879"></a>
<span class="sourceLineNo">880</span>     *            be computed.Data length less than or equal to 8192, it is divisible by 8. &lt;/div&gt;<a name="line.880"></a>
<span class="sourceLineNo">881</span>     *<a name="line.881"></a>
<span class="sourceLineNo">882</span>     * @param mode<a name="line.882"></a>
<span class="sourceLineNo">883</span>     *            {@link EDUKPTDesMode}<a name="line.883"></a>
<span class="sourceLineNo">884</span>     * @return {@link DUKPTResult}<a name="line.884"></a>
<span class="sourceLineNo">885</span>     * @throws PedDevException<a name="line.885"></a>
<span class="sourceLineNo">886</span>     */<a name="line.886"></a>
<span class="sourceLineNo">887</span>    public DUKPTResult calcDUKPTDes(byte groupIndex, byte keyVarType, byte[] iv, byte[] dataIn, EDUKPTDesMode mode)<a name="line.887"></a>
<span class="sourceLineNo">888</span>            throws PedDevException;<a name="line.888"></a>
<span class="sourceLineNo">889</span><a name="line.889"></a>
<span class="sourceLineNo">890</span>    /**<a name="line.890"></a>
<span class="sourceLineNo">891</span>     * &lt;div class="zh"&gt; 获取当前的KSN。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.891"></a>
<span class="sourceLineNo">892</span>     * &lt;div class="en"&gt; Get the current KSN. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.892"></a>
<span class="sourceLineNo">893</span>     *<a name="line.893"></a>
<span class="sourceLineNo">894</span>     * @param groupIndex<a name="line.894"></a>
<span class="sourceLineNo">895</span>     *            &lt;div class="zh"&gt; [1~100] DUKPT密钥组索引号 &lt;/div&gt; &lt;div class="en"&gt; [1~100] DUKPT group index ID &lt;/div&gt;<a name="line.895"></a>
<span class="sourceLineNo">896</span>     *<a name="line.896"></a>
<span class="sourceLineNo">897</span>     * @return &lt;div class="zh"&gt; 10 bytes ,KSN currently  &lt;/div&gt; &lt;div class="en"&gt; 10 bytes ,KSN currently. &lt;/div&gt;<a name="line.897"></a>
<span class="sourceLineNo">898</span>     *<a name="line.898"></a>
<span class="sourceLineNo">899</span>     * @throws PedDevException<a name="line.899"></a>
<span class="sourceLineNo">900</span>     */<a name="line.900"></a>
<span class="sourceLineNo">901</span>    public byte[] getDUKPTKsn(byte groupIndex) throws PedDevException;<a name="line.901"></a>
<span class="sourceLineNo">902</span><a name="line.902"></a>
<span class="sourceLineNo">903</span>    /**<a name="line.903"></a>
<span class="sourceLineNo">904</span>     * &lt;div class="zh"&gt; 对应于KSN的单个DUKPT密钥最多只能使用256次，在达到最大次数后，进一步使用该密钥将返回{@link EPedDevException#PED_ERR_DUKPT_NEED_INC_KSN}异常，<a name="line.904"></a>
<span class="sourceLineNo">905</span>     * 所以请在使用钥匙次数超过最大次数之前增加KSN。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt;<a name="line.905"></a>
<span class="sourceLineNo">906</span>     * &lt;div class="en"&gt; A single DUKPT key corresponding to a KSN can only be used at most 256 times, further use of that key will result in<a name="line.906"></a>
<span class="sourceLineNo">907</span>     * {@link EPedDevException#PED_ERR_DUKPT_NEED_INC_KSN} after reaching the maxium times. So please increase KSN before number of use of the key<a name="line.907"></a>
<span class="sourceLineNo">908</span>     * exceeding the maximum times. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.908"></a>
<span class="sourceLineNo">909</span>     *<a name="line.909"></a>
<span class="sourceLineNo">910</span>     * @param groupIndex<a name="line.910"></a>
<span class="sourceLineNo">911</span>     *            &lt;div class="zh"&gt; [1~100] DUKPT密钥组索引号 &lt;/div&gt; &lt;div class="en"&gt; [1~100] DUKPT group ID &lt;/div&gt;<a name="line.911"></a>
<span class="sourceLineNo">912</span>     *<a name="line.912"></a>
<span class="sourceLineNo">913</span>     * @throws PedDevException<a name="line.913"></a>
<span class="sourceLineNo">914</span>     */<a name="line.914"></a>
<span class="sourceLineNo">915</span>    public void incDUKPTKsn(byte groupIndex) throws PedDevException;<a name="line.915"></a>
<span class="sourceLineNo">916</span><a name="line.916"></a>
<span class="sourceLineNo">917</span>    /**<a name="line.917"></a>
<span class="sourceLineNo">918</span>     * &lt;div class="zh"&gt; 实现脱机明文PIN校验功能。获取明文PIN，然后按照应用提供的卡片命令与卡片通道号，将明文PIN BLOCK直接发送给卡片(PIN BLOCK格式在用法部分描述)。<a name="line.918"></a>
<span class="sourceLineNo">919</span>     * 仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt;<a name="line.919"></a>
<span class="sourceLineNo">920</span>     * &lt;div class="en"&gt; Achieve the function of verifying plaintext offline PIN. Get plaintext PIN and then Send plaintext<a name="line.920"></a>
<span class="sourceLineNo">921</span>     * PIN BLOCK to card according to card command and card slot number (PIN BLOCK format will be provided in operation<a name="line.921"></a>
<span class="sourceLineNo">922</span>     * part.). {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.922"></a>
<span class="sourceLineNo">923</span>     *<a name="line.923"></a>
<span class="sourceLineNo">924</span>     * @param slot<a name="line.924"></a>
<span class="sourceLineNo">925</span>     *            &lt;div class="zh"&gt; 卡片所在的卡座号 &lt;/div&gt; &lt;div class="en"&gt; card slot number &lt;/div&gt;<a name="line.925"></a>
<span class="sourceLineNo">926</span>     *<a name="line.926"></a>
<span class="sourceLineNo">927</span>     * @param expPinLen<a name="line.927"></a>
<span class="sourceLineNo">928</span>     *            &lt;div class="zh"&gt; 0~12的枚举集合 可输入的合法密码长度字符串，应用程序把允许的密 码长度全部枚举出来，并且用","号隔开每个长度， 如允许输入4、6位密码并且允许无密码直接按确认，<a name="line.928"></a>
<span class="sourceLineNo">929</span>     *            则该字符串应该设置为"0,4,6" &lt;/div&gt; &lt;div class="en"&gt; Enumeration of 0-12.The enter password string with legal<a name="line.929"></a>
<span class="sourceLineNo">930</span>     *            length. Application enumerates all possible lengths of PIN. ‘,’ will be used to separate each number<a name="line.930"></a>
<span class="sourceLineNo">931</span>     *            of length. If 4 or 6 digits of PIN are allowed and it is also allowed to press ‘Enter’ without PIN<a name="line.931"></a>
<span class="sourceLineNo">932</span>     *            .Then this string should be set as ‘0, 4, and 6’. &lt;/div&gt;<a name="line.932"></a>
<span class="sourceLineNo">933</span>     *<a name="line.933"></a>
<span class="sourceLineNo">934</span>     * @param mode &lt;div class="zh"&gt;<a name="line.934"></a>
<span class="sourceLineNo">935</span>     *              &lt;ul&gt;<a name="line.935"></a>
<span class="sourceLineNo">936</span>     *                  &lt;li&gt;0x00: I C卡命令模式，现支持符合EMV2000的IC卡命令。&lt;/li&gt;<a name="line.936"></a>
<span class="sourceLineNo">937</span>     *                  &lt;li&gt;0x01: 给WIC使用。&lt;/li&gt;<a name="line.937"></a>
<span class="sourceLineNo">938</span>     *              &lt;/ul&gt;<a name="line.938"></a>
<span class="sourceLineNo">939</span>     *             &lt;/div&gt;<a name="line.939"></a>
<span class="sourceLineNo">940</span>     *             &lt;div class="en"&gt;<a name="line.940"></a>
<span class="sourceLineNo">941</span>     *              &lt;ul&gt;<a name="line.941"></a>
<span class="sourceLineNo">942</span>     *                  &lt;li&gt;0x00: IC Card Command Mode,Currently support EMV2000.&lt;/li&gt;<a name="line.942"></a>
<span class="sourceLineNo">943</span>     *                  &lt;li&gt;0x01: For WIC.&lt;/li&gt;<a name="line.943"></a>
<span class="sourceLineNo">944</span>     *              &lt;/ul&gt;<a name="line.944"></a>
<span class="sourceLineNo">945</span>     *             &lt;/div&gt;<a name="line.945"></a>
<span class="sourceLineNo">946</span>     *<a name="line.946"></a>
<span class="sourceLineNo">947</span>     * @param timeoutMs<a name="line.947"></a>
<span class="sourceLineNo">948</span>     *            &lt;div class="zh"&gt; 输入PIN的超时时间，单位：毫秒 最大值为300000ms &lt;/div&gt; &lt;div class="en"&gt; The timeout of PIN entry<a name="line.948"></a>
<span class="sourceLineNo">949</span>     *            [ms],Maximum is 300000ms. &lt;/div&gt;<a name="line.949"></a>
<span class="sourceLineNo">950</span>     *<a name="line.950"></a>
<span class="sourceLineNo">951</span>     * @return &lt;div class="zh"&gt; 卡片响应的状态码 (2字节：SW1+SW2) &lt;/div&gt; &lt;div class="en"&gt; The status code of card response (2<a name="line.951"></a>
<span class="sourceLineNo">952</span>     *         bytes: SW1+SW2). &lt;/div&gt;<a name="line.952"></a>
<span class="sourceLineNo">953</span>     *<a name="line.953"></a>
<span class="sourceLineNo">954</span>     * @throws PedDevException<a name="line.954"></a>
<span class="sourceLineNo">955</span>     */<a name="line.955"></a>
<span class="sourceLineNo">956</span>    public byte[] verifyPlainPin(byte slot, String expPinLen, byte mode, int timeoutMs) throws PedDevException;<a name="line.956"></a>
<span class="sourceLineNo">957</span><a name="line.957"></a>
<span class="sourceLineNo">958</span>    /**<a name="line.958"></a>
<span class="sourceLineNo">959</span>     * &lt;div class="zh"&gt; 实现脱机密文PIN校验功能。先获取明文PIN，再用应用提供的RsaPinKey对明文PIN按照EMV规范进行加密，然后用应用<a name="line.959"></a>
<span class="sourceLineNo">960</span>     * 提供的卡片命令与卡片通道号，将密文PIN直接发送给卡片 。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.960"></a>
<span class="sourceLineNo">961</span>     * &lt;div class="en"&gt; Verify enciphered PIN offline. Get plain text PIN and then use RsaPinKey provided by application<a name="line.961"></a>
<span class="sourceLineNo">962</span>     * to encrypt plaintext PIN according to EMV standard. Send enciphered PIN to card according to card command and<a name="line.962"></a>
<span class="sourceLineNo">963</span>     * card channel number provided by application. {@link EPedType#INTERNAL} only is supported. &lt;/div&gt;<a name="line.963"></a>
<span class="sourceLineNo">964</span>     *<a name="line.964"></a>
<span class="sourceLineNo">965</span>     * @param slot<a name="line.965"></a>
<span class="sourceLineNo">966</span>     *            &lt;div class="zh"&gt; 卡片所在的卡座号 &lt;/div&gt; &lt;div class="en"&gt; card slot number &lt;/div&gt;<a name="line.966"></a>
<span class="sourceLineNo">967</span>     *<a name="line.967"></a>
<span class="sourceLineNo">968</span>     * @param expPinLen<a name="line.968"></a>
<span class="sourceLineNo">969</span>     *            &lt;div class="zh"&gt; 0~12的枚举集合 可输入的合法密码长度字符串，应用程序把允许的密 码长度全部枚举出来，并且用","号隔开每个长度， 如允许输入4、6位密码并且允许无密码直接按确认，<a name="line.969"></a>
<span class="sourceLineNo">970</span>     *            则该字符串应该设置为"0,4,6" &lt;/div&gt; &lt;div class="en"&gt; Enumeration of 0-12.The enter password string with legal<a name="line.970"></a>
<span class="sourceLineNo">971</span>     *            length. Application enumerates all possible lengths of PIN. ‘,’ will be used to separate each number<a name="line.971"></a>
<span class="sourceLineNo">972</span>     *            of length. If 4 or 6 digits of PIN are allowed and it is also allowed to press ‘Enter’ without PIN<a name="line.972"></a>
<span class="sourceLineNo">973</span>     *            .Then this string should be set as ‘0, 4, and 6’. &lt;/div&gt;<a name="line.973"></a>
<span class="sourceLineNo">974</span>     *<a name="line.974"></a>
<span class="sourceLineNo">975</span>     *<a name="line.975"></a>
<span class="sourceLineNo">976</span>     * @param rsaPinKey<a name="line.976"></a>
<span class="sourceLineNo">977</span>     *            {@link RSAPinKey}<a name="line.977"></a>
<span class="sourceLineNo">978</span>     * @param mode<a name="line.978"></a>
<span class="sourceLineNo">979</span>     *            &lt;div class="zh"&gt; 0x00 IC卡命令模式，目前支持EMV2000。 &lt;/div&gt; &lt;div class="en"&gt; 0x00 IC Card Command Mode,Currently<a name="line.979"></a>
<span class="sourceLineNo">980</span>     *            support EMV2000. &lt;/div&gt;<a name="line.980"></a>
<span class="sourceLineNo">981</span>     *<a name="line.981"></a>
<span class="sourceLineNo">982</span>     * @param timeout<a name="line.982"></a>
<span class="sourceLineNo">983</span>     *            &lt;div class="zh"&gt; 输入PIN的超时时间，单位：毫秒 最大值为300000ms &lt;/div&gt; &lt;div class="en"&gt; The timeout of PIN input<a name="line.983"></a>
<span class="sourceLineNo">984</span>     *            [unit:ms].Maximum is 300000Ms. &lt;/div&gt;<a name="line.984"></a>
<span class="sourceLineNo">985</span>     *<a name="line.985"></a>
<span class="sourceLineNo">986</span>     * @return &lt;div class="zh"&gt; 卡片响应的状态码 (2字节：SW1+SW2) &lt;/div&gt; &lt;div class="en"&gt; The card response code (2 bytes:SW1 and<a name="line.986"></a>
<span class="sourceLineNo">987</span>     *         SW2) &lt;/div&gt;<a name="line.987"></a>
<span class="sourceLineNo">988</span>     *<a name="line.988"></a>
<span class="sourceLineNo">989</span>     * @throws PedDevException<a name="line.989"></a>
<span class="sourceLineNo">990</span>     */<a name="line.990"></a>
<span class="sourceLineNo">991</span>    public byte[] verifyCipherPin(byte slot, String expPinLen, RSAPinKey rsaPinKey, byte mode, int timeout)<a name="line.991"></a>
<span class="sourceLineNo">992</span>            throws PedDevException;<a name="line.992"></a>
<span class="sourceLineNo">993</span><a name="line.993"></a>
<span class="sourceLineNo">994</span>    /**<a name="line.994"></a>
<span class="sourceLineNo">995</span>     * &lt;div class="zh"&gt; 该接口仅用于外置密码键盘，下载密钥，计算pinblock,计算mac,des加解密使用 。仅支持{@link EPedType#EXTERNAL_TYPEA} 类型。&lt;/div&gt; &lt;div class="en"&gt; This interface only be used<a name="line.995"></a>
<span class="sourceLineNo">996</span>     * for external PIN pad Use for downloading main key and work key. {@link EPedType#EXTERNAL_TYPEA} only is supported.&lt;/div&gt;<a name="line.996"></a>
<span class="sourceLineNo">997</span>     *<a name="line.997"></a>
<span class="sourceLineNo">998</span>     * @param exMode<a name="line.998"></a>
<span class="sourceLineNo">999</span>     *            &lt;div class="zh"&gt;<a name="line.999"></a>
<span class="sourceLineNo">1000</span>     *            &lt;ul&gt;<a name="line.1000"></a>
<span class="sourceLineNo">1001</span>     *            调用writeKey时，如果下载的密钥为主密钥或DES密钥，取值如下：<a name="line.1001"></a>
<span class="sourceLineNo">1002</span>     *            &lt;li&gt;-1,默认值，3倍DES密钥 16字节&lt;/li&gt;<a name="line.1002"></a>
<span class="sourceLineNo">1003</span>     *            &lt;li&gt;0x01 单DES密钥 8字节&lt;/li&gt;<a name="line.1003"></a>
<span class="sourceLineNo">1004</span>     *            &lt;li&gt;0x03 3倍DES密钥 16字节&lt;/li&gt;<a name="line.1004"></a>
<span class="sourceLineNo">1005</span>     *            &lt;li&gt;0x07 3倍DES密钥 24字节&lt;/li&gt;<a name="line.1005"></a>
<span class="sourceLineNo">1006</span>     *<a name="line.1006"></a>
<span class="sourceLineNo">1007</span>     *            &lt;/ul&gt;<a name="line.1007"></a>
<span class="sourceLineNo">1008</span>     *<a name="line.1008"></a>
<span class="sourceLineNo">1009</span>     *            &lt;ul&gt;<a name="line.1009"></a>
<span class="sourceLineNo">1010</span>     *            调用writeKey时，如果下载的密钥为工作密钥(TPK,TAK)则指示最终工作密钥明文的生成运算方式:<a name="line.1010"></a>
<span class="sourceLineNo">1011</span>     *            &lt;li&gt;-1,默认值，主密钥和工作密钥均为3DES/16字节密钥，采用主密钥对工作密钥解密的方式&lt;/li&gt;<a name="line.1011"></a>
<span class="sourceLineNo">1012</span>     *            &lt;li&gt;0x01-- DES加密 0x81-- DES解密 MKeyID 与 WKeyID 均为单DES/ 8字节密钥&lt;/li&gt;<a name="line.1012"></a>
<span class="sourceLineNo">1013</span>     *            &lt;li&gt;0x03-- 3DES加密0x31-- 3DES加密 0x83-- 3DES解密 0xb1-- 3DES解密 0x03-- 3DES加密<a name="line.1013"></a>
<span class="sourceLineNo">1014</span>     *            MKeyID为3DES/16字节密钥，WKeyID为单DES/8字节密钥&lt;/li&gt;<a name="line.1014"></a>
<span class="sourceLineNo">1015</span>     *            &lt;li&gt;0x07-- 3DES加密 0x87-- 3DES解密 MKeyID为3DES/24字节密钥，WKeyID为单DES/8字节密钥&lt;/li&gt;<a name="line.1015"></a>
<span class="sourceLineNo">1016</span>     *            &lt;li&gt;0x33-- 3DES加密 0xb3-- 3DES解密 MKeyID与WKeyID均为3DES/16字节密钥&lt;/li&gt;<a name="line.1016"></a>
<span class="sourceLineNo">1017</span>     *            &lt;li&gt;0x71-- 3DES加密 0xf1-- 3DES解密 MKeyID为3DES/24字节密钥, WKeyID为单DES/8字节密钥&lt;/li&gt;<a name="line.1017"></a>
<span class="sourceLineNo">1018</span>     *            &lt;li&gt;0x73-- 3DES加密 0xf3-- 3DES解密 MKeyID为3DES/24字节密钥, WKeyID为3DES－16字节密钥&lt;/li&gt;<a name="line.1018"></a>
<span class="sourceLineNo">1019</span>     *            &lt;li&gt;0x77-- 3DES加密 0xf7-- 3DES解密 MKeyID与WKeyID均为3DES/24字节密钥&lt;/li&gt;<a name="line.1019"></a>
<span class="sourceLineNo">1020</span>     *            &lt;/ul&gt;<a name="line.1020"></a>
<span class="sourceLineNo">1021</span>     *<a name="line.1021"></a>
<span class="sourceLineNo">1022</span>     *            &lt;ul&gt;<a name="line.1022"></a>
<span class="sourceLineNo">1023</span>     *            调用getPinBlock的时候: 如果mode = EPinBlockMode.ISO9564_0模式<a name="line.1023"></a>
<span class="sourceLineNo">1024</span>     *            &lt;li&gt;-1: 默认值，TPK为16字节密钥&lt;/li&gt;<a name="line.1024"></a>
<span class="sourceLineNo">1025</span>     *            &lt;li&gt;0x01：8字节单DES,按照ANSI X9.8标准，PIN输入时当最小长度不为0时,允许按"确认"退出&lt;/li&gt;<a name="line.1025"></a>
<span class="sourceLineNo">1026</span>     *            &lt;li&gt;0x31:16字节密钥DES按照ANSI X9.8标准，PIN输入时当最小长度不为0时,允许按"确认"退出&lt;/li&gt;<a name="line.1026"></a>
<span class="sourceLineNo">1027</span>     *            &lt;li&gt;0x71:24字节密钥DES按照ANSI X9.8标准，PIN输入时当最小长度不为0时,允许按"确认"退出&lt;/li&gt;<a name="line.1027"></a>
<span class="sourceLineNo">1028</span>     *            &lt;li&gt;0x04 ：按照ANSI X9.8标准,采用3DES加密方法&lt;/li&gt;<a name="line.1028"></a>
<span class="sourceLineNo">1029</span>     *<a name="line.1029"></a>
<span class="sourceLineNo">1030</span>     *            如果mode = EPinBlockMode.HKEPS模式(X3.92)<a name="line.1030"></a>
<span class="sourceLineNo">1031</span>     *            &lt;li&gt;-1: 默认值，TPK为8字节单DES密钥&lt;/li&gt;<a name="line.1031"></a>
<span class="sourceLineNo">1032</span>     *            &lt;li&gt;0x02: des按照ANSI X3.92标准&lt;/li&gt;<a name="line.1032"></a>
<span class="sourceLineNo">1033</span>     *            &lt;li&gt;0x32: 16字节密钥DES按照ANSI X3.92标准,大陆版SP20不支持&lt;/li&gt;<a name="line.1033"></a>
<span class="sourceLineNo">1034</span>     *            &lt;li&gt;0x72: 24字节密钥DES按照ANSI X3.92标准,大陆版SP20不支持&lt;/li&gt;<a name="line.1034"></a>
<span class="sourceLineNo">1035</span>     *            &lt;/ul&gt;<a name="line.1035"></a>
<span class="sourceLineNo">1036</span>     *<a name="line.1036"></a>
<span class="sourceLineNo">1037</span>     *            &lt;ul&gt;<a name="line.1037"></a>
<span class="sourceLineNo">1038</span>     *            调用getMac的时候,指定PedMacMode后还需要指定exMode 如果mode = PedMacMode#MODE_00(算法1),exMode的取值如下：<a name="line.1038"></a>
<span class="sourceLineNo">1039</span>     *            &lt;li&gt;-1: 默认值，3DES加密[密钥为16字节]&lt;/li&gt;<a name="line.1039"></a>
<span class="sourceLineNo">1040</span>     *            &lt;li&gt;0x01 DES加密[密钥为8字节]&lt;/li&gt;<a name="line.1040"></a>
<span class="sourceLineNo">1041</span>     *            &lt;li&gt;0x03 3DES加密[密钥为16字节]&lt;/li&gt;<a name="line.1041"></a>
<span class="sourceLineNo">1042</span>     *            &lt;li&gt;0x07 3DES加密[密钥为24字节]&lt;/li&gt;<a name="line.1042"></a>
<span class="sourceLineNo">1043</span>     *<a name="line.1043"></a>
<span class="sourceLineNo">1044</span>     *            如果mode = PedMacMode#MODE_01(算法2),exMode的取值如下：<a name="line.1044"></a>
<span class="sourceLineNo">1045</span>     *            &lt;li&gt;-1: 默认值，3DES加密[密钥为16字节]&lt;/li&gt;<a name="line.1045"></a>
<span class="sourceLineNo">1046</span>     *            &lt;li&gt;0x01 DES加密[密钥为8字节]&lt;/li&gt;<a name="line.1046"></a>
<span class="sourceLineNo">1047</span>     *            &lt;li&gt;0x03 3DES加密[密钥为16字节]&lt;/li&gt;<a name="line.1047"></a>
<span class="sourceLineNo">1048</span>     *            &lt;li&gt;0x07 3DES加密[密钥为24字节]&lt;/li&gt;<a name="line.1048"></a>
<span class="sourceLineNo">1049</span>     *<a name="line.1049"></a>
<span class="sourceLineNo">1050</span>     *            如果mode = PedMacMode#MODE_02(算法3),exMode的取值如下：<a name="line.1050"></a>
<span class="sourceLineNo">1051</span>     *            &lt;li&gt;-1: 默认值，3DES加密[密钥为16字节]&lt;/li&gt;<a name="line.1051"></a>
<span class="sourceLineNo">1052</span>     *            &lt;li&gt;0x13: 3DES加密[密钥为16字节]&lt;/li&gt;<a name="line.1052"></a>
<span class="sourceLineNo">1053</span>     *            &lt;li&gt;0x17: 3DES加密[密钥为24字节]&lt;/li&gt;<a name="line.1053"></a>
<span class="sourceLineNo">1054</span>     *<a name="line.1054"></a>
<span class="sourceLineNo">1055</span>     *            &lt;/ul&gt;<a name="line.1055"></a>
<span class="sourceLineNo">1056</span>     *<a name="line.1056"></a>
<span class="sourceLineNo">1057</span>     *            &lt;ul&gt;<a name="line.1057"></a>
<span class="sourceLineNo">1058</span>     *            调用calcDes的时候，需要指定exMode,取值如下：<a name="line.1058"></a>
<span class="sourceLineNo">1059</span>     *            &lt;li&gt;-1: 默认值，[密钥为16字节]，加解密由calcDes的EPedDesMode参数指定&lt;/li&gt;<a name="line.1059"></a>
<span class="sourceLineNo">1060</span>     *            &lt;li&gt;0x01 DES加密&lt;/li&gt;<a name="line.1060"></a>
<span class="sourceLineNo">1061</span>     *            &lt;li&gt;0x03 3DES加密 [密钥为16字节]&lt;/li&gt;<a name="line.1061"></a>
<span class="sourceLineNo">1062</span>     *            &lt;li&gt;0x81 DES解密 （EPS无此项）&lt;/li&gt;<a name="line.1062"></a>
<span class="sourceLineNo">1063</span>     *            &lt;li&gt;0x83 3DES解密 （EPS无此项）&lt;/li&gt;<a name="line.1063"></a>
<span class="sourceLineNo">1064</span>     *            &lt;li&gt;0x07 3DES加密 [密钥为24字节]&lt;/li&gt;<a name="line.1064"></a>
<span class="sourceLineNo">1065</span>     *            &lt;li&gt;0x87 3DES解密 [密钥为24字节]&lt;/li&gt;<a name="line.1065"></a>
<span class="sourceLineNo">1066</span>     *<a name="line.1066"></a>
<span class="sourceLineNo">1067</span>     *            &lt;/ul&gt;<a name="line.1067"></a>
<span class="sourceLineNo">1068</span>     *            &lt;/div&gt; &lt;div class="en"&gt; When call writeKey,if the downloading key is main key or the DES key,then:<a name="line.1068"></a>
<span class="sourceLineNo">1069</span>     *            &lt;ul&gt;<a name="line.1069"></a>
<span class="sourceLineNo">1070</span>     *            &lt;li&gt;mode=0x01 -DES key of 8 bytes&lt;/li&gt;<a name="line.1070"></a>
<span class="sourceLineNo">1071</span>     *            &lt;li&gt;mode=0x03 -3DES key of 16 bytes&lt;/li&gt;<a name="line.1071"></a>
<span class="sourceLineNo">1072</span>     *            &lt;li&gt;mode=0x07 -3DES key of 24 bytes&lt;/li&gt;<a name="line.1072"></a>
<span class="sourceLineNo">1073</span>     *            &lt;/ul&gt;<a name="line.1073"></a>
<span class="sourceLineNo">1074</span>     *            When called writeKey,if the downloading key is work key(TPK,TAK), then specify the final generated<a name="line.1074"></a>
<span class="sourceLineNo">1075</span>     *            computation mode:<a name="line.1075"></a>
<span class="sourceLineNo">1076</span>     *            &lt;ul&gt;<a name="line.1076"></a>
<span class="sourceLineNo">1077</span>     *            &lt;li&gt;0x01-- DES encryption 0x81-- DES decryption. MKeyID and WKeyID are both DES/ key of 8 bytes&lt;/li&gt;<a name="line.1077"></a>
<span class="sourceLineNo">1078</span>     *            &lt;li&gt;0x03-- 3DES encryption 0x83-- 3DES decryption 0xb1-- 3DES decreption. MKeyID is 3DES/key of 16<a name="line.1078"></a>
<span class="sourceLineNo">1079</span>     *            bytes，WKeyID is DES/key of 8 bytes&lt;/li&gt;<a name="line.1079"></a>
<span class="sourceLineNo">1080</span>     *            &lt;li&gt;0x07-- 3DES encryption 0x87-- 3DES decryption. MKeyID is 3DES/key of 24 bytes，WKeyID is DES/key of<a name="line.1080"></a>
<span class="sourceLineNo">1081</span>     *            8 bytes&lt;/li&gt;<a name="line.1081"></a>
<span class="sourceLineNo">1082</span>     *            &lt;li&gt;0x33-- 3DES encryption 0xb3-- 3DES decryption. MKeyID and WKeyID are both 3DES/key of 16 bytes&lt;/li&gt;<a name="line.1082"></a>
<span class="sourceLineNo">1083</span>     *            &lt;li&gt;0x71-- 3DES encryption 0xf1-- 3DES decryption. MKeyID is 3DES/key of 24 bytes, WKeyID is DES/key<a name="line.1083"></a>
<span class="sourceLineNo">1084</span>     *            of 8 bytes&lt;/li&gt;<a name="line.1084"></a>
<span class="sourceLineNo">1085</span>     *            &lt;li&gt;0x73-- 3DES encryption 0xf3-- 3DES decryption. MKeyID is 3DES/key of 24 bytes, WKeyID is 3DES/key<a name="line.1085"></a>
<span class="sourceLineNo">1086</span>     *            of 16 bytes&lt;/li&gt;<a name="line.1086"></a>
<span class="sourceLineNo">1087</span>     *            &lt;li&gt;0x77-- 3DES encryption 0xf7-- 3DES decryption. MKeyID and WKeyID are both 3DES/key of 24 bytes&lt;/li&gt;<a name="line.1087"></a>
<span class="sourceLineNo">1088</span>     *            &lt;/ul&gt;<a name="line.1088"></a>
<span class="sourceLineNo">1089</span>     *            When called getPinBlock,to ANSI X3.92 Standard<a name="line.1089"></a>
<span class="sourceLineNo">1090</span>     *            &lt;ul&gt;<a name="line.1090"></a>
<span class="sourceLineNo">1091</span>     *            &lt;li&gt;0x02: 8 bytes key&lt;/li&gt;<a name="line.1091"></a>
<span class="sourceLineNo">1092</span>     *            &lt;li&gt;0x32: 16 bytes key&lt;/li&gt;<a name="line.1092"></a>
<span class="sourceLineNo">1093</span>     *            &lt;li&gt;0x72: 24 bytes key&lt;/li&gt;<a name="line.1093"></a>
<span class="sourceLineNo">1094</span>     *            &lt;/ul&gt;<a name="line.1094"></a>
<span class="sourceLineNo">1095</span>     *            When called getMac,specify PedMacMode and exMode. If mode= PedMacMode#MODE_00, exMode value as<a name="line.1095"></a>
<span class="sourceLineNo">1096</span>     *            follows:<a name="line.1096"></a>
<span class="sourceLineNo">1097</span>     *            &lt;ul&gt;<a name="line.1097"></a>
<span class="sourceLineNo">1098</span>     *            &lt;li&gt;0x01 -DES encryption[8 bytes]&lt;/li&gt;<a name="line.1098"></a>
<span class="sourceLineNo">1099</span>     *            &lt;li&gt;0x03 -3DES encryption[16 bytes]&lt;/li&gt;<a name="line.1099"></a>
<span class="sourceLineNo">1100</span>     *            &lt;li&gt;0x07 -3DES encryption [24 bytes]&lt;/li&gt;<a name="line.1100"></a>
<span class="sourceLineNo">1101</span>     *            &lt;/ul&gt;<a name="line.1101"></a>
<span class="sourceLineNo">1102</span>     *            If mode = PedMacMode#MODE_02,exMode value as follows:<a name="line.1102"></a>
<span class="sourceLineNo">1103</span>     *            &lt;ul&gt;<a name="line.1103"></a>
<span class="sourceLineNo">1104</span>     *            &lt;li&gt;0x13: 3DES encryption [16 bytes]&lt;/li&gt;<a name="line.1104"></a>
<span class="sourceLineNo">1105</span>     *            &lt;li&gt;0x17: 3DES encryption [24 bytes]&lt;/li&gt;<a name="line.1105"></a>
<span class="sourceLineNo">1106</span>     *            &lt;/ul&gt;<a name="line.1106"></a>
<span class="sourceLineNo">1107</span>     *            If mode = PedMacMode#MODE_01,exMode value as follows:<a name="line.1107"></a>
<span class="sourceLineNo">1108</span>     *            &lt;ul&gt;<a name="line.1108"></a>
<span class="sourceLineNo">1109</span>     *            &lt;li&gt;0x01 -DES encryption [8 bytes]&lt;/li&gt;<a name="line.1109"></a>
<span class="sourceLineNo">1110</span>     *            &lt;li&gt;0x03 -3DES encryption [16 bytes]&lt;/li&gt;<a name="line.1110"></a>
<span class="sourceLineNo">1111</span>     *            &lt;li&gt;0x07 -3DES encryption [24 bytes]&lt;/li&gt;<a name="line.1111"></a>
<span class="sourceLineNo">1112</span>     *            &lt;/ul&gt;<a name="line.1112"></a>
<span class="sourceLineNo">1113</span>     *            When called calDes,specify the exMode, value as follows:<a name="line.1113"></a>
<span class="sourceLineNo">1114</span>     *            &lt;ul&gt;<a name="line.1114"></a>
<span class="sourceLineNo">1115</span>     *            &lt;li&gt;mode = 0x01 -DES encryption&lt;/li&gt;<a name="line.1115"></a>
<span class="sourceLineNo">1116</span>     *            &lt;li&gt;mode = 0x03 -3DES encryption [16 bytes]&lt;/li&gt;<a name="line.1116"></a>
<span class="sourceLineNo">1117</span>     *            &lt;li&gt;mode = 0x81 -DES decryption [No this option for EPS]&lt;/li&gt;<a name="line.1117"></a>
<span class="sourceLineNo">1118</span>     *            &lt;li&gt;mode = 0x83 -3DES decryption[No this option for EPS]&lt;/li&gt;<a name="line.1118"></a>
<span class="sourceLineNo">1119</span>     *            &lt;li&gt;mode=0x07 -3DES encryption　[24 bytes]&lt;/li&gt;<a name="line.1119"></a>
<span class="sourceLineNo">1120</span>     *            &lt;li&gt;mode=0x87 -3DES decryption　[24 bytes]&lt;/li&gt;<a name="line.1120"></a>
<span class="sourceLineNo">1121</span>     *            &lt;/ul&gt;<a name="line.1121"></a>
<span class="sourceLineNo">1122</span>     *            &lt;/div&gt;<a name="line.1122"></a>
<span class="sourceLineNo">1123</span>     *<a name="line.1123"></a>
<span class="sourceLineNo">1124</span>     *<a name="line.1124"></a>
<span class="sourceLineNo">1125</span>     */<a name="line.1125"></a>
<span class="sourceLineNo">1126</span>    public void setExMode(int exMode);<a name="line.1126"></a>
<span class="sourceLineNo">1127</span><a name="line.1127"></a>
<span class="sourceLineNo">1128</span>    /**<a name="line.1128"></a>
<span class="sourceLineNo">1129</span>     * &lt;div class="zh"&gt; 该接口仅用于外置密码键盘<a name="line.1129"></a>
<span class="sourceLineNo">1130</span>     *<a name="line.1130"></a>
<span class="sourceLineNo">1131</span>     * 清屏 &lt;/div&gt; &lt;div class="en"&gt; This interface only be used for external PIN pad Clear screen &lt;/div&gt;<a name="line.1131"></a>
<span class="sourceLineNo">1132</span>     *<a name="line.1132"></a>
<span class="sourceLineNo">1133</span>     * @throws PedDevException<a name="line.1133"></a>
<span class="sourceLineNo">1134</span>     */<a name="line.1134"></a>
<span class="sourceLineNo">1135</span>    public void clearScreen() throws PedDevException;<a name="line.1135"></a>
<span class="sourceLineNo">1136</span><a name="line.1136"></a>
<span class="sourceLineNo">1137</span>    /**<a name="line.1137"></a>
<span class="sourceLineNo">1138</span>     * &lt;div class="zh"&gt; 该接口仅用于外置密码键盘<a name="line.1138"></a>
<span class="sourceLineNo">1139</span>     *<a name="line.1139"></a>
<span class="sourceLineNo">1140</span>     * 超时时间内输入指定长度范围内的字符串。仅支持{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt; &lt;div class="en"&gt; This interface only be used for external PIN pad Type string with<a name="line.1140"></a>
<span class="sourceLineNo">1141</span>     * specified length within timeout. {@link EPedType#EXTERNAL_TYPEA} only is supported.&lt;/div&gt;<a name="line.1141"></a>
<span class="sourceLineNo">1142</span>     *<a name="line.1142"></a>
<span class="sourceLineNo">1143</span>     *<a name="line.1143"></a>
<span class="sourceLineNo">1144</span>     * @param mode<a name="line.1144"></a>
<span class="sourceLineNo">1145</span>     *            &lt;div class="zh"&gt; 0x00 - 明码显示, 0x01 - 显示*号 &lt;/div&gt; &lt;div class="en"&gt; 0x00 - show plain code, 0x01 - show<a name="line.1145"></a>
<span class="sourceLineNo">1146</span>     *            * code &lt;/div&gt;<a name="line.1146"></a>
<span class="sourceLineNo">1147</span>     *<a name="line.1147"></a>
<span class="sourceLineNo">1148</span>     * @param min<a name="line.1148"></a>
<span class="sourceLineNo">1149</span>     *            &lt;div class="zh"&gt; 输入字符串的最小长度 &lt;/div&gt; &lt;div class="en"&gt; Min length for typing string &lt;/div&gt;<a name="line.1149"></a>
<span class="sourceLineNo">1150</span>     *<a name="line.1150"></a>
<span class="sourceLineNo">1151</span>     * @param max<a name="line.1151"></a>
<span class="sourceLineNo">1152</span>     *            &lt;div class="zh"&gt; 输入字符串的最大长度 &lt;/div&gt; &lt;div class="en"&gt; Max length for typing string &lt;/div&gt;<a name="line.1152"></a>
<span class="sourceLineNo">1153</span>     *<a name="line.1153"></a>
<span class="sourceLineNo">1154</span>     * @param timeoutMs<a name="line.1154"></a>
<span class="sourceLineNo">1155</span>     *            &lt;div class="zh"&gt; 超时时间，单位毫秒，最大超时时间为120秒 &lt;/div&gt; &lt;div class="en"&gt; Timeout[ms],max timeout is 120 seconds.<a name="line.1155"></a>
<span class="sourceLineNo">1156</span>     *            &lt;/div&gt;<a name="line.1156"></a>
<span class="sourceLineNo">1157</span>     *<a name="line.1157"></a>
<span class="sourceLineNo">1158</span>     * @return &lt;div class="zh"&gt; 输入的字符串 &lt;/div&gt; &lt;div class="en"&gt; typed string &lt;/div&gt;<a name="line.1158"></a>
<span class="sourceLineNo">1159</span>     *<a name="line.1159"></a>
<span class="sourceLineNo">1160</span>     * @throws PedDevException<a name="line.1160"></a>
<span class="sourceLineNo">1161</span>     */<a name="line.1161"></a>
<span class="sourceLineNo">1162</span>    public String inputStr(byte mode, byte min, byte max, int timeoutMs) throws PedDevException;<a name="line.1162"></a>
<span class="sourceLineNo">1163</span><a name="line.1163"></a>
<span class="sourceLineNo">1164</span>    /**<a name="line.1164"></a>
<span class="sourceLineNo">1165</span>     * &lt;div class="zh"&gt; 该接口仅用于外置密码键盘 显示英文字符。仅支持{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt; &lt;div class="en"&gt; This interface only be used for external PIN pad<a name="line.1165"></a>
<span class="sourceLineNo">1166</span>     * show English character. {@link EPedType#EXTERNAL_TYPEA} only is supported.&lt;/div&gt;<a name="line.1166"></a>
<span class="sourceLineNo">1167</span>     *<a name="line.1167"></a>
<span class="sourceLineNo">1168</span>     * @param x<a name="line.1168"></a>
<span class="sourceLineNo">1169</span>     *            &lt;div class="zh"&gt; 显示字符在LCD上的起始点阵列号(单位：点),0≤x&lt;122； &lt;/div&gt; &lt;div class="en"&gt; Horizontal coordinate which<a name="line.1169"></a>
<span class="sourceLineNo">1170</span>     *            is displayed on LCD.(unit: pixel great than or equal to 0 and less than or equal to 122) &lt;/div&gt;<a name="line.1170"></a>
<span class="sourceLineNo">1171</span>     *<a name="line.1171"></a>
<span class="sourceLineNo">1172</span>     * @param y<a name="line.1172"></a>
<span class="sourceLineNo">1173</span>     *            &lt;div class="zh"&gt; y：显示字符在LCD上的行号(单位：行),每行均为16点高的行，0—第一行，1--第二 &lt;/div&gt; &lt;div class="en"&gt; Vertical<a name="line.1173"></a>
<span class="sourceLineNo">1174</span>     *            coordinate which is displayed on LCD.(unit:pixel),the height of every row is 16 pixels. 0-1st row,<a name="line.1174"></a>
<span class="sourceLineNo">1175</span>     *            1-2nd row &lt;/div&gt;<a name="line.1175"></a>
<span class="sourceLineNo">1176</span>     *<a name="line.1176"></a>
<span class="sourceLineNo">1177</span>     * @param str<a name="line.1177"></a>
<span class="sourceLineNo">1178</span>     *            &lt;div class="zh"&gt; 要显示的字符串 &lt;/div&gt; &lt;div class="en"&gt; string to be displayed &lt;/div&gt;<a name="line.1178"></a>
<span class="sourceLineNo">1179</span>     *<a name="line.1179"></a>
<span class="sourceLineNo">1180</span>     * @throws PedDevException<a name="line.1180"></a>
<span class="sourceLineNo">1181</span>     */<a name="line.1181"></a>
<span class="sourceLineNo">1182</span>    public void showStr(byte x, byte y, String str) throws PedDevException;<a name="line.1182"></a>
<span class="sourceLineNo">1183</span><a name="line.1183"></a>
<span class="sourceLineNo">1184</span>    /**<a name="line.1184"></a>
<span class="sourceLineNo">1185</span>     * &lt;div class="zh"&gt; 获取外置密码键盘的SN。支持{@link EPedType#EXTERNAL_TYPEA},{@link EPedType#EXTERNAL_TYPEC} 类型。&lt;/div&gt;<a name="line.1185"></a>
<span class="sourceLineNo">1186</span>     * &lt;div class="en"&gt; get External Ped Serial Number. {@link EPedType#EXTERNAL_TYPEA},{@link EPedType#EXTERNAL_TYPEC} is supported.&lt;/div&gt;<a name="line.1186"></a>
<span class="sourceLineNo">1187</span>     *<a name="line.1187"></a>
<span class="sourceLineNo">1188</span>     * @return &lt;div class="zh"&gt; 序列号 &lt;/div&gt; &lt;div class="en"&gt; serial number &lt;/div&gt;<a name="line.1188"></a>
<span class="sourceLineNo">1189</span>     *<a name="line.1189"></a>
<span class="sourceLineNo">1190</span>     * @throws PedDevException<a name="line.1190"></a>
<span class="sourceLineNo">1191</span>     */<a name="line.1191"></a>
<span class="sourceLineNo">1192</span>    public String getSN() throws PedDevException;<a name="line.1192"></a>
<span class="sourceLineNo">1193</span><a name="line.1193"></a>
<span class="sourceLineNo">1194</span>    /**<a name="line.1194"></a>
<span class="sourceLineNo">1195</span>     * &lt;div class="zh"&gt; 设置输入框密码的显隐 （*） 和提示信息。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt; &lt;div class="en"&gt; Show Password * at Keyboard Page when input Pin and<a name="line.1195"></a>
<span class="sourceLineNo">1196</span>     * Set reminder text when input Pin. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1196"></a>
<span class="sourceLineNo">1197</span>     *<a name="line.1197"></a>
<span class="sourceLineNo">1198</span>     * @param flag<a name="line.1198"></a>
<span class="sourceLineNo">1199</span>     *            &lt;div class="zh"&gt; 控制输入框的显隐 ,true:显示 false:隐藏&lt;/div&gt; &lt;div class="en"&gt; display password with * at Keyboard<a name="line.1199"></a>
<span class="sourceLineNo">1200</span>     *            Page when input pin,true:shows false:hidden &lt;/div&gt;<a name="line.1200"></a>
<span class="sourceLineNo">1201</span>     *<a name="line.1201"></a>
<span class="sourceLineNo">1202</span>     * @param title<a name="line.1202"></a>
<span class="sourceLineNo">1203</span>     *            &lt;div class="zh"&gt; 要显示的提示字符串 &lt;/div&gt; &lt;div class="en"&gt; reminder text when input Pin &lt;/div&gt;<a name="line.1203"></a>
<span class="sourceLineNo">1204</span>     *<a name="line.1204"></a>
<span class="sourceLineNo">1205</span>     * @throws PedDevException<a name="line.1205"></a>
<span class="sourceLineNo">1206</span>     */<a name="line.1206"></a>
<span class="sourceLineNo">1207</span>    public void showInputBox(boolean flag, String title) throws PedDevException;<a name="line.1207"></a>
<span class="sourceLineNo">1208</span><a name="line.1208"></a>
<span class="sourceLineNo">1209</span>    /**<a name="line.1209"></a>
<span class="sourceLineNo">1210</span>     * &lt;div class="zh"&gt; 生成一组 SM2 密钥对。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.1210"></a>
<span class="sourceLineNo">1211</span>     * &lt;div class="en"&gt; Generate one SM2 key-pair.{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported. &lt;/div&gt;<a name="line.1211"></a>
<span class="sourceLineNo">1212</span>     *<a name="line.1212"></a>
<span class="sourceLineNo">1213</span>     * @param keyLenBit<a name="line.1213"></a>
<span class="sourceLineNo">1214</span>     *            &lt;div class="zh"&gt; 私钥位数，支持256bit &lt;/div&gt; &lt;div class="en"&gt; bits of private key, only support 256 bits.<a name="line.1214"></a>
<span class="sourceLineNo">1215</span>     *            &lt;/div&gt;<a name="line.1215"></a>
<span class="sourceLineNo">1216</span>     *<a name="line.1216"></a>
<span class="sourceLineNo">1217</span>     * @return {@link SM2KeyPair}<a name="line.1217"></a>
<span class="sourceLineNo">1218</span>     * @throws PedDevException<a name="line.1218"></a>
<span class="sourceLineNo">1219</span>     */<a name="line.1219"></a>
<span class="sourceLineNo">1220</span>    public SM2KeyPair genSM2KeyPair(int keyLenBit) throws PedDevException;<a name="line.1220"></a>
<span class="sourceLineNo">1221</span><a name="line.1221"></a>
<span class="sourceLineNo">1222</span>    /**<a name="line.1222"></a>
<span class="sourceLineNo">1223</span>     * &lt;div class="zh"&gt; 注入 SM2 密钥 。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt; To write SM2 cipher key to PED. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1223"></a>
<span class="sourceLineNo">1224</span>     *<a name="line.1224"></a>
<span class="sourceLineNo">1225</span>     * @param srcKeyType<a name="line.1225"></a>
<span class="sourceLineNo">1226</span>     *            {@link EPedKeyType} &lt;div class="zh"&gt; 发散SM2秘钥（公/私钥）的源秘钥的类型，可以是PED_SM4_TMK。 &lt;/div&gt; &lt;div class="en"&gt; Type<a name="line.1226"></a>
<span class="sourceLineNo">1227</span>     *            of the source key to diversify SM2 key(private/public key),Could be PED_SM4_TMK key. &lt;/div&gt;<a name="line.1227"></a>
<span class="sourceLineNo">1228</span>     *<a name="line.1228"></a>
<span class="sourceLineNo">1229</span>     * @param srcKeyIdx<a name="line.1229"></a>
<span class="sourceLineNo">1230</span>     *            &lt;div class="zh"&gt; 发散SM2秘钥（公/私钥）的源秘钥的索引 &lt;/div&gt; &lt;div class="en"&gt; Index of the source key to diversify SM2<a name="line.1230"></a>
<span class="sourceLineNo">1231</span>     *            key(private/public key) &lt;/div&gt;<a name="line.1231"></a>
<span class="sourceLineNo">1232</span>     *<a name="line.1232"></a>
<span class="sourceLineNo">1233</span>     * @param dstKeyType<a name="line.1233"></a>
<span class="sourceLineNo">1234</span>     *            {@link EPedKeyType} &lt;div class="zh"&gt; 目标密钥的类型，可以是PED_SM2_PVT_KEY或者PED_SM2_PUB_KEY。 &lt;/div&gt; &lt;div<a name="line.1234"></a>
<span class="sourceLineNo">1235</span>     *            class="en"&gt; Type of the destination key, Could be PED_SM2_PVT_KEY or PED_SM2_PUB_KEY. &lt;/div&gt;<a name="line.1235"></a>
<span class="sourceLineNo">1236</span>     *<a name="line.1236"></a>
<span class="sourceLineNo">1237</span>     * @param dstKeyIdx<a name="line.1237"></a>
<span class="sourceLineNo">1238</span>     *            &lt;div class="zh"&gt; 目标密钥对额索引 &lt;/div&gt; &lt;div class="en"&gt; Index of the destination key. &lt;/div&gt;<a name="line.1238"></a>
<span class="sourceLineNo">1239</span>     *<a name="line.1239"></a>
<span class="sourceLineNo">1240</span>     * @param keyValue<a name="line.1240"></a>
<span class="sourceLineNo">1241</span>     *            &lt;div class="zh"&gt; SM2公私钥的数据 &lt;/div&gt; &lt;div class="en"&gt; SM2 private/public key data. &lt;/div&gt;<a name="line.1241"></a>
<span class="sourceLineNo">1242</span>     *<a name="line.1242"></a>
<span class="sourceLineNo">1243</span>     * @throws PedDevException<a name="line.1243"></a>
<span class="sourceLineNo">1244</span>     */<a name="line.1244"></a>
<span class="sourceLineNo">1245</span>    public void writeSM2CipherKey(EPedKeyType srcKeyType, byte srcKeyIdx, EPedKeyType dstKeyType, byte dstKeyIdx,<a name="line.1245"></a>
<span class="sourceLineNo">1246</span>            byte[] keyValue) throws PedDevException;<a name="line.1246"></a>
<span class="sourceLineNo">1247</span><a name="line.1247"></a>
<span class="sourceLineNo">1248</span>    /**<a name="line.1248"></a>
<span class="sourceLineNo">1249</span>     * &lt;div class="zh"&gt; 往PED中写入SM2密钥。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.1249"></a>
<span class="sourceLineNo">1250</span>     * &lt;div class="en"&gt; To write SM2 key to PED. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.1250"></a>
<span class="sourceLineNo">1251</span>     *<a name="line.1251"></a>
<span class="sourceLineNo">1252</span>     * @param keyIdx<a name="line.1252"></a>
<span class="sourceLineNo">1253</span>     *            &lt;div class="zh"&gt; SM2 密钥索引[1~20] &lt;/div&gt; &lt;div class="en"&gt; SM2 key index: 1~20 &lt;/div&gt;<a name="line.1253"></a>
<span class="sourceLineNo">1254</span>     *<a name="line.1254"></a>
<span class="sourceLineNo">1255</span>     * @param keyType<a name="line.1255"></a>
<span class="sourceLineNo">1256</span>     *            &lt;div class="zh"&gt; SM2_PVT_KEY：私钥 SM2_PUB_KEY：公钥 &lt;/div&gt; &lt;div class="en"&gt; private key: SM2_PVT_KEY public<a name="line.1256"></a>
<span class="sourceLineNo">1257</span>     *            key:SM2_PUB_KEY &lt;/div&gt;<a name="line.1257"></a>
<span class="sourceLineNo">1258</span>     *<a name="line.1258"></a>
<span class="sourceLineNo">1259</span>     * @param keyValue<a name="line.1259"></a>
<span class="sourceLineNo">1260</span>     *            &lt;div class="zh"&gt; 私钥, KeyValue 长度是 32 bytes 公钥, KeyValue 长度是 64 bytes &lt;/div&gt; &lt;div class="en"&gt; private<a name="line.1260"></a>
<span class="sourceLineNo">1261</span>     *            key data: 32 bytes public key data: 64 bytes &lt;/div&gt;<a name="line.1261"></a>
<span class="sourceLineNo">1262</span>     *<a name="line.1262"></a>
<span class="sourceLineNo">1263</span>     * @throws PedDevException<a name="line.1263"></a>
<span class="sourceLineNo">1264</span>     */<a name="line.1264"></a>
<span class="sourceLineNo">1265</span>    public void writeSM2Key(byte keyIdx, EPedKeyType keyType, byte[] keyValue) throws PedDevException;<a name="line.1265"></a>
<span class="sourceLineNo">1266</span><a name="line.1266"></a>
<span class="sourceLineNo">1267</span>    /**<a name="line.1267"></a>
<span class="sourceLineNo">1268</span>     * &lt;div class="zh"&gt; 使用 SM2 公钥加密数据或私钥解密数据 。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。&lt;/div&gt; &lt;div class="en"&gt; Use SM2 public key to encrypt data, or SM2 private<a name="line.1268"></a>
<span class="sourceLineNo">1269</span>     * key to decrypt data. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.1269"></a>
<span class="sourceLineNo">1270</span>     *<a name="line.1270"></a>
<span class="sourceLineNo">1271</span>     * @param keyIdx<a name="line.1271"></a>
<span class="sourceLineNo">1272</span>     *            &lt;div class="zh"&gt; SM2 密钥索引[1~20] &lt;/div&gt; &lt;div class="en"&gt; SM2 key index: 1~20 &lt;/div&gt;<a name="line.1272"></a>
<span class="sourceLineNo">1273</span>     *<a name="line.1273"></a>
<span class="sourceLineNo">1274</span>     * @param input<a name="line.1274"></a>
<span class="sourceLineNo">1275</span>     *            &lt;div class="zh"&gt; 待加密或解密的数据。加密：最大长度(1024-96)字节； 解密：最大长度1024字节。 &lt;/div&gt; &lt;div class="en"&gt; Input data to be<a name="line.1275"></a>
<span class="sourceLineNo">1276</span>     *            encrypted or decrypted. Encrypt: max length is (1024-96) bytes. Decrypt: max length is 1024 bytes.<a name="line.1276"></a>
<span class="sourceLineNo">1277</span>     *            &lt;/div&gt;<a name="line.1277"></a>
<span class="sourceLineNo">1278</span>     *<a name="line.1278"></a>
<span class="sourceLineNo">1279</span>     * @param operation<a name="line.1279"></a>
<span class="sourceLineNo">1280</span>     *            {@link ECryptOperate}<a name="line.1280"></a>
<span class="sourceLineNo">1281</span>     * @return &lt;div class="zh"&gt; 加密或解密后的数据 &lt;/div&gt; &lt;div class="en"&gt; data that after encryption or decryption &lt;/div&gt;<a name="line.1281"></a>
<span class="sourceLineNo">1282</span>     *<a name="line.1282"></a>
<span class="sourceLineNo">1283</span>     * @throws PedDevException<a name="line.1283"></a>
<span class="sourceLineNo">1284</span>     */<a name="line.1284"></a>
<span class="sourceLineNo">1285</span>    public byte[] SM2Recover(byte keyIdx, byte[] input, ECryptOperate operation) throws PedDevException;<a name="line.1285"></a>
<span class="sourceLineNo">1286</span><a name="line.1286"></a>
<span class="sourceLineNo">1287</span>    /**<a name="line.1287"></a>
<span class="sourceLineNo">1288</span>     * &lt;div class="zh"&gt; 使用 SM2 算法获得签名信息 。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。&lt;/div&gt;<a name="line.1288"></a>
<span class="sourceLineNo">1289</span>     * &lt;div class="en"&gt; Use SM2 algorithm to calculate the signature data. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.<a name="line.1289"></a>
<span class="sourceLineNo">1290</span>     * &lt;/div&gt;<a name="line.1290"></a>
<span class="sourceLineNo">1291</span>     *<a name="line.1291"></a>
<span class="sourceLineNo">1292</span>     * @param pubKeyIdx<a name="line.1292"></a>
<span class="sourceLineNo">1293</span>     *            &lt;div class="zh"&gt; SM2 公钥索引[1~20] &lt;/div&gt; &lt;div class="en"&gt; SM2 public key index: 1~20 &lt;/div&gt;<a name="line.1293"></a>
<span class="sourceLineNo">1294</span>     *<a name="line.1294"></a>
<span class="sourceLineNo">1295</span>     * @param pvtKeyIdx<a name="line.1295"></a>
<span class="sourceLineNo">1296</span>     *            &lt;div class="zh"&gt; SM2 私钥索引[1~20] &lt;/div&gt; &lt;div class="en"&gt; SM2 private key index: 1~20 &lt;/div&gt;<a name="line.1296"></a>
<span class="sourceLineNo">1297</span>     *<a name="line.1297"></a>
<span class="sourceLineNo">1298</span>     * @param uid<a name="line.1298"></a>
<span class="sourceLineNo">1299</span>     *            &lt;div class="zh"&gt; 签名者 ID 无特殊约定的情况下，用户身份的标识 ID 的长度为 16 字节，其默认值为 0x31, 0x32, 0x33, 0x34, 0x35, 0x36,<a name="line.1299"></a>
<span class="sourceLineNo">1300</span>     *            0x37, 0x38, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38。 &lt;/div&gt; &lt;div class="en"&gt; Signer ID, max<a name="line.1300"></a>
<span class="sourceLineNo">1301</span>     *            length is 512 bytes, and default value is {0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,<a name="line.1301"></a>
<span class="sourceLineNo">1302</span>     *            0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38} &lt;/div&gt;<a name="line.1302"></a>
<span class="sourceLineNo">1303</span>     *<a name="line.1303"></a>
<span class="sourceLineNo">1304</span>     * @param input<a name="line.1304"></a>
<span class="sourceLineNo">1305</span>     *            &lt;div class="zh"&gt; 待签名数据，最大长度1024字节 &lt;/div&gt; &lt;div class="en"&gt; Input data, and max length is 1024 bytes.<a name="line.1305"></a>
<span class="sourceLineNo">1306</span>     *            &lt;/div&gt;<a name="line.1306"></a>
<span class="sourceLineNo">1307</span>     *<a name="line.1307"></a>
<span class="sourceLineNo">1308</span>     * @return &lt;div class="zh"&gt; 64 字节的签名值 &lt;/div&gt; &lt;div class="en"&gt; 64 bytes signature data. &lt;/div&gt;<a name="line.1308"></a>
<span class="sourceLineNo">1309</span>     *<a name="line.1309"></a>
<span class="sourceLineNo">1310</span>     * @throws PedDevException<a name="line.1310"></a>
<span class="sourceLineNo">1311</span>     */<a name="line.1311"></a>
<span class="sourceLineNo">1312</span>    public byte[] SM2Sign(byte pubKeyIdx, byte pvtKeyIdx, byte[] uid, byte[] input) throws PedDevException;<a name="line.1312"></a>
<span class="sourceLineNo">1313</span><a name="line.1313"></a>
<span class="sourceLineNo">1314</span>    /**<a name="line.1314"></a>
<span class="sourceLineNo">1315</span>     * &lt;div class="zh"&gt; 使用 SM2 公钥验证签名。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.1315"></a>
<span class="sourceLineNo">1316</span>     * &lt;div class="en"&gt; Use SM2 algorithm to verify the signature data. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.1316"></a>
<span class="sourceLineNo">1317</span>     *<a name="line.1317"></a>
<span class="sourceLineNo">1318</span>     * @param pubKeyIdx<a name="line.1318"></a>
<span class="sourceLineNo">1319</span>     *            &lt;div class="zh"&gt; SM2 公钥索引[1~20] &lt;/div&gt; &lt;div class="en"&gt; SM2 public key index: 1~20 &lt;/div&gt;<a name="line.1319"></a>
<span class="sourceLineNo">1320</span>     * @param uid<a name="line.1320"></a>
<span class="sourceLineNo">1321</span>     *            &lt;div class="zh"&gt; 签名者 ID,最大长度为512字节,无特殊约定的情况下，用户身份的标识 ID 的 长度为 16 字节，其默认值为 0x31, 0x32, 0x33, 0x34,<a name="line.1321"></a>
<span class="sourceLineNo">1322</span>     *            0x35, 0x36, 0x37, 0x38, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38。 &lt;/div&gt; &lt;div class="en"&gt; Signer<a name="line.1322"></a>
<span class="sourceLineNo">1323</span>     *            ID , maximum length is 512 bytes, max length is 512 bytes, and default value is<a name="line.1323"></a>
<span class="sourceLineNo">1324</span>     *            {0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38, 0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38} &lt;/div&gt;<a name="line.1324"></a>
<span class="sourceLineNo">1325</span>     * @param input<a name="line.1325"></a>
<span class="sourceLineNo">1326</span>     *            &lt;div class="zh"&gt; 被签名数据 &lt;/div&gt; &lt;div class="en"&gt; Input data, and max length is 1024 bytes. &lt;/div&gt;<a name="line.1326"></a>
<span class="sourceLineNo">1327</span>     * @param signature<a name="line.1327"></a>
<span class="sourceLineNo">1328</span>     *            &lt;div class="zh"&gt; 64 字节的签名值 &lt;/div&gt; &lt;div class="en"&gt; 64 bytes signature data. &lt;/div&gt;<a name="line.1328"></a>
<span class="sourceLineNo">1329</span>     * @throws PedDevException<a name="line.1329"></a>
<span class="sourceLineNo">1330</span>     */<a name="line.1330"></a>
<span class="sourceLineNo">1331</span>    public void SM2Verify(byte pubKeyIdx, byte[] uid, byte[] input, byte[] signature) throws PedDevException;<a name="line.1331"></a>
<span class="sourceLineNo">1332</span><a name="line.1332"></a>
<span class="sourceLineNo">1333</span>    /**<a name="line.1333"></a>
<span class="sourceLineNo">1334</span>     * &lt;div class="zh"&gt; 使用 SM3 算法计算哈希值。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.1334"></a>
<span class="sourceLineNo">1335</span>     * &lt;div class="en"&gt; Use SM3 algorithm to calculate Hash. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.1335"></a>
<span class="sourceLineNo">1336</span>     *<a name="line.1336"></a>
<span class="sourceLineNo">1337</span>     * @param input<a name="line.1337"></a>
<span class="sourceLineNo">1338</span>     *            &lt;div class="zh"&gt; 输入数据 &lt;/div&gt; &lt;div class="en"&gt; Input data. &lt;/div&gt;<a name="line.1338"></a>
<span class="sourceLineNo">1339</span>     * @param mode<a name="line.1339"></a>
<span class="sourceLineNo">1340</span>     *            &lt;div class="zh"&gt; 目前支持 0x00,其它值保留 &lt;/div&gt; &lt;div class="en"&gt; Only support 0x00. &lt;/div&gt;<a name="line.1340"></a>
<span class="sourceLineNo">1341</span>     * @return &lt;div class="zh"&gt; 32 字节哈希值 &lt;/div&gt; &lt;div class="en"&gt; Hash, 32 bytes. &lt;/div&gt;<a name="line.1341"></a>
<span class="sourceLineNo">1342</span>     * @throws PedDevException<a name="line.1342"></a>
<span class="sourceLineNo">1343</span>     */<a name="line.1343"></a>
<span class="sourceLineNo">1344</span>    public byte[] SM3(byte[] input, byte mode) throws PedDevException;// 目前mode均为0；<a name="line.1344"></a>
<span class="sourceLineNo">1345</span><a name="line.1345"></a>
<span class="sourceLineNo">1346</span>    /**<a name="line.1346"></a>
<span class="sourceLineNo">1347</span>     * &lt;div class="zh"&gt; 使用 SM4 算法加密或解密数据 。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。&lt;/div&gt;<a name="line.1347"></a>
<span class="sourceLineNo">1348</span>     * &lt;div class="en"&gt; Use SM4 algorithm to encrypt or decrypt. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.1348"></a>
<span class="sourceLineNo">1349</span>     *<a name="line.1349"></a>
<span class="sourceLineNo">1350</span>     * @param keyIdx<a name="line.1350"></a>
<span class="sourceLineNo">1351</span>     *            &lt;div class="zh"&gt; SM4_TDK 的索引[1～100] &lt;/div&gt; &lt;div class="en"&gt; SM4_TDK index: 1~100 &lt;/div&gt;<a name="line.1351"></a>
<span class="sourceLineNo">1352</span>     *<a name="line.1352"></a>
<span class="sourceLineNo">1353</span>     * @param initVector<a name="line.1353"></a>
<span class="sourceLineNo">1354</span>     *            &lt;div class="zh"&gt;CBC mode:16 字节初始化向量； 对于 ECB 模式该域为 NULL。 &lt;/div&gt; &lt;div class="en"&gt; ECB mode: init vector<a name="line.1354"></a>
<span class="sourceLineNo">1355</span>     *            is null CBC mode: init vector, 16 bytes. &lt;/div&gt;<a name="line.1355"></a>
<span class="sourceLineNo">1356</span>     * @param input<a name="line.1356"></a>
<span class="sourceLineNo">1357</span>     *            &lt;div class="zh"&gt; 待加密或解密的数据.最大长度为8K，并且为16倍数。 &lt;/div&gt; &lt;div class="en"&gt; Input data to be encrypted or<a name="line.1357"></a>
<span class="sourceLineNo">1358</span>     *            decrypted. Maximum length is 8K, and that is a multiple of 16. &lt;/div&gt;<a name="line.1358"></a>
<span class="sourceLineNo">1359</span>     * @param operation<a name="line.1359"></a>
<span class="sourceLineNo">1360</span>     *            &lt;ul&gt;<a name="line.1360"></a>
<span class="sourceLineNo">1361</span>     *            &lt;li&gt;{@link ECryptOperate#ENCRYPT}&lt;/li&gt;<a name="line.1361"></a>
<span class="sourceLineNo">1362</span>     *            &lt;li&gt;{@link ECryptOperate#DECRYPT}&lt;/li&gt;<a name="line.1362"></a>
<span class="sourceLineNo">1363</span>     *            &lt;/ul&gt;<a name="line.1363"></a>
<span class="sourceLineNo">1364</span>     * @param option<a name="line.1364"></a>
<span class="sourceLineNo">1365</span>     *            &lt;ul&gt;<a name="line.1365"></a>
<span class="sourceLineNo">1366</span>     *            &lt;li&gt;{@link ECryptOpt#ECB}&lt;/li&gt;<a name="line.1366"></a>
<span class="sourceLineNo">1367</span>     *            &lt;li&gt;{@link ECryptOpt#CBC}&lt;/li&gt;<a name="line.1367"></a>
<span class="sourceLineNo">1368</span>     *            &lt;/ul&gt;<a name="line.1368"></a>
<span class="sourceLineNo">1369</span>     *<a name="line.1369"></a>
<span class="sourceLineNo">1370</span>     * @return &lt;div class="zh"&gt; 加密或解密后的数据 &lt;/div&gt; &lt;div class="en"&gt; data that after encryption or decryption &lt;/div&gt;<a name="line.1370"></a>
<span class="sourceLineNo">1371</span>     * @throws PedDevException<a name="line.1371"></a>
<span class="sourceLineNo">1372</span>     */<a name="line.1372"></a>
<span class="sourceLineNo">1373</span>    public byte[] SM4(byte keyIdx, byte[] initVector, byte[] input, ECryptOperate operation, ECryptOpt option)<a name="line.1373"></a>
<span class="sourceLineNo">1374</span>            throws PedDevException;<a name="line.1374"></a>
<span class="sourceLineNo">1375</span><a name="line.1375"></a>
<span class="sourceLineNo">1376</span>    /**<a name="line.1376"></a>
<span class="sourceLineNo">1377</span>     * &lt;div class="zh"&gt; 使用 SM4 算法计算 MAC。 支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。&lt;/div&gt;<a name="line.1377"></a>
<span class="sourceLineNo">1378</span>     * &lt;div class="en"&gt; Use SM4 algorithm to calculate MAC. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.1378"></a>
<span class="sourceLineNo">1379</span>     *<a name="line.1379"></a>
<span class="sourceLineNo">1380</span>     * @param keyIdx<a name="line.1380"></a>
<span class="sourceLineNo">1381</span>     *            &lt;div class="zh"&gt; SM4_TAK 的密钥索引[1～100] &lt;/div&gt; &lt;div class="en"&gt; SM4_TAK index: 1~100 &lt;/div&gt;<a name="line.1381"></a>
<span class="sourceLineNo">1382</span>     * @param initVector<a name="line.1382"></a>
<span class="sourceLineNo">1383</span>     *            &lt;div class="zh"&gt; 16 字节初始化向量 &lt;/div&gt; &lt;div class="en"&gt; init vector, 16 bytes &lt;/div&gt;<a name="line.1383"></a>
<span class="sourceLineNo">1384</span>     * @param input<a name="line.1384"></a>
<span class="sourceLineNo">1385</span>     *            &lt;div class="zh"&gt; 待计算 MAC 的数据<a name="line.1385"></a>
<span class="sourceLineNo">1386</span>     *            &lt;br/&gt;Mode为0时,支持8K,16的倍数<a name="line.1386"></a>
<span class="sourceLineNo">1387</span>     *            &lt;br/&gt;Mode为1时,支持1024,16的倍数&lt;/div&gt;<a name="line.1387"></a>
<span class="sourceLineNo">1388</span>     *            &lt;div class="en"&gt; Input data.<a name="line.1388"></a>
<span class="sourceLineNo">1389</span>     *            &lt;br/&gt;Mode = 0: support 8K, multiples of 16.<a name="line.1389"></a>
<span class="sourceLineNo">1390</span>     *            &lt;br/&gt;Mode = 1: support 1024, multiples of 16.&lt;/div&gt;<a name="line.1390"></a>
<span class="sourceLineNo">1391</span>     * @param mode<a name="line.1391"></a>
<span class="sourceLineNo">1392</span>     *            &lt;div class="zh"&gt; 0x00: 使用 SM4 CBC 算法计算 MAC 值，首先 将初始向量与 BLOCK1 进行异或，并用 SM4 算法使用 TAK 对异或的结果进行加密，然后<a name="line.1392"></a>
<span class="sourceLineNo">1393</span>     *            获得的密文与 BLOCK2 异或，用 SM4 算法使 用 TAK 对结果加密，按顺序给出 16 字节的 加密结果。MacOut 为 16 字节。 0x01: SM3 Hash Mac，MacOut 为<a name="line.1393"></a>
<span class="sourceLineNo">1394</span>     *            32 字节。 &lt;/div&gt; &lt;div class="en"&gt; 0x00: use SM4 CBC algorithm, and MAC has 16 bytes. 0x01: use SM3<a name="line.1394"></a>
<span class="sourceLineNo">1395</span>     *            algorithm, and MAC has 32 bytes. &lt;/div&gt;<a name="line.1395"></a>
<span class="sourceLineNo">1396</span>     * @return MAC<a name="line.1396"></a>
<span class="sourceLineNo">1397</span>     * @throws PedDevException<a name="line.1397"></a>
<span class="sourceLineNo">1398</span>     */<a name="line.1398"></a>
<span class="sourceLineNo">1399</span>    public byte[] getMacSM(byte keyIdx, byte[] initVector, byte[] input, byte mode) throws PedDevException;// 当mode选择0x01时，参数initVector没用到可以为null.<a name="line.1399"></a>
<span class="sourceLineNo">1400</span><a name="line.1400"></a>
<span class="sourceLineNo">1401</span>    /**<a name="line.1401"></a>
<span class="sourceLineNo">1402</span>     * &lt;div class="zh"&gt; 指定的时限内,扫描键盘上输入的 PIN 并输出采用 SM4 算法生成的 PIN BLOCK 加密数据块。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt; &lt;div class="en"&gt; Scan the keyboard<a name="line.1402"></a>
<span class="sourceLineNo">1403</span>     * PIN entry and output the PIN BLOCK using SM4_TPK. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.&lt;/div&gt;<a name="line.1403"></a>
<span class="sourceLineNo">1404</span>     *<a name="line.1404"></a>
<span class="sourceLineNo">1405</span>     * @param keyIndex<a name="line.1405"></a>
<span class="sourceLineNo">1406</span>     *            &lt;div class="zh"&gt; [1～100] SM4_TPK 的索引 &lt;/div&gt; &lt;div class="en"&gt; [1~100] SM4_TPK index &lt;/div&gt;<a name="line.1406"></a>
<span class="sourceLineNo">1407</span>     *<a name="line.1407"></a>
<span class="sourceLineNo">1408</span>     * @param expPinLen<a name="line.1408"></a>
<span class="sourceLineNo">1409</span>     *            &lt;div class="zh"&gt; &lt;p&gt;当IPed为{@link EPedType#INTERNAL}:0~12的枚举集合<a name="line.1409"></a>
<span class="sourceLineNo">1410</span>     *            可输入的合法密码长度字符串，应用程序把允许的密码长度全部枚举出来，并且用"，"号隔开每个长度，如允许输入4、6位密码并且允许无密码直接按确认，则该字符串应该设置为"0,4,6"。<a name="line.1410"></a>
<span class="sourceLineNo">1411</span>     *            若枚举0长度则示意可以不输任何数字而直接按确认键返回。&lt;/p&gt; &lt;p&gt;当IPed为{@link EPedType#EXTERNAL_TYPEA}:PIN长度在expPinLen中的最小值和最大值区间。如果mode = EPinBlockMode.ISO9564_0时,当最小长度不为0时,允许按"确认"退出 。&lt;/p&gt; &lt;/div&gt;<a name="line.1411"></a>
<span class="sourceLineNo">1412</span>     *            &lt;div class="en"&gt;&lt;p&gt;When IPed is {@link EPedType#INTERNAL}:Enumeration of 0-12.The enter password string with legal length. Application enumerates of all possible lengths of PIN. ","will be used to separate each<a name="line.1412"></a>
<span class="sourceLineNo">1413</span>     *            number of length. If no PIN,or 4 or 6 digits of PIN are allowed, the string will be set as "0,4,6". 0 means that no PIN is required, and pressing "Enter" will return.&lt;p&gt;<a name="line.1413"></a>
<span class="sourceLineNo">1414</span>     *            &lt;p&gt;When IPed is {@link EPedType#EXTERNAL_TYPEA}:The PIN length is between the minimum and maximum values in expPinLen. If mode = EPinBlockMode.ISO9564_0, press "ok" to exit when the minimum length is not 0.&lt;/p&gt; &lt;/div&gt;<a name="line.1414"></a>
<span class="sourceLineNo">1415</span>     * @param dataIn<a name="line.1415"></a>
<span class="sourceLineNo">1416</span>     *            &lt;div class="zh"&gt; DataIn 域共占用 16 字节空间，用于存放卡号 移位后生成的 16 位主账号。 当 Mode=0x00 时,DataIn 指向卡号移位后生 成的 16 位主帐号。<a name="line.1416"></a>
<span class="sourceLineNo">1417</span>     *            &lt;/div&gt; &lt;div class="en"&gt; If Mode=0x00, DataIn is the 16 bytes PAN after shifting. &lt;/div&gt;<a name="line.1417"></a>
<span class="sourceLineNo">1418</span>     * @param mode<a name="line.1418"></a>
<span class="sourceLineNo">1419</span>     *            {@link EPinBlockMode} &lt;div class="zh"&gt; 选择 PIN BLOCK 的格式, ISO9564 格式 0 &lt;/div&gt; &lt;div class="en"&gt; PIN<a name="line.1419"></a>
<span class="sourceLineNo">1420</span>     *            BLOCK format ISO9564 format 0 &lt;/div&gt;<a name="line.1420"></a>
<span class="sourceLineNo">1421</span>     *<a name="line.1421"></a>
<span class="sourceLineNo">1422</span>     * @param timeoutMs<a name="line.1422"></a>
<span class="sourceLineNo">1423</span>     *            &lt;div class="zh"&gt; 输入 PIN 的超时时间,单位：毫秒 最大值为 300000ms 0:表示没有超时时间，PED 不做超时控制。 &lt;/div&gt; &lt;div class="en"&gt; The<a name="line.1423"></a>
<span class="sourceLineNo">1424</span>     *            timeout of PIN entry [ms, Input] Maximum is 300000Ms. &lt;/div&gt;<a name="line.1424"></a>
<span class="sourceLineNo">1425</span>     *<a name="line.1425"></a>
<span class="sourceLineNo">1426</span>     * @return &lt;div class="zh"&gt; 16bytes 生成的密文 PINBlock &lt;/div&gt; &lt;div class="en"&gt; 16bytes PINBlock &lt;/div&gt;<a name="line.1426"></a>
<span class="sourceLineNo">1427</span>     * @throws PedDevException<a name="line.1427"></a>
<span class="sourceLineNo">1428</span>     */<a name="line.1428"></a>
<span class="sourceLineNo">1429</span>    public byte[] getPinBlockSM4(byte keyIndex, String expPinLen, byte[] dataIn, EPinBlockMode mode/* MODE仅为0 */,<a name="line.1429"></a>
<span class="sourceLineNo">1430</span>            int timeoutMs) throws PedDevException;<a name="line.1430"></a>
<span class="sourceLineNo">1431</span><a name="line.1431"></a>
<span class="sourceLineNo">1432</span>    /**<a name="line.1432"></a>
<span class="sourceLineNo">1433</span>     * &lt;div class="zh"&gt; PedGetPinBlock 时取消输入。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA},{@link EPedType#EXTERNAL_TYPEC} 类型。 &lt;/div&gt;<a name="line.1433"></a>
<span class="sourceLineNo">1434</span>     * &lt;div class="en"&gt; Cancel input when PedGetPinBlock. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA},{@link EPedType#EXTERNAL_TYPEC} is supported.&lt;/div&gt;<a name="line.1434"></a>
<span class="sourceLineNo">1435</span>     *<a name="line.1435"></a>
<span class="sourceLineNo">1436</span>     * @throws PedDevException<a name="line.1436"></a>
<span class="sourceLineNo">1437</span>     */<a name="line.1437"></a>
<span class="sourceLineNo">1438</span>    public void cancelInput() throws PedDevException;<a name="line.1438"></a>
<span class="sourceLineNo">1439</span><a name="line.1439"></a>
<span class="sourceLineNo">1440</span>    /**<a name="line.1440"></a>
<span class="sourceLineNo">1441</span>     * &lt;div class="zh"&gt; 输入Pin时设置总额。 仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.1441"></a>
<span class="sourceLineNo">1442</span>     * &lt;div class="en"&gt; Set amount Text when Input Pin. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1442"></a>
<span class="sourceLineNo">1443</span>     *<a name="line.1443"></a>
<span class="sourceLineNo">1444</span>     * @param amount<a name="line.1444"></a>
<span class="sourceLineNo">1445</span>     *            &lt;div class="zh"&gt; 总额 &lt;/div&gt; &lt;div class="en"&gt; consumption amount need be shown &lt;/div&gt;<a name="line.1445"></a>
<span class="sourceLineNo">1446</span>     * @throws PedDevException<a name="line.1446"></a>
<span class="sourceLineNo">1447</span>     */<a name="line.1447"></a>
<span class="sourceLineNo">1448</span>    public void setAmount(String amount) throws PedDevException;<a name="line.1448"></a>
<span class="sourceLineNo">1449</span><a name="line.1449"></a>
<span class="sourceLineNo">1450</span>    /**<a name="line.1450"></a>
<span class="sourceLineNo">1451</span>     * &lt;div class="zh"&gt; 使用Idkey对机器序列号等身份信息进行加密运算 。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.1451"></a>
<span class="sourceLineNo">1452</span>     * &lt;div class="en"&gt; Use IdKey encrypt Identity information. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1452"></a>
<span class="sourceLineNo">1453</span>     *<a name="line.1453"></a>
<span class="sourceLineNo">1454</span>     * @param keyId<a name="line.1454"></a>
<span class="sourceLineNo">1455</span>     *            &lt;div class="zh"&gt; 1 (目前只支持索引1) &lt;/div&gt; &lt;div class="en"&gt; 1(only support 1 now) &lt;/div&gt;<a name="line.1455"></a>
<span class="sourceLineNo">1456</span>     * @param initvector<a name="line.1456"></a>
<span class="sourceLineNo">1457</span>     *            &lt;div class="zh"&gt; ECB 模式: 初始向量为 null ; CBC 模式: 初始向量, 16 字节.&lt;/div&gt; &lt;div class="en"&gt; ECB mode: init<a name="line.1457"></a>
<span class="sourceLineNo">1458</span>     *            vector is null; CBC mode: init vector, 16 bytes. &lt;/div&gt;<a name="line.1458"></a>
<span class="sourceLineNo">1459</span>     * @param dataIn<a name="line.1459"></a>
<span class="sourceLineNo">1460</span>     *            &lt;div class="zh"&gt; 输入数据进行加密或解密。 最大长度为1024，16的倍数。 &lt;/div&gt; &lt;div class="en"&gt;To encrypt or decrypt incoming<a name="line.1460"></a>
<span class="sourceLineNo">1461</span>     *            data. A maximum length of 1024, a multiple of 16.&lt;/div&gt;<a name="line.1461"></a>
<span class="sourceLineNo">1462</span>     * @param mode<a name="line.1462"></a>
<span class="sourceLineNo">1463</span>     *            {@link EIdKeycCalcMode}<a name="line.1463"></a>
<span class="sourceLineNo">1464</span>     * @return &lt;div class="zh"&gt; 加密的数据 &lt;/div&gt; &lt;div class="en"&gt;Encrypt Result &lt;/div&gt;<a name="line.1464"></a>
<span class="sourceLineNo">1465</span>     */<a name="line.1465"></a>
<span class="sourceLineNo">1466</span>    public byte[] idKeyCalc(byte keyId, byte[] initvector, byte[] dataIn, EIdKeycCalcMode mode) throws PedDevException;<a name="line.1466"></a>
<span class="sourceLineNo">1467</span><a name="line.1467"></a>
<span class="sourceLineNo">1468</span>    /**<a name="line.1468"></a>
<span class="sourceLineNo">1469</span>     * &lt;div class="zh"&gt; 设置密码键盘横向显示。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt;<a name="line.1469"></a>
<span class="sourceLineNo">1470</span>     * &lt;div class="en"&gt;Set password keyboard horizontal display. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1470"></a>
<span class="sourceLineNo">1471</span>     *<a name="line.1471"></a>
<span class="sourceLineNo">1472</span>     * @param landscape<a name="line.1472"></a>
<span class="sourceLineNo">1473</span>     *            &lt;div class="zh"&gt; true:横向 false:竖向。 注: 密码键盘横屏显示不支持自定义键盘,跟IPed.setKeyBoardLayout接口不能一起调用。 &lt;/div&gt;<a name="line.1473"></a>
<span class="sourceLineNo">1474</span>     *            &lt;div class="en"&gt;true:horizontalfalse:vertical. Note: The horizontal screen display of the password keyboard does not support custom keyboards and<a name="line.1474"></a>
<span class="sourceLineNo">1475</span>     *            cannot be called together with the IPed.setKeyBoardLayout interface.&lt;/div&gt;<a name="line.1475"></a>
<span class="sourceLineNo">1476</span>     * @throws PedDevException<a name="line.1476"></a>
<span class="sourceLineNo">1477</span>     */<a name="line.1477"></a>
<span class="sourceLineNo">1478</span>    public void setKeyboardLayoutLandscape(boolean landscape) throws PedDevException;<a name="line.1478"></a>
<span class="sourceLineNo">1479</span><a name="line.1479"></a>
<span class="sourceLineNo">1480</span>    /**<a name="line.1480"></a>
<span class="sourceLineNo">1481</span>     * &lt;div class="zh"&gt; 设置定制的Pin输入键盘布局 。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Set the custom Pin input keyboard layout. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1481"></a>
<span class="sourceLineNo">1482</span>     *<a name="line.1482"></a>
<span class="sourceLineNo">1483</span>     * @param isOnce<a name="line.1483"></a>
<span class="sourceLineNo">1484</span>     *            &lt;div class="zh"&gt; true:单次有效 false:重启机器前有效 &lt;/div&gt; &lt;div class="en"&gt;true:single effect false:effective before restarting the device&lt;/div&gt;<a name="line.1484"></a>
<span class="sourceLineNo">1485</span>     * @param layoutInfo<a name="line.1485"></a>
<span class="sourceLineNo">1486</span>     *             &lt;div class="zh"&gt; 定制Pin输入键盘布局 ，json格式的字符串，<a name="line.1486"></a>
<span class="sourceLineNo">1487</span>     *             模板：{<a name="line.1487"></a>
<span class="sourceLineNo">1488</span>     *                      "areas": [{<a name="line.1488"></a>
<span class="sourceLineNo">1489</span>     *                          "type": "NUM",<a name="line.1489"></a>
<span class="sourceLineNo">1490</span>     *                          "geometry": "x,y,w,h"<a name="line.1490"></a>
<span class="sourceLineNo">1491</span>     *                          },<a name="line.1491"></a>
<span class="sourceLineNo">1492</span>     *                          {<a name="line.1492"></a>
<span class="sourceLineNo">1493</span>     *                          "type": "CANCEL",<a name="line.1493"></a>
<span class="sourceLineNo">1494</span>     *                          "geometry": "x,y,w,h"<a name="line.1494"></a>
<span class="sourceLineNo">1495</span>     *                          },<a name="line.1495"></a>
<span class="sourceLineNo">1496</span>     *                           {<a name="line.1496"></a>
<span class="sourceLineNo">1497</span>     *                          "type": "ENTER",<a name="line.1497"></a>
<span class="sourceLineNo">1498</span>     *                          "geometry": "x,y,w,h"<a name="line.1498"></a>
<span class="sourceLineNo">1499</span>     *                          },<a name="line.1499"></a>
<span class="sourceLineNo">1500</span>     *                          {<a name="line.1500"></a>
<span class="sourceLineNo">1501</span>     *                          "type": "CLEAR",<a name="line.1501"></a>
<span class="sourceLineNo">1502</span>     *                          "geometry": "x,y,w,h"<a name="line.1502"></a>
<span class="sourceLineNo">1503</span>     *                          }<a name="line.1503"></a>
<span class="sourceLineNo">1504</span>     *                      ]<a name="line.1504"></a>
<span class="sourceLineNo">1505</span>     *                  }<a name="line.1505"></a>
<span class="sourceLineNo">1506</span>     *              type表示键类型，NUM表示数字键，CLEAR表示清除键，ENTER表示确认件，CANCEL表示取消键<a name="line.1506"></a>
<span class="sourceLineNo">1507</span>     *              geomentry表示键盘布局，x表示x坐标，y表示y坐标，w表示宽，h表示高&lt;/div&gt;<a name="line.1507"></a>
<span class="sourceLineNo">1508</span>     *              &lt;div class="en"&gt;custom Pin input keyboard layout, json-formatted string,<a name="line.1508"></a>
<span class="sourceLineNo">1509</span>     *              template:<a name="line.1509"></a>
<span class="sourceLineNo">1510</span>     *              {<a name="line.1510"></a>
<span class="sourceLineNo">1511</span>     *                      "areas": [{<a name="line.1511"></a>
<span class="sourceLineNo">1512</span>     *                          "type": "NUM",<a name="line.1512"></a>
<span class="sourceLineNo">1513</span>     *                          "geometry": "x,y,w,h"<a name="line.1513"></a>
<span class="sourceLineNo">1514</span>     *                          },<a name="line.1514"></a>
<span class="sourceLineNo">1515</span>     *                          {<a name="line.1515"></a>
<span class="sourceLineNo">1516</span>     *                          "type": "CANCEL",<a name="line.1516"></a>
<span class="sourceLineNo">1517</span>     *                          "geometry": "x,y,w,h"<a name="line.1517"></a>
<span class="sourceLineNo">1518</span>     *                          },<a name="line.1518"></a>
<span class="sourceLineNo">1519</span>     *                           {<a name="line.1519"></a>
<span class="sourceLineNo">1520</span>     *                          "type": "ENTER",<a name="line.1520"></a>
<span class="sourceLineNo">1521</span>     *                          "geometry": "x,y,w,h"<a name="line.1521"></a>
<span class="sourceLineNo">1522</span>     *                          },<a name="line.1522"></a>
<span class="sourceLineNo">1523</span>     *                          {<a name="line.1523"></a>
<span class="sourceLineNo">1524</span>     *                          "type": "CLEAR",<a name="line.1524"></a>
<span class="sourceLineNo">1525</span>     *                          "geometry": "x,y,w,h"<a name="line.1525"></a>
<span class="sourceLineNo">1526</span>     *                          }<a name="line.1526"></a>
<span class="sourceLineNo">1527</span>     *                      ]<a name="line.1527"></a>
<span class="sourceLineNo">1528</span>     *                  }<a name="line.1528"></a>
<span class="sourceLineNo">1529</span>     *              type:key type,NUM:number key,CLEAR:clear key,ENTER:enter key,CANCEL:cancel key.<a name="line.1529"></a>
<span class="sourceLineNo">1530</span>     *              geomentry:key layout parameters,x:x-coordinate,y:y-coordinate,w:width,h:height.<a name="line.1530"></a>
<span class="sourceLineNo">1531</span>     *              &lt;/div&gt;<a name="line.1531"></a>
<span class="sourceLineNo">1532</span>     * @return &lt;div class="zh"&gt; 数字键盘的顺序，为10个字节byte数组 &lt;/div&gt; &lt;div class="en"&gt;numeric keypad order, 10 byte array&lt;/div&gt;<a name="line.1532"></a>
<span class="sourceLineNo">1533</span>     *<a name="line.1533"></a>
<span class="sourceLineNo">1534</span>     * @throws PedDevException<a name="line.1534"></a>
<span class="sourceLineNo">1535</span>     */<a name="line.1535"></a>
<span class="sourceLineNo">1536</span>    public byte[] setKeyBoardLayout(boolean isOnce, String layoutInfo) throws PedDevException;<a name="line.1536"></a>
<span class="sourceLineNo">1537</span><a name="line.1537"></a>
<span class="sourceLineNo">1538</span>    /**<a name="line.1538"></a>
<span class="sourceLineNo">1539</span>     * &lt;div class="zh"&gt; PED 輸入PIN监听器,仅对内置PED有效 &lt;/div&gt; &lt;div class="en"&gt; PED input PIN listener,only effective on internal<a name="line.1539"></a>
<span class="sourceLineNo">1540</span>     * PED &lt;/div&gt;<a name="line.1540"></a>
<span class="sourceLineNo">1541</span>     *<a name="line.1541"></a>
<span class="sourceLineNo">1542</span>     */<a name="line.1542"></a>
<span class="sourceLineNo">1543</span>    public interface IPedInputPinListener {<a name="line.1543"></a>
<span class="sourceLineNo">1544</span><a name="line.1544"></a>
<span class="sourceLineNo">1545</span>        /**<a name="line.1545"></a>
<span class="sourceLineNo">1546</span>         * &lt;div class="zh"&gt; 按键事件。 &lt;/div&gt; &lt;div class="en"&gt; key event &lt;/div&gt;<a name="line.1546"></a>
<span class="sourceLineNo">1547</span>         *<a name="line.1547"></a>
<span class="sourceLineNo">1548</span>         * @param keyCode<a name="line.1548"></a>
<span class="sourceLineNo">1549</span>         *            {@link EKeyCode}<a name="line.1549"></a>
<span class="sourceLineNo">1550</span>         *<a name="line.1550"></a>
<span class="sourceLineNo">1551</span>         */<a name="line.1551"></a>
<span class="sourceLineNo">1552</span>        public void onKeyEvent(EKeyCode keyCode);<a name="line.1552"></a>
<span class="sourceLineNo">1553</span><a name="line.1553"></a>
<span class="sourceLineNo">1554</span>    }<a name="line.1554"></a>
<span class="sourceLineNo">1555</span><a name="line.1555"></a>
<span class="sourceLineNo">1556</span>    /**<a name="line.1556"></a>
<span class="sourceLineNo">1557</span>     * &lt;div class="zh"&gt;写入一个AES密钥，并可以选择使用KCV验证密钥正确性。仅支持TAESK。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt; &lt;div class="en"&gt; To write Aes key to PED, and use KCV to check the<a name="line.1557"></a>
<span class="sourceLineNo">1558</span>     * key correction.only allow TAESK. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1558"></a>
<span class="sourceLineNo">1559</span>     *<a name="line.1559"></a>
<span class="sourceLineNo">1560</span>     * @param srcKeyType<a name="line.1560"></a>
<span class="sourceLineNo">1561</span>     *            {@link EPedKeyType} &lt;div class="zh"&gt;<a name="line.1561"></a>
<span class="sourceLineNo">1562</span>     *            &lt;p&gt;<a name="line.1562"></a>
<span class="sourceLineNo">1563</span>     *            原密钥类型<a name="line.1563"></a>
<span class="sourceLineNo">1564</span>     *            &lt;/p&gt;<a name="line.1564"></a>
<span class="sourceLineNo">1565</span>     *            &lt;ul&gt;<a name="line.1565"></a>
<span class="sourceLineNo">1566</span>     *            &lt;li&gt;{@link EPedKeyType#TLK}&lt;/li&gt;<a name="line.1566"></a>
<span class="sourceLineNo">1567</span>     *            &lt;li&gt;{@link EPedKeyType#TMK}&lt;/li&gt;<a name="line.1567"></a>
<span class="sourceLineNo">1568</span>     *            &lt;li&gt;{@link EPedKeyType#AES_TMK}&lt;/li&gt;<a name="line.1568"></a>
<span class="sourceLineNo">1569</span>     *            &lt;/ul&gt;<a name="line.1569"></a>
<span class="sourceLineNo">1570</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1570"></a>
<span class="sourceLineNo">1571</span>     *            &lt;p&gt;<a name="line.1571"></a>
<span class="sourceLineNo">1572</span>     *            Source Key Type<a name="line.1572"></a>
<span class="sourceLineNo">1573</span>     *            &lt;/p&gt;<a name="line.1573"></a>
<span class="sourceLineNo">1574</span>     *            &lt;ul&gt;<a name="line.1574"></a>
<span class="sourceLineNo">1575</span>     *            &lt;li&gt;{@link EPedKeyType#TLK}&lt;/li&gt;<a name="line.1575"></a>
<span class="sourceLineNo">1576</span>     *            &lt;li&gt;{@link EPedKeyType#TMK}&lt;/li&gt;<a name="line.1576"></a>
<span class="sourceLineNo">1577</span>     *            &lt;li&gt;{@link EPedKeyType#AES_TMK}&lt;/li&gt;<a name="line.1577"></a>
<span class="sourceLineNo">1578</span>     *            &lt;/ul&gt;<a name="line.1578"></a>
<span class="sourceLineNo">1579</span>     *            &lt;/div&gt;<a name="line.1579"></a>
<span class="sourceLineNo">1580</span>     *<a name="line.1580"></a>
<span class="sourceLineNo">1581</span>     *<a name="line.1581"></a>
<span class="sourceLineNo">1582</span>     * @param srcKeyIndex<a name="line.1582"></a>
<span class="sourceLineNo">1583</span>     *            &lt;div class="zh"&gt;<a name="line.1583"></a>
<span class="sourceLineNo">1584</span>     *            &lt;p&gt;<a name="line.1584"></a>
<span class="sourceLineNo">1585</span>     *            原密钥索引<a name="line.1585"></a>
<span class="sourceLineNo">1586</span>     *            &lt;/p&gt;<a name="line.1586"></a>
<span class="sourceLineNo">1587</span>     *            &lt;ul&gt;<a name="line.1587"></a>
<span class="sourceLineNo">1588</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TLK}时, srcKeyIndex=1有效&lt;/li&gt;<a name="line.1588"></a>
<span class="sourceLineNo">1589</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TMK}时, srcKeyIndex=[1~100]有效&lt;/li&gt;<a name="line.1589"></a>
<span class="sourceLineNo">1590</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#AES_TMK}时, srcKeyIndex=[1~100]有效&lt;/li&gt;<a name="line.1590"></a>
<span class="sourceLineNo">1591</span>     *            &lt;/ul&gt;<a name="line.1591"></a>
<span class="sourceLineNo">1592</span>     *            当srcKeyIndex = 0，密钥将以明文形式写入PED。 &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1592"></a>
<span class="sourceLineNo">1593</span>     *            &lt;p&gt;<a name="line.1593"></a>
<span class="sourceLineNo">1594</span>     *            Source Key Index<a name="line.1594"></a>
<span class="sourceLineNo">1595</span>     *            &lt;/p&gt;<a name="line.1595"></a>
<span class="sourceLineNo">1596</span>     *            &lt;ul&gt;<a name="line.1596"></a>
<span class="sourceLineNo">1597</span>     *            &lt;li&gt;when srcKeyType=TLK, srcKeyIndex=1&lt;/li&gt;<a name="line.1597"></a>
<span class="sourceLineNo">1598</span>     *            &lt;li&gt;when srcKeyType=TMK, srcKeyIndex=[1~100]&lt;/li&gt;<a name="line.1598"></a>
<span class="sourceLineNo">1599</span>     *            &lt;li&gt;when srcKeyType=AES_TMK, srcKeyIndex=[1~100]&lt;/li&gt;<a name="line.1599"></a>
<span class="sourceLineNo">1600</span>     *            &lt;/ul&gt;<a name="line.1600"></a>
<span class="sourceLineNo">1601</span>     *            when srcKeyIndex = 0，The key will be written to PED in clear text. &lt;/div&gt;<a name="line.1601"></a>
<span class="sourceLineNo">1602</span>     *<a name="line.1602"></a>
<span class="sourceLineNo">1603</span>     * @param destkeyIndex<a name="line.1603"></a>
<span class="sourceLineNo">1604</span>     *            &lt;div class="zh"&gt;<a name="line.1604"></a>
<span class="sourceLineNo">1605</span>     *            &lt;p&gt;<a name="line.1605"></a>
<span class="sourceLineNo">1606</span>     *            目的密钥索引[1-100]<a name="line.1606"></a>
<span class="sourceLineNo">1607</span>     *            &lt;/p&gt;<a name="line.1607"></a>
<span class="sourceLineNo">1608</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1608"></a>
<span class="sourceLineNo">1609</span>     *            &lt;p&gt;<a name="line.1609"></a>
<span class="sourceLineNo">1610</span>     *            Destination Key Index[1-100]<a name="line.1610"></a>
<span class="sourceLineNo">1611</span>     *            &lt;/p&gt;<a name="line.1611"></a>
<span class="sourceLineNo">1612</span>     *            &lt;/div&gt;<a name="line.1612"></a>
<span class="sourceLineNo">1613</span>     *<a name="line.1613"></a>
<span class="sourceLineNo">1614</span>     * @param destKeyValue<a name="line.1614"></a>
<span class="sourceLineNo">1615</span>     *            &lt;div class="zh"&gt;<a name="line.1615"></a>
<span class="sourceLineNo">1616</span>     *            &lt;p&gt;<a name="line.1616"></a>
<span class="sourceLineNo">1617</span>     *            密钥明文或密文,16/24/32bytes<a name="line.1617"></a>
<span class="sourceLineNo">1618</span>     *            &lt;/p&gt;<a name="line.1618"></a>
<span class="sourceLineNo">1619</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1619"></a>
<span class="sourceLineNo">1620</span>     *            &lt;p&gt;<a name="line.1620"></a>
<span class="sourceLineNo">1621</span>     *            Cryptograph or Plaintext,16/24/32bytes<a name="line.1621"></a>
<span class="sourceLineNo">1622</span>     *            &lt;/p&gt;<a name="line.1622"></a>
<span class="sourceLineNo">1623</span>     *            &lt;/div&gt;<a name="line.1623"></a>
<span class="sourceLineNo">1624</span>     *<a name="line.1624"></a>
<span class="sourceLineNo">1625</span>     * @param checkMode<a name="line.1625"></a>
<span class="sourceLineNo">1626</span>     *            {@link EAesCheckMode} &lt;div class="zh"&gt;<a name="line.1626"></a>
<span class="sourceLineNo">1627</span>     *            &lt;p&gt;<a name="line.1627"></a>
<span class="sourceLineNo">1628</span>     *            校验模式<a name="line.1628"></a>
<span class="sourceLineNo">1629</span>     *            &lt;/p&gt;<a name="line.1629"></a>
<span class="sourceLineNo">1630</span>     *            &lt;ul&gt;<a name="line.1630"></a>
<span class="sourceLineNo">1631</span>     *            &lt;li&gt;checkMode=KCV_NONE -无验证.&lt;/li&gt;<a name="line.1631"></a>
<span class="sourceLineNo">1632</span>     *            &lt;li&gt;checkMode=KCV_ENCRYPT_0 -对16个字节的0x00进行AES ECB模式加密运算，得到的密文的前4个字节即为KCV值。&lt;/li&gt;<a name="line.1632"></a>
<span class="sourceLineNo">1633</span>     *            &lt;li&gt;checkMode=KCV_ENCRYPT_FIX_DATA -首先对密钥明文进行奇校验，再对16字节长度<a name="line.1633"></a>
<span class="sourceLineNo">1634</span>     *            ―\x12\x34\x56\x78\x90\x12\x34\x56\x12\x34\x56\x78\x90\x12\x34\x56‖进行AES ECB模式的加密运算，得到的密文的前4个字节即为KCV值。&lt;/li&gt;<a name="line.1634"></a>
<span class="sourceLineNo">1635</span>     *            &lt;li&gt;checkMode=KCV_MAC_INPUT_DATA -传入一串数据KcvData，使用源密钥对[aucDstKeyValue(密文)+<a name="line.1635"></a>
<span class="sourceLineNo">1636</span>     *            KcvData]进行指定模式的MAC运算，得到的8个字节的MAC值即为KCV值。&lt;/li&gt;<a name="line.1636"></a>
<span class="sourceLineNo">1637</span>     *            &lt;/ul&gt;<a name="line.1637"></a>
<span class="sourceLineNo">1638</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1638"></a>
<span class="sourceLineNo">1639</span>     *            &lt;p&gt;<a name="line.1639"></a>
<span class="sourceLineNo">1640</span>     *            Check Mode<a name="line.1640"></a>
<span class="sourceLineNo">1641</span>     *            &lt;/p&gt;<a name="line.1641"></a>
<span class="sourceLineNo">1642</span>     *            &lt;ul&gt;<a name="line.1642"></a>
<span class="sourceLineNo">1643</span>     *            &lt;li&gt;When checkMode=KCV_NONE -No Check&lt;/li&gt;<a name="line.1643"></a>
<span class="sourceLineNo">1644</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_0 -Perform AES ECB mode encryption on 16 bytes 0x00, and use first 4<a name="line.1644"></a>
<span class="sourceLineNo">1645</span>     *            bytes as KCV.&lt;/li&gt;<a name="line.1645"></a>
<span class="sourceLineNo">1646</span>     *<a name="line.1646"></a>
<span class="sourceLineNo">1647</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_FIX_DATA -Perform parity check first, then perform AES ECB mode<a name="line.1647"></a>
<span class="sourceLineNo">1648</span>     *            encryption on 16 bytes―\x12\x34\x56\x78\x90\x12\x34\x56\x12\x34\x56\x78\x90\x12\x34\x56‖, and use<a name="line.1648"></a>
<span class="sourceLineNo">1649</span>     *            first 4 bytes as KCV.&lt;/li&gt;<a name="line.1649"></a>
<span class="sourceLineNo">1650</span>     *<a name="line.1650"></a>
<span class="sourceLineNo">1651</span>     *            &lt;li&gt;When checkMode=KCV_MAC_INPUT_DATA -Send in data KcvData, use source key to perform specified mode<a name="line.1651"></a>
<span class="sourceLineNo">1652</span>     *            of MAC on [aucDesKeyValue(ciphertext) +KcvData], and use the 8 bytes result as KCV.&lt;/li&gt;<a name="line.1652"></a>
<span class="sourceLineNo">1653</span>     *            &lt;/ul&gt;<a name="line.1653"></a>
<span class="sourceLineNo">1654</span>     *            &lt;/div&gt;<a name="line.1654"></a>
<span class="sourceLineNo">1655</span>     *<a name="line.1655"></a>
<span class="sourceLineNo">1656</span>     * @param checkBuf<a name="line.1656"></a>
<span class="sourceLineNo">1657</span>     *            &lt;div class="zh"&gt;<a name="line.1657"></a>
<span class="sourceLineNo">1658</span>     *            &lt;p&gt;<a name="line.1658"></a>
<span class="sourceLineNo">1659</span>     *            校验数据缓冲区<a name="line.1659"></a>
<span class="sourceLineNo">1660</span>     *            &lt;/p&gt;<a name="line.1660"></a>
<span class="sourceLineNo">1661</span>     *            &lt;ul&gt;<a name="line.1661"></a>
<span class="sourceLineNo">1662</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_NONE}时 checkBuf的值无效,系统认为不验证KCV,可以为null&lt;/li&gt;<a name="line.1662"></a>
<span class="sourceLineNo">1663</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_ENCRYPT_0}时checkBuf为KCV的值&lt;/li&gt;<a name="line.1663"></a>
<span class="sourceLineNo">1664</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_ENCRYPT_FIX_DATA}时checkBuf为KCV的值&lt;/li&gt;<a name="line.1664"></a>
<span class="sourceLineNo">1665</span>     *            &lt;li&gt;当iCheckMode={@link ECheckMode#KCV_MAC_INPUT_DATA}时按以下规则提供checkBuf:<a name="line.1665"></a>
<span class="sourceLineNo">1666</span>     *            &lt;p&gt;<a name="line.1666"></a>
<span class="sourceLineNo">1667</span>     *            checkBuf[0]= KcvData长度(KcvDataLen)<a name="line.1667"></a>
<span class="sourceLineNo">1668</span>     *            &lt;/p&gt;<a name="line.1668"></a>
<span class="sourceLineNo">1669</span>     *            &lt;p&gt;<a name="line.1669"></a>
<span class="sourceLineNo">1670</span>     *            checkBuf+1: KcvData<a name="line.1670"></a>
<span class="sourceLineNo">1671</span>     *            &lt;/p&gt;<a name="line.1671"></a>
<span class="sourceLineNo">1672</span>     *            &lt;p&gt;<a name="line.1672"></a>
<span class="sourceLineNo">1673</span>     *            checkBuf[1+KcvDataLen]=MAC运算模式,参考{@link #getMac(byte, byte[], EPedMacMode)}中的mode参数<a name="line.1673"></a>
<span class="sourceLineNo">1674</span>     *            &lt;/p&gt;<a name="line.1674"></a>
<span class="sourceLineNo">1675</span>     *            &lt;p&gt;<a name="line.1675"></a>
<span class="sourceLineNo">1676</span>     *            checkBuf[2+KcvDataLen]=KCV长度<a name="line.1676"></a>
<span class="sourceLineNo">1677</span>     *            &lt;/p&gt;<a name="line.1677"></a>
<span class="sourceLineNo">1678</span>     *            &lt;p&gt;<a name="line.1678"></a>
<span class="sourceLineNo">1679</span>     *            checkBuf[3+KcvDataLen]是KCV的值<a name="line.1679"></a>
<span class="sourceLineNo">1680</span>     *            &lt;/p&gt;<a name="line.1680"></a>
<span class="sourceLineNo">1681</span>     *            &lt;/li&gt;<a name="line.1681"></a>
<span class="sourceLineNo">1682</span>     *            &lt;/ul&gt;<a name="line.1682"></a>
<span class="sourceLineNo">1683</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1683"></a>
<span class="sourceLineNo">1684</span>     *            &lt;p&gt;<a name="line.1684"></a>
<span class="sourceLineNo">1685</span>     *            Check Data Buffer<a name="line.1685"></a>
<span class="sourceLineNo">1686</span>     *            &lt;/p&gt;<a name="line.1686"></a>
<span class="sourceLineNo">1687</span>     *            &lt;ul&gt;<a name="line.1687"></a>
<span class="sourceLineNo">1688</span>     *            &lt;li&gt;When checkMode=KCV_NONE -PED won't check KCV, this data is no meaning.&lt;/li&gt;<a name="line.1688"></a>
<span class="sourceLineNo">1689</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_0 -4 bytes key check value&lt;/li&gt;<a name="line.1689"></a>
<span class="sourceLineNo">1690</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_FIX_DATA -4 bytes key check value&lt;/li&gt;<a name="line.1690"></a>
<span class="sourceLineNo">1691</span>     *            &lt;li&gt;When iCheckMode=KCV_MAC_INPUT_DATA - checkBuf as follows: checkBuf[0] = length of KcvData<a name="line.1691"></a>
<span class="sourceLineNo">1692</span>     *            checkBuf+1: kcvData checkBuf[1+kcvDataLen]: MAC computation mode<a name="line.1692"></a>
<span class="sourceLineNo">1693</span>     *            {@link #getMac(byte, byte[], EPedMacMode)} checkBuf[2+kcvDataLen]:KCV length<a name="line.1693"></a>
<span class="sourceLineNo">1694</span>     *            checkBuf[3+kcvDataLen]:KCV Value&lt;/li&gt;<a name="line.1694"></a>
<span class="sourceLineNo">1695</span>     *            &lt;/ul&gt;<a name="line.1695"></a>
<span class="sourceLineNo">1696</span>     *            &lt;/div&gt;<a name="line.1696"></a>
<span class="sourceLineNo">1697</span>     * @since V2.00.02<a name="line.1697"></a>
<span class="sourceLineNo">1698</span>     * @throws PedDevException<a name="line.1698"></a>
<span class="sourceLineNo">1699</span>     */<a name="line.1699"></a>
<span class="sourceLineNo">1700</span>    public void writeAesKey(EPedKeyType srcKeyType, byte srcKeyIndex, byte destkeyIndex, byte[] destKeyValue,<a name="line.1700"></a>
<span class="sourceLineNo">1701</span>            EAesCheckMode checkMode, byte[] checkBuf) throws PedDevException;<a name="line.1701"></a>
<span class="sourceLineNo">1702</span><a name="line.1702"></a>
<span class="sourceLineNo">1703</span>    /**<a name="line.1703"></a>
<span class="sourceLineNo">1704</span>     * &lt;div class="zh"&gt; 用AES算法进行加密或者解密 。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.1704"></a>
<span class="sourceLineNo">1705</span>     * &lt;div class="en"&gt; Use AES algorithm to encrypt or decrypt. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1705"></a>
<span class="sourceLineNo">1706</span>     *<a name="line.1706"></a>
<span class="sourceLineNo">1707</span>     * @param keyIdx<a name="line.1707"></a>
<span class="sourceLineNo">1708</span>     *            &lt;div class="zh"&gt; AES_TDK 密钥索引: 1~40&lt;/div&gt; &lt;div class="en"&gt; AES_TDK Key index: 1~40 &lt;/div&gt;<a name="line.1708"></a>
<span class="sourceLineNo">1709</span>     * @param initvector<a name="line.1709"></a>
<span class="sourceLineNo">1710</span>     *            &lt;div class="zh"&gt;使用CBC/OFB 模式进行加解密运算时需要用到，若InitVector为NULL，则默认为16字节的全0x00。 使用ECB加解密时不需要，可以为NULL。 &lt;/div&gt;<a name="line.1710"></a>
<span class="sourceLineNo">1711</span>     *            &lt;div class="en"&gt; ECB mode: init vector is null .CBC mode: init vector, 16 bytes. &lt;/div&gt;<a name="line.1711"></a>
<span class="sourceLineNo">1712</span>     * @param dataIn<a name="line.1712"></a>
<span class="sourceLineNo">1713</span>     *            &lt;div class="zh"&gt;待运算的数据.应小于等于1024字节，且为16的倍数。 &lt;/div&gt; &lt;div class="en"&gt; Input data to be encrypted or<a name="line.1713"></a>
<span class="sourceLineNo">1714</span>     *            decrypted. Max length &lt;= 1024, and that is a multiple of 16.&lt;/div&gt;<a name="line.1714"></a>
<span class="sourceLineNo">1715</span>     * @param operation<a name="line.1715"></a>
<span class="sourceLineNo">1716</span>     *            &lt;ul&gt;<a name="line.1716"></a>
<span class="sourceLineNo">1717</span>     *            &lt;li&gt;{@link ECryptOperate#ENCRYPT}&lt;/li&gt;<a name="line.1717"></a>
<span class="sourceLineNo">1718</span>     *            &lt;li&gt;{@link ECryptOperate#DECRYPT}&lt;/li&gt;<a name="line.1718"></a>
<span class="sourceLineNo">1719</span>     *            &lt;/ul&gt;<a name="line.1719"></a>
<span class="sourceLineNo">1720</span>     * @param option<a name="line.1720"></a>
<span class="sourceLineNo">1721</span>     *            &lt;ul&gt;<a name="line.1721"></a>
<span class="sourceLineNo">1722</span>     *            &lt;li&gt;{@link ECryptOpt#ECB}&lt;/li&gt;<a name="line.1722"></a>
<span class="sourceLineNo">1723</span>     *            &lt;li&gt;{@link ECryptOpt#CBC}&lt;/li&gt;<a name="line.1723"></a>
<span class="sourceLineNo">1724</span>     *            &lt;li&gt;{@link ECryptOpt#OFB}&lt;/li&gt;<a name="line.1724"></a>
<span class="sourceLineNo">1725</span>     *            &lt;/ul&gt;<a name="line.1725"></a>
<span class="sourceLineNo">1726</span>     * @return &lt;div class="zh"&gt; 加密或者解密后的数据 &lt;/div&gt; &lt;div class="en"&gt; encrypted or decrypted data &lt;/div&gt;<a name="line.1726"></a>
<span class="sourceLineNo">1727</span>     * @since V2.00.02<a name="line.1727"></a>
<span class="sourceLineNo">1728</span>     * @throws PedDevException<a name="line.1728"></a>
<span class="sourceLineNo">1729</span>     */<a name="line.1729"></a>
<span class="sourceLineNo">1730</span>    public byte[] calcAes(byte keyIdx, byte[] initvector, byte[] dataIn, ECryptOperate operation, ECryptOpt option)<a name="line.1730"></a>
<span class="sourceLineNo">1731</span>            throws PedDevException;<a name="line.1731"></a>
<span class="sourceLineNo">1732</span><a name="line.1732"></a>
<span class="sourceLineNo">1733</span>    /**<a name="line.1733"></a>
<span class="sourceLineNo">1734</span>     * &lt;div class="zh"&gt;设置键盘按键显示模式，固定序列或随机序列(默认)。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Set keyboard display mode, fixed sequence or<a name="line.1734"></a>
<span class="sourceLineNo">1735</span>     * random sequence (default). {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1735"></a>
<span class="sourceLineNo">1736</span>     *<a name="line.1736"></a>
<span class="sourceLineNo">1737</span>     * @param random<a name="line.1737"></a>
<span class="sourceLineNo">1738</span>     *            true:random false:fixed sequence<a name="line.1738"></a>
<span class="sourceLineNo">1739</span>     * @since V2.00.03<a name="line.1739"></a>
<span class="sourceLineNo">1740</span>     * @throws PedDevException<a name="line.1740"></a>
<span class="sourceLineNo">1741</span>     */<a name="line.1741"></a>
<span class="sourceLineNo">1742</span>    public void setKeyboardRandom(boolean random) throws PedDevException;<a name="line.1742"></a>
<span class="sourceLineNo">1743</span><a name="line.1743"></a>
<span class="sourceLineNo">1744</span>    /**<a name="line.1744"></a>
<span class="sourceLineNo">1745</span>     * &lt;div class="zh"&gt; 生成RSA密钥对并注入PED。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt;<a name="line.1745"></a>
<span class="sourceLineNo">1746</span>     * &lt;div class="en"&gt; Generate RSA key pairs then inject into PED. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1746"></a>
<span class="sourceLineNo">1747</span>     *<a name="line.1747"></a>
<span class="sourceLineNo">1748</span>     * @param pvtKeyIdx<a name="line.1748"></a>
<span class="sourceLineNo">1749</span>     *            &lt;div class="zh"&gt;私钥索引1-10&lt;/div&gt; &lt;div class="en"&gt; Private key index 1-10 &lt;/div&gt;<a name="line.1749"></a>
<span class="sourceLineNo">1750</span>     * @param pubKeyIdx<a name="line.1750"></a>
<span class="sourceLineNo">1751</span>     *            &lt;div class="zh"&gt;公钥索引1-10&lt;/div&gt; &lt;div class="en"&gt;Public key index 1-10&lt;/div&gt;<a name="line.1751"></a>
<span class="sourceLineNo">1752</span>     * @param modLenBit<a name="line.1752"></a>
<span class="sourceLineNo">1753</span>     *            &lt;div class="zh"&gt; 模长，支持512,1024,2048。 &lt;/div&gt; &lt;div class="en"&gt; Modulus len,support 512,1024,2048. &lt;/div&gt;<a name="line.1753"></a>
<span class="sourceLineNo">1754</span>     * @param pubExpType<a name="line.1754"></a>
<span class="sourceLineNo">1755</span>     *            &lt;div class="zh"&gt; 公共指数类型：0:3 1:65537 &lt;/div&gt; &lt;div class="en"&gt; Public exponent type: 0:3 1:65537 &lt;/div&gt;<a name="line.1755"></a>
<span class="sourceLineNo">1756</span>     * @throws PedDevException<a name="line.1756"></a>
<span class="sourceLineNo">1757</span>     * @since V2.01.00<a name="line.1757"></a>
<span class="sourceLineNo">1758</span>     */<a name="line.1758"></a>
<span class="sourceLineNo">1759</span>    public void genRSAKey(byte pvtKeyIdx, byte pubKeyIdx, short modLenBit, byte pubExpType) throws PedDevException;<a name="line.1759"></a>
<span class="sourceLineNo">1760</span><a name="line.1760"></a>
<span class="sourceLineNo">1761</span>    /**<a name="line.1761"></a>
<span class="sourceLineNo">1762</span>     * &lt;div class="zh"&gt; 设置外置PED的连接端口。支持{@link EPedType#EXTERNAL_TYPEA},{@link EPedType#EXTERNAL_TYPEC} 类型。&lt;/div&gt;<a name="line.1762"></a>
<span class="sourceLineNo">1763</span>     * &lt;div class="en"&gt; Set connection port of the external PED. {@link EPedType#EXTERNAL_TYPEA},{@link EPedType#EXTERNAL_TYPEC} is supported.&lt;/div&gt;<a name="line.1763"></a>
<span class="sourceLineNo">1764</span>     *<a name="line.1764"></a>
<span class="sourceLineNo">1765</span>     * @param port<a name="line.1765"></a>
<span class="sourceLineNo">1766</span>     *            {@link EUartPort}<a name="line.1766"></a>
<span class="sourceLineNo">1767</span>     * @since V2.02.00<a name="line.1767"></a>
<span class="sourceLineNo">1768</span>     */<a name="line.1768"></a>
<span class="sourceLineNo">1769</span>    void setPort(EUartPort port);<a name="line.1769"></a>
<span class="sourceLineNo">1770</span><a name="line.1770"></a>
<span class="sourceLineNo">1771</span>    /**<a name="line.1771"></a>
<span class="sourceLineNo">1772</span>     * &lt;div class="zh"&gt; 指定的时限内，扫描键盘上输入的PIN并输出PIN BLOCK加密数据块。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt; &lt;div class="en"&gt; Scan the keyboard PIN entry and<a name="line.1772"></a>
<span class="sourceLineNo">1773</span>     * output the PIN BLOCK encrypted data block in a specific time. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1773"></a>
<span class="sourceLineNo">1774</span>     *<a name="line.1774"></a>
<span class="sourceLineNo">1775</span>     *<a name="line.1775"></a>
<span class="sourceLineNo">1776</span>     * @param keyIndex<a name="line.1776"></a>
<span class="sourceLineNo">1777</span>     *            &lt;div class="zh"&gt; [1~100] TPK的索引 &lt;/div&gt; &lt;div class="en"&gt; [1~100] TPK index &lt;/div&gt;<a name="line.1777"></a>
<span class="sourceLineNo">1778</span>     *<a name="line.1778"></a>
<span class="sourceLineNo">1779</span>     * @param expPinLen<a name="line.1779"></a>
<span class="sourceLineNo">1780</span>     *            &lt;div class="zh"&gt; 0~12的枚举集合<a name="line.1780"></a>
<span class="sourceLineNo">1781</span>     *            可输入的合法密码长度    字符串，应用程序把允许的密码长度全部枚举出来，并且用"，"号隔开每个长度，如允许输入4、6位密码并且允许无密码直接按确认，则该字符串应该设置为"0,4,6"。<a name="line.1781"></a>
<span class="sourceLineNo">1782</span>     *            若枚举0长度则示意可以不输任何数字而直接按确认键返回。<a name="line.1782"></a>
<span class="sourceLineNo">1783</span>     *            &lt;p&gt;<a name="line.1783"></a>
<span class="sourceLineNo">1784</span>     *            若枚举长度存在无效值，则忽略无效值。若输入长度超过设置长度，则忽略超出的输入。<a name="line.1784"></a>
<span class="sourceLineNo">1785</span>     *            &lt;/p&gt;<a name="line.1785"></a>
<span class="sourceLineNo">1786</span>     *            &lt;p&gt;<a name="line.1786"></a>
<span class="sourceLineNo">1787</span>     *            当mode=0x05的时候，该参数为"5"<a name="line.1787"></a>
<span class="sourceLineNo">1788</span>     *            &lt;/p&gt;<a name="line.1788"></a>
<span class="sourceLineNo">1789</span>     *            &lt;/div&gt; &lt;div class="en"&gt; Enumeration of 0-12.The enter password string with legal length. Application<a name="line.1789"></a>
<span class="sourceLineNo">1790</span>     *            enumerates of all possible lengths of PIN. ","will be used to separate each number of length. If no<a name="line.1790"></a>
<span class="sourceLineNo">1791</span>     *            PIN,or 4 or 6 digits of PIN are allowed, the string will be set as "0,4,6". 0 means that no PIN is<a name="line.1791"></a>
<span class="sourceLineNo">1792</span>     *            required, and pressing "Enter" will return.<a name="line.1792"></a>
<span class="sourceLineNo">1793</span>     *            &lt;p&gt;<a name="line.1793"></a>
<span class="sourceLineNo">1794</span>     *             If there is an invalid value in the enumeration length, the invalid value will be ignored.<a name="line.1794"></a>
<span class="sourceLineNo">1795</span>     *             If the input length exceeds the set length, the excess input will be ignored.<a name="line.1795"></a>
<span class="sourceLineNo">1796</span>     *            &lt;/p&gt;<a name="line.1796"></a>
<span class="sourceLineNo">1797</span>     *            &lt;p&gt;<a name="line.1797"></a>
<span class="sourceLineNo">1798</span>     *            When mode=0x05，it should be "5"<a name="line.1798"></a>
<span class="sourceLineNo">1799</span>     *            &lt;/p&gt;<a name="line.1799"></a>
<span class="sourceLineNo">1800</span>     *            &lt;/div&gt;<a name="line.1800"></a>
<span class="sourceLineNo">1801</span>     *<a name="line.1801"></a>
<span class="sourceLineNo">1802</span>     * @param dataIn<a name="line.1802"></a>
<span class="sourceLineNo">1803</span>     *            &lt;div class="zh"&gt;<a name="line.1803"></a>
<span class="sourceLineNo">1804</span>     *            &lt;ul&gt;<a name="line.1804"></a>
<span class="sourceLineNo">1805</span>     *            &lt;li&gt;当mode=0x00时, DataIn指向卡号移位后生成的16位主帐号。&lt;/li&gt;<a name="line.1805"></a>
<span class="sourceLineNo">1806</span>     *            &lt;li&gt;当mode=0x01时, DataIn被忽略.接口内部采用随机数填充PINBlock。&lt;/li&gt;<a name="line.1806"></a>
<span class="sourceLineNo">1807</span>     *            &lt;li&gt;当mode=0x02时, DataIn指向位移后的16位PAN。&lt;/li&gt;<a name="line.1807"></a>
<span class="sourceLineNo">1808</span>     *            &lt;li&gt;当mode=0x03时, 为交易流水号ISN [6 Bytes,ASCII码]&lt;/li&gt;<a name="line.1808"></a>
<span class="sourceLineNo">1809</span>     *            &lt;li&gt;当Mode=0x05时, DataIn包含卡账号和CCS数据，格式为PANlen(1个字节) + CCSlen（1个字节） + PAN（PANlen个字节） +<a name="line.1809"></a>
<span class="sourceLineNo">1810</span>     *            CCS（CCSlen个字节）。其中PAN为卡账号（ASCII码），目前限定PANlen必须为18，CCSlen必须为0或者8，CCS为ASCII码格式。&lt;/li&gt;<a name="line.1810"></a>
<span class="sourceLineNo">1811</span>     *            &lt;li&gt;当mode=0x14时，DataIn为原始主帐号。&lt;/li&gt;<a name="line.1811"></a>
<span class="sourceLineNo">1812</span>     *            &lt;/ul&gt;<a name="line.1812"></a>
<span class="sourceLineNo">1813</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1813"></a>
<span class="sourceLineNo">1814</span>     *            &lt;ul&gt;<a name="line.1814"></a>
<span class="sourceLineNo">1815</span>     *            &lt;li&gt;When mode=0x00, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.1815"></a>
<span class="sourceLineNo">1816</span>     *            &lt;li&gt;When mode=0x01, DataIn is ignored. The interface uses random numbers to fill PINBlock internally.&lt;/li&gt;<a name="line.1816"></a>
<span class="sourceLineNo">1817</span>     *            &lt;li&gt;When mode=0x02, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.1817"></a>
<span class="sourceLineNo">1818</span>     *            &lt;li&gt;When mode=0x03, dataIn is ISN [6 Bytes, ASCII code]&lt;/li&gt;<a name="line.1818"></a>
<span class="sourceLineNo">1819</span>     *            &lt;li&gt;When Mode=0x05, DataIn contains card account and CCS data. The format is PANlen (1 bytes) + CCSlen<a name="line.1819"></a>
<span class="sourceLineNo">1820</span>     *            (1 bytes) + PAN (PANlen byte) + CCS (CCSlen byte). In which PAN is a card account (ASCII code), the<a name="line.1820"></a>
<span class="sourceLineNo">1821</span>     *            current limited PANlen must be 18, CCSlen must be 0 or 8, CCS is ASCII code format.&lt;/li&gt;<a name="line.1821"></a>
<span class="sourceLineNo">1822</span>     *            &lt;li&gt;When mode=0x14, DataIn is the original primary account.&lt;/li&gt;<a name="line.1822"></a>
<span class="sourceLineNo">1823</span>     *            &lt;/ul&gt;<a name="line.1823"></a>
<span class="sourceLineNo">1824</span>     *            &lt;/div&gt;<a name="line.1824"></a>
<span class="sourceLineNo">1825</span>     *<a name="line.1825"></a>
<span class="sourceLineNo">1826</span>     * @param mode<a name="line.1826"></a>
<span class="sourceLineNo">1827</span>     *            &lt;div class="zh"&gt; PIN BLOCK的格式<a name="line.1827"></a>
<span class="sourceLineNo">1828</span>     *            &lt;ul&gt;<a name="line.1828"></a>
<span class="sourceLineNo">1829</span>     *            &lt;li&gt;0x00:ISO9564_0&lt;/li&gt;<a name="line.1829"></a>
<span class="sourceLineNo">1830</span>     *            &lt;li&gt;0x01:ISO9564_1&lt;/li&gt;<a name="line.1830"></a>
<span class="sourceLineNo">1831</span>     *            &lt;li&gt;0x02:ISO9564_3&lt;/li&gt;<a name="line.1831"></a>
<span class="sourceLineNo">1832</span>     *            &lt;li&gt;0x03:HK EPS&lt;/li&gt;<a name="line.1832"></a>
<span class="sourceLineNo">1833</span>     *            &lt;li&gt;0x04:预留&lt;/li&gt;<a name="line.1833"></a>
<span class="sourceLineNo">1834</span>     *            &lt;li&gt;0x05:Italy 专用模式&lt;/li&gt;<a name="line.1834"></a>
<span class="sourceLineNo">1835</span>     *            &lt;li&gt;0x06:AS2805 zero length PIN block mode。不会要求输入PIN，不会弹出输PIN窗口，expPinLen必须为0。&lt;/li&gt;<a name="line.1835"></a>
<span class="sourceLineNo">1836</span>     *            &lt;li&gt;0x11:使用AES_TPK加密,pinblock是日本的hit特殊模式&lt;/li&gt;<a name="line.1836"></a>
<span class="sourceLineNo">1837</span>     *            &lt;li&gt;0x12:使用AES_TPK加密,pinblock是日本的PKCS7模式&lt;/li&gt;<a name="line.1837"></a>
<span class="sourceLineNo">1838</span>     *            &lt;li&gt;0x14:使用AES_TPK加密,pinblock是ISO9564 格式4&lt;/li&gt;<a name="line.1838"></a>
<span class="sourceLineNo">1839</span>     *            &lt;li&gt;0x50:3DES-CBC&lt;/li&gt;<a name="line.1839"></a>
<span class="sourceLineNo">1840</span>     *            &lt;/ul&gt;<a name="line.1840"></a>
<span class="sourceLineNo">1841</span>     *            &lt;/div&gt; &lt;div class="en"&gt; PIN BLOCK Format<a name="line.1841"></a>
<span class="sourceLineNo">1842</span>     *            &lt;ul&gt;<a name="line.1842"></a>
<span class="sourceLineNo">1843</span>     *            &lt;li&gt;0x00:ISO9564_0&lt;/li&gt;<a name="line.1843"></a>
<span class="sourceLineNo">1844</span>     *            &lt;li&gt;0x01:ISO9564_1&lt;/li&gt;<a name="line.1844"></a>
<span class="sourceLineNo">1845</span>     *            &lt;li&gt;0x02:ISO9564_3&lt;/li&gt;<a name="line.1845"></a>
<span class="sourceLineNo">1846</span>     *            &lt;li&gt;0x03:HK EPS -EPS PINBLOCK Format&lt;/li&gt;<a name="line.1846"></a>
<span class="sourceLineNo">1847</span>     *            &lt;li&gt;0x04:Reserved&lt;/li&gt;<a name="line.1847"></a>
<span class="sourceLineNo">1848</span>     *            &lt;li&gt;0x05:Italy special mode&lt;/li&gt;<a name="line.1848"></a>
<span class="sourceLineNo">1849</span>     *            &lt;li&gt;0x06:AS2805 zero length PIN block mode。The pin input window will not pop up. expPinLen must be 0.&lt;/li&gt;<a name="line.1849"></a>
<span class="sourceLineNo">1850</span>     *            &lt;li&gt;0x11:Using AES_TPK encryption, pinblock is Japan's hit special mode&lt;/li&gt;<a name="line.1850"></a>
<span class="sourceLineNo">1851</span>     *            &lt;li&gt;0x12:Using AES_TPK encryption, pinblock is Japan's PKCS7 mode&lt;/li&gt;<a name="line.1851"></a>
<span class="sourceLineNo">1852</span>     *            &lt;li&gt;0x14:Using AES_TPK encryption, pinblock is in ISO9564 format 4&lt;/li&gt;<a name="line.1852"></a>
<span class="sourceLineNo">1853</span>     *            &lt;li&gt;0x50:3DES-CBC&lt;/li&gt;<a name="line.1853"></a>
<span class="sourceLineNo">1854</span>     *            &lt;/ul&gt;<a name="line.1854"></a>
<span class="sourceLineNo">1855</span>     *            &lt;/div&gt;<a name="line.1855"></a>
<span class="sourceLineNo">1856</span>     *<a name="line.1856"></a>
<span class="sourceLineNo">1857</span>     * @param timeoutMs<a name="line.1857"></a>
<span class="sourceLineNo">1858</span>     *            &lt;div class="zh"&gt;<a name="line.1858"></a>
<span class="sourceLineNo">1859</span>     *            &lt;p&gt;<a name="line.1859"></a>
<span class="sourceLineNo">1860</span>     *            输入PIN的超时时间,单位：毫秒 最大值为300000ms<a name="line.1860"></a>
<span class="sourceLineNo">1861</span>     *            &lt;/p&gt;<a name="line.1861"></a>
<span class="sourceLineNo">1862</span>     *            &lt;p&gt;<a name="line.1862"></a>
<span class="sourceLineNo">1863</span>     *            0:表示没有超时时间，PED不做超时控制<a name="line.1863"></a>
<span class="sourceLineNo">1864</span>     *            &lt;/p&gt;<a name="line.1864"></a>
<span class="sourceLineNo">1865</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1865"></a>
<span class="sourceLineNo">1866</span>     *            &lt;p&gt;<a name="line.1866"></a>
<span class="sourceLineNo">1867</span>     *            The timeout of PIN entry [unit:ms] Maximum is 300000ms.<a name="line.1867"></a>
<span class="sourceLineNo">1868</span>     *            &lt;/p&gt;<a name="line.1868"></a>
<span class="sourceLineNo">1869</span>     *            &lt;p&gt;<a name="line.1869"></a>
<span class="sourceLineNo">1870</span>     *            0: No timeout time, not doing timeout control for PED.<a name="line.1870"></a>
<span class="sourceLineNo">1871</span>     *            &lt;/p&gt;<a name="line.1871"></a>
<span class="sourceLineNo">1872</span>     *            &lt;/div&gt;<a name="line.1872"></a>
<span class="sourceLineNo">1873</span>     *<a name="line.1873"></a>
<span class="sourceLineNo">1874</span>     * @return &lt;div class="zh"&gt; 返回pinBlock，如果bypass 返回NULL。如果mode=0x11，返回16字节数组。 &lt;/div&gt; &lt;div class="en"&gt; Return pinBlock byte array, if<a name="line.1874"></a>
<span class="sourceLineNo">1875</span>     *         bypass,return NULL. If mode=0x11,return 16 byte array.&lt;/div&gt;<a name="line.1875"></a>
<span class="sourceLineNo">1876</span>     *<a name="line.1876"></a>
<span class="sourceLineNo">1877</span>     * @throws PedDevException<a name="line.1877"></a>
<span class="sourceLineNo">1878</span>     * @since V2.02.00<a name="line.1878"></a>
<span class="sourceLineNo">1879</span>     */<a name="line.1879"></a>
<span class="sourceLineNo">1880</span>    public byte[] getPinBlock(byte keyIndex, String expPinLen, byte[] dataIn, byte mode, int timeoutMs)<a name="line.1880"></a>
<span class="sourceLineNo">1881</span>            throws PedDevException;<a name="line.1881"></a>
<span class="sourceLineNo">1882</span><a name="line.1882"></a>
<span class="sourceLineNo">1883</span>    /**<a name="line.1883"></a>
<span class="sourceLineNo">1884</span>     * &lt;div class="zh"&gt; 读取RSA公钥密钥 。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt; Read rsa public key. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1884"></a>
<span class="sourceLineNo">1885</span>     *<a name="line.1885"></a>
<span class="sourceLineNo">1886</span>     * @param rsaKeyIndex<a name="line.1886"></a>
<span class="sourceLineNo">1887</span>     *            &lt;div class="zh"&gt; RSA公钥索引[1-10] &lt;/div&gt; &lt;div class="en"&gt; RSA public key index [1-10] &lt;/div&gt;<a name="line.1887"></a>
<span class="sourceLineNo">1888</span>     * @return &lt;div class="zh"&gt; {@link RSAKeyInfo} &lt;/div&gt; &lt;div class="en"&gt; {@link RSAKeyInfo}&lt;/div&gt;<a name="line.1888"></a>
<span class="sourceLineNo">1889</span>     * @throws PedDevException<a name="line.1889"></a>
<span class="sourceLineNo">1890</span>     * @since V2.03.00<a name="line.1890"></a>
<span class="sourceLineNo">1891</span>     */<a name="line.1891"></a>
<span class="sourceLineNo">1892</span>    RSAKeyInfo readRSAKey(byte rsaKeyIndex) throws PedDevException;<a name="line.1892"></a>
<span class="sourceLineNo">1893</span><a name="line.1893"></a>
<span class="sourceLineNo">1894</span>    /**<a name="line.1894"></a>
<span class="sourceLineNo">1895</span>     * &lt;div class="zh"&gt; 设定某些功能键的功能。PED 上电后,CLEAR 键的默认功能为,持卡人输入 PIN 时,按 CLEAR 键, 清除已输入的 PIN。可以通过该函数来设置 CLEAR 键的不同功能。仅支持{@link EPedType#INTERNAL} 类型。<a name="line.1895"></a>
<span class="sourceLineNo">1896</span>     * &lt;/div&gt; &lt;div class="en"&gt;The function of setting some function keys. After the PED is powered on, the default<a name="line.1896"></a>
<span class="sourceLineNo">1897</span>     * function of the CLEAR key is to press the CLEAR key to clear the incoming PIN when the cardholder enters PIN.<a name="line.1897"></a>
<span class="sourceLineNo">1898</span>     * This function can be used to set different functions of the CLEAR key. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.1898"></a>
<span class="sourceLineNo">1899</span>     *<a name="line.1899"></a>
<span class="sourceLineNo">1900</span>     * @param ucKey<a name="line.1900"></a>
<span class="sourceLineNo">1901</span>     *            &lt;div class="zh"&gt;<a name="line.1901"></a>
<span class="sourceLineNo">1902</span>     *            &lt;ul&gt;<a name="line.1902"></a>
<span class="sourceLineNo">1903</span>     *            &lt;li&gt;ucKey为0x00时，表示在已输入的PIN已经清空或者没有输入PIN时按CLEAR键的功能，PED退出输入密码状态，并返回PED_RET_ERR_INPUT_CLEAR。&lt;/li&gt;<a name="line.1903"></a>
<span class="sourceLineNo">1904</span>     *            &lt;li&gt;<a name="line.1904"></a>
<span class="sourceLineNo">1905</span>     *            ucKey为0x01时，表示调用该函数后，密码输入的接口(PedGetPinBlock、PedGetPinDukpt、PedVerifyPlainPin、PedVerifyCipherPin)<a name="line.1905"></a>
<span class="sourceLineNo">1906</span>     *            在输入PIN过程中，按下CLEAR键，逐个清除最后输入的PIN，当清空所有已输入的PIN时，不退出输入PIN函数。&lt;/li&gt;<a name="line.1906"></a>
<span class="sourceLineNo">1907</span>     *            &lt;li&gt;ucKey为0x02时，表示允许按ATM4键，结束PIN输入，对于无ATM键的机型无效。&lt;/li&gt;<a name="line.1907"></a>
<span class="sourceLineNo">1908</span>     *            &lt;li&gt;ucKey为0x03时，表示允许按功能键，结束PIN输入，对于无FN键的机型无效。&lt;/li&gt;<a name="line.1908"></a>
<span class="sourceLineNo">1909</span>     *            &lt;li&gt;ucKey为0x04时，表示没有输入PIN时按CLEAR键，PED退出输入密码状态，并返回PED_RET_ERR_INPUT_CLEAR；当有PIN输入时，按CLEAR键逐个清除最后输入的PIN，当清空所有已输入的PIN时，不退出输入PIN函数&lt;/li&gt;<a name="line.1909"></a>
<span class="sourceLineNo">1910</span>     *            &lt;li&gt;ucKey为0x05时，表示没有输入PIN时按CLEAR键，PED退出输入密码状态，并返回PED_RET_ERR_INPUT_CLEAR；当有PIN输入时，按CLEAR键会一次性全部清除所有输入的PIN，当清空所有已输入的PIN时再按CLEAR键，不退出输入PIN函数。&lt;/li&gt;<a name="line.1910"></a>
<span class="sourceLineNo">1911</span>     *            &lt;li&gt;ucKey为0x07时，表示当PIN输入达到指定个数时，无需用户手动按确认键，自动结束PIN输入。&lt;/li&gt;<a name="line.1911"></a>
<span class="sourceLineNo">1912</span>     *            &lt;li&gt;ucKey为0xff时，表示恢复功能键默认功能。&lt;/li&gt;<a name="line.1912"></a>
<span class="sourceLineNo">1913</span>     *            &lt;/ul&gt;<a name="line.1913"></a>
<span class="sourceLineNo">1914</span>     *            备注：&lt;br&gt;<a name="line.1914"></a>
<span class="sourceLineNo">1915</span>     *            （1）ucKey为0x00，0x01，0x04，0x05时，描述的是按CLEAR键的功能，只能选一种。&lt;br&gt;<a name="line.1915"></a>
<span class="sourceLineNo">1916</span>     *            （2）ucKey为0x07时，描述的是自动完成PIN输入的功能。&lt;br&gt;<a name="line.1916"></a>
<span class="sourceLineNo">1917</span>     *            （3）ucKey为0x02，0x03时，描述的是重新自定义可以结束PIN输入的按键（要看所使用的机型是否有这个按键）。&lt;br&gt;<a name="line.1917"></a>
<span class="sourceLineNo">1918</span>     *            （1），（2）和（3）这三种情况是可以同时设置起效的。比如setFunctionKey(0x00)后还可以设置setFunctionKey(0x07)。<a name="line.1918"></a>
<span class="sourceLineNo">1919</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1919"></a>
<span class="sourceLineNo">1920</span>     *            &lt;ul&gt;<a name="line.1920"></a>
<span class="sourceLineNo">1921</span>     *            &lt;li&gt;When ucKey is 0x00, it means that PED exits the input password state and returns to<a name="line.1921"></a>
<span class="sourceLineNo">1922</span>     *            PED_RET_ERR_INPUT_CLEAR when the input PIN is empty or does not enter PIN with the CLEAR key.&lt;/li&gt;<a name="line.1922"></a>
<span class="sourceLineNo">1923</span>     *            &lt;li&gt;<a name="line.1923"></a>
<span class="sourceLineNo">1924</span>     *            When ucKey is 0x01, when the function is called, the interface (PedGetPinBlock, PedGetPinDukpt,<a name="line.1924"></a>
<span class="sourceLineNo">1925</span>     *            PedVerifyPlainPin, PedVerifyCipherPin) of the password input is pressed by the CLEAR key in the input<a name="line.1925"></a>
<span class="sourceLineNo">1926</span>     *            PIN process, and the final PIN is removed one by one. When all the entered PIN are emptied, the input<a name="line.1926"></a>
<span class="sourceLineNo">1927</span>     *            PIN function is not exited.&lt;/li&gt;<a name="line.1927"></a>
<span class="sourceLineNo">1928</span>     *            &lt;li&gt;When ucKey is 0x02, it means that the ATM4 input is allowed to end the PIN input, which is invalid<a name="line.1928"></a>
<span class="sourceLineNo">1929</span>     *            for the machine without ATM key.&lt;/li&gt;<a name="line.1929"></a>
<span class="sourceLineNo">1930</span>     *            &lt;li&gt;When ucKey is 0x03, it means that the PIN input is allowed to press the function key, which is<a name="line.1930"></a>
<span class="sourceLineNo">1931</span>     *            invalid for the FN free key.&lt;/li&gt;<a name="line.1931"></a>
<span class="sourceLineNo">1932</span>     *            &lt;li&gt;When ucKey is 0x04, it means pressing CLEAR when PIN is not entered, PED exits the password input state and returns PED_RET_ERR_INPUT_CLEAR; when there is PIN input, press CLEAR key to clear the last PIN one by one, and when all the PIN input is emptied, it does not exit the input PIN function.&lt;/li&gt;<a name="line.1932"></a>
<span class="sourceLineNo">1933</span>     *            &lt;li&gt;When ucKey is 0x05, it means pressing CLEAR when PIN is not entered, PED exits the password state and returns to PED_RET_ERR_INPUT_CLEAR; when there is PIN input, pressing CLEAR key clears all input PINs at one time, and then pressing CLEAR key when all input PINs are emptied, and does not exit the input PIN function.&lt;/li&gt;<a name="line.1933"></a>
<span class="sourceLineNo">1934</span>     *            &lt;li&gt;When ucKey is 0x07, it means that when the PIN input reaches the specified number, the user does not need to manually press the confirm key, but automatically ends the PIN input.&lt;/li&gt;<a name="line.1934"></a>
<span class="sourceLineNo">1935</span>     *            &lt;li&gt;When ucKey is 0xff, it means restoring the default function of the function key.&lt;/li&gt;<a name="line.1935"></a>
<span class="sourceLineNo">1936</span>     *            &lt;/ul&gt;<a name="line.1936"></a>
<span class="sourceLineNo">1937</span>     *            Notes:&lt;br&gt;<a name="line.1937"></a>
<span class="sourceLineNo">1938</span>     *            (1)If ucKey is 0x00, 0x01, 0x04 or 0x05, it describes the function of pressing the CLEAR key. Only one function can be selected.&lt;br&gt;<a name="line.1938"></a>
<span class="sourceLineNo">1939</span>     *            (2)If ucKey is 0x07, it describes the function of automatically completing PIN input.&lt;br&gt;<a name="line.1939"></a>
<span class="sourceLineNo">1940</span>     *            (3)If ucKey is 0x02 or 0x03, it describes a button that can be re-customized to end the PIN entry (depending on whether the model you are using has this button).&lt;br&gt;<a name="line.1940"></a>
<span class="sourceLineNo">1941</span>     *            (1), (2) and (3) can be set to take effect at the same time. For example, you can call setFunctionKey(0x07) after setFunctionKey(0x00).<a name="line.1941"></a>
<span class="sourceLineNo">1942</span>     *            &lt;/div&gt;<a name="line.1942"></a>
<span class="sourceLineNo">1943</span>     * @throws PedDevException<a name="line.1943"></a>
<span class="sourceLineNo">1944</span>     * @since V3.00.00<a name="line.1944"></a>
<span class="sourceLineNo">1945</span>     */<a name="line.1945"></a>
<span class="sourceLineNo">1946</span>    void setFunctionKey(byte ucKey) throws PedDevException;<a name="line.1946"></a>
<span class="sourceLineNo">1947</span> /**<a name="line.1947"></a>
<span class="sourceLineNo">1948</span>     * &lt;div class="zh"&gt; 在PED上输入PIN，并使DUKPT的PIN密钥计算PINBlock，仅适用于type-c类外置密码键盘。&lt;/div&gt; &lt;div class="en"&gt; PINBlock Input the PIN on PED,and use<a name="line.1948"></a>
<span class="sourceLineNo">1949</span>     * the PINkey of DUKPT to calculate the PINBlock. Only for external type-c pinpad&lt;/div&gt;<a name="line.1949"></a>
<span class="sourceLineNo">1950</span>     *<a name="line.1950"></a>
<span class="sourceLineNo">1951</span>     * @param groupIndex<a name="line.1951"></a>
<span class="sourceLineNo">1952</span>     *            &lt;div class="zh"&gt; [1~100]DUKPT引擎索引, 0,1,2 &lt;/div&gt; &lt;div class="en"&gt; [1~100] DUKPT key group id， 0,1,2&lt;/div&gt;<a name="line.1952"></a>
<span class="sourceLineNo">1953</span>     *<a name="line.1953"></a>
<span class="sourceLineNo">1954</span>     * @param expPinLen<a name="line.1954"></a>
<span class="sourceLineNo">1955</span>     *            &lt;div class="zh"&gt; 4~12的枚举集合<a name="line.1955"></a>
<span class="sourceLineNo">1956</span>     *            可输入的合法密码长度字符串，应用程序把允许的密码长度全部枚举出来，并且用"，"号隔开每个长度，如允许输入4、6位密码并且允许无密码直接按确认，则该字符串应该设置为"4,6"。&lt;/div&gt;<a name="line.1956"></a>
<span class="sourceLineNo">1957</span>     *            &lt;div class="en"&gt; Enumeration of 4-12.The enter password string with<a name="line.1957"></a>
<span class="sourceLineNo">1958</span>     *            legal length. Application enumerates of all possible lengths of PIN. ","will be used to separate each number of length. &lt;/div&gt;<a name="line.1958"></a>
<span class="sourceLineNo">1959</span>     *<a name="line.1959"></a>
<span class="sourceLineNo">1960</span>     * @param dataIn<a name="line.1960"></a>
<span class="sourceLineNo">1961</span>     *            &lt;div class="zh"&gt;<a name="line.1961"></a>
<span class="sourceLineNo">1962</span>     *            &lt;ul&gt;<a name="line.1962"></a>
<span class="sourceLineNo">1963</span>     *            &lt;li&gt;dataIn指向卡号移位后生成的16位主帐号&lt;/li&gt;<a name="line.1963"></a>
<span class="sourceLineNo">1964</span>     *<a name="line.1964"></a>
<span class="sourceLineNo">1965</span>     *            &lt;/ul&gt;<a name="line.1965"></a>
<span class="sourceLineNo">1966</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1966"></a>
<span class="sourceLineNo">1967</span>     *            &lt;ul&gt;<a name="line.1967"></a>
<span class="sourceLineNo">1968</span>     *           &lt;li&gt;dataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.1968"></a>
<span class="sourceLineNo">1969</span>     *            &lt;/ul&gt;<a name="line.1969"></a>
<span class="sourceLineNo">1970</span>     *            &lt;/div&gt;<a name="line.1970"></a>
<span class="sourceLineNo">1971</span>     *<a name="line.1971"></a>
<span class="sourceLineNo">1972</span>     * @param isByPass<a name="line.1972"></a>
<span class="sourceLineNo">1973</span>     *  &lt;div class="zh"&gt;<a name="line.1973"></a>
<span class="sourceLineNo">1974</span>     *            &lt;ul&gt;<a name="line.1974"></a>
<span class="sourceLineNo">1975</span>     *            &lt;li&gt;是否允许不输入密码，true:意味着可以直接按Enter键返回&lt;/li&gt;<a name="line.1975"></a>
<span class="sourceLineNo">1976</span>     *            &lt;/ul&gt;<a name="line.1976"></a>
<span class="sourceLineNo">1977</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1977"></a>
<span class="sourceLineNo">1978</span>     *            &lt;ul&gt;<a name="line.1978"></a>
<span class="sourceLineNo">1979</span>     *           &lt;li&gt;true:means that no PIN is required, and pressing "Enter" will return.&lt;/li&gt;<a name="line.1979"></a>
<span class="sourceLineNo">1980</span>     *           &lt;/ul&gt;<a name="line.1980"></a>
<span class="sourceLineNo">1981</span>     *           &lt;/div&gt;<a name="line.1981"></a>
<span class="sourceLineNo">1982</span>     *<a name="line.1982"></a>
<span class="sourceLineNo">1983</span>     * @param msg1 &lt;div class="zh"&gt;提示1。&lt;/div&gt; &lt;div class="en"&gt;Hint 1.&lt;/div&gt;<a name="line.1983"></a>
<span class="sourceLineNo">1984</span>     *<a name="line.1984"></a>
<span class="sourceLineNo">1985</span>     * @param msg2 &lt;div class="zh"&gt;提示2。&lt;/div&gt; &lt;div class="en"&gt;Hint 2.&lt;/div&gt;<a name="line.1985"></a>
<span class="sourceLineNo">1986</span>     *<a name="line.1986"></a>
<span class="sourceLineNo">1987</span>     * @param timeoutMs<a name="line.1987"></a>
<span class="sourceLineNo">1988</span>     *            &lt;div class="zh"&gt;<a name="line.1988"></a>
<span class="sourceLineNo">1989</span>     *            &lt;p&gt;<a name="line.1989"></a>
<span class="sourceLineNo">1990</span>     *            输入PIN的超时时间,单位：毫秒 最大值为300000ms<a name="line.1990"></a>
<span class="sourceLineNo">1991</span>     *            &lt;/p&gt;<a name="line.1991"></a>
<span class="sourceLineNo">1992</span>     *            &lt;p&gt;<a name="line.1992"></a>
<span class="sourceLineNo">1993</span>     *            0:表示没有超时时间，PED不做超时控制<a name="line.1993"></a>
<span class="sourceLineNo">1994</span>     *            &lt;/p&gt;<a name="line.1994"></a>
<span class="sourceLineNo">1995</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.1995"></a>
<span class="sourceLineNo">1996</span>     *            &lt;p&gt;<a name="line.1996"></a>
<span class="sourceLineNo">1997</span>     *            The timeout of PIN entry [unit:ms] Maximum is 300000ms.<a name="line.1997"></a>
<span class="sourceLineNo">1998</span>     *            &lt;/p&gt;<a name="line.1998"></a>
<span class="sourceLineNo">1999</span>     *            &lt;p&gt;<a name="line.1999"></a>
<span class="sourceLineNo">2000</span>     *            0: No timeout time, not doing timeout control for PED.<a name="line.2000"></a>
<span class="sourceLineNo">2001</span>     *            &lt;/p&gt;<a name="line.2001"></a>
<span class="sourceLineNo">2002</span>     *            &lt;/div&gt;<a name="line.2002"></a>
<span class="sourceLineNo">2003</span>     *<a name="line.2003"></a>
<span class="sourceLineNo">2004</span>     * @return DUKPTResult {@link DUKPTResult}<a name="line.2004"></a>
<span class="sourceLineNo">2005</span>     * @throws PedDevException<a name="line.2005"></a>
<span class="sourceLineNo">2006</span>     */<a name="line.2006"></a>
<span class="sourceLineNo">2007</span>    public DUKPTResult getDUKPTPin(byte groupIndex, String expPinLen, byte[] dataIn, Boolean isByPass, String msg1, String msg2, int timeoutMs)<a name="line.2007"></a>
<span class="sourceLineNo">2008</span>            throws PedDevException;<a name="line.2008"></a>
<span class="sourceLineNo">2009</span><a name="line.2009"></a>
<span class="sourceLineNo">2010</span>    /**<a name="line.2010"></a>
<span class="sourceLineNo">2011</span>     * &lt;div class="zh"&gt; 设置PIN输入的密码键盘类型。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt; &lt;div class="en"&gt; set keyboard type. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2011"></a>
<span class="sourceLineNo">2012</span>     *<a name="line.2012"></a>
<span class="sourceLineNo">2013</span>     * @param type<a name="line.2013"></a>
<span class="sourceLineNo">2014</span>     *            &lt;div class="zh"&gt;<a name="line.2014"></a>
<span class="sourceLineNo">2015</span>     *            &lt;ul&gt;<a name="line.2015"></a>
<span class="sourceLineNo">2016</span>     *            &lt;li&gt;0:同时开启物理键盘和虚拟键盘输入&lt;/li&gt;<a name="line.2016"></a>
<span class="sourceLineNo">2017</span>     *            &lt;li&gt;1:只开启物理键盘输入&lt;/li&gt;<a name="line.2017"></a>
<span class="sourceLineNo">2018</span>     *            &lt;li&gt;2:只开启虚拟键盘输入&lt;/li&gt;<a name="line.2018"></a>
<span class="sourceLineNo">2019</span>     *            &lt;/ul&gt;<a name="line.2019"></a>
<span class="sourceLineNo">2020</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2020"></a>
<span class="sourceLineNo">2021</span>     *            &lt;ul&gt;<a name="line.2021"></a>
<span class="sourceLineNo">2022</span>     *            &lt;li&gt;0:Open physical keyboard and virtual keyboard input simultaneously.&lt;/li&gt;<a name="line.2022"></a>
<span class="sourceLineNo">2023</span>     *            &lt;li&gt;1:Only physical keyboard input is enabled.&lt;/li&gt;<a name="line.2023"></a>
<span class="sourceLineNo">2024</span>     *            &lt;li&gt;2:Open virtual keyboard input only&lt;/li&gt;<a name="line.2024"></a>
<span class="sourceLineNo">2025</span>     *            &lt;/ul&gt;<a name="line.2025"></a>
<span class="sourceLineNo">2026</span>     *            &lt;/div&gt;<a name="line.2026"></a>
<span class="sourceLineNo">2027</span>     * @throws PedDevException<a name="line.2027"></a>
<span class="sourceLineNo">2028</span>     */<a name="line.2028"></a>
<span class="sourceLineNo">2029</span>    void setKeyBoardType(int type) throws PedDevException;<a name="line.2029"></a>
<span class="sourceLineNo">2030</span><a name="line.2030"></a>
<span class="sourceLineNo">2031</span>    /**<a name="line.2031"></a>
<span class="sourceLineNo">2032</span>     * &lt;div class="zh"&gt; 获取PIN输入的密码键盘类型 。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt; get keyboard type for PIN entry. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2032"></a>
<span class="sourceLineNo">2033</span>     *<a name="line.2033"></a>
<span class="sourceLineNo">2034</span>     * @return &lt;div class="zh"&gt;<a name="line.2034"></a>
<span class="sourceLineNo">2035</span>     *         &lt;ul&gt;<a name="line.2035"></a>
<span class="sourceLineNo">2036</span>     *         &lt;li&gt;0:同时开启物理键盘和虚拟键盘输入&lt;/li&gt;<a name="line.2036"></a>
<span class="sourceLineNo">2037</span>     *         &lt;li&gt;1:只开启物理键盘输入&lt;/li&gt;<a name="line.2037"></a>
<span class="sourceLineNo">2038</span>     *         &lt;li&gt;2:只开启虚拟键盘输入&lt;/li&gt;<a name="line.2038"></a>
<span class="sourceLineNo">2039</span>     *         &lt;/ul&gt;<a name="line.2039"></a>
<span class="sourceLineNo">2040</span>     *         &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2040"></a>
<span class="sourceLineNo">2041</span>     *         &lt;ul&gt;<a name="line.2041"></a>
<span class="sourceLineNo">2042</span>     *         &lt;li&gt;0:Open physical keyboard and virtual keyboard input simultaneously.&lt;/li&gt;<a name="line.2042"></a>
<span class="sourceLineNo">2043</span>     *         &lt;li&gt;1:Only physical keyboard input is enabled.&lt;/li&gt;<a name="line.2043"></a>
<span class="sourceLineNo">2044</span>     *         &lt;li&gt;2:Open virtual keyboard input only&lt;/li&gt;<a name="line.2044"></a>
<span class="sourceLineNo">2045</span>     *         &lt;/ul&gt;<a name="line.2045"></a>
<span class="sourceLineNo">2046</span>     *         &lt;/div&gt;<a name="line.2046"></a>
<span class="sourceLineNo">2047</span>     * @throws PedDevException<a name="line.2047"></a>
<span class="sourceLineNo">2048</span>     */<a name="line.2048"></a>
<span class="sourceLineNo">2049</span>    int getKeyBoardType() throws PedDevException;<a name="line.2049"></a>
<span class="sourceLineNo">2050</span><a name="line.2050"></a>
<span class="sourceLineNo">2051</span>    /**<a name="line.2051"></a>
<span class="sourceLineNo">2052</span>     * &lt;div class="zh"&gt; 指定的时限内，扫描键盘上输入的PIN并输出PIN BLOCK加密数据块。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt; &lt;div class="en"&gt; Scan the keyboard PIN entry and<a name="line.2052"></a>
<span class="sourceLineNo">2053</span>     * output the PIN BLOCK encrypted data block in a specific time. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2053"></a>
<span class="sourceLineNo">2054</span>     *<a name="line.2054"></a>
<span class="sourceLineNo">2055</span>     *<a name="line.2055"></a>
<span class="sourceLineNo">2056</span>     * @param keyIdx<a name="line.2056"></a>
<span class="sourceLineNo">2057</span>     *            &lt;div class="zh"&gt; [1~100] TPK的索引 &lt;/div&gt; &lt;div class="en"&gt; [1~100] TPK index &lt;/div&gt;<a name="line.2057"></a>
<span class="sourceLineNo">2058</span>     *<a name="line.2058"></a>
<span class="sourceLineNo">2059</span>     * @param expPinLen<a name="line.2059"></a>
<span class="sourceLineNo">2060</span>     *            &lt;div class="zh"&gt; 0~12的枚举集合<a name="line.2060"></a>
<span class="sourceLineNo">2061</span>     *            可输入的合法密码长度字符串，应用程序把允许的密码长度全部枚举出来，并且用"，"号隔开每个长度，如允许输入4、6位密码并且允许无密码直接按确认，则该字符串应该设置为"0,4,6"。<a name="line.2061"></a>
<span class="sourceLineNo">2062</span>     *            若枚举0长度则示意可以不输任何数字而直接按确认键返回。<a name="line.2062"></a>
<span class="sourceLineNo">2063</span>     *            &lt;p&gt;<a name="line.2063"></a>
<span class="sourceLineNo">2064</span>     *             若枚举长度存在无效值，则忽略无效值。若输入长度超过设置长度，则忽略超出的输入。<a name="line.2064"></a>
<span class="sourceLineNo">2065</span>     *            &lt;/p&gt;<a name="line.2065"></a>
<span class="sourceLineNo">2066</span>     *            &lt;p&gt;<a name="line.2066"></a>
<span class="sourceLineNo">2067</span>     *            当mode=0x05的时候，该参数为"5"<a name="line.2067"></a>
<span class="sourceLineNo">2068</span>     *            &lt;/p&gt;<a name="line.2068"></a>
<span class="sourceLineNo">2069</span>     *            &lt;/div&gt; &lt;div class="en"&gt; Enumeration of 0-12.The enter password string with legal length. Application<a name="line.2069"></a>
<span class="sourceLineNo">2070</span>     *            enumerates of all possible lengths of PIN. ","will be used to separate each number of length. If no<a name="line.2070"></a>
<span class="sourceLineNo">2071</span>     *            PIN,or 4 or 6 digits of PIN are allowed, the string will be set as "0,4,6". 0 means that no PIN is<a name="line.2071"></a>
<span class="sourceLineNo">2072</span>     *            required, and pressing "Enter" will return.<a name="line.2072"></a>
<span class="sourceLineNo">2073</span>     *            &lt;p&gt;<a name="line.2073"></a>
<span class="sourceLineNo">2074</span>     *             If there is an invalid value in the enumeration length, the invalid value will be ignored.<a name="line.2074"></a>
<span class="sourceLineNo">2075</span>     *             If the input length exceeds the set length, the excess input will be ignored.<a name="line.2075"></a>
<span class="sourceLineNo">2076</span>     *            &lt;/p&gt;<a name="line.2076"></a>
<span class="sourceLineNo">2077</span>     *            &lt;p&gt;<a name="line.2077"></a>
<span class="sourceLineNo">2078</span>     *            When mode=0x05，it should be "5"<a name="line.2078"></a>
<span class="sourceLineNo">2079</span>     *            &lt;/p&gt;<a name="line.2079"></a>
<span class="sourceLineNo">2080</span>     *            &lt;/div&gt;<a name="line.2080"></a>
<span class="sourceLineNo">2081</span>     *<a name="line.2081"></a>
<span class="sourceLineNo">2082</span>     * @param dataIn<a name="line.2082"></a>
<span class="sourceLineNo">2083</span>     *            &lt;div class="zh"&gt;<a name="line.2083"></a>
<span class="sourceLineNo">2084</span>     *            &lt;ul&gt;<a name="line.2084"></a>
<span class="sourceLineNo">2085</span>     *            &lt;li&gt;当mode=0x00时, DataIn指向卡号移位后生成的16位主帐号。&lt;/li&gt;<a name="line.2085"></a>
<span class="sourceLineNo">2086</span>     *            &lt;li&gt;当mode=0x01时, DataIn被忽略.接口内部采用随机数填充PINBlock。&lt;/li&gt;<a name="line.2086"></a>
<span class="sourceLineNo">2087</span>     *            &lt;li&gt;当mode=0x02时, DataIn指向位移后的16位PAN。&lt;/li&gt;<a name="line.2087"></a>
<span class="sourceLineNo">2088</span>     *            &lt;li&gt;当mode=0x05时, DataIn包含卡账号和CCS数据，格式为PANlen(1个字节) + CCSlen（1个字节） + PAN（PANlen个字节） +<a name="line.2088"></a>
<span class="sourceLineNo">2089</span>     *            CCS（CCSlen个字节）。其中PAN为卡账号（ASCII码），目前限定PANlen必须为18，CCSlen必须为0或者8，CCS为ASCII码格式。&lt;/li&gt;<a name="line.2089"></a>
<span class="sourceLineNo">2090</span>     *            &lt;li&gt;当mode=0x14时，DataIn为原始主帐号。&lt;/li&gt;<a name="line.2090"></a>
<span class="sourceLineNo">2091</span>     *            &lt;/ul&gt;<a name="line.2091"></a>
<span class="sourceLineNo">2092</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2092"></a>
<span class="sourceLineNo">2093</span>     *            &lt;ul&gt;<a name="line.2093"></a>
<span class="sourceLineNo">2094</span>     *            &lt;li&gt;When mode=0x00, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.2094"></a>
<span class="sourceLineNo">2095</span>     *            &lt;li&gt;When mode=0x01, DataIn is ignored. The interface uses random numbers to fill PINBlock internally.&lt;/li&gt;<a name="line.2095"></a>
<span class="sourceLineNo">2096</span>     *            &lt;li&gt;When mode=0x02, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.2096"></a>
<span class="sourceLineNo">2097</span>     *            &lt;li&gt;When mode=0x03, dataIn is ISN [6 Bytes, ASCII code]&lt;/li&gt;<a name="line.2097"></a>
<span class="sourceLineNo">2098</span>     *            &lt;li&gt;When mode=0x05, DataIn contains card account and CCS data. The format is PANlen (1 bytes) + CCSlen<a name="line.2098"></a>
<span class="sourceLineNo">2099</span>     *            (1 bytes) + PAN (PANlen byte) + CCS (CCSlen byte). In which PAN is a card account (ASCII code), the<a name="line.2099"></a>
<span class="sourceLineNo">2100</span>     *            current limited PANlen must be 18, CCSlen must be 0 or 8, CCS is ASCII code format.&lt;/li&gt;<a name="line.2100"></a>
<span class="sourceLineNo">2101</span>     *            &lt;li&gt;When mode=0x14, DataIn is the original primary account.&lt;/li&gt;<a name="line.2101"></a>
<span class="sourceLineNo">2102</span>     *            &lt;/ul&gt;<a name="line.2102"></a>
<span class="sourceLineNo">2103</span>     *            &lt;/div&gt;<a name="line.2103"></a>
<span class="sourceLineNo">2104</span>     *<a name="line.2104"></a>
<span class="sourceLineNo">2105</span>     * @param mode<a name="line.2105"></a>
<span class="sourceLineNo">2106</span>     *            &lt;div class="zh"&gt; PIN BLOCK的格式<a name="line.2106"></a>
<span class="sourceLineNo">2107</span>     *            &lt;ul&gt;<a name="line.2107"></a>
<span class="sourceLineNo">2108</span>     *            &lt;li&gt;0x00:ISO9564_0&lt;/li&gt;<a name="line.2108"></a>
<span class="sourceLineNo">2109</span>     *            &lt;li&gt;0x01:ISO9564_1&lt;/li&gt;<a name="line.2109"></a>
<span class="sourceLineNo">2110</span>     *            &lt;li&gt;0x02:ISO9564_3&lt;/li&gt;<a name="line.2110"></a>
<span class="sourceLineNo">2111</span>     *            &lt;li&gt;0x03:HK EPS&lt;/li&gt;<a name="line.2111"></a>
<span class="sourceLineNo">2112</span>     *            &lt;li&gt;0x04:预留&lt;/li&gt;<a name="line.2112"></a>
<span class="sourceLineNo">2113</span>     *            &lt;li&gt;0x05:Italy 专用模式&lt;/li&gt;<a name="line.2113"></a>
<span class="sourceLineNo">2114</span>     *            &lt;li&gt;0x11:使用AES_TPK加密,pinblock是日本的hit特殊模式&lt;/li&gt;<a name="line.2114"></a>
<span class="sourceLineNo">2115</span>     *            &lt;li&gt;0x12:使用AES_TPK加密,pinblock是日本的PKCS7模式&lt;/li&gt;<a name="line.2115"></a>
<span class="sourceLineNo">2116</span>     *            &lt;li&gt;0x14:使用AES_TPK加密,pinblock是ISO9564 格式4&lt;/li&gt;<a name="line.2116"></a>
<span class="sourceLineNo">2117</span>     *            &lt;li&gt;0x50:3DES-CBC&lt;/li&gt;<a name="line.2117"></a>
<span class="sourceLineNo">2118</span>     *            &lt;/ul&gt;<a name="line.2118"></a>
<span class="sourceLineNo">2119</span>     *            &lt;/div&gt; &lt;div class="en"&gt; PIN BLOCK Format<a name="line.2119"></a>
<span class="sourceLineNo">2120</span>     *            &lt;ul&gt;<a name="line.2120"></a>
<span class="sourceLineNo">2121</span>     *            &lt;li&gt;0x00:ISO9564_0&lt;/li&gt;<a name="line.2121"></a>
<span class="sourceLineNo">2122</span>     *            &lt;li&gt;0x01:ISO9564_1&lt;/li&gt;<a name="line.2122"></a>
<span class="sourceLineNo">2123</span>     *            &lt;li&gt;0x02:ISO9564_3&lt;/li&gt;<a name="line.2123"></a>
<span class="sourceLineNo">2124</span>     *            &lt;li&gt;0x03:HK EPS -EPS PINBLOCK Format&lt;/li&gt;<a name="line.2124"></a>
<span class="sourceLineNo">2125</span>     *            &lt;li&gt;0x04:Reserved&lt;/li&gt;<a name="line.2125"></a>
<span class="sourceLineNo">2126</span>     *            &lt;li&gt;0x05:Italy special mode&lt;/li&gt;<a name="line.2126"></a>
<span class="sourceLineNo">2127</span>     *            &lt;li&gt;0x11:Using AES_TPK encryption, pinblock is Japan's hit special mode&lt;/li&gt;<a name="line.2127"></a>
<span class="sourceLineNo">2128</span>     *            &lt;li&gt;0x12:Using AES_TPK encryption, pinblock is Japan's PKCS7 mode&lt;/li&gt;<a name="line.2128"></a>
<span class="sourceLineNo">2129</span>     *            &lt;li&gt;0x14:Using AES_TPK encryption, pinblock is in ISO9564 format 4&lt;/li&gt;<a name="line.2129"></a>
<span class="sourceLineNo">2130</span>     *            &lt;li&gt;0x50:3DES-CBC&lt;/li&gt;<a name="line.2130"></a>
<span class="sourceLineNo">2131</span>     *            &lt;/ul&gt;<a name="line.2131"></a>
<span class="sourceLineNo">2132</span>     *            &lt;/div&gt;<a name="line.2132"></a>
<span class="sourceLineNo">2133</span>     *<a name="line.2133"></a>
<span class="sourceLineNo">2134</span>     * @param timeoutMs<a name="line.2134"></a>
<span class="sourceLineNo">2135</span>     *            &lt;div class="zh"&gt;<a name="line.2135"></a>
<span class="sourceLineNo">2136</span>     *            &lt;p&gt;<a name="line.2136"></a>
<span class="sourceLineNo">2137</span>     *            输入PIN的超时时间,单位：毫秒 最大值为300000ms<a name="line.2137"></a>
<span class="sourceLineNo">2138</span>     *            &lt;/p&gt;<a name="line.2138"></a>
<span class="sourceLineNo">2139</span>     *            &lt;p&gt;<a name="line.2139"></a>
<span class="sourceLineNo">2140</span>     *            0:表示没有超时时间，PED不做超时控制<a name="line.2140"></a>
<span class="sourceLineNo">2141</span>     *            &lt;/p&gt;<a name="line.2141"></a>
<span class="sourceLineNo">2142</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2142"></a>
<span class="sourceLineNo">2143</span>     *            &lt;p&gt;<a name="line.2143"></a>
<span class="sourceLineNo">2144</span>     *            The timeout of PIN entry [unit:ms] Maximum is 300000ms.<a name="line.2144"></a>
<span class="sourceLineNo">2145</span>     *            &lt;/p&gt;<a name="line.2145"></a>
<span class="sourceLineNo">2146</span>     *            &lt;p&gt;<a name="line.2146"></a>
<span class="sourceLineNo">2147</span>     *            0: No timeout time, not doing timeout control for PED.<a name="line.2147"></a>
<span class="sourceLineNo">2148</span>     *            &lt;/p&gt;<a name="line.2148"></a>
<span class="sourceLineNo">2149</span>     *            &lt;/div&gt;<a name="line.2149"></a>
<span class="sourceLineNo">2150</span>     *<a name="line.2150"></a>
<span class="sourceLineNo">2151</span>     * @param controlTime &lt;div class="zh"&gt; 等待第二个及之后的按键的超时时间,单位：毫秒(超过30s的为30s) &lt;/div&gt;<a name="line.2151"></a>
<span class="sourceLineNo">2152</span>     *        &lt;div class="en"&gt; The time-out for waiting for the second and subsequent keys in milliseconds (30 seconds for more than 30 seconds) &lt;/div&gt;<a name="line.2152"></a>
<span class="sourceLineNo">2153</span>     *<a name="line.2153"></a>
<span class="sourceLineNo">2154</span>     * @return &lt;div class="zh"&gt; 返回pinBlock，如果bypass 返回NULL。如果mode=0x11，返回16字节数组。 &lt;/div&gt; &lt;div class="en"&gt; Return pinBlock byte array, if<a name="line.2154"></a>
<span class="sourceLineNo">2155</span>     *         bypass,return NULL. If mode=0x11,return 16 byte array.&lt;/div&gt;<a name="line.2155"></a>
<span class="sourceLineNo">2156</span>     *<a name="line.2156"></a>
<span class="sourceLineNo">2157</span>     * @throws PedDevException<a name="line.2157"></a>
<span class="sourceLineNo">2158</span>     * @since V3.02.00<a name="line.2158"></a>
<span class="sourceLineNo">2159</span>     */<a name="line.2159"></a>
<span class="sourceLineNo">2160</span>    byte[] getPinBlock(byte keyIdx, String expPinLen, byte[] dataIn, byte mode, int timeoutMs, int controlTime)throws PedDevException;<a name="line.2160"></a>
<span class="sourceLineNo">2161</span><a name="line.2161"></a>
<span class="sourceLineNo">2162</span>    /**<a name="line.2162"></a>
<span class="sourceLineNo">2163</span>     * &lt;div class="zh"&gt; 实现脱机明文PIN校验功能。获取明文PIN，然后按照应用提供的卡片命令与卡片通道号，将明文PIN BLOCK直接发送给卡片(PIN BLOCK格式在用法部分描述)。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt; &lt;div<a name="line.2163"></a>
<span class="sourceLineNo">2164</span>     * class="en"&gt; Achieve the function of verifying plaintext offline PIN. Get plaintext PIN and then Send plaintext<a name="line.2164"></a>
<span class="sourceLineNo">2165</span>     * PIN BLOCK to card according to card command and card slot number (PIN BLOCK format will be provided in operation<a name="line.2165"></a>
<span class="sourceLineNo">2166</span>     * part.). {@link EPedType#INTERNAL} only is supported. &lt;/div&gt;<a name="line.2166"></a>
<span class="sourceLineNo">2167</span>     *<a name="line.2167"></a>
<span class="sourceLineNo">2168</span>     * @param slot<a name="line.2168"></a>
<span class="sourceLineNo">2169</span>     *            &lt;div class="zh"&gt; 卡片所在的卡座号 &lt;/div&gt; &lt;div class="en"&gt; card slot number &lt;/div&gt;<a name="line.2169"></a>
<span class="sourceLineNo">2170</span>     *<a name="line.2170"></a>
<span class="sourceLineNo">2171</span>     * @param expPinLen<a name="line.2171"></a>
<span class="sourceLineNo">2172</span>     *            &lt;div class="zh"&gt; 0~12的枚举集合 可输入的合法密码长度字符串，应用程序把允许的密 码长度全部枚举出来，并且用","号隔开每个长度， 如允许输入4、6位密码并且允许无密码直接按确认，<a name="line.2172"></a>
<span class="sourceLineNo">2173</span>     *            则该字符串应该设置为"0,4,6" &lt;/div&gt; &lt;div class="en"&gt; Enumeration of 0-12.The enter password string with legal<a name="line.2173"></a>
<span class="sourceLineNo">2174</span>     *            length. Application enumerates all possible lengths of PIN. ‘,’ will be used to separate each number<a name="line.2174"></a>
<span class="sourceLineNo">2175</span>     *            of length. If 4 or 6 digits of PIN are allowed and it is also allowed to press ‘Enter’ without PIN<a name="line.2175"></a>
<span class="sourceLineNo">2176</span>     *            .Then this string should be set as ‘0, 4, and 6’. &lt;/div&gt;<a name="line.2176"></a>
<span class="sourceLineNo">2177</span>     *<a name="line.2177"></a>
<span class="sourceLineNo">2178</span>     * @param mode &lt;div class="zh"&gt;<a name="line.2178"></a>
<span class="sourceLineNo">2179</span>     *              &lt;ul&gt;<a name="line.2179"></a>
<span class="sourceLineNo">2180</span>     *                  &lt;li&gt;0x00: I C卡命令模式，现支持符合EMV2000的IC卡命令。&lt;/li&gt;<a name="line.2180"></a>
<span class="sourceLineNo">2181</span>     *                  &lt;li&gt;0x01: 给WIC使用。&lt;/li&gt;<a name="line.2181"></a>
<span class="sourceLineNo">2182</span>     *              &lt;/ul&gt;<a name="line.2182"></a>
<span class="sourceLineNo">2183</span>     *             &lt;/div&gt;<a name="line.2183"></a>
<span class="sourceLineNo">2184</span>     *             &lt;div class="en"&gt;<a name="line.2184"></a>
<span class="sourceLineNo">2185</span>     *              &lt;ul&gt;<a name="line.2185"></a>
<span class="sourceLineNo">2186</span>     *                  &lt;li&gt;0x00: IC Card Command Mode,Currently support EMV2000.&lt;/li&gt;<a name="line.2186"></a>
<span class="sourceLineNo">2187</span>     *                  &lt;li&gt;0x01: For WIC.&lt;/li&gt;<a name="line.2187"></a>
<span class="sourceLineNo">2188</span>     *              &lt;/ul&gt;<a name="line.2188"></a>
<span class="sourceLineNo">2189</span>     *             &lt;/div&gt;<a name="line.2189"></a>
<span class="sourceLineNo">2190</span>     *<a name="line.2190"></a>
<span class="sourceLineNo">2191</span>     * @param timeoutMs<a name="line.2191"></a>
<span class="sourceLineNo">2192</span>     *            &lt;div class="zh"&gt; 输入PIN的超时时间，单位：毫秒 最大值为300000ms &lt;/div&gt; &lt;div class="en"&gt; The timeout of PIN entry<a name="line.2192"></a>
<span class="sourceLineNo">2193</span>     *            [ms],Maximum is 300000ms. &lt;/div&gt;<a name="line.2193"></a>
<span class="sourceLineNo">2194</span>     *<a name="line.2194"></a>
<span class="sourceLineNo">2195</span>     * @param controlTime &lt;div class="zh"&gt; 等待第二个及之后的按键的超时时间,单位：毫秒(超过30s的为30s) &lt;/div&gt;<a name="line.2195"></a>
<span class="sourceLineNo">2196</span>     *        &lt;div class="en"&gt; The time-out for waiting for the second and subsequent keys in milliseconds (30 seconds for more than 30 seconds) &lt;/div&gt;<a name="line.2196"></a>
<span class="sourceLineNo">2197</span>     *<a name="line.2197"></a>
<span class="sourceLineNo">2198</span>     * @return &lt;div class="zh"&gt; 卡片响应的状态码 (2字节：SW1+SW2) &lt;/div&gt; &lt;div class="en"&gt; The status code of card response (2<a name="line.2198"></a>
<span class="sourceLineNo">2199</span>     *         bytes: SW1+SW2). &lt;/div&gt;<a name="line.2199"></a>
<span class="sourceLineNo">2200</span>     *<a name="line.2200"></a>
<span class="sourceLineNo">2201</span>     * @throws PedDevException<a name="line.2201"></a>
<span class="sourceLineNo">2202</span>     *<a name="line.2202"></a>
<span class="sourceLineNo">2203</span>     * @since V3.02.00<a name="line.2203"></a>
<span class="sourceLineNo">2204</span>     */<a name="line.2204"></a>
<span class="sourceLineNo">2205</span>    byte[] verifyPlainPin(byte slot, String expPinLen, byte mode, int timeoutMs, int controlTime)throws PedDevException;<a name="line.2205"></a>
<span class="sourceLineNo">2206</span><a name="line.2206"></a>
<span class="sourceLineNo">2207</span>    /**<a name="line.2207"></a>
<span class="sourceLineNo">2208</span>     * &lt;div class="zh"&gt; 实现脱机密文PIN校验功能。先获取明文PIN，再用应用提供的RsaPinKey对明文PIN按照EMV规范进行加密，然后用应用提供的卡片命令与卡片通道号，将密文PIN直接发送给卡片 。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.2208"></a>
<span class="sourceLineNo">2209</span>     * &lt;div class="en"&gt; Verify enciphered PIN offline. Get plain text PIN and then use RsaPinKey provided by application<a name="line.2209"></a>
<span class="sourceLineNo">2210</span>     * to encrypt plaintext PIN according to EMV standard. Send enciphered PIN to card according to card command and<a name="line.2210"></a>
<span class="sourceLineNo">2211</span>     * card channel number provided by application. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2211"></a>
<span class="sourceLineNo">2212</span>     *<a name="line.2212"></a>
<span class="sourceLineNo">2213</span>     * @param slot<a name="line.2213"></a>
<span class="sourceLineNo">2214</span>     *            &lt;div class="zh"&gt; 卡片所在的卡座号 &lt;/div&gt; &lt;div class="en"&gt; card slot number &lt;/div&gt;<a name="line.2214"></a>
<span class="sourceLineNo">2215</span>     *<a name="line.2215"></a>
<span class="sourceLineNo">2216</span>     * @param expPinLen<a name="line.2216"></a>
<span class="sourceLineNo">2217</span>     *            &lt;div class="zh"&gt; 0~12的枚举集合 可输入的合法密码长度字符串，应用程序把允许的密 码长度全部枚举出来，并且用","号隔开每个长度， 如允许输入4、6位密码并且允许无密码直接按确认，<a name="line.2217"></a>
<span class="sourceLineNo">2218</span>     *            则该字符串应该设置为"0,4,6" &lt;/div&gt; &lt;div class="en"&gt; Enumeration of 0-12.The enter password string with legal<a name="line.2218"></a>
<span class="sourceLineNo">2219</span>     *            length. Application enumerates all possible lengths of PIN. ‘,’ will be used to separate each number<a name="line.2219"></a>
<span class="sourceLineNo">2220</span>     *            of length. If 4 or 6 digits of PIN are allowed and it is also allowed to press ‘Enter’ without PIN<a name="line.2220"></a>
<span class="sourceLineNo">2221</span>     *            .Then this string should be set as ‘0, 4, and 6’. &lt;/div&gt;<a name="line.2221"></a>
<span class="sourceLineNo">2222</span>     *<a name="line.2222"></a>
<span class="sourceLineNo">2223</span>     *<a name="line.2223"></a>
<span class="sourceLineNo">2224</span>     * @param rsaPinKey<a name="line.2224"></a>
<span class="sourceLineNo">2225</span>     *            {@link RSAPinKey}<a name="line.2225"></a>
<span class="sourceLineNo">2226</span>     * @param mode<a name="line.2226"></a>
<span class="sourceLineNo">2227</span>     *            &lt;div class="zh"&gt; 0x00 IC卡命令模式，目前支持EMV2000。 &lt;/div&gt; &lt;div class="en"&gt; 0x00 IC Card Command Mode,Currently<a name="line.2227"></a>
<span class="sourceLineNo">2228</span>     *            support EMV2000. &lt;/div&gt;<a name="line.2228"></a>
<span class="sourceLineNo">2229</span>     *<a name="line.2229"></a>
<span class="sourceLineNo">2230</span>     * @param timeoutMs<a name="line.2230"></a>
<span class="sourceLineNo">2231</span>     *            &lt;div class="zh"&gt; 输入PIN的超时时间，单位：毫秒 最大值为300000ms &lt;/div&gt; &lt;div class="en"&gt; The timeout of PIN input<a name="line.2231"></a>
<span class="sourceLineNo">2232</span>     *            [unit:ms].Maximum is 300000Ms. &lt;/div&gt;<a name="line.2232"></a>
<span class="sourceLineNo">2233</span>     *<a name="line.2233"></a>
<span class="sourceLineNo">2234</span>     * @param controlTime &lt;div class="zh"&gt; 等待第二个及之后的按键的超时时间,单位：毫秒(超过30s的为30s) &lt;/div&gt;<a name="line.2234"></a>
<span class="sourceLineNo">2235</span>     *        &lt;div class="en"&gt; The time-out for waiting for the second and subsequent keys in milliseconds (30 seconds for more than 30 seconds) &lt;/div&gt;<a name="line.2235"></a>
<span class="sourceLineNo">2236</span>     *<a name="line.2236"></a>
<span class="sourceLineNo">2237</span>     * @return &lt;div class="zh"&gt; 卡片响应的状态码 (2字节：SW1+SW2) &lt;/div&gt; &lt;div class="en"&gt; The card response code (2 bytes:SW1 and<a name="line.2237"></a>
<span class="sourceLineNo">2238</span>     *         SW2) &lt;/div&gt;<a name="line.2238"></a>
<span class="sourceLineNo">2239</span>     *<a name="line.2239"></a>
<span class="sourceLineNo">2240</span>     * @throws PedDevException<a name="line.2240"></a>
<span class="sourceLineNo">2241</span>     *<a name="line.2241"></a>
<span class="sourceLineNo">2242</span>     * @since V3.02.00<a name="line.2242"></a>
<span class="sourceLineNo">2243</span>     */<a name="line.2243"></a>
<span class="sourceLineNo">2244</span>    byte[] verifyCipherPin(byte slot, String expPinLen, RSAPinKey rsaPinKey, byte mode, int timeoutMs, int controlTime)throws PedDevException;<a name="line.2244"></a>
<span class="sourceLineNo">2245</span><a name="line.2245"></a>
<span class="sourceLineNo">2246</span>    /**<a name="line.2246"></a>
<span class="sourceLineNo">2247</span>     * &lt;div class="zh"&gt; 设置定制的Pin输入键盘布局  ,调用此方法前，需保证传入的View已绘制完成，<a name="line.2247"></a>
<span class="sourceLineNo">2248</span>     *  如Activity.onWindowFocusChanged(boolean hasFocus),hasFocus=true时，调用此方法。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.2248"></a>
<span class="sourceLineNo">2249</span>     * &lt;div class="en"&gt;Set the custom Pin input keyboard layout,This method is called before,<a name="line.2249"></a>
<span class="sourceLineNo">2250</span>     *  need to ensure that the incoming View has been mapped, such as Activity.onWindowFocusChanged (Boolean hasFocus),<a name="line.2250"></a>
<span class="sourceLineNo">2251</span>     *  when hasFocus equals true, this method is called. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2251"></a>
<span class="sourceLineNo">2252</span>     *<a name="line.2252"></a>
<span class="sourceLineNo">2253</span>     * @param isOnce<a name="line.2253"></a>
<span class="sourceLineNo">2254</span>     *            &lt;div class="zh"&gt; true:单次有效 false:重启机器前有效 &lt;/div&gt;<a name="line.2254"></a>
<span class="sourceLineNo">2255</span>     *            &lt;div class="en"&gt;true:single effect false:effective before restarting the device&lt;/div&gt;<a name="line.2255"></a>
<span class="sourceLineNo">2256</span>     *<a name="line.2256"></a>
<span class="sourceLineNo">2257</span>     * @param keyboardInputs &lt;div class="zh"&gt;键盘集合。注意：数字键必须按照键盘布局从左到右，从上到下的顺序加入Map。<a name="line.2257"></a>
<span class="sourceLineNo">2258</span>     *                      Map.Key:键实例，Map.value:表示键类型，NUM表示数字键，CLEAR表示清除键，ENTER表示确认键，CANCEL表示取消键&lt;/div&gt;<a name="line.2258"></a>
<span class="sourceLineNo">2259</span>     *                      &lt;div class="en"&gt;Keyboard set. Note: The numeric keys MUST be added to the map in order(from left to right, top to bottom),<a name="line.2259"></a>
<span class="sourceLineNo">2260</span>     *                      according to the keyboard layout. Map.key: Key instance, Map.value: represents Key type, NUM represents number Key,<a name="line.2260"></a>
<span class="sourceLineNo">2261</span>     *                      CLEAR represents CLEAR Key, ENTER represents confirm Key, and CANCEL represents CANCEL Key&lt;/div&gt;<a name="line.2261"></a>
<span class="sourceLineNo">2262</span>     *<a name="line.2262"></a>
<span class="sourceLineNo">2263</span>     * @return &lt;div class="zh"&gt; 数字键盘的顺序，为10个字节byte数组 &lt;/div&gt; &lt;div class="en"&gt;numeric keypad order, 10 byte array&lt;/div&gt;<a name="line.2263"></a>
<span class="sourceLineNo">2264</span>     *<a name="line.2264"></a>
<span class="sourceLineNo">2265</span>     * @throws PedDevException<a name="line.2265"></a>
<span class="sourceLineNo">2266</span>     */<a name="line.2266"></a>
<span class="sourceLineNo">2267</span>    public byte[] setKeyBoardLayout(boolean isOnce, LinkedHashMap&lt;View, String&gt; keyboardInputs) throws PedDevException;<a name="line.2267"></a>
<span class="sourceLineNo">2268</span><a name="line.2268"></a>
<span class="sourceLineNo">2269</span>    /**<a name="line.2269"></a>
<span class="sourceLineNo">2270</span>     * &lt;div class="zh"&gt;注入TIK。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Injection of TIK. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2270"></a>
<span class="sourceLineNo">2271</span>     *<a name="line.2271"></a>
<span class="sourceLineNo">2272</span>     * @param kbpkType &lt;div class="zh"&gt;KBPK类型  0x01:TLK,0x02:TMK&lt;/div&gt; &lt;div class="en"&gt;KBPK type. 0x01:TLK,0x02:TMK&lt;/div&gt;<a name="line.2272"></a>
<span class="sourceLineNo">2273</span>     *<a name="line.2273"></a>
<span class="sourceLineNo">2274</span>     * @param kbpkIndex &lt;div class="zh"&gt;KBPK索引  当kbpkType=0x01,kbpkIndex=1;当kbpkType=0x02,kbpkIndex=[1-100]&lt;/div&gt;<a name="line.2274"></a>
<span class="sourceLineNo">2275</span>     *                  &lt;div class="en"&gt;KBPK index.if kbpkType=0x01,kbpkIndex=1.if kbpkType=0x02,kbpkIndex=[1-100]&lt;/div&gt;<a name="line.2275"></a>
<span class="sourceLineNo">2276</span>     *<a name="line.2276"></a>
<span class="sourceLineNo">2277</span>     * @param groupIndex &lt;div class="zh"&gt;DUKPT密钥组索引号 [1~100]&lt;/div&gt; &lt;div class="en"&gt;DUKPT key group index number [1~100]&lt;/div&gt;<a name="line.2277"></a>
<span class="sourceLineNo">2278</span>     *<a name="line.2278"></a>
<span class="sourceLineNo">2279</span>     * @param TR31keyBlock &lt;div class="zh"&gt;TR-31 Key Block&lt;/div&gt; &lt;div class="en"&gt;TR-31 Key Block&lt;/div&gt;<a name="line.2279"></a>
<span class="sourceLineNo">2280</span>     *<a name="line.2280"></a>
<span class="sourceLineNo">2281</span>     * @throws PedDevException<a name="line.2281"></a>
<span class="sourceLineNo">2282</span>     *<a name="line.2282"></a>
<span class="sourceLineNo">2283</span>     * @since V3.06.00<a name="line.2283"></a>
<span class="sourceLineNo">2284</span>     */<a name="line.2284"></a>
<span class="sourceLineNo">2285</span>    void writeTIK(byte kbpkType, byte kbpkIndex, byte groupIndex, byte[] TR31keyBlock) throws PedDevException;<a name="line.2285"></a>
<span class="sourceLineNo">2286</span><a name="line.2286"></a>
<span class="sourceLineNo">2287</span>    /**<a name="line.2287"></a>
<span class="sourceLineNo">2288</span>     * &lt;div class="zh"&gt; 写入一个密钥，包括TLK，TMK和TWK的写入、发散，并可以选择使用KCV验证密钥正确性。Pax Tech Iberia SL客户定制。<a name="line.2288"></a>
<span class="sourceLineNo">2289</span>     * &lt;p&gt;<a name="line.2289"></a>
<span class="sourceLineNo">2290</span>     * 当写入PED_TLK时，PED首先格式化，清除所有已经下载的密钥，再写入PED_TLK。 明文写入密钥时，srcKeyIndex=0 对于外置A类密键只能写入明文的主密钥和DES密钥，且下载密文TPK，TAK时不校验<a name="line.2290"></a>
<span class="sourceLineNo">2291</span>     * 对于外置A类PED需要调用setExMode设置exMode {@link IPed#setExMode}， exMode默认为-1，表示写入的密钥密钥均为16字节，写入TPK TAK采用主密钥解密的方式 。<a name="line.2291"></a>
<span class="sourceLineNo">2292</span>     * 支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。<a name="line.2292"></a>
<span class="sourceLineNo">2293</span>     * &lt;/p&gt;<a name="line.2293"></a>
<span class="sourceLineNo">2294</span>     * &lt;/div&gt;<a name="line.2294"></a>
<span class="sourceLineNo">2295</span>     * &lt;div class="en"&gt; Write in one key includes write in and divergent of TLK, TMK and TWK. And use KCV to check the<a name="line.2295"></a>
<span class="sourceLineNo">2296</span>     * key correction. For Pax Tech Iberia SL.<a name="line.2296"></a>
<span class="sourceLineNo">2297</span>     * &lt;p&gt;<a name="line.2297"></a>
<span class="sourceLineNo">2298</span>     * When write PED_TLK,PED will format ,clear all the key has been downloaded,then write in PED_TLK. Writing the<a name="line.2298"></a>
<span class="sourceLineNo">2299</span>     * plaintext into a key, when scrKeyIndex=0,need to call function setExMode {@link IPed#setExMode} for external pad.<a name="line.2299"></a>
<span class="sourceLineNo">2300</span>     * External srcKeyType A can only write the main key and the DES key of plaintext. And it will not check when<a name="line.2300"></a>
<span class="sourceLineNo">2301</span>     * downloading cryptograph TPK and TAK.<a name="line.2301"></a>
<span class="sourceLineNo">2302</span>     * {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported.<a name="line.2302"></a>
<span class="sourceLineNo">2303</span>     * &lt;/p&gt;<a name="line.2303"></a>
<span class="sourceLineNo">2304</span>     * &lt;/div&gt;<a name="line.2304"></a>
<span class="sourceLineNo">2305</span>     *<a name="line.2305"></a>
<span class="sourceLineNo">2306</span>     * @param srcKeyType<a name="line.2306"></a>
<span class="sourceLineNo">2307</span>     *            {@link EPedKeyType} &lt;div class="zh"&gt;<a name="line.2307"></a>
<span class="sourceLineNo">2308</span>     *            &lt;p&gt;<a name="line.2308"></a>
<span class="sourceLineNo">2309</span>     *            原密钥类型<a name="line.2309"></a>
<span class="sourceLineNo">2310</span>     *            &lt;/p&gt;<a name="line.2310"></a>
<span class="sourceLineNo">2311</span>     *            &lt;ul&gt;<a name="line.2311"></a>
<span class="sourceLineNo">2312</span>     *            &lt;li&gt;{@link EPedKeyType#TLK}&lt;/li&gt;<a name="line.2312"></a>
<span class="sourceLineNo">2313</span>     *            &lt;li&gt;{@link EPedKeyType#TMK}/{@link EPedKeyType#SM4_TMK}&lt;/li&gt;<a name="line.2313"></a>
<span class="sourceLineNo">2314</span>     *            &lt;li&gt;{@link EPedKeyType#TPK}&lt;/li&gt;<a name="line.2314"></a>
<span class="sourceLineNo">2315</span>     *            &lt;li&gt;{@link EPedKeyType#TAK}&lt;/li&gt;<a name="line.2315"></a>
<span class="sourceLineNo">2316</span>     *            &lt;li&gt;{@link EPedKeyType#TDK}&lt;/li&gt;<a name="line.2316"></a>
<span class="sourceLineNo">2317</span>     *            &lt;/ul&gt;<a name="line.2317"></a>
<span class="sourceLineNo">2318</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2318"></a>
<span class="sourceLineNo">2319</span>     *            &lt;p&gt;<a name="line.2319"></a>
<span class="sourceLineNo">2320</span>     *            Source Key Type<a name="line.2320"></a>
<span class="sourceLineNo">2321</span>     *            &lt;/p&gt;<a name="line.2321"></a>
<span class="sourceLineNo">2322</span>     *            &lt;ul&gt;<a name="line.2322"></a>
<span class="sourceLineNo">2323</span>     *            &lt;li&gt;TLK - Terminal Loading Key&lt;/li&gt;<a name="line.2323"></a>
<span class="sourceLineNo">2324</span>     *            &lt;li&gt;TMK - Terminal Master Key&lt;/li&gt;<a name="line.2324"></a>
<span class="sourceLineNo">2325</span>     *            &lt;li&gt;TPK -Transaction PIN Key&lt;/li&gt;<a name="line.2325"></a>
<span class="sourceLineNo">2326</span>     *            &lt;li&gt;TAK -Transaction Mac Key&lt;/li&gt;<a name="line.2326"></a>
<span class="sourceLineNo">2327</span>     *            &lt;li&gt;TDK -Terminal Des Key&lt;/li&gt;<a name="line.2327"></a>
<span class="sourceLineNo">2328</span>     *            &lt;/ul&gt;<a name="line.2328"></a>
<span class="sourceLineNo">2329</span>     *            &lt;/div&gt;<a name="line.2329"></a>
<span class="sourceLineNo">2330</span>     *<a name="line.2330"></a>
<span class="sourceLineNo">2331</span>     * @param srcKeyIndex<a name="line.2331"></a>
<span class="sourceLineNo">2332</span>     *            &lt;div class="zh"&gt;<a name="line.2332"></a>
<span class="sourceLineNo">2333</span>     *            &lt;p&gt;<a name="line.2333"></a>
<span class="sourceLineNo">2334</span>     *            原密钥索引<a name="line.2334"></a>
<span class="sourceLineNo">2335</span>     *            &lt;/p&gt;<a name="line.2335"></a>
<span class="sourceLineNo">2336</span>     *            &lt;ul&gt;<a name="line.2336"></a>
<span class="sourceLineNo">2337</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TLK}时, srcKeyIndex=1有效&lt;/li&gt;<a name="line.2337"></a>
<span class="sourceLineNo">2338</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TMK}/{@link EPedKeyType#SM4_TMK}/{@link EPedKeyType#TPK}<a name="line.2338"></a>
<span class="sourceLineNo">2339</span>     *            /{@link EPedKeyType#TAK}/{@link EPedKeyType#TDK}时, srcKeyIndex=[1~100]有效&lt;/li&gt;<a name="line.2339"></a>
<span class="sourceLineNo">2340</span>     *            &lt;/ul&gt;<a name="line.2340"></a>
<span class="sourceLineNo">2341</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2341"></a>
<span class="sourceLineNo">2342</span>     *            &lt;p&gt;<a name="line.2342"></a>
<span class="sourceLineNo">2343</span>     *            Source Key Index<a name="line.2343"></a>
<span class="sourceLineNo">2344</span>     *            &lt;/p&gt;<a name="line.2344"></a>
<span class="sourceLineNo">2345</span>     *            &lt;ul&gt;<a name="line.2345"></a>
<span class="sourceLineNo">2346</span>     *            &lt;li&gt;when srcKeyType=TLK, srcKeyIndex=1&lt;/li&gt;<a name="line.2346"></a>
<span class="sourceLineNo">2347</span>     *            &lt;li&gt;when srcKeyType=TMK/SM4_TMK/TPK/TAK/TDK, srcKeyIndex=[1~100]&lt;/li&gt;<a name="line.2347"></a>
<span class="sourceLineNo">2348</span>     *            &lt;/ul&gt;<a name="line.2348"></a>
<span class="sourceLineNo">2349</span>     *            &lt;/div&gt;<a name="line.2349"></a>
<span class="sourceLineNo">2350</span>     *<a name="line.2350"></a>
<span class="sourceLineNo">2351</span>     * @param destKeyType<a name="line.2351"></a>
<span class="sourceLineNo">2352</span>     *            {@link EPedKeyType} &lt;div class="zh"&gt;<a name="line.2352"></a>
<span class="sourceLineNo">2353</span>     *            &lt;p&gt;<a name="line.2353"></a>
<span class="sourceLineNo">2354</span>     *            目的密钥类型<a name="line.2354"></a>
<span class="sourceLineNo">2355</span>     *            &lt;/p&gt;<a name="line.2355"></a>
<span class="sourceLineNo">2356</span>     *            &lt;ul&gt;<a name="line.2356"></a>
<span class="sourceLineNo">2357</span>     *            &lt;li&gt;{@link EPedKeyType#TLK}&lt;/li&gt;<a name="line.2357"></a>
<span class="sourceLineNo">2358</span>     *            &lt;li&gt;{@link EPedKeyType#TMK}/{@link EPedKeyType#SM4_TMK}&lt;/li&gt;<a name="line.2358"></a>
<span class="sourceLineNo">2359</span>     *            &lt;li&gt;{@link EPedKeyType#TPK}/{@link EPedKeyType#SM4_TPK}&lt;/li&gt;<a name="line.2359"></a>
<span class="sourceLineNo">2360</span>     *            &lt;li&gt;{@link EPedKeyType#TAK}/{@link EPedKeyType#SM4_TAK}&lt;/li&gt;<a name="line.2360"></a>
<span class="sourceLineNo">2361</span>     *            &lt;li&gt;{@link EPedKeyType#TDK}/{@link EPedKeyType#SM4_TDK}&lt;/li&gt;<a name="line.2361"></a>
<span class="sourceLineNo">2362</span>     *            &lt;/ul&gt;<a name="line.2362"></a>
<span class="sourceLineNo">2363</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2363"></a>
<span class="sourceLineNo">2364</span>     *            &lt;p&gt;<a name="line.2364"></a>
<span class="sourceLineNo">2365</span>     *            Destination Key Type<a name="line.2365"></a>
<span class="sourceLineNo">2366</span>     *            &lt;/p&gt;<a name="line.2366"></a>
<span class="sourceLineNo">2367</span>     *            reference srcKeyType {@link IPed#writeKey} &lt;/div&gt;<a name="line.2367"></a>
<span class="sourceLineNo">2368</span>     *<a name="line.2368"></a>
<span class="sourceLineNo">2369</span>     * @param destkeyIndex<a name="line.2369"></a>
<span class="sourceLineNo">2370</span>     *            &lt;div class="zh"&gt;<a name="line.2370"></a>
<span class="sourceLineNo">2371</span>     *            &lt;p&gt;<a name="line.2371"></a>
<span class="sourceLineNo">2372</span>     *            目的密钥索引<a name="line.2372"></a>
<span class="sourceLineNo">2373</span>     *            &lt;/p&gt;<a name="line.2373"></a>
<span class="sourceLineNo">2374</span>     *            &lt;ul&gt;<a name="line.2374"></a>
<span class="sourceLineNo">2375</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TLK}时, destkeyIndex=1有效&lt;/li&gt;<a name="line.2375"></a>
<span class="sourceLineNo">2376</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TMK}/{@link EPedKeyType#SM4_TMK}/{@link EPedKeyType#TPK}/<a name="line.2376"></a>
<span class="sourceLineNo">2377</span>     *            {@link EPedKeyType#SM4_TPK}/{@link EPedKeyType#TAK}/{@link EPedKeyType#SM4_TAK}/<a name="line.2377"></a>
<span class="sourceLineNo">2378</span>     *            {@link EPedKeyType#TDK}/{@link EPedKeyType#SM4_TDK}时, destkeyIndex=[1~100]有效&lt;/li&gt;<a name="line.2378"></a>
<span class="sourceLineNo">2379</span>     *            &lt;/ul&gt;<a name="line.2379"></a>
<span class="sourceLineNo">2380</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2380"></a>
<span class="sourceLineNo">2381</span>     *            &lt;p&gt;<a name="line.2381"></a>
<span class="sourceLineNo">2382</span>     *            Destination Key Index<a name="line.2382"></a>
<span class="sourceLineNo">2383</span>     *            &lt;/p&gt;<a name="line.2383"></a>
<span class="sourceLineNo">2384</span>     *            reference srcKeyIndex {@link IPed#writeKey} &lt;/div&gt;<a name="line.2384"></a>
<span class="sourceLineNo">2385</span>     *<a name="line.2385"></a>
<span class="sourceLineNo">2386</span>     * @param destKeyValue<a name="line.2386"></a>
<span class="sourceLineNo">2387</span>     *            &lt;div class="zh"&gt;<a name="line.2387"></a>
<span class="sourceLineNo">2388</span>     *            &lt;p&gt;<a name="line.2388"></a>
<span class="sourceLineNo">2389</span>     *            密钥明文或密文<a name="line.2389"></a>
<span class="sourceLineNo">2390</span>     *            &lt;/p&gt;<a name="line.2390"></a>
<span class="sourceLineNo">2391</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2391"></a>
<span class="sourceLineNo">2392</span>     *            &lt;p&gt;<a name="line.2392"></a>
<span class="sourceLineNo">2393</span>     *            Cryptograph or Plaintext<a name="line.2393"></a>
<span class="sourceLineNo">2394</span>     *            &lt;/p&gt;<a name="line.2394"></a>
<span class="sourceLineNo">2395</span>     *            &lt;/div&gt;<a name="line.2395"></a>
<span class="sourceLineNo">2396</span>     *<a name="line.2396"></a>
<span class="sourceLineNo">2397</span>     * @param checkMode<a name="line.2397"></a>
<span class="sourceLineNo">2398</span>     *            {@link ECheckMode} &lt;div class="zh"&gt;<a name="line.2398"></a>
<span class="sourceLineNo">2399</span>     *            &lt;p&gt;<a name="line.2399"></a>
<span class="sourceLineNo">2400</span>     *            校验模式<a name="line.2400"></a>
<span class="sourceLineNo">2401</span>     *            &lt;/p&gt;<a name="line.2401"></a>
<span class="sourceLineNo">2402</span>     *            &lt;ul&gt;<a name="line.2402"></a>
<span class="sourceLineNo">2403</span>     *            &lt;li&gt;{@link ECheckMode#KCV_NONE}&lt;/li&gt;<a name="line.2403"></a>
<span class="sourceLineNo">2404</span>     *            &lt;li&gt;{@link ECheckMode#KCV_ENCRYPT_0}&lt;/li&gt;<a name="line.2404"></a>
<span class="sourceLineNo">2405</span>     *            &lt;li&gt;{@link ECheckMode#KCV_ENCRYPT_FIX_DATA}&lt;/li&gt;<a name="line.2405"></a>
<span class="sourceLineNo">2406</span>     *            &lt;li&gt;{@link ECheckMode#KCV_MAC_INPUT_DATA}&lt;/li&gt;<a name="line.2406"></a>
<span class="sourceLineNo">2407</span>     *            &lt;li&gt;{@link ECheckMode#KCV_SM4_ENCRYPT_0}&lt;/li&gt;<a name="line.2407"></a>
<span class="sourceLineNo">2408</span>     *            &lt;/ul&gt;<a name="line.2408"></a>
<span class="sourceLineNo">2409</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2409"></a>
<span class="sourceLineNo">2410</span>     *            &lt;p&gt;<a name="line.2410"></a>
<span class="sourceLineNo">2411</span>     *            Check Mode<a name="line.2411"></a>
<span class="sourceLineNo">2412</span>     *            &lt;/p&gt;<a name="line.2412"></a>
<span class="sourceLineNo">2413</span>     *            &lt;ul&gt;<a name="line.2413"></a>
<span class="sourceLineNo">2414</span>     *            &lt;li&gt;When checkMode=KCV_NONE -No Check&lt;/li&gt;<a name="line.2414"></a>
<span class="sourceLineNo">2415</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_0 -Perform DES/TDES encryption on 8 bytes 0x00, and use first 4 bytes<a name="line.2415"></a>
<span class="sourceLineNo">2416</span>     *            as KCV.&lt;/li&gt;<a name="line.2416"></a>
<span class="sourceLineNo">2417</span>     *<a name="line.2417"></a>
<span class="sourceLineNo">2418</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_FIX_DATA -Perform parity check first, then perform DES/TDES encryption<a name="line.2418"></a>
<span class="sourceLineNo">2419</span>     *            on 8 bytes―\x12\x34\x56\x78\x90\x12\x34\x56, and use first 4 bytes as KCV.&lt;/li&gt;<a name="line.2419"></a>
<span class="sourceLineNo">2420</span>     *<a name="line.2420"></a>
<span class="sourceLineNo">2421</span>     *            &lt;li&gt;When iCheckMode=KCV_MAC_INPUT_DATA -Send in data KcvData, use source key to perform specified mode<a name="line.2421"></a>
<span class="sourceLineNo">2422</span>     *            of MAC on [aucDesKeyValue +KcvData], and use the 8 bytes result as KCV.&lt;/li&gt;<a name="line.2422"></a>
<span class="sourceLineNo">2423</span>     *<a name="line.2423"></a>
<span class="sourceLineNo">2424</span>     *            &lt;li&gt;When iCheckMode=KCV_SM4_ENCRYPT_0 -Perform TDES encryption on 16 bytes 0x00 by SM4, and use first<a name="line.2424"></a>
<span class="sourceLineNo">2425</span>     *            4 bytes as KCV.&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;<a name="line.2425"></a>
<span class="sourceLineNo">2426</span>     *<a name="line.2426"></a>
<span class="sourceLineNo">2427</span>     * @param checkBuf<a name="line.2427"></a>
<span class="sourceLineNo">2428</span>     *            &lt;div class="zh"&gt;<a name="line.2428"></a>
<span class="sourceLineNo">2429</span>     *            &lt;p&gt;<a name="line.2429"></a>
<span class="sourceLineNo">2430</span>     *            校验数据缓冲区<a name="line.2430"></a>
<span class="sourceLineNo">2431</span>     *            &lt;/p&gt;<a name="line.2431"></a>
<span class="sourceLineNo">2432</span>     *            &lt;ul&gt;<a name="line.2432"></a>
<span class="sourceLineNo">2433</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_NONE}时 checkBuf的值无效,系统认为不验证KCV,可以为null&lt;/li&gt;<a name="line.2433"></a>
<span class="sourceLineNo">2434</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_ENCRYPT_0},4字节的kcv&lt;/li&gt;<a name="line.2434"></a>
<span class="sourceLineNo">2435</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_ENCRYPT_FIX_DATA},4字节的kcv&lt;/li&gt;<a name="line.2435"></a>
<span class="sourceLineNo">2436</span>     *            &lt;li&gt;当iCheckMode={@link ECheckMode#KCV_MAC_INPUT_DATA}时按以下规则提供checkBuf:<a name="line.2436"></a>
<span class="sourceLineNo">2437</span>     *            &lt;p&gt;<a name="line.2437"></a>
<span class="sourceLineNo">2438</span>     *            checkBuf[0]= KcvData长度(KcvDataLen)<a name="line.2438"></a>
<span class="sourceLineNo">2439</span>     *            &lt;/p&gt;<a name="line.2439"></a>
<span class="sourceLineNo">2440</span>     *            &lt;p&gt;<a name="line.2440"></a>
<span class="sourceLineNo">2441</span>     *            checkBuf+1: KcvData<a name="line.2441"></a>
<span class="sourceLineNo">2442</span>     *            &lt;/p&gt;<a name="line.2442"></a>
<span class="sourceLineNo">2443</span>     *            &lt;p&gt;<a name="line.2443"></a>
<span class="sourceLineNo">2444</span>     *            checkBuf[1+KcvDataLen]=MAC运算模式,参考{@link #getMac(byte, byte[], EPedMacMode)}中的mode参数<a name="line.2444"></a>
<span class="sourceLineNo">2445</span>     *            &lt;/p&gt;<a name="line.2445"></a>
<span class="sourceLineNo">2446</span>     *            &lt;p&gt;<a name="line.2446"></a>
<span class="sourceLineNo">2447</span>     *            checkBuf[2+KcvDataLen]=KCV长度<a name="line.2447"></a>
<span class="sourceLineNo">2448</span>     *            &lt;/p&gt;<a name="line.2448"></a>
<span class="sourceLineNo">2449</span>     *            &lt;p&gt;<a name="line.2449"></a>
<span class="sourceLineNo">2450</span>     *            checkBuf[3+KcvDataLen]是KCV的值<a name="line.2450"></a>
<span class="sourceLineNo">2451</span>     *            &lt;/p&gt;<a name="line.2451"></a>
<span class="sourceLineNo">2452</span>     *            &lt;/li&gt;<a name="line.2452"></a>
<span class="sourceLineNo">2453</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_SM4_ENCRYPT_0},4字节的kcv&lt;/li&gt;<a name="line.2453"></a>
<span class="sourceLineNo">2454</span>     *            &lt;/ul&gt;<a name="line.2454"></a>
<span class="sourceLineNo">2455</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2455"></a>
<span class="sourceLineNo">2456</span>     *            &lt;p&gt;<a name="line.2456"></a>
<span class="sourceLineNo">2457</span>     *            Check Data Buffer<a name="line.2457"></a>
<span class="sourceLineNo">2458</span>     *            &lt;/p&gt;<a name="line.2458"></a>
<span class="sourceLineNo">2459</span>     *            &lt;ul&gt;<a name="line.2459"></a>
<span class="sourceLineNo">2460</span>     *            &lt;li&gt;When checkMode=KCV_NONE -PED wont check KCV, this data is no meaning.&lt;/li&gt;<a name="line.2460"></a>
<span class="sourceLineNo">2461</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_0 -4 bytes key check value&lt;/li&gt;<a name="line.2461"></a>
<span class="sourceLineNo">2462</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_FIX_DATA -4 bytes key check value&lt;/li&gt;<a name="line.2462"></a>
<span class="sourceLineNo">2463</span>     *            &lt;li&gt;When iCheckMode=KCV_MAC_INPUT_DATA - checkBuf as follows: checkBuf[0] = length of KcvData<a name="line.2463"></a>
<span class="sourceLineNo">2464</span>     *            checkBuf+1: kcvData checkBuf[1+kcvDataLen]: MAC computation mode<a name="line.2464"></a>
<span class="sourceLineNo">2465</span>     *            {@link #getMac(byte, byte[], EPedMacMode)} checkBuf[2+kcvDataLen]:KCV length<a name="line.2465"></a>
<span class="sourceLineNo">2466</span>     *            checkBuf[3+kcvDataLen]:KCV Value&lt;/li&gt;<a name="line.2466"></a>
<span class="sourceLineNo">2467</span>     *            &lt;li&gt;When checkMode=KCV_SM4_ENCRYPT_0 -4 bytes key check value&lt;/li&gt;<a name="line.2467"></a>
<span class="sourceLineNo">2468</span>     *            &lt;/ul&gt;<a name="line.2468"></a>
<span class="sourceLineNo">2469</span>     *            &lt;/div&gt;<a name="line.2469"></a>
<span class="sourceLineNo">2470</span>     *<a name="line.2470"></a>
<span class="sourceLineNo">2471</span>     * @param keyVarIn &lt;div class="zh"&gt;由keyVarIn生成destKeyValue。&lt;/div&gt; &lt;div class="en"&gt;DestKeyValue is generated by keyVarIn.&lt;/div&gt;<a name="line.2471"></a>
<span class="sourceLineNo">2472</span>     *<a name="line.2472"></a>
<span class="sourceLineNo">2473</span>     * @param keyVarMode &lt;div class="zh"&gt;<a name="line.2473"></a>
<span class="sourceLineNo">2474</span>     *             &lt;ul&gt;<a name="line.2474"></a>
<span class="sourceLineNo">2475</span>     *             &lt;li&gt;0x00:同{@link IPed#writeKey(EPedKeyType, byte, EPedKeyType, byte, byte[], ECheckMode, byte[])}；&lt;/li&gt;<a name="line.2475"></a>
<span class="sourceLineNo">2476</span>     *             &lt;li&gt;0x01:srcKeyIndex密钥和destkeyIndex密钥的长度都必须是16字节。<a name="line.2476"></a>
<span class="sourceLineNo">2477</span>     *             srcKeyIndex对应密钥表示SrcKey，<a name="line.2477"></a>
<span class="sourceLineNo">2478</span>     *             SrcKey的左8个字节表示为SrcKey-L。SrcKey的右边8个字节表示为SrcKey-R。<a name="line.2478"></a>
<span class="sourceLineNo">2479</span>     *             keyVarIn的左8个字节表示为keyVarIn-L。右8字节的keyVarIn表示为keyVarIn-R。<a name="line.2479"></a>
<span class="sourceLineNo">2480</span>     *             K1 = SrcKey-L XOR keyVarIn-L<a name="line.2480"></a>
<span class="sourceLineNo">2481</span>     *             K2 = SrcKey-R XOR keyVarIn-L<a name="line.2481"></a>
<span class="sourceLineNo">2482</span>     *             K3 = SrcKey-L XOR keyVarIn-R<a name="line.2482"></a>
<span class="sourceLineNo">2483</span>     *             K4 = SrcKey-R XOR keyVarIn-R<a name="line.2483"></a>
<span class="sourceLineNo">2484</span>     *             使用K1K2解密destKeyValue的左8字节，然后使用K3K4解密destKeyValue的右8字节；&lt;/li&gt;<a name="line.2484"></a>
<span class="sourceLineNo">2485</span>     *             &lt;li&gt;0x02:使用OWF2算法对源密钥进行解密，解密结果存储为目标密钥； &lt;/li&gt;<a name="line.2485"></a>
<span class="sourceLineNo">2486</span>     *             &lt;li&gt;0x03:destKeyValue将由源密钥用CBC TDES算法解密并存储为目标密钥；&lt;/li&gt;<a name="line.2486"></a>
<span class="sourceLineNo">2487</span>     *             &lt;li&gt;0x04:destKeyValue将由指定的源密钥用CBC TDES算法加密并存储为目标密钥；&lt;/li&gt;<a name="line.2487"></a>
<span class="sourceLineNo">2488</span>     *             &lt;li&gt;0x05:源密钥通过3DES ECB算法加密destKeyValue得到目的密钥； &lt;/li&gt;<a name="line.2488"></a>
<span class="sourceLineNo">2489</span>     *             &lt;li&gt;0x06:源密钥通过OWF2解密destKeyValue后再异或destKeyValue得到目的密钥；&lt;/li&gt;<a name="line.2489"></a>
<span class="sourceLineNo">2490</span>     *             &lt;li&gt;0x07:源密钥通过GOWF(OWF3)模式解密destKeyValue得到目的密钥；&lt;/li&gt;<a name="line.2490"></a>
<span class="sourceLineNo">2491</span>     *             &lt;li&gt;0x09:源密钥通过APACS70 OWF模式发散destKeyValue得到目的密钥;&lt;/li&gt;<a name="line.2491"></a>
<span class="sourceLineNo">2492</span>     *             &lt;/ul&gt;<a name="line.2492"></a>
<span class="sourceLineNo">2493</span>     *             &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2493"></a>
<span class="sourceLineNo">2494</span>     *             &lt;ul&gt;<a name="line.2494"></a>
<span class="sourceLineNo">2495</span>     *             &lt;li&gt;0x00:like {@link IPed#writeKey(EPedKeyType, byte, EPedKeyType, byte, byte[], ECheckMode, byte[])};&lt;/li&gt;<a name="line.2495"></a>
<span class="sourceLineNo">2496</span>     *             &lt;li&gt;0x01:Both the srcKeyIndex key and destkeyIndex key must be 16 bytes in length.<a name="line.2496"></a>
<span class="sourceLineNo">2497</span>     *             SrcKeyIndex corresponds to the key SrcKey, and the left 8 bytes of the SrcKey are represented as Srckey-L.<a name="line.2497"></a>
<span class="sourceLineNo">2498</span>     *             The 8 bytes to the right of the SrcKey are represented as Srckey-R.<a name="line.2498"></a>
<span class="sourceLineNo">2499</span>     *             The left 8 bytes of keyVarIn are represented as keyvarin-L.The right 8-byte keyVarIn is represented as keyvarin-R.<a name="line.2499"></a>
<span class="sourceLineNo">2500</span>     *             K1 = SrcKey-L XOR keyVarIn-L<a name="line.2500"></a>
<span class="sourceLineNo">2501</span>     *             K2 = SrcKey-R XOR keyVarIn-L<a name="line.2501"></a>
<span class="sourceLineNo">2502</span>     *             K3 = SrcKey-L XOR keyVarIn-R<a name="line.2502"></a>
<span class="sourceLineNo">2503</span>     *             K4 = SrcKey-R XOR keyVarIn-R<a name="line.2503"></a>
<span class="sourceLineNo">2504</span>     *             Decrypt the left 8 bytes of destKeyValue with K1K2, and then decrypt the right 8 bytes of destKeyValue with K3K4;&lt;/li&gt;<a name="line.2504"></a>
<span class="sourceLineNo">2505</span>     *             &lt;li&gt;0x02:The source key is decrypted using the OWF2 algorithm, and the decryption result is stored as the target key;&lt;/li&gt;<a name="line.2505"></a>
<span class="sourceLineNo">2506</span>     *             &lt;li&gt;0x03:The destKeyValue will be decrypted by the source key using the CBC TDES algorithm and stored as the target key;&lt;/li&gt;<a name="line.2506"></a>
<span class="sourceLineNo">2507</span>     *             &lt;li&gt;0x04:The destKeyValue will be encrypted by the specified source key with the CBC TDES algorithm and stored as the target key;&lt;/li&gt;<a name="line.2507"></a>
<span class="sourceLineNo">2508</span>     *             &lt;li&gt;0x05:The source key uses 3DES ECB algorithm to encrypt the destKeyValue to obtain the target key;&lt;/li&gt;<a name="line.2508"></a>
<span class="sourceLineNo">2509</span>     *             &lt;li&gt;0x06:The source key uses OWF2 to decrypt the destKeyValue and then xOR destKeyValue to obtain the target key;&lt;/li&gt;<a name="line.2509"></a>
<span class="sourceLineNo">2510</span>     *             &lt;li&gt;0x07:The source key uses GOWF(OWF3) mode to decrypt the destKeyValue to obtain the target key&lt;/li&gt;<a name="line.2510"></a>
<span class="sourceLineNo">2511</span>     *             &lt;li&gt;0x09:The source key diverges destKeyValue through the APACS70 OWF mode to obtain the destination key&lt;/li&gt;<a name="line.2511"></a>
<span class="sourceLineNo">2512</span>     *             &lt;/ul&gt;<a name="line.2512"></a>
<span class="sourceLineNo">2513</span>     *             &lt;/div&gt;<a name="line.2513"></a>
<span class="sourceLineNo">2514</span>     *<a name="line.2514"></a>
<span class="sourceLineNo">2515</span>     * @throws PedDevException<a name="line.2515"></a>
<span class="sourceLineNo">2516</span>     * @since V3.08.00<a name="line.2516"></a>
<span class="sourceLineNo">2517</span>     */<a name="line.2517"></a>
<span class="sourceLineNo">2518</span>    void writeKeyEx(EPedKeyType srcKeyType, byte srcKeyIndex, EPedKeyType destKeyType, byte destkeyIndex,<a name="line.2518"></a>
<span class="sourceLineNo">2519</span>            byte[] destKeyValue, ECheckMode checkMode, byte[] checkBuf, byte[] keyVarIn, byte keyVarMode) throws PedDevException;<a name="line.2519"></a>
<span class="sourceLineNo">2520</span>    /**<a name="line.2520"></a>
<span class="sourceLineNo">2521</span>     * &lt;div class="zh"&gt;读取PAX CA证书。&lt;/div&gt; &lt;div class="en"&gt;Read the PAX CA certificate.&lt;/div&gt;<a name="line.2521"></a>
<span class="sourceLineNo">2522</span>     *<a name="line.2522"></a>
<span class="sourceLineNo">2523</span>     * @param index &lt;div class="zh"&gt;证书索引。<a name="line.2523"></a>
<span class="sourceLineNo">2524</span>     * &lt;ul&gt;<a name="line.2524"></a>
<span class="sourceLineNo">2525</span>     * &lt;li&gt;0:PAXCA_RCA_R01_IDX  &lt;/li&gt;<a name="line.2525"></a>
<span class="sourceLineNo">2526</span>     * &lt;li&gt;1:PAXCA_OCADEV01_IDX &lt;/li&gt;<a name="line.2526"></a>
<span class="sourceLineNo">2527</span>     * &lt;li&gt;2:PAXCA_OCASYS01_IDX  &lt;/li&gt;<a name="line.2527"></a>
<span class="sourceLineNo">2528</span>     * &lt;li&gt;3:PAXCA_RCA_S01_IDX  &lt;/li&gt;<a name="line.2528"></a>
<span class="sourceLineNo">2529</span>     * &lt;li&gt;4:PAXCA_OCASMDEV01_IDX  &lt;/li&gt;<a name="line.2529"></a>
<span class="sourceLineNo">2530</span>     * &lt;li&gt;5:PAXCA_OCASMSYS01_IDX &lt;/li&gt;<a name="line.2530"></a>
<span class="sourceLineNo">2531</span>     * &lt;li&gt;100:PAXCA_DA_IDX &lt;/li&gt;<a name="line.2531"></a>
<span class="sourceLineNo">2532</span>     * &lt;li&gt;101:PAXCA_DE_IDX &lt;/li&gt;<a name="line.2532"></a>
<span class="sourceLineNo">2533</span>     * &lt;li&gt;102:PAXCA_DSIG_IDX &lt;/li&gt;<a name="line.2533"></a>
<span class="sourceLineNo">2534</span>     * &lt;li&gt;103:PAXCA_DID_IDX &lt;/li&gt;<a name="line.2534"></a>
<span class="sourceLineNo">2535</span>     * &lt;li&gt;104:PAXCA_DTLS_IDX &lt;/li&gt;<a name="line.2535"></a>
<span class="sourceLineNo">2536</span>     * &lt;li&gt;105:PAXCA_DC_IDX &lt;/li&gt;<a name="line.2536"></a>
<span class="sourceLineNo">2537</span>     * &lt;li&gt;200:PAXCA_RKIAK_IDX &lt;/li&gt;<a name="line.2537"></a>
<span class="sourceLineNo">2538</span>     * &lt;/ul&gt;<a name="line.2538"></a>
<span class="sourceLineNo">2539</span>     * &lt;/div&gt;<a name="line.2539"></a>
<span class="sourceLineNo">2540</span>     * &lt;div class="en"&gt;Certificate index.<a name="line.2540"></a>
<span class="sourceLineNo">2541</span>     * &lt;ul&gt;<a name="line.2541"></a>
<span class="sourceLineNo">2542</span>     * &lt;li&gt;0:PAXCA_RCA_R01_IDX  &lt;/li&gt;<a name="line.2542"></a>
<span class="sourceLineNo">2543</span>     * &lt;li&gt;1:PAXCA_OCADEV01_IDX &lt;/li&gt;<a name="line.2543"></a>
<span class="sourceLineNo">2544</span>     * &lt;li&gt;2:PAXCA_OCASYS01_IDX  &lt;/li&gt;<a name="line.2544"></a>
<span class="sourceLineNo">2545</span>     * &lt;li&gt;3:PAXCA_RCA_S01_IDX  &lt;/li&gt;<a name="line.2545"></a>
<span class="sourceLineNo">2546</span>     * &lt;li&gt;4:PAXCA_OCASMDEV01_IDX  &lt;/li&gt;<a name="line.2546"></a>
<span class="sourceLineNo">2547</span>     * &lt;li&gt;5:PAXCA_OCASMSYS01_IDX &lt;/li&gt;<a name="line.2547"></a>
<span class="sourceLineNo">2548</span>     * &lt;li&gt;100:PAXCA_DA_IDX &lt;/li&gt;<a name="line.2548"></a>
<span class="sourceLineNo">2549</span>     * &lt;li&gt;101:PAXCA_DE_IDX &lt;/li&gt;<a name="line.2549"></a>
<span class="sourceLineNo">2550</span>     * &lt;li&gt;102:PAXCA_DSIG_IDX &lt;/li&gt;<a name="line.2550"></a>
<span class="sourceLineNo">2551</span>     * &lt;li&gt;103:PAXCA_DID_IDX &lt;/li&gt;<a name="line.2551"></a>
<span class="sourceLineNo">2552</span>     * &lt;li&gt;104:PAXCA_DTLS_IDX &lt;/li&gt;<a name="line.2552"></a>
<span class="sourceLineNo">2553</span>     * &lt;li&gt;105:PAXCA_DC_IDX &lt;/li&gt;<a name="line.2553"></a>
<span class="sourceLineNo">2554</span>     * &lt;li&gt;200:PAXCA_RKIAK_IDX &lt;/li&gt;<a name="line.2554"></a>
<span class="sourceLineNo">2555</span>     * &lt;/ul&gt;<a name="line.2555"></a>
<span class="sourceLineNo">2556</span>     * &lt;/div&gt;<a name="line.2556"></a>
<span class="sourceLineNo">2557</span>     *<a name="line.2557"></a>
<span class="sourceLineNo">2558</span>     * @return &lt;div class="zh"&gt;PAX CA证书。&lt;/div&gt; &lt;div class="en"&gt;&lt;/div&gt;<a name="line.2558"></a>
<span class="sourceLineNo">2559</span>     *<a name="line.2559"></a>
<span class="sourceLineNo">2560</span>     * @throws PedDevException<a name="line.2560"></a>
<span class="sourceLineNo">2561</span>     * @since V3.08.00<a name="line.2561"></a>
<span class="sourceLineNo">2562</span>     */<a name="line.2562"></a>
<span class="sourceLineNo">2563</span>    byte[] readPaxCA(byte index) throws PedDevException;<a name="line.2563"></a>
<span class="sourceLineNo">2564</span><a name="line.2564"></a>
<span class="sourceLineNo">2565</span>    /**<a name="line.2565"></a>
<span class="sourceLineNo">2566</span>     * &lt;div class="zh"&gt;写入一个AES密钥，并可以选择使用KCV验证密钥正确性。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt; &lt;div class="en"&gt; To write Aes key to PED, and use KCV to check the<a name="line.2566"></a>
<span class="sourceLineNo">2567</span>     * key correction. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2567"></a>
<span class="sourceLineNo">2568</span>     *<a name="line.2568"></a>
<span class="sourceLineNo">2569</span>     * @param srcKeyType<a name="line.2569"></a>
<span class="sourceLineNo">2570</span>     *            &lt;div class="zh"&gt;<a name="line.2570"></a>
<span class="sourceLineNo">2571</span>     *            &lt;p&gt;<a name="line.2571"></a>
<span class="sourceLineNo">2572</span>     *            原密钥类型。<a name="line.2572"></a>
<span class="sourceLineNo">2573</span>     *            &lt;/p&gt;<a name="line.2573"></a>
<span class="sourceLineNo">2574</span>     *            &lt;ul&gt;<a name="line.2574"></a>
<span class="sourceLineNo">2575</span>     *            &lt;li&gt;0x01:TLK.&lt;/li&gt;<a name="line.2575"></a>
<span class="sourceLineNo">2576</span>     *            &lt;li&gt;0x02:TMK.&lt;/li&gt;<a name="line.2576"></a>
<span class="sourceLineNo">2577</span>     *            &lt;li&gt;0x22:AES_TMK.&lt;/li&gt;<a name="line.2577"></a>
<span class="sourceLineNo">2578</span>     *            &lt;/ul&gt;<a name="line.2578"></a>
<span class="sourceLineNo">2579</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2579"></a>
<span class="sourceLineNo">2580</span>     *            &lt;p&gt;<a name="line.2580"></a>
<span class="sourceLineNo">2581</span>     *            Source Key Type.<a name="line.2581"></a>
<span class="sourceLineNo">2582</span>     *            &lt;/p&gt;<a name="line.2582"></a>
<span class="sourceLineNo">2583</span>     *            &lt;ul&gt;<a name="line.2583"></a>
<span class="sourceLineNo">2584</span>     *            &lt;li&gt;0x01:TLK.&lt;/li&gt;<a name="line.2584"></a>
<span class="sourceLineNo">2585</span>     *            &lt;li&gt;0x02:TMK.&lt;/li&gt;<a name="line.2585"></a>
<span class="sourceLineNo">2586</span>     *            &lt;li&gt;0x22:AES_TMK.&lt;/li&gt;<a name="line.2586"></a>
<span class="sourceLineNo">2587</span>     *            &lt;/ul&gt;<a name="line.2587"></a>
<span class="sourceLineNo">2588</span>     *            &lt;/div&gt;<a name="line.2588"></a>
<span class="sourceLineNo">2589</span>     *<a name="line.2589"></a>
<span class="sourceLineNo">2590</span>     *<a name="line.2590"></a>
<span class="sourceLineNo">2591</span>     * @param srcKeyIndex<a name="line.2591"></a>
<span class="sourceLineNo">2592</span>     *            &lt;div class="zh"&gt;<a name="line.2592"></a>
<span class="sourceLineNo">2593</span>     *            &lt;p&gt;<a name="line.2593"></a>
<span class="sourceLineNo">2594</span>     *            原密钥索引<a name="line.2594"></a>
<span class="sourceLineNo">2595</span>     *            &lt;/p&gt;<a name="line.2595"></a>
<span class="sourceLineNo">2596</span>     *            &lt;ul&gt;<a name="line.2596"></a>
<span class="sourceLineNo">2597</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TLK}时, srcKeyIndex=1有效&lt;/li&gt;<a name="line.2597"></a>
<span class="sourceLineNo">2598</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#TMK}时, srcKeyIndex=[1~100]有效&lt;/li&gt;<a name="line.2598"></a>
<span class="sourceLineNo">2599</span>     *            &lt;li&gt;如果srcKeyType={@link EPedKeyType#AES_TMK}时, srcKeyIndex=[1~100]有效&lt;/li&gt;<a name="line.2599"></a>
<span class="sourceLineNo">2600</span>     *            &lt;/ul&gt;<a name="line.2600"></a>
<span class="sourceLineNo">2601</span>     *            当srcKeyIndex = 0，密钥将以明文形式写入PED。 &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2601"></a>
<span class="sourceLineNo">2602</span>     *            &lt;p&gt;<a name="line.2602"></a>
<span class="sourceLineNo">2603</span>     *            Source Key Index<a name="line.2603"></a>
<span class="sourceLineNo">2604</span>     *            &lt;/p&gt;<a name="line.2604"></a>
<span class="sourceLineNo">2605</span>     *            &lt;ul&gt;<a name="line.2605"></a>
<span class="sourceLineNo">2606</span>     *            &lt;li&gt;when srcKeyType=TLK, srcKeyIndex=1&lt;/li&gt;<a name="line.2606"></a>
<span class="sourceLineNo">2607</span>     *            &lt;li&gt;when srcKeyType=TMK, srcKeyIndex=[1~100]&lt;/li&gt;<a name="line.2607"></a>
<span class="sourceLineNo">2608</span>     *            &lt;li&gt;when srcKeyType=AES_TMK, srcKeyIndex=[1~100]&lt;/li&gt;<a name="line.2608"></a>
<span class="sourceLineNo">2609</span>     *            &lt;/ul&gt;<a name="line.2609"></a>
<span class="sourceLineNo">2610</span>     *            when srcKeyIndex = 0，The key will be written to PED in clear text. &lt;/div&gt;<a name="line.2610"></a>
<span class="sourceLineNo">2611</span>     * @param destKeyType &lt;div class="zh"&gt;<a name="line.2611"></a>
<span class="sourceLineNo">2612</span>     *            &lt;p&gt;<a name="line.2612"></a>
<span class="sourceLineNo">2613</span>     *            目的密钥类型。<a name="line.2613"></a>
<span class="sourceLineNo">2614</span>     *            &lt;/p&gt;<a name="line.2614"></a>
<span class="sourceLineNo">2615</span>     *            &lt;ul&gt;<a name="line.2615"></a>
<span class="sourceLineNo">2616</span>     *            &lt;li&gt;0x20:TAESK.&lt;/li&gt;<a name="line.2616"></a>
<span class="sourceLineNo">2617</span>     *            &lt;li&gt;0x22:AES_TMK.&lt;/li&gt;<a name="line.2617"></a>
<span class="sourceLineNo">2618</span>     *            &lt;li&gt;0x23:AES_TPK.&lt;/li&gt;<a name="line.2618"></a>
<span class="sourceLineNo">2619</span>     *            &lt;li&gt;0x24:AES_TAK.&lt;/li&gt;<a name="line.2619"></a>
<span class="sourceLineNo">2620</span>     *            &lt;li&gt;0x2A:AES_PPAD.&lt;/li&gt;<a name="line.2620"></a>
<span class="sourceLineNo">2621</span>     *            &lt;/ul&gt;<a name="line.2621"></a>
<span class="sourceLineNo">2622</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2622"></a>
<span class="sourceLineNo">2623</span>     *            &lt;p&gt;<a name="line.2623"></a>
<span class="sourceLineNo">2624</span>     *            Destination Key Type.<a name="line.2624"></a>
<span class="sourceLineNo">2625</span>     *            &lt;/p&gt;<a name="line.2625"></a>
<span class="sourceLineNo">2626</span>     *            &lt;ul&gt;<a name="line.2626"></a>
<span class="sourceLineNo">2627</span>     *            &lt;li&gt;0x20:TAESK.&lt;/li&gt;<a name="line.2627"></a>
<span class="sourceLineNo">2628</span>     *            &lt;li&gt;0x22:AES_TMK.&lt;/li&gt;<a name="line.2628"></a>
<span class="sourceLineNo">2629</span>     *            &lt;li&gt;0x23:AES_TPK.&lt;/li&gt;<a name="line.2629"></a>
<span class="sourceLineNo">2630</span>     *            &lt;li&gt;0x24:AES_TAK.&lt;/li&gt;<a name="line.2630"></a>
<span class="sourceLineNo">2631</span>     *            &lt;li&gt;0x2A:AES_PPAD.&lt;/li&gt;<a name="line.2631"></a>
<span class="sourceLineNo">2632</span>     *            &lt;/ul&gt; &lt;/div&gt;<a name="line.2632"></a>
<span class="sourceLineNo">2633</span>     *<a name="line.2633"></a>
<span class="sourceLineNo">2634</span>     * @param destKeyIndex<a name="line.2634"></a>
<span class="sourceLineNo">2635</span>     *            &lt;div class="zh"&gt;<a name="line.2635"></a>
<span class="sourceLineNo">2636</span>     *            &lt;p&gt;<a name="line.2636"></a>
<span class="sourceLineNo">2637</span>     *            目的密钥索引[1-100]<a name="line.2637"></a>
<span class="sourceLineNo">2638</span>     *            &lt;/p&gt;<a name="line.2638"></a>
<span class="sourceLineNo">2639</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2639"></a>
<span class="sourceLineNo">2640</span>     *            &lt;p&gt;<a name="line.2640"></a>
<span class="sourceLineNo">2641</span>     *            Destination Key Index[1-100]<a name="line.2641"></a>
<span class="sourceLineNo">2642</span>     *            &lt;/p&gt;<a name="line.2642"></a>
<span class="sourceLineNo">2643</span>     *            &lt;/div&gt;<a name="line.2643"></a>
<span class="sourceLineNo">2644</span>     *<a name="line.2644"></a>
<span class="sourceLineNo">2645</span>     * @param destKeyValue<a name="line.2645"></a>
<span class="sourceLineNo">2646</span>     *            &lt;div class="zh"&gt;<a name="line.2646"></a>
<span class="sourceLineNo">2647</span>     *            &lt;p&gt;<a name="line.2647"></a>
<span class="sourceLineNo">2648</span>     *            密钥明文或密文,16/24/32bytes<a name="line.2648"></a>
<span class="sourceLineNo">2649</span>     *            &lt;/p&gt;<a name="line.2649"></a>
<span class="sourceLineNo">2650</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2650"></a>
<span class="sourceLineNo">2651</span>     *            &lt;p&gt;<a name="line.2651"></a>
<span class="sourceLineNo">2652</span>     *            Cryptograph or Plaintext,16/24/32bytes<a name="line.2652"></a>
<span class="sourceLineNo">2653</span>     *            &lt;/p&gt;<a name="line.2653"></a>
<span class="sourceLineNo">2654</span>     *            &lt;/div&gt;<a name="line.2654"></a>
<span class="sourceLineNo">2655</span>     *<a name="line.2655"></a>
<span class="sourceLineNo">2656</span>     * @param checkMode<a name="line.2656"></a>
<span class="sourceLineNo">2657</span>     *            {@link EAesCheckMode} &lt;div class="zh"&gt;<a name="line.2657"></a>
<span class="sourceLineNo">2658</span>     *            &lt;p&gt;<a name="line.2658"></a>
<span class="sourceLineNo">2659</span>     *            校验模式<a name="line.2659"></a>
<span class="sourceLineNo">2660</span>     *            &lt;/p&gt;<a name="line.2660"></a>
<span class="sourceLineNo">2661</span>     *            &lt;ul&gt;<a name="line.2661"></a>
<span class="sourceLineNo">2662</span>     *            &lt;li&gt;checkMode=KCV_NONE -无验证.&lt;/li&gt;<a name="line.2662"></a>
<span class="sourceLineNo">2663</span>     *            &lt;li&gt;checkMode=KCV_ENCRYPT_0 -对16个字节的0x00进行AES ECB模式加密运算，得到的密文的前4个字节即为KCV值。&lt;/li&gt;<a name="line.2663"></a>
<span class="sourceLineNo">2664</span>     *            &lt;li&gt;checkMode=KCV_ENCRYPT_FIX_DATA -首先对密钥明文进行奇校验，再对16字节长度<a name="line.2664"></a>
<span class="sourceLineNo">2665</span>     *            ―\x12\x34\x56\x78\x90\x12\x34\x56\x12\x34\x56\x78\x90\x12\x34\x56‖进行AES ECB模式的加密运算，得到的密文的前4个字节即为KCV值。&lt;/li&gt;<a name="line.2665"></a>
<span class="sourceLineNo">2666</span>     *            &lt;li&gt;checkMode=KCV_MAC_INPUT_DATA -传入一串数据KcvData，使用源密钥对[aucDstKeyValue(密文)+<a name="line.2666"></a>
<span class="sourceLineNo">2667</span>     *            KcvData]进行指定模式的MAC运算，得到的8个字节的MAC值即为KCV值。&lt;/li&gt;<a name="line.2667"></a>
<span class="sourceLineNo">2668</span>     *            &lt;/ul&gt;<a name="line.2668"></a>
<span class="sourceLineNo">2669</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2669"></a>
<span class="sourceLineNo">2670</span>     *            &lt;p&gt;<a name="line.2670"></a>
<span class="sourceLineNo">2671</span>     *            Check Mode<a name="line.2671"></a>
<span class="sourceLineNo">2672</span>     *            &lt;/p&gt;<a name="line.2672"></a>
<span class="sourceLineNo">2673</span>     *            &lt;ul&gt;<a name="line.2673"></a>
<span class="sourceLineNo">2674</span>     *            &lt;li&gt;When checkMode=KCV_NONE -No Check&lt;/li&gt;<a name="line.2674"></a>
<span class="sourceLineNo">2675</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_0 -Perform AES ECB mode encryption on 16 bytes 0x00, and use first 4<a name="line.2675"></a>
<span class="sourceLineNo">2676</span>     *            bytes as KCV.&lt;/li&gt;<a name="line.2676"></a>
<span class="sourceLineNo">2677</span>     *<a name="line.2677"></a>
<span class="sourceLineNo">2678</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_FIX_DATA -Perform parity check first, then perform AES ECB mode<a name="line.2678"></a>
<span class="sourceLineNo">2679</span>     *            encryption on 16 bytes―\x12\x34\x56\x78\x90\x12\x34\x56\x12\x34\x56\x78\x90\x12\x34\x56‖, and use<a name="line.2679"></a>
<span class="sourceLineNo">2680</span>     *            first 4 bytes as KCV.&lt;/li&gt;<a name="line.2680"></a>
<span class="sourceLineNo">2681</span>     *<a name="line.2681"></a>
<span class="sourceLineNo">2682</span>     *            &lt;li&gt;When checkMode=KCV_MAC_INPUT_DATA -Send in data KcvData, use source key to perform specified mode<a name="line.2682"></a>
<span class="sourceLineNo">2683</span>     *            of MAC on [aucDesKeyValue(ciphertext) +KcvData], and use the 8 bytes result as KCV.&lt;/li&gt;<a name="line.2683"></a>
<span class="sourceLineNo">2684</span>     *            &lt;/ul&gt;<a name="line.2684"></a>
<span class="sourceLineNo">2685</span>     *            &lt;/div&gt;<a name="line.2685"></a>
<span class="sourceLineNo">2686</span>     *<a name="line.2686"></a>
<span class="sourceLineNo">2687</span>     * @param checkBuf<a name="line.2687"></a>
<span class="sourceLineNo">2688</span>     *            &lt;div class="zh"&gt;<a name="line.2688"></a>
<span class="sourceLineNo">2689</span>     *            &lt;p&gt;<a name="line.2689"></a>
<span class="sourceLineNo">2690</span>     *            校验数据缓冲区<a name="line.2690"></a>
<span class="sourceLineNo">2691</span>     *            &lt;/p&gt;<a name="line.2691"></a>
<span class="sourceLineNo">2692</span>     *            &lt;ul&gt;<a name="line.2692"></a>
<span class="sourceLineNo">2693</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_NONE}时 checkBuf的值无效,系统认为不验证KCV,可以为null&lt;/li&gt;<a name="line.2693"></a>
<span class="sourceLineNo">2694</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_ENCRYPT_0}时checkBuf为KCV的值&lt;/li&gt;<a name="line.2694"></a>
<span class="sourceLineNo">2695</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_ENCRYPT_FIX_DATA}时checkBuf为KCV的值&lt;/li&gt;<a name="line.2695"></a>
<span class="sourceLineNo">2696</span>     *            &lt;li&gt;当checkMode={@link ECheckMode#KCV_MAC_INPUT_DATA}时按以下规则提供checkBuf:<a name="line.2696"></a>
<span class="sourceLineNo">2697</span>     *            &lt;p&gt;<a name="line.2697"></a>
<span class="sourceLineNo">2698</span>     *            checkBuf[0]= KcvData长度(KcvDataLen)<a name="line.2698"></a>
<span class="sourceLineNo">2699</span>     *            &lt;/p&gt;<a name="line.2699"></a>
<span class="sourceLineNo">2700</span>     *            &lt;p&gt;<a name="line.2700"></a>
<span class="sourceLineNo">2701</span>     *            checkBuf+1: KcvData<a name="line.2701"></a>
<span class="sourceLineNo">2702</span>     *            &lt;/p&gt;<a name="line.2702"></a>
<span class="sourceLineNo">2703</span>     *            &lt;p&gt;<a name="line.2703"></a>
<span class="sourceLineNo">2704</span>     *            checkBuf[1+KcvDataLen]=MAC运算模式,参考{@link #getMac(byte, byte[], EPedMacMode)}中的mode参数<a name="line.2704"></a>
<span class="sourceLineNo">2705</span>     *            &lt;/p&gt;<a name="line.2705"></a>
<span class="sourceLineNo">2706</span>     *            &lt;p&gt;<a name="line.2706"></a>
<span class="sourceLineNo">2707</span>     *            checkBuf[2+KcvDataLen]=KCV长度<a name="line.2707"></a>
<span class="sourceLineNo">2708</span>     *            &lt;/p&gt;<a name="line.2708"></a>
<span class="sourceLineNo">2709</span>     *            &lt;p&gt;<a name="line.2709"></a>
<span class="sourceLineNo">2710</span>     *            checkBuf[3+KcvDataLen]是KCV的值<a name="line.2710"></a>
<span class="sourceLineNo">2711</span>     *            &lt;/p&gt;<a name="line.2711"></a>
<span class="sourceLineNo">2712</span>     *            &lt;/li&gt;<a name="line.2712"></a>
<span class="sourceLineNo">2713</span>     *            &lt;/ul&gt;<a name="line.2713"></a>
<span class="sourceLineNo">2714</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2714"></a>
<span class="sourceLineNo">2715</span>     *            &lt;p&gt;<a name="line.2715"></a>
<span class="sourceLineNo">2716</span>     *            Check Data Buffer<a name="line.2716"></a>
<span class="sourceLineNo">2717</span>     *            &lt;/p&gt;<a name="line.2717"></a>
<span class="sourceLineNo">2718</span>     *            &lt;ul&gt;<a name="line.2718"></a>
<span class="sourceLineNo">2719</span>     *            &lt;li&gt;When checkMode=KCV_NONE -PED won't check KCV, this data is no meaning.&lt;/li&gt;<a name="line.2719"></a>
<span class="sourceLineNo">2720</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_0 -4 bytes key check value&lt;/li&gt;<a name="line.2720"></a>
<span class="sourceLineNo">2721</span>     *            &lt;li&gt;When checkMode=KCV_ENCRYPT_FIX_DATA -4 bytes key check value&lt;/li&gt;<a name="line.2721"></a>
<span class="sourceLineNo">2722</span>     *            &lt;li&gt;When checkMode=KCV_MAC_INPUT_DATA - checkBuf as follows: checkBuf[0] = length of KcvData<a name="line.2722"></a>
<span class="sourceLineNo">2723</span>     *            checkBuf+1: kcvData checkBuf[1+kcvDataLen]: MAC computation mode<a name="line.2723"></a>
<span class="sourceLineNo">2724</span>     *            {@link #getMac(byte, byte[], EPedMacMode)} checkBuf[2+kcvDataLen]:KCV length<a name="line.2724"></a>
<span class="sourceLineNo">2725</span>     *            checkBuf[3+kcvDataLen]:KCV Value&lt;/li&gt;<a name="line.2725"></a>
<span class="sourceLineNo">2726</span>     *            &lt;/ul&gt;<a name="line.2726"></a>
<span class="sourceLineNo">2727</span>     *            &lt;/div&gt;<a name="line.2727"></a>
<span class="sourceLineNo">2728</span>     *<a name="line.2728"></a>
<span class="sourceLineNo">2729</span>     * @throws PedDevException<a name="line.2729"></a>
<span class="sourceLineNo">2730</span>     * @since V3.08.00<a name="line.2730"></a>
<span class="sourceLineNo">2731</span>     */<a name="line.2731"></a>
<span class="sourceLineNo">2732</span>    public void writeAesKey(byte srcKeyType, byte srcKeyIndex, byte destKeyType, byte destKeyIndex, byte[] destKeyValue,<a name="line.2732"></a>
<span class="sourceLineNo">2733</span>            EAesCheckMode checkMode, byte[] checkBuf) throws PedDevException;<a name="line.2733"></a>
<span class="sourceLineNo">2734</span><a name="line.2734"></a>
<span class="sourceLineNo">2735</span>    /**<a name="line.2735"></a>
<span class="sourceLineNo">2736</span>     * &lt;div class="zh"&gt; 使用DUKPT的MAC密钥或DES密钥，对输入缓存内数据进行加密或解密。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.2736"></a>
<span class="sourceLineNo">2737</span>     * &lt;div class="en"&gt; Use MAC key or DES key of DUKPT to encrypt or decrypt the data in the input buffer.{@link EPedType#INTERNAL} only is supported. &lt;/div&gt;<a name="line.2737"></a>
<span class="sourceLineNo">2738</span>     *<a name="line.2738"></a>
<span class="sourceLineNo">2739</span>     * @param groupIndex<a name="line.2739"></a>
<span class="sourceLineNo">2740</span>     *            &lt;div class="zh"&gt; [1~100] DUKPT密钥组索引号 &lt;/div&gt; &lt;div class="en"&gt; [1~100] DUKPT group ID &lt;/div&gt;<a name="line.2740"></a>
<span class="sourceLineNo">2741</span>     *<a name="line.2741"></a>
<span class="sourceLineNo">2742</span>     * @param keyVarType<a name="line.2742"></a>
<span class="sourceLineNo">2743</span>     *            &lt;div class="zh"&gt;<a name="line.2743"></a>
<span class="sourceLineNo">2744</span>     *            &lt;ul&gt;<a name="line.2744"></a>
<span class="sourceLineNo">2745</span>     *            &lt;li&gt;0x00: 用请求和应答MAC密钥。&lt;/li&gt;<a name="line.2745"></a>
<span class="sourceLineNo">2746</span>     *            &lt;li&gt;0x01: 用DUKPT DES密钥运算。&lt;/li&gt;<a name="line.2746"></a>
<span class="sourceLineNo">2747</span>     *            &lt;li&gt;0x02: 用DUKPT PIN密钥运算，只能做加密(mode的值只能为0x01或者0x13)，解密会返回错误。&lt;/li&gt;<a name="line.2747"></a>
<span class="sourceLineNo">2748</span>     *            &lt;li&gt;0x03: 使用应答MAC密钥，仅支持加密模式，即mode值只能为0x01、0x03、0x11、0x13。&lt;/li&gt;<a name="line.2748"></a>
<span class="sourceLineNo">2749</span>     *            &lt;li&gt;0x04: 使用应答DES密钥，仅支持加密模式，即mode值只能为0x01、0x03、0x11、0x13。&lt;/li&gt;<a name="line.2749"></a>
<span class="sourceLineNo">2750</span>     *            &lt;/ul&gt;<a name="line.2750"></a>
<span class="sourceLineNo">2751</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.2751"></a>
<span class="sourceLineNo">2752</span>     *            &lt;ul&gt;<a name="line.2752"></a>
<span class="sourceLineNo">2753</span>     *            &lt;li&gt;0x00:Use request and response MAC key.&lt;/li&gt;<a name="line.2753"></a>
<span class="sourceLineNo">2754</span>     *            &lt;li&gt;0x01:Use DUKPT DES key operation.&lt;/li&gt;<a name="line.2754"></a>
<span class="sourceLineNo">2755</span>     *            &lt;li&gt;0x02:Use DUKPT PIN key operation, only encryption(The value of mode can only be 0x01 or 0x13.), decryption will return error.&lt;/li&gt;<a name="line.2755"></a>
<span class="sourceLineNo">2756</span>     *            &lt;li&gt;0x03:Using the reply MAC key, only the encryption mode is supported, the mode value can only be 0x01, 0x03, 0x011, 0x13.&lt;/li&gt;<a name="line.2756"></a>
<span class="sourceLineNo">2757</span>     *            &lt;li&gt;0x04:Using the reply DES key, only the encryption mode is supported, the mode value can only be 0x01, 0x03, 0x011, 0x13.&lt;/li&gt;<a name="line.2757"></a>
<span class="sourceLineNo">2758</span>     *            &lt;/ul&gt;<a name="line.2758"></a>
<span class="sourceLineNo">2759</span>     *            &lt;/div&gt;<a name="line.2759"></a>
<span class="sourceLineNo">2760</span>     *<a name="line.2760"></a>
<span class="sourceLineNo">2761</span>     * @param iv<a name="line.2761"></a>
<span class="sourceLineNo">2762</span>     *            &lt;div class="zh"&gt; 8/16字节初始向量，CBC加解密时需要，如果传入NULL，将默认用“\x00\x00\x00\x00\x00\x00\x00\x00”或<a name="line.2762"></a>
<span class="sourceLineNo">2763</span>     *            “\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00”作为初始向量 &lt;/div&gt;<a name="line.2763"></a>
<span class="sourceLineNo">2764</span>     *            &lt;div class="en"&gt; 8/16 bytes initialization vector, used for CBC encryption or decryption. If set it to NULL,<a name="line.2764"></a>
<span class="sourceLineNo">2765</span>     *            it will use “\x00\x00\x00\x00\x00\x00\x00\x00” or “\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00”<a name="line.2765"></a>
<span class="sourceLineNo">2766</span>     *            as the initialization vector by default. &lt;/div&gt;<a name="line.2766"></a>
<span class="sourceLineNo">2767</span>     *<a name="line.2767"></a>
<span class="sourceLineNo">2768</span>     * @param dataIn<a name="line.2768"></a>
<span class="sourceLineNo">2769</span>     *            &lt;div class="zh"&gt; 指向需要进行运算的数据, 数据长度&lt;=8192，8整除(AES时，16整除)。&lt;/div&gt; &lt;div class="en"&gt; Point to the data which need to<a name="line.2769"></a>
<span class="sourceLineNo">2770</span>     *            be computed.Data length less than or equal to 8192, it is divisible by 8(In AES, 16 is divisible). &lt;/div&gt;<a name="line.2770"></a>
<span class="sourceLineNo">2771</span>     *<a name="line.2771"></a>
<span class="sourceLineNo">2772</span>     * @param mode &lt;div class="zh"&gt;<a name="line.2772"></a>
<span class="sourceLineNo">2773</span>     * &lt;ul&gt;<a name="line.2773"></a>
<span class="sourceLineNo">2774</span>     * &lt;li&gt;0x00:ECB 解密。&lt;/li&gt;<a name="line.2774"></a>
<span class="sourceLineNo">2775</span>     * &lt;li&gt;0x01:ECB 加密。&lt;/li&gt;<a name="line.2775"></a>
<span class="sourceLineNo">2776</span>     * &lt;li&gt;0x02:CBC 解密。&lt;/li&gt;<a name="line.2776"></a>
<span class="sourceLineNo">2777</span>     * &lt;li&gt;0x03:CBC 加密。&lt;/li&gt;<a name="line.2777"></a>
<span class="sourceLineNo">2778</span>     * &lt;li&gt;0x10:AES ECB 解密。&lt;/li&gt;<a name="line.2778"></a>
<span class="sourceLineNo">2779</span>     * &lt;li&gt;0x11:AES ECB 加密。&lt;/li&gt;<a name="line.2779"></a>
<span class="sourceLineNo">2780</span>     * &lt;li&gt;0x12:AES CBC 解密。&lt;/li&gt;<a name="line.2780"></a>
<span class="sourceLineNo">2781</span>     * &lt;li&gt;0x13:AES CBC 加密。&lt;/li&gt;<a name="line.2781"></a>
<span class="sourceLineNo">2782</span>     * &lt;/ul&gt;<a name="line.2782"></a>
<span class="sourceLineNo">2783</span>     * &lt;/div&gt;<a name="line.2783"></a>
<span class="sourceLineNo">2784</span>     * &lt;div class="en"&gt;<a name="line.2784"></a>
<span class="sourceLineNo">2785</span>     * &lt;ul&gt;<a name="line.2785"></a>
<span class="sourceLineNo">2786</span>     * &lt;li&gt;0x00:ECB decryption.&lt;/li&gt;<a name="line.2786"></a>
<span class="sourceLineNo">2787</span>     * &lt;li&gt;0x01:ECB encryption.&lt;/li&gt;<a name="line.2787"></a>
<span class="sourceLineNo">2788</span>     * &lt;li&gt;0x02:CBC decryption.&lt;/li&gt;<a name="line.2788"></a>
<span class="sourceLineNo">2789</span>     * &lt;li&gt;0x03:CBC encryption.&lt;/li&gt;<a name="line.2789"></a>
<span class="sourceLineNo">2790</span>     * &lt;li&gt;0x10:AES ECB decryption.&lt;/li&gt;<a name="line.2790"></a>
<span class="sourceLineNo">2791</span>     * &lt;li&gt;0x11:AES ECB encryption.&lt;/li&gt;<a name="line.2791"></a>
<span class="sourceLineNo">2792</span>     * &lt;li&gt;0x12:AES CBC decryption.&lt;/li&gt;<a name="line.2792"></a>
<span class="sourceLineNo">2793</span>     * &lt;li&gt;0x13:AES CBC encryption.&lt;/li&gt;<a name="line.2793"></a>
<span class="sourceLineNo">2794</span>     * &lt;/ul&gt;<a name="line.2794"></a>
<span class="sourceLineNo">2795</span>     * &lt;/div&gt;<a name="line.2795"></a>
<span class="sourceLineNo">2796</span>     *<a name="line.2796"></a>
<span class="sourceLineNo">2797</span>     * @return {@link DUKPTResult}<a name="line.2797"></a>
<span class="sourceLineNo">2798</span>     * @throws PedDevException<a name="line.2798"></a>
<span class="sourceLineNo">2799</span>     * @since V3.08.00<a name="line.2799"></a>
<span class="sourceLineNo">2800</span>     */<a name="line.2800"></a>
<span class="sourceLineNo">2801</span>    public DUKPTResult calcDUKPTData(byte groupIndex, byte keyVarType, byte[] iv, byte[] dataIn, byte mode)<a name="line.2801"></a>
<span class="sourceLineNo">2802</span>            throws PedDevException;<a name="line.2802"></a>
<span class="sourceLineNo">2803</span><a name="line.2803"></a>
<span class="sourceLineNo">2804</span>    /**<a name="line.2804"></a>
<span class="sourceLineNo">2805</span>     * &lt;div class="zh"&gt; 使用DUKPT的MAC密钥计算MAC。支持{@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} 类型。 韩国Smartro定制。&lt;/div&gt;<a name="line.2805"></a>
<span class="sourceLineNo">2806</span>     * &lt;div class="en"&gt; Use MAC Key to calculate MAC. {@link EPedType#INTERNAL},{@link EPedType#EXTERNAL_TYPEA} is supported. For Korea Smartro.&lt;/div&gt;<a name="line.2806"></a>
<span class="sourceLineNo">2807</span>     *<a name="line.2807"></a>
<span class="sourceLineNo">2808</span>     * @param groupIndex<a name="line.2808"></a>
<span class="sourceLineNo">2809</span>     *            &lt;div class="zh"&gt; [1~100] DUKPT密钥组索引号 &lt;/div&gt; &lt;div class="en"&gt; [1~100] DUKPT key group index id &lt;/div&gt;<a name="line.2809"></a>
<span class="sourceLineNo">2810</span>     *<a name="line.2810"></a>
<span class="sourceLineNo">2811</span>     * @param dataIn<a name="line.2811"></a>
<span class="sourceLineNo">2812</span>     *            &lt;div class="zh"&gt; 指向需要计算MAC的数据内容 &lt;/div&gt; &lt;div class="en"&gt; The MAC data content needs to be calculated&lt;/div&gt;<a name="line.2812"></a>
<span class="sourceLineNo">2813</span>     *<a name="line.2813"></a>
<span class="sourceLineNo">2814</span>     * @param mode &lt;div class="zh"&gt;<a name="line.2814"></a>
<span class="sourceLineNo">2815</span>     * &lt;ul&gt;<a name="line.2815"></a>
<span class="sourceLineNo">2816</span>     * &lt;li&gt;0:{@link EDUKPTMacMode#MODE_00}&lt;/li&gt;<a name="line.2816"></a>
<span class="sourceLineNo">2817</span>     * &lt;li&gt;1:{@link EDUKPTMacMode#MODE_01}&lt;/li&gt;<a name="line.2817"></a>
<span class="sourceLineNo">2818</span>     * &lt;li&gt;2:{@link EDUKPTMacMode#MODE_02}&lt;/li&gt;<a name="line.2818"></a>
<span class="sourceLineNo">2819</span>     * &lt;li&gt;5:{@link EDUKPTMacMode#MODE_05}&lt;/li&gt;<a name="line.2819"></a>
<span class="sourceLineNo">2820</span>     * &lt;li&gt;20:{@link EDUKPTMacMode#MODE_20}&lt;/li&gt;<a name="line.2820"></a>
<span class="sourceLineNo">2821</span>     * &lt;li&gt;21:{@link EDUKPTMacMode#MODE_21}&lt;/li&gt;<a name="line.2821"></a>
<span class="sourceLineNo">2822</span>     * &lt;li&gt;22:{@link EDUKPTMacMode#MODE_22}&lt;/li&gt;<a name="line.2822"></a>
<span class="sourceLineNo">2823</span>     * &lt;li&gt;25:{@link EDUKPTMacMode#MODE_25}&lt;/li&gt;<a name="line.2823"></a>
<span class="sourceLineNo">2824</span>     * &lt;li&gt;40:{@link EDUKPTMacMode#MODE_40}&lt;/li&gt;<a name="line.2824"></a>
<span class="sourceLineNo">2825</span>     * &lt;li&gt;41:{@link EDUKPTMacMode#MODE_41}&lt;/li&gt;<a name="line.2825"></a>
<span class="sourceLineNo">2826</span>     * &lt;li&gt;42:{@link EDUKPTMacMode#MODE_42}&lt;/li&gt;<a name="line.2826"></a>
<span class="sourceLineNo">2827</span>     * &lt;li&gt;45:{@link EDUKPTMacMode#MODE_45}&lt;/li&gt;<a name="line.2827"></a>
<span class="sourceLineNo">2828</span>     * &lt;/ul&gt;<a name="line.2828"></a>
<span class="sourceLineNo">2829</span>     * 备注：20，22，40，42模式可以支持最大输入8k大小的输入数据，其他模式维持原来最大1k的输入数据<a name="line.2829"></a>
<span class="sourceLineNo">2830</span>     * &lt;/div&gt;<a name="line.2830"></a>
<span class="sourceLineNo">2831</span>     * &lt;div class="en"&gt;<a name="line.2831"></a>
<span class="sourceLineNo">2832</span>     * &lt;ul&gt;<a name="line.2832"></a>
<span class="sourceLineNo">2833</span>     * &lt;li&gt;0:{@link EDUKPTMacMode#MODE_00}&lt;/li&gt;<a name="line.2833"></a>
<span class="sourceLineNo">2834</span>     * &lt;li&gt;1:{@link EDUKPTMacMode#MODE_01}&lt;/li&gt;<a name="line.2834"></a>
<span class="sourceLineNo">2835</span>     * &lt;li&gt;2:{@link EDUKPTMacMode#MODE_02}&lt;/li&gt;<a name="line.2835"></a>
<span class="sourceLineNo">2836</span>     * &lt;li&gt;5:{@link EDUKPTMacMode#MODE_05}&lt;/li&gt;<a name="line.2836"></a>
<span class="sourceLineNo">2837</span>     * &lt;li&gt;20:{@link EDUKPTMacMode#MODE_20}&lt;/li&gt;<a name="line.2837"></a>
<span class="sourceLineNo">2838</span>     * &lt;li&gt;21:{@link EDUKPTMacMode#MODE_21}&lt;/li&gt;<a name="line.2838"></a>
<span class="sourceLineNo">2839</span>     * &lt;li&gt;22:{@link EDUKPTMacMode#MODE_22}&lt;/li&gt;<a name="line.2839"></a>
<span class="sourceLineNo">2840</span>     * &lt;li&gt;25:{@link EDUKPTMacMode#MODE_25}&lt;/li&gt;<a name="line.2840"></a>
<span class="sourceLineNo">2841</span>     * &lt;li&gt;40:{@link EDUKPTMacMode#MODE_40}&lt;/li&gt;<a name="line.2841"></a>
<span class="sourceLineNo">2842</span>     * &lt;li&gt;41:{@link EDUKPTMacMode#MODE_41}&lt;/li&gt;<a name="line.2842"></a>
<span class="sourceLineNo">2843</span>     * &lt;li&gt;42:{@link EDUKPTMacMode#MODE_42}&lt;/li&gt;<a name="line.2843"></a>
<span class="sourceLineNo">2844</span>     * &lt;li&gt;45:{@link EDUKPTMacMode#MODE_45}&lt;/li&gt;<a name="line.2844"></a>
<span class="sourceLineNo">2845</span>     * &lt;/ul&gt;<a name="line.2845"></a>
<span class="sourceLineNo">2846</span>     * Note: In 20, 22, 40, and 42 modes, the maximum size of input data can be 8 KB. In other modes, the maximum size of input data can be 1 KB<a name="line.2846"></a>
<span class="sourceLineNo">2847</span>     * &lt;/div&gt;<a name="line.2847"></a>
<span class="sourceLineNo">2848</span>     *<a name="line.2848"></a>
<span class="sourceLineNo">2849</span>     * @return {@link DUKPTResult}<a name="line.2849"></a>
<span class="sourceLineNo">2850</span>     * @throws PedDevException<a name="line.2850"></a>
<span class="sourceLineNo">2851</span>         * @since V3.09.00<a name="line.2851"></a>
<span class="sourceLineNo">2852</span>     */<a name="line.2852"></a>
<span class="sourceLineNo">2853</span>    DUKPTResult getDUKPTMac(byte groupIndex, byte[] dataIn, byte mode) throws PedDevException;<a name="line.2853"></a>
<span class="sourceLineNo">2854</span><a name="line.2854"></a>
<span class="sourceLineNo">2855</span>    /**<a name="line.2855"></a>
<span class="sourceLineNo">2856</span>     * &lt;div class="zh"&gt;擦除指定类型的密钥。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.2856"></a>
<span class="sourceLineNo">2857</span>     * &lt;div class="en"&gt;Erases the key of the specified type.  {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2857"></a>
<span class="sourceLineNo">2858</span>     *<a name="line.2858"></a>
<span class="sourceLineNo">2859</span>     * @param mode &lt;div class="zh"&gt;<a name="line.2859"></a>
<span class="sourceLineNo">2860</span>     * &lt;ul&gt;<a name="line.2860"></a>
<span class="sourceLineNo">2861</span>     * &lt;li&gt;0:清空TDES MK/SK DUKPT, AES MK/SK DUKPT密钥。&lt;/li&gt;<a name="line.2861"></a>
<span class="sourceLineNo">2862</span>     * &lt;li&gt;1:清空TDES MK/SK DUKPT, AES MK/SK DUKPT, SM2、RSA密钥。&lt;/li&gt;<a name="line.2862"></a>
<span class="sourceLineNo">2863</span>     * &lt;li&gt;2:清空 SM2、RSA密钥。&lt;/li&gt;<a name="line.2863"></a>
<span class="sourceLineNo">2864</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.2864"></a>
<span class="sourceLineNo">2865</span>     * &lt;div class="en"&gt;<a name="line.2865"></a>
<span class="sourceLineNo">2866</span>     * &lt;ul&gt;<a name="line.2866"></a>
<span class="sourceLineNo">2867</span>     * &lt;li&gt;0: Clear TDES MK/SK DUKPT, AES MK/SK DUKPT keys.&lt;/li&gt;<a name="line.2867"></a>
<span class="sourceLineNo">2868</span>     * &lt;li&gt;1: Clear TDES MK/SK DUKPT, AES MK/SK DUKPT, SM2、RSA keys.&lt;/li&gt;<a name="line.2868"></a>
<span class="sourceLineNo">2869</span>     * &lt;li&gt;2: Clear SM2、RSA keys.&lt;/li&gt;<a name="line.2869"></a>
<span class="sourceLineNo">2870</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.2870"></a>
<span class="sourceLineNo">2871</span>     * @throws PedDevException<a name="line.2871"></a>
<span class="sourceLineNo">2872</span>     * @since V3.11.00<a name="line.2872"></a>
<span class="sourceLineNo">2873</span>     */<a name="line.2873"></a>
<span class="sourceLineNo">2874</span>    void eraseKeyEx(byte mode) throws PedDevException;<a name="line.2874"></a>
<span class="sourceLineNo">2875</span><a name="line.2875"></a>
<span class="sourceLineNo">2876</span>    /**<a name="line.2876"></a>
<span class="sourceLineNo">2877</span>     * &lt;div class="zh"&gt;WIC卡的密钥验证步骤，根据WIC密钥计算出challenge数据。接口不进行与卡片交互的步骤，仅计算出challenge数据。后续流程需要由应用处理。需要设备中存在WIC密钥（以TDK的方式保存）。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.2877"></a>
<span class="sourceLineNo">2878</span>     * &lt;div class="en"&gt;WIC card key verification steps, based on the WIC key to calculate the challenge data.The interface does not perform the steps of interacting with the card,<a name="line.2878"></a>
<span class="sourceLineNo">2879</span>     * only calculating the challenge data.Subsequent processes need to be handled by the application.The WIC key (stored as TDK) is required to be present in the device.{@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2879"></a>
<span class="sourceLineNo">2880</span>     *<a name="line.2880"></a>
<span class="sourceLineNo">2881</span>     * @param srcKeyIndex &lt;div class="zh"&gt;WIC key索引。&lt;/div&gt; &lt;div class="en"&gt;WIC key index.&lt;/div&gt;<a name="line.2881"></a>
<span class="sourceLineNo">2882</span>     *<a name="line.2882"></a>
<span class="sourceLineNo">2883</span>     * @param mode &lt;div class="zh"&gt;<a name="line.2883"></a>
<span class="sourceLineNo">2884</span>     * &lt;ul&gt;<a name="line.2884"></a>
<span class="sourceLineNo">2885</span>     * &lt;li&gt;0:WIC key为16字节，根据cardSN计算出16字节daughter key，并根据dataIn算出challenge数据。&lt;/li&gt;<a name="line.2885"></a>
<span class="sourceLineNo">2886</span>     * &lt;li&gt;1:WIC key为8字节，根据cardSN直接算出challenge数据。&lt;/li&gt;<a name="line.2886"></a>
<span class="sourceLineNo">2887</span>     * &lt;li&gt;2:WIC key为8字节，根据cardSN直接算出challenge数据。&lt;/li&gt;<a name="line.2887"></a>
<span class="sourceLineNo">2888</span>     * &lt;/ul&gt;&lt;/div&gt; &lt;div class="en"&gt;<a name="line.2888"></a>
<span class="sourceLineNo">2889</span>     * &lt;ul&gt;<a name="line.2889"></a>
<span class="sourceLineNo">2890</span>     * &lt;li&gt;0:The WIC key is 16 bytes. Calculate the 16-byte daughter key according to cardSN, and calculate the challenge data according to dataIn.&lt;/li&gt;<a name="line.2890"></a>
<span class="sourceLineNo">2891</span>     * &lt;li&gt;1:The WIC key is 8 bytes, and the challenge data is directly calculated according to the cardSN.&lt;/li&gt;<a name="line.2891"></a>
<span class="sourceLineNo">2892</span>     * &lt;li&gt;2:The WIC key is 8 bytes, and the challenge data is directly calculated according to the cardSN.&lt;/li&gt;<a name="line.2892"></a>
<span class="sourceLineNo">2893</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.2893"></a>
<span class="sourceLineNo">2894</span>     *<a name="line.2894"></a>
<span class="sourceLineNo">2895</span>     * @param cardSN &lt;div class="zh"&gt;8字节的Card SN信息。&lt;/div&gt; &lt;div class="en"&gt;8 bytes of Card SN information.&lt;/div&gt;<a name="line.2895"></a>
<span class="sourceLineNo">2896</span>     *<a name="line.2896"></a>
<span class="sourceLineNo">2897</span>     * @param dataIn &lt;div class="zh"&gt;输入数据。8字节。仅在mode=0时使用。当mode为其他值时传入任意数据即可。&lt;/div&gt;<a name="line.2897"></a>
<span class="sourceLineNo">2898</span>     * &lt;div class="en"&gt;Enter data.8 bytes.Used only when mode=0.Pass in any data when the mode is any other value.&lt;/div&gt;<a name="line.2898"></a>
<span class="sourceLineNo">2899</span>     *<a name="line.2899"></a>
<span class="sourceLineNo">2900</span>     * @return &lt;div class="zh"&gt;8字节的challenge数据。&lt;/div&gt; &lt;div class="en"&gt;8 bytes of challenge data.&lt;/div&gt;<a name="line.2900"></a>
<span class="sourceLineNo">2901</span>     *<a name="line.2901"></a>
<span class="sourceLineNo">2902</span>     * @throws PedDevException<a name="line.2902"></a>
<span class="sourceLineNo">2903</span>     * @since V3.12.00<a name="line.2903"></a>
<span class="sourceLineNo">2904</span>     */<a name="line.2904"></a>
<span class="sourceLineNo">2905</span>    byte[] challengeWICKey(byte srcKeyIndex, byte mode, byte[] cardSN, byte[] dataIn) throws PedDevException;<a name="line.2905"></a>
<span class="sourceLineNo">2906</span><a name="line.2906"></a>
<span class="sourceLineNo">2907</span>    /**<a name="line.2907"></a>
<span class="sourceLineNo">2908</span>     * &lt;div class="zh"&gt;输入PIN的过程，并将PIN保存在PED内部。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.2908"></a>
<span class="sourceLineNo">2909</span>     * &lt;div class="en"&gt;The process of entering the PIN and saving the PIN inside the PED. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2909"></a>
<span class="sourceLineNo">2910</span>     *<a name="line.2910"></a>
<span class="sourceLineNo">2911</span>     * @param expPinLen &lt;div class="zh"&gt;0,4~12的枚举集合可输入的合法密码长度字符串，应用程序把允许的密码长度全部枚举出来，并且用","号隔开每个长度，<a name="line.2911"></a>
<span class="sourceLineNo">2912</span>     * 如允许输入4、6位密码并且允许无密码直接按确认，则该字符串应该设置为"0,4,6"。若枚举0长度则示意可以不输任何数字而直接按确认键返回(仅用于特殊用途，后续的PIN操作会返回失败)。&lt;/div&gt;<a name="line.2912"></a>
<span class="sourceLineNo">2913</span>     * &lt;div class="en"&gt;Enumeration of 0,4-12.The enter password string with legal length. Application enumerates of all possible lengths of PIN.<a name="line.2913"></a>
<span class="sourceLineNo">2914</span>     * "," will be used to separate each number of length. If no PIN,or 4 or 6 digits of PIN are allowed, the string will be set as "0,4,6".<a name="line.2914"></a>
<span class="sourceLineNo">2915</span>     * 0 means that no PIN is required, and pressing "Enter" will return(For special purposes only, subsequent PIN operations will return a failure).&lt;/div&gt;<a name="line.2915"></a>
<span class="sourceLineNo">2916</span>     *<a name="line.2916"></a>
<span class="sourceLineNo">2917</span>     * @param timeoutMs &lt;div class="zh"&gt;输入PIN的超时时间,单位：毫秒 最大值为300000ms。0:表示没有超时时间，PED不做超时控制。&lt;/div&gt;<a name="line.2917"></a>
<span class="sourceLineNo">2918</span>     * &lt;div class="en"&gt;The timeout of PIN entry [unit:ms] Maximum is 300000ms.0: No timeout time, not doing timeout control for PED.&lt;/div&gt;<a name="line.2918"></a>
<span class="sourceLineNo">2919</span>     *<a name="line.2919"></a>
<span class="sourceLineNo">2920</span>     * @param mode &lt;div class="zh"&gt;保留扩展，目前为0x00。&lt;/div&gt; &lt;div class="en"&gt;Reserved for extension, currently 0x00.&lt;/div&gt;<a name="line.2920"></a>
<span class="sourceLineNo">2921</span>     *<a name="line.2921"></a>
<span class="sourceLineNo">2922</span>     * @throws PedDevException<a name="line.2922"></a>
<span class="sourceLineNo">2923</span>     */<a name="line.2923"></a>
<span class="sourceLineNo">2924</span>    void inputPin(String expPinLen, long timeoutMs, byte mode) throws PedDevException;<a name="line.2924"></a>
<span class="sourceLineNo">2925</span><a name="line.2925"></a>
<span class="sourceLineNo">2926</span>    /**<a name="line.2926"></a>
<span class="sourceLineNo">2927</span>     * &lt;div class="zh"&gt;将{@link #inputPin(String, long, byte)}的输入PIN加密为密文PinBlock。PIN将被清空。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.2927"></a>
<span class="sourceLineNo">2928</span>     * &lt;div class="en"&gt;Encrypt the inputPin of {@link #inputPin(String, long, byte)} as ciphertext PinBlock.The PIN will be cleared. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2928"></a>
<span class="sourceLineNo">2929</span>     *<a name="line.2929"></a>
<span class="sourceLineNo">2930</span>     * @param keyIndex &lt;div class="zh"&gt; [1~100] TPK的索引 &lt;/div&gt; &lt;div class="en"&gt; [1~100] TPK index &lt;/div&gt;<a name="line.2930"></a>
<span class="sourceLineNo">2931</span>     *<a name="line.2931"></a>
<span class="sourceLineNo">2932</span>     * @param dataIn &lt;div class="zh"&gt;<a name="line.2932"></a>
<span class="sourceLineNo">2933</span>     * &lt;ul&gt;<a name="line.2933"></a>
<span class="sourceLineNo">2934</span>     *  &lt;li&gt;当mode=0x00时，DataIn指向卡号移位后生成的16位主帐号，不包含校验位。&lt;/li&gt;<a name="line.2934"></a>
<span class="sourceLineNo">2935</span>     *  &lt;li&gt;当mode=0x01时，DataIn被忽略,接口内部采用随机数填充PINBlock。 &lt;/li&gt;<a name="line.2935"></a>
<span class="sourceLineNo">2936</span>     *  &lt;li&gt;当mode=0x02时，DataIn指向位移后的16位PAN。&lt;/li&gt;<a name="line.2936"></a>
<span class="sourceLineNo">2937</span>     *  &lt;li&gt;当mode=0x03时，为交易流水号ISN [6 Bytes,ASCII码]。&lt;/li&gt;<a name="line.2937"></a>
<span class="sourceLineNo">2938</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.2938"></a>
<span class="sourceLineNo">2939</span>     * &lt;div class="en"&gt;<a name="line.2939"></a>
<span class="sourceLineNo">2940</span>     * &lt;ul&gt;<a name="line.2940"></a>
<span class="sourceLineNo">2941</span>     *  &lt;li&gt;When mode=0x00, DataIn is the 16 bytes primary account number after shifting, excluding the check bit.&lt;/li&gt;<a name="line.2941"></a>
<span class="sourceLineNo">2942</span>     *  &lt;li&gt;When mode=0x01, DataIn is ignored. The interface uses random numbers to fill PINBlock internally.&lt;/li&gt;<a name="line.2942"></a>
<span class="sourceLineNo">2943</span>     *  &lt;li&gt;When mode=0x02, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.2943"></a>
<span class="sourceLineNo">2944</span>     *  &lt;li&gt;When mode=0x03, is the transaction current number [6 Bytes,ASCII code].&lt;/li&gt;<a name="line.2944"></a>
<span class="sourceLineNo">2945</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.2945"></a>
<span class="sourceLineNo">2946</span>     * @param mode &lt;div class="zh"&gt; PIN BLOCK的格式。<a name="line.2946"></a>
<span class="sourceLineNo">2947</span>     * &lt;ul&gt;<a name="line.2947"></a>
<span class="sourceLineNo">2948</span>     *  &lt;li&gt;0x00:ISO9564 格式0。该模式有频度控制，触发频度控制时返回{@link EPedDevException #PED_ERR_WAIT_INTERVAL}。&lt;/li&gt;<a name="line.2948"></a>
<span class="sourceLineNo">2949</span>     *  &lt;li&gt;0x01:ISO9564 格式1。&lt;/li&gt;<a name="line.2949"></a>
<span class="sourceLineNo">2950</span>     *  &lt;li&gt;0x02:ISO9564 格式3。&lt;/li&gt;<a name="line.2950"></a>
<span class="sourceLineNo">2951</span>     *  &lt;li&gt;0x03:HK EPS 格式。&lt;/li&gt;<a name="line.2951"></a>
<span class="sourceLineNo">2952</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.2952"></a>
<span class="sourceLineNo">2953</span>     * &lt;div class="en"&gt; PIN BLOCK Format.<a name="line.2953"></a>
<span class="sourceLineNo">2954</span>     *  &lt;ul&gt;<a name="line.2954"></a>
<span class="sourceLineNo">2955</span>     *   &lt;li&gt;0x00:ISO9564 format 0. This mode has frequency control, which returns {@link EPedDevException #PED_ERR_WAIT_INTERVAL} when triggered.&lt;/li&gt;<a name="line.2955"></a>
<span class="sourceLineNo">2956</span>     *   &lt;li&gt;0x01:ISO9564 format 1.&lt;/li&gt;<a name="line.2956"></a>
<span class="sourceLineNo">2957</span>     *   &lt;li&gt;0x02:ISO9564 format 3.&lt;/li&gt;<a name="line.2957"></a>
<span class="sourceLineNo">2958</span>     *   &lt;li&gt;0x03:HK EPS format.&lt;/li&gt;<a name="line.2958"></a>
<span class="sourceLineNo">2959</span>     *  &lt;/ul&gt;&lt;/div&gt;<a name="line.2959"></a>
<span class="sourceLineNo">2960</span>     *<a name="line.2960"></a>
<span class="sourceLineNo">2961</span>     * @return &lt;div class="zh"&gt;8字节的PinBlock。&lt;/div&gt; &lt;div class="en"&gt;8-byte PinBlock.&lt;/div&gt;<a name="line.2961"></a>
<span class="sourceLineNo">2962</span>     *<a name="line.2962"></a>
<span class="sourceLineNo">2963</span>     * @throws PedDevException<a name="line.2963"></a>
<span class="sourceLineNo">2964</span>     * @since V3.13.00<a name="line.2964"></a>
<span class="sourceLineNo">2965</span>     */<a name="line.2965"></a>
<span class="sourceLineNo">2966</span>    byte[] pinEndGetPinBlock(byte keyIndex, byte[] dataIn, byte mode) throws PedDevException;<a name="line.2966"></a>
<span class="sourceLineNo">2967</span><a name="line.2967"></a>
<span class="sourceLineNo">2968</span>    /**<a name="line.2968"></a>
<span class="sourceLineNo">2969</span>     * &lt;div class="zh"&gt;在{@link #inputPin(String, long, byte)}输入完毕后，使用DUKPT的PIN密钥计算PinBlock。PIN将被清空。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt;<a name="line.2969"></a>
<span class="sourceLineNo">2970</span>     * &lt;div class="en"&gt;After {@link #inputPin(String, long, byte)} is entered, calculate the PinBlock using DUKPT's Pin key.<a name="line.2970"></a>
<span class="sourceLineNo">2971</span>     * The PIN will be cleared. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.2971"></a>
<span class="sourceLineNo">2972</span>     *<a name="line.2972"></a>
<span class="sourceLineNo">2973</span>     * @param groupIndex &lt;div class="zh"&gt; [1~100] DUKPT密钥组索引号 &lt;/div&gt; &lt;div class="en"&gt; [1~100]DUKPT key group id &lt;/div&gt;<a name="line.2973"></a>
<span class="sourceLineNo">2974</span>     *<a name="line.2974"></a>
<span class="sourceLineNo">2975</span>     * @param dataIn &lt;div class="zh"&gt;<a name="line.2975"></a>
<span class="sourceLineNo">2976</span>     * &lt;ul&gt;<a name="line.2976"></a>
<span class="sourceLineNo">2977</span>     * &lt;li&gt;当mode=00/20时，DataIn指向卡号移位后生成的16位主帐号，不包含校验位。&lt;/li&gt;<a name="line.2977"></a>
<span class="sourceLineNo">2978</span>     * &lt;li&gt;当mode=01/21时，DataIn被忽略,接口内部采用随机数填充PINBlock。 &lt;/li&gt;<a name="line.2978"></a>
<span class="sourceLineNo">2979</span>     * &lt;li&gt;当mode=02/22时，DataIn指向位移后的16位PAN。&lt;/li&gt;<a name="line.2979"></a>
<span class="sourceLineNo">2980</span>     * &lt;li&gt;当mode=03/23时，为交易流水号ISN [6 Bytes,ASCII码]。&lt;/li&gt;<a name="line.2980"></a>
<span class="sourceLineNo">2981</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.2981"></a>
<span class="sourceLineNo">2982</span>     * &lt;div class="en"&gt;<a name="line.2982"></a>
<span class="sourceLineNo">2983</span>     * &lt;ul&gt;<a name="line.2983"></a>
<span class="sourceLineNo">2984</span>     * &lt;li&gt;When mode=00/20, DataIn is the 16 bytes primary account number after shifting, excluding the check bit.&lt;/li&gt;<a name="line.2984"></a>
<span class="sourceLineNo">2985</span>     * &lt;li&gt;When mode=01/21, DataIn is ignored. The interface uses random numbers to fill PINBlock internally.&lt;/li&gt;<a name="line.2985"></a>
<span class="sourceLineNo">2986</span>     * &lt;li&gt;When mode=02/22, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.2986"></a>
<span class="sourceLineNo">2987</span>     * &lt;li&gt;When mode=03/23, is the transaction current number [6 Bytes,ASCII code].&lt;/li&gt;<a name="line.2987"></a>
<span class="sourceLineNo">2988</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.2988"></a>
<span class="sourceLineNo">2989</span>     *<a name="line.2989"></a>
<span class="sourceLineNo">2990</span>     * @param mode &lt;div class="zh"&gt;<a name="line.2990"></a>
<span class="sourceLineNo">2991</span>     * &lt;ul&gt;<a name="line.2991"></a>
<span class="sourceLineNo">2992</span>     * &lt;li&gt;00:ISO9564 格式0， KSN自动加1。&lt;/li&gt;<a name="line.2992"></a>
<span class="sourceLineNo">2993</span>     * &lt;li&gt;01:ISO9564 格式1， KSN自动加1。&lt;/li&gt;<a name="line.2993"></a>
<span class="sourceLineNo">2994</span>     * &lt;li&gt;02:ISO9564 格式3 ，KSN自动加1。&lt;/li&gt;<a name="line.2994"></a>
<span class="sourceLineNo">2995</span>     * &lt;li&gt;03:HK EPS格式， KSN自动加1。&lt;/li&gt;<a name="line.2995"></a>
<span class="sourceLineNo">2996</span>     * &lt;li&gt;20:ISO9564 格式0，KSN不自动加1。&lt;/li&gt;<a name="line.2996"></a>
<span class="sourceLineNo">2997</span>     * &lt;li&gt;21:ISO9564 格式1，KSN不自动加1。&lt;/li&gt;<a name="line.2997"></a>
<span class="sourceLineNo">2998</span>     * &lt;li&gt;22:ISO9564 格式3，KSN不自动加1。&lt;/li&gt;<a name="line.2998"></a>
<span class="sourceLineNo">2999</span>     * &lt;li&gt;23:HK EPS格式， KSN不自动加1。&lt;/li&gt;<a name="line.2999"></a>
<span class="sourceLineNo">3000</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.3000"></a>
<span class="sourceLineNo">3001</span>     * &lt;div class="en"&gt;<a name="line.3001"></a>
<span class="sourceLineNo">3002</span>     * &lt;ul&gt;<a name="line.3002"></a>
<span class="sourceLineNo">3003</span>     * &lt;li&gt;00:ISO9564 format 0, KSN automatically add 1.&lt;/li&gt;<a name="line.3003"></a>
<span class="sourceLineNo">3004</span>     * &lt;li&gt;01:ISO9564 format 1, KSN automatically add 1.&lt;/li&gt;<a name="line.3004"></a>
<span class="sourceLineNo">3005</span>     * &lt;li&gt;02:ISO9564 format 3, KSN automatically add 1.&lt;/li&gt;<a name="line.3005"></a>
<span class="sourceLineNo">3006</span>     * &lt;li&gt;03:HK EPS format, KSN automatically add 1.&lt;/li&gt;<a name="line.3006"></a>
<span class="sourceLineNo">3007</span>     * &lt;li&gt;20:ISO9564 format 0,KSN doesn't automatically add 1.&lt;/li&gt;<a name="line.3007"></a>
<span class="sourceLineNo">3008</span>     * &lt;li&gt;21:ISO9564 format 1,KSN doesn't automatically add 1.&lt;/li&gt;<a name="line.3008"></a>
<span class="sourceLineNo">3009</span>     * &lt;li&gt;22:ISO9564 format 3,KSN doesn't automatically add 1.&lt;/li&gt;<a name="line.3009"></a>
<span class="sourceLineNo">3010</span>     * &lt;li&gt;23:HK EPS format, KSN doesn't automatically add 1.&lt;/li&gt;<a name="line.3010"></a>
<span class="sourceLineNo">3011</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.3011"></a>
<span class="sourceLineNo">3012</span>     *<a name="line.3012"></a>
<span class="sourceLineNo">3013</span>     * @return {@link DUKPTResult}<a name="line.3013"></a>
<span class="sourceLineNo">3014</span>     *<a name="line.3014"></a>
<span class="sourceLineNo">3015</span>     * @throws PedDevException<a name="line.3015"></a>
<span class="sourceLineNo">3016</span>     * @since V3.13.00<a name="line.3016"></a>
<span class="sourceLineNo">3017</span>     */<a name="line.3017"></a>
<span class="sourceLineNo">3018</span>    DUKPTResult pinEndGetDukptPin(byte groupIndex, byte[] dataIn, byte mode) throws PedDevException;<a name="line.3018"></a>
<span class="sourceLineNo">3019</span><a name="line.3019"></a>
<span class="sourceLineNo">3020</span>    /**<a name="line.3020"></a>
<span class="sourceLineNo">3021</span>     * &lt;div class="zh"&gt;在{@link #inputPin(String, long, byte)}输入完毕后，使用AES DUKPT的PIN密钥计算PinBlock。PIN将被清空。仅支持{@link EPedType#INTERNAL} 类型。 &lt;/div&gt;<a name="line.3021"></a>
<span class="sourceLineNo">3022</span>     * &lt;div class="en"&gt;After {@link #inputPin(String, long, byte)} is entered, calculate the PinBlock using AES DUKPT's Pin key.<a name="line.3022"></a>
<span class="sourceLineNo">3023</span>     * The PIN will be cleared. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3023"></a>
<span class="sourceLineNo">3024</span>     *<a name="line.3024"></a>
<span class="sourceLineNo">3025</span>     * @param groupIndex &lt;div class="zh"&gt;[1~40] AES DUKPT密钥组索引号 。&lt;/div&gt; &lt;div class="en"&gt; [1~40] AES DUKPT key group id. &lt;/div&gt;<a name="line.3025"></a>
<span class="sourceLineNo">3026</span>     *<a name="line.3026"></a>
<span class="sourceLineNo">3027</span>     * @param dataIn &lt;div class="zh"&gt;<a name="line.3027"></a>
<span class="sourceLineNo">3028</span>     * &lt;ul&gt;<a name="line.3028"></a>
<span class="sourceLineNo">3029</span>     * &lt;li&gt;当mode=0x20时，dataIn指向卡号移位后生成的16位主帐号，不包含校验位。&lt;/li&gt;<a name="line.3029"></a>
<span class="sourceLineNo">3030</span>     * &lt;li&gt;当mode=0x21时，dataIn未使用，但是不能为NULL。 &lt;/li&gt;<a name="line.3030"></a>
<span class="sourceLineNo">3031</span>     * &lt;li&gt;当mode=0x22时，dataIn指向卡号移位后生成的16位主帐号，不包含校验位。&lt;/li&gt;<a name="line.3031"></a>
<span class="sourceLineNo">3032</span>     * &lt;li&gt;当mode=0x23时，为交易流水号ISN [6 Bytes,ASCII码]。&lt;/li&gt;<a name="line.3032"></a>
<span class="sourceLineNo">3033</span>     * &lt;li&gt;当mode=0x24时，dataIn为主账号。&lt;/li&gt;<a name="line.3033"></a>
<span class="sourceLineNo">3034</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.3034"></a>
<span class="sourceLineNo">3035</span>     * &lt;div class="en"&gt;<a name="line.3035"></a>
<span class="sourceLineNo">3036</span>     * &lt;ul&gt;<a name="line.3036"></a>
<span class="sourceLineNo">3037</span>     * &lt;li&gt;When mode=0x20, dataIn points to the 16-bit primary account generated after the card number shift, excluding the check bit.&lt;/li&gt;<a name="line.3037"></a>
<span class="sourceLineNo">3038</span>     * &lt;li&gt;When mode=0x21, dataIn is not in use, but cannot be NULL.&lt;/li&gt;<a name="line.3038"></a>
<span class="sourceLineNo">3039</span>     * &lt;li&gt;When mode=0x22, dataIn points to the 16-bit primary account generated after the card number shift, excluding the check bit.&lt;/li&gt;<a name="line.3039"></a>
<span class="sourceLineNo">3040</span>     * &lt;li&gt;When mode=0x23, is the transaction current number [6 Bytes,ASCII code].&lt;/li&gt;<a name="line.3040"></a>
<span class="sourceLineNo">3041</span>     * &lt;li&gt;When mode=0x24, dataIn is primary account.&lt;/li&gt;<a name="line.3041"></a>
<span class="sourceLineNo">3042</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.3042"></a>
<span class="sourceLineNo">3043</span>     *<a name="line.3043"></a>
<span class="sourceLineNo">3044</span>     * @param eAlgorithmType {@link EAlgorithmType}<a name="line.3044"></a>
<span class="sourceLineNo">3045</span>     *<a name="line.3045"></a>
<span class="sourceLineNo">3046</span>     * @param mode &lt;div class="zh"&gt;<a name="line.3046"></a>
<span class="sourceLineNo">3047</span>     * &lt;ul&gt;<a name="line.3047"></a>
<span class="sourceLineNo">3048</span>     * &lt;li&gt;0x20:ISO9564 格式0，KSN不自动加1。&lt;/li&gt;<a name="line.3048"></a>
<span class="sourceLineNo">3049</span>     * &lt;li&gt;0x21:ISO9564 格式1，KSN不自动加1。&lt;/li&gt;<a name="line.3049"></a>
<span class="sourceLineNo">3050</span>     * &lt;li&gt;0x22:ISO9564 格式3，KSN不自动加1。&lt;/li&gt;<a name="line.3050"></a>
<span class="sourceLineNo">3051</span>     * &lt;li&gt;0x23:HK EPS格式， KSN不自动加1。&lt;/li&gt;<a name="line.3051"></a>
<span class="sourceLineNo">3052</span>     * &lt;li&gt;0x24:ISO9564 格式4，KSN不自动加1。&lt;/li&gt;<a name="line.3052"></a>
<span class="sourceLineNo">3053</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.3053"></a>
<span class="sourceLineNo">3054</span>     * &lt;div class="en"&gt;<a name="line.3054"></a>
<span class="sourceLineNo">3055</span>     * &lt;ul&gt;<a name="line.3055"></a>
<span class="sourceLineNo">3056</span>     * &lt;li&gt;0x20:ISO9564 format 0,KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3056"></a>
<span class="sourceLineNo">3057</span>     * &lt;li&gt;0x21:ISO9564 format 1,KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3057"></a>
<span class="sourceLineNo">3058</span>     * &lt;li&gt;0x22:ISO9564 format 3,KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3058"></a>
<span class="sourceLineNo">3059</span>     * &lt;li&gt;0x23:HK EPS format, KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3059"></a>
<span class="sourceLineNo">3060</span>     * &lt;li&gt;0x24:ISO9564 format 4,KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3060"></a>
<span class="sourceLineNo">3061</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.3061"></a>
<span class="sourceLineNo">3062</span>     *<a name="line.3062"></a>
<span class="sourceLineNo">3063</span>     * @return {@link DUKPTResult}<a name="line.3063"></a>
<span class="sourceLineNo">3064</span>     *<a name="line.3064"></a>
<span class="sourceLineNo">3065</span>     * @throws PedDevException<a name="line.3065"></a>
<span class="sourceLineNo">3066</span>     * @since V3.13.00<a name="line.3066"></a>
<span class="sourceLineNo">3067</span>     */<a name="line.3067"></a>
<span class="sourceLineNo">3068</span>    DUKPTResult pinEndGetAesDukptPin(byte groupIndex, byte[] dataIn, EAlgorithmType eAlgorithmType, byte mode) throws PedDevException;<a name="line.3068"></a>
<span class="sourceLineNo">3069</span><a name="line.3069"></a>
<span class="sourceLineNo">3070</span>    /**<a name="line.3070"></a>
<span class="sourceLineNo">3071</span>     * &lt;div class="zh"&gt;在{@link #inputPin(String, long, byte)}输入完毕后，进行脱机明文PIN校验功能。<a name="line.3071"></a>
<span class="sourceLineNo">3072</span>     * 按照应用提供的卡片命令与卡片通道号，将明文PinBlock直接发送给卡片。PIN将被清空。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.3072"></a>
<span class="sourceLineNo">3073</span>     * &lt;div class="en"&gt;After {@link #inputPin(String, long, byte)} is entered, offline plaintext PIN validation is performed.<a name="line.3073"></a>
<span class="sourceLineNo">3074</span>     * Send the clear text PinBlock directly to the card according to the card command and card channel number provided by<a name="line.3074"></a>
<span class="sourceLineNo">3075</span>     * the application。 The PIN will be cleared. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3075"></a>
<span class="sourceLineNo">3076</span>     *<a name="line.3076"></a>
<span class="sourceLineNo">3077</span>     * @param slot &lt;div class="zh"&gt; 卡片所在的卡座号。 &lt;/div&gt; &lt;div class="en"&gt;The card slot number. &lt;/div&gt;<a name="line.3077"></a>
<span class="sourceLineNo">3078</span>     *<a name="line.3078"></a>
<span class="sourceLineNo">3079</span>     * @param mode &lt;div class="zh"&gt;<a name="line.3079"></a>
<span class="sourceLineNo">3080</span>     *              &lt;ul&gt;<a name="line.3080"></a>
<span class="sourceLineNo">3081</span>     *                  &lt;li&gt;0x00: I C卡命令模式，现支持符合EMV2000的IC卡命令。&lt;/li&gt;<a name="line.3081"></a>
<span class="sourceLineNo">3082</span>     *                  &lt;li&gt;0x01: 给WIC使用。&lt;/li&gt;<a name="line.3082"></a>
<span class="sourceLineNo">3083</span>     *              &lt;/ul&gt;<a name="line.3083"></a>
<span class="sourceLineNo">3084</span>     *             &lt;/div&gt;<a name="line.3084"></a>
<span class="sourceLineNo">3085</span>     *             &lt;div class="en"&gt;<a name="line.3085"></a>
<span class="sourceLineNo">3086</span>     *              &lt;ul&gt;<a name="line.3086"></a>
<span class="sourceLineNo">3087</span>     *                  &lt;li&gt;0x00: IC Card Command Mode,Currently support EMV2000.&lt;/li&gt;<a name="line.3087"></a>
<span class="sourceLineNo">3088</span>     *                  &lt;li&gt;0x01: For WIC.&lt;/li&gt;<a name="line.3088"></a>
<span class="sourceLineNo">3089</span>     *              &lt;/ul&gt;<a name="line.3089"></a>
<span class="sourceLineNo">3090</span>     *             &lt;/div&gt;<a name="line.3090"></a>
<span class="sourceLineNo">3091</span>     *<a name="line.3091"></a>
<span class="sourceLineNo">3092</span>     * @return &lt;div class="zh"&gt; 卡片响应的状态码 (2字节：SW1+SW2) &lt;/div&gt;<a name="line.3092"></a>
<span class="sourceLineNo">3093</span>     * &lt;div class="en"&gt; The status code of card response (2 bytes: SW1+SW2). &lt;/div&gt;<a name="line.3093"></a>
<span class="sourceLineNo">3094</span>     *<a name="line.3094"></a>
<span class="sourceLineNo">3095</span>     * @throws PedDevException<a name="line.3095"></a>
<span class="sourceLineNo">3096</span>     * @since V3.13.00<a name="line.3096"></a>
<span class="sourceLineNo">3097</span>     */<a name="line.3097"></a>
<span class="sourceLineNo">3098</span>    byte[] pinEndVerifyPlainPin(byte slot, byte mode) throws PedDevException;<a name="line.3098"></a>
<span class="sourceLineNo">3099</span><a name="line.3099"></a>
<span class="sourceLineNo">3100</span>    /**<a name="line.3100"></a>
<span class="sourceLineNo">3101</span>     * &lt;div class="zh"&gt; 在{@link #inputPin(String, long, byte)}输入完毕后，进行脱机密文PIN校验功能。先获取明文PIN，再用应用提供的RsaPinKey<a name="line.3101"></a>
<span class="sourceLineNo">3102</span>     * 对明文PIN按照EMV规范进行加密，然后用应用提供的卡片命令与卡片通道号，将密文PIN直接发送给卡片 。PIN将被清空。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.3102"></a>
<span class="sourceLineNo">3103</span>     * &lt;div class="en"&gt;After {@link #inputPin(String, long, byte)} is entered, verify enciphered PIN offline is performed. Get plain text PIN and then<a name="line.3103"></a>
<span class="sourceLineNo">3104</span>     * use RsaPinKey provided by application to encrypt plaintext PIN according to EMV standard. Send enciphered PIN to card according to card command<a name="line.3104"></a>
<span class="sourceLineNo">3105</span>     * and card channel number provided by application. The PIN will be cleared.{@link EPedType#INTERNAL} only is supported. &lt;/div&gt;<a name="line.3105"></a>
<span class="sourceLineNo">3106</span>     *<a name="line.3106"></a>
<span class="sourceLineNo">3107</span>     * @param slot &lt;div class="zh"&gt; 卡片所在的卡座号。 &lt;/div&gt; &lt;div class="en"&gt;The card slot number. &lt;/div&gt;<a name="line.3107"></a>
<span class="sourceLineNo">3108</span>     *<a name="line.3108"></a>
<span class="sourceLineNo">3109</span>     * @param rsaPinKey {@link RSAPinKey}<a name="line.3109"></a>
<span class="sourceLineNo">3110</span>     *<a name="line.3110"></a>
<span class="sourceLineNo">3111</span>     * @param mode &lt;div class="zh"&gt; 0x00 IC卡命令模式，目前支持EMV2000。 &lt;/div&gt; &lt;div class="en"&gt; 0x00 IC Card Command Mode,Currently support EMV2000. &lt;/div&gt;<a name="line.3111"></a>
<span class="sourceLineNo">3112</span>     *<a name="line.3112"></a>
<span class="sourceLineNo">3113</span>     * @return &lt;div class="zh"&gt; 卡片响应的状态码 (2字节：SW1+SW2) &lt;/div&gt;<a name="line.3113"></a>
<span class="sourceLineNo">3114</span>     * &lt;div class="en"&gt; The status code of card response (2 bytes: SW1+SW2). &lt;/div&gt;<a name="line.3114"></a>
<span class="sourceLineNo">3115</span>     *<a name="line.3115"></a>
<span class="sourceLineNo">3116</span>     * @throws PedDevException<a name="line.3116"></a>
<span class="sourceLineNo">3117</span>     * @since V3.13.00<a name="line.3117"></a>
<span class="sourceLineNo">3118</span>     */<a name="line.3118"></a>
<span class="sourceLineNo">3119</span>    byte[] pinEndVerifyCipherPin(byte slot, RSAPinKey rsaPinKey, byte mode) throws PedDevException;<a name="line.3119"></a>
<span class="sourceLineNo">3120</span><a name="line.3120"></a>
<span class="sourceLineNo">3121</span>    /**<a name="line.3121"></a>
<span class="sourceLineNo">3122</span>     * &lt;div class="zh"&gt;设置PED密码键盘类型。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.3122"></a>
<span class="sourceLineNo">3123</span>     * &lt;div class="en"&gt;Set the PED keyboard type. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3123"></a>
<span class="sourceLineNo">3124</span>     *<a name="line.3124"></a>
<span class="sourceLineNo">3125</span>     * @param type &lt;div class="zh"&gt;<a name="line.3125"></a>
<span class="sourceLineNo">3126</span>     *  &lt;ul&gt;<a name="line.3126"></a>
<span class="sourceLineNo">3127</span>     *      &lt;li&gt;0x01:翻转PED密码键盘。&lt;/li&gt;<a name="line.3127"></a>
<span class="sourceLineNo">3128</span>     *      &lt;li&gt;0x02:盲人模式PED密码键盘。&lt;/li&gt;<a name="line.3128"></a>
<span class="sourceLineNo">3129</span>     *  &lt;/ul&gt;&lt;/div&gt;<a name="line.3129"></a>
<span class="sourceLineNo">3130</span>     * &lt;div class="en"&gt;<a name="line.3130"></a>
<span class="sourceLineNo">3131</span>     *  &lt;ul&gt;<a name="line.3131"></a>
<span class="sourceLineNo">3132</span>     *      &lt;li&gt;0x01:Flip the PED keyboard.&lt;/li&gt;<a name="line.3132"></a>
<span class="sourceLineNo">3133</span>     *      &lt;li&gt;0x02:Blind mode PED keyboard.&lt;/li&gt;<a name="line.3133"></a>
<span class="sourceLineNo">3134</span>     *  &lt;/ul&gt;&lt;/div&gt;<a name="line.3134"></a>
<span class="sourceLineNo">3135</span>     * @throws PedDevException<a name="line.3135"></a>
<span class="sourceLineNo">3136</span>     * @since V3.15.00<a name="line.3136"></a>
<span class="sourceLineNo">3137</span>     */<a name="line.3137"></a>
<span class="sourceLineNo">3138</span>    void setKeyboard(byte type) throws PedDevException;<a name="line.3138"></a>
<span class="sourceLineNo">3139</span><a name="line.3139"></a>
<span class="sourceLineNo">3140</span>    /**<a name="line.3140"></a>
<span class="sourceLineNo">3141</span>     * &lt;div class="zh"&gt;擦除指定的密钥。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.3141"></a>
<span class="sourceLineNo">3142</span>     * &lt;div class="en"&gt;Erases the specified key. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3142"></a>
<span class="sourceLineNo">3143</span>     *<a name="line.3143"></a>
<span class="sourceLineNo">3144</span>     * @param keyType  &lt;div class="zh"&gt;密钥类型。<a name="line.3144"></a>
<span class="sourceLineNo">3145</span>     *                 &lt;ul&gt;<a name="line.3145"></a>
<span class="sourceLineNo">3146</span>     *                 &lt;li&gt;0x02: TMK[1~100]&lt;/li&gt;<a name="line.3146"></a>
<span class="sourceLineNo">3147</span>     *                 &lt;li&gt;0x0A: TWK[1~100]&lt;/li&gt;<a name="line.3147"></a>
<span class="sourceLineNo">3148</span>     *                 &lt;li&gt;0x07: TIK[1~100]&lt;/li&gt;<a name="line.3148"></a>
<span class="sourceLineNo">3149</span>     *                 &lt;li&gt;0x51: AES_TIK[1~100]&lt;/li&gt;<a name="line.3149"></a>
<span class="sourceLineNo">3150</span>     *                 &lt;li&gt;0X0B: RSA[1~20]&lt;/li&gt;<a name="line.3150"></a>
<span class="sourceLineNo">3151</span>     *                 &lt;li&gt;0x30: SM2_PVT_KEY[1~20]&lt;/li&gt;<a name="line.3151"></a>
<span class="sourceLineNo">3152</span>     *                 &lt;li&gt;0x31: SM2_PUB_KEY[1~20]&lt;/li&gt;<a name="line.3152"></a>
<span class="sourceLineNo">3153</span>     *                 &lt;li&gt;0x46: SALT_KEY[1~2]&lt;/li&gt;<a name="line.3153"></a>
<span class="sourceLineNo">3154</span>     *                 &lt;/ul&gt;<a name="line.3154"></a>
<span class="sourceLineNo">3155</span>     *                 &lt;/div&gt;<a name="line.3155"></a>
<span class="sourceLineNo">3156</span>     *                 &lt;div class="en"&gt;Key type.<a name="line.3156"></a>
<span class="sourceLineNo">3157</span>     *                 &lt;ul&gt;<a name="line.3157"></a>
<span class="sourceLineNo">3158</span>     *                 &lt;li&gt;0x02: TMK[1~100]&lt;/li&gt;<a name="line.3158"></a>
<span class="sourceLineNo">3159</span>     *                 &lt;li&gt;0x0A: TWK[1~100]&lt;/li&gt;<a name="line.3159"></a>
<span class="sourceLineNo">3160</span>     *                 &lt;li&gt;0x07: TIK[1~100]&lt;/li&gt;<a name="line.3160"></a>
<span class="sourceLineNo">3161</span>     *                 &lt;li&gt;0x51: AES_TIK[1~100]&lt;/li&gt;<a name="line.3161"></a>
<span class="sourceLineNo">3162</span>     *                 &lt;li&gt;0X0B: RSA[1~20]&lt;/li&gt;<a name="line.3162"></a>
<span class="sourceLineNo">3163</span>     *                 &lt;li&gt;0x30: SM2_PVT_KEY[1~20]&lt;/li&gt;<a name="line.3163"></a>
<span class="sourceLineNo">3164</span>     *                 &lt;li&gt;0x31: SM2_PUB_KEY[1~20]&lt;/li&gt;<a name="line.3164"></a>
<span class="sourceLineNo">3165</span>     *                 &lt;li&gt;0x46: SALT_KEY[1~2]&lt;/li&gt;<a name="line.3165"></a>
<span class="sourceLineNo">3166</span>     *                 &lt;/ul&gt;&lt;/div&gt;<a name="line.3166"></a>
<span class="sourceLineNo">3167</span>     * @param keyIndex &lt;div class="zh"&gt;密钥索引。&lt;/div&gt; &lt;div class="en"&gt;Key index.&lt;/div&gt;<a name="line.3167"></a>
<span class="sourceLineNo">3168</span>     * @throws PedDevException<a name="line.3168"></a>
<span class="sourceLineNo">3169</span>     * @since V3.15.00<a name="line.3169"></a>
<span class="sourceLineNo">3170</span>     */<a name="line.3170"></a>
<span class="sourceLineNo">3171</span>    void eraseKey(byte keyType, byte keyIndex) throws PedDevException;<a name="line.3171"></a>
<span class="sourceLineNo">3172</span><a name="line.3172"></a>
<span class="sourceLineNo">3173</span>    /**<a name="line.3173"></a>
<span class="sourceLineNo">3174</span>     * &lt;div class="zh"&gt;写入TR31格式的密钥到PED。包括TMK、TWK、TIK、AES_TMK、AES_TWK和AES_TIK。&lt;/div&gt;&lt;div class="en"&gt;To write keys in TR31 format into PED, including TMK,TWK,TIK,AES_TMK,AES_TWK and AES_TIK.&lt;/div&gt;<a name="line.3174"></a>
<span class="sourceLineNo">3175</span>     *<a name="line.3175"></a>
<span class="sourceLineNo">3176</span>     * @param srcKeyType &lt;div class="zh"&gt;原密钥类型。<a name="line.3176"></a>
<span class="sourceLineNo">3177</span>     *                   &lt;ul&gt;<a name="line.3177"></a>
<span class="sourceLineNo">3178</span>     *                    &lt;li&gt;0x01:{@link EPedKeyType#TLK}&lt;/li&gt;<a name="line.3178"></a>
<span class="sourceLineNo">3179</span>     *                    &lt;li&gt;0x02:{@link EPedKeyType#TMK}&lt;/li&gt;<a name="line.3179"></a>
<span class="sourceLineNo">3180</span>     *                    &lt;li&gt;0x22:{@link EPedKeyType#AES_TMK}&lt;/li&gt;<a name="line.3180"></a>
<span class="sourceLineNo">3181</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.3181"></a>
<span class="sourceLineNo">3182</span>     *                   &lt;div class="en"&gt;The source key type.<a name="line.3182"></a>
<span class="sourceLineNo">3183</span>     *                   &lt;ul&gt;<a name="line.3183"></a>
<span class="sourceLineNo">3184</span>     *                    &lt;li&gt;0x01:{@link EPedKeyType#TLK}&lt;/li&gt;<a name="line.3184"></a>
<span class="sourceLineNo">3185</span>     *                    &lt;li&gt;0x02:{@link EPedKeyType#TMK}&lt;/li&gt;<a name="line.3185"></a>
<span class="sourceLineNo">3186</span>     *                    &lt;li&gt;0x22:{@link EPedKeyType#AES_TMK}&lt;/li&gt;<a name="line.3186"></a>
<span class="sourceLineNo">3187</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.3187"></a>
<span class="sourceLineNo">3188</span>     * @param srcKeyIndex &lt;div class="zh"&gt;原密钥索引。<a name="line.3188"></a>
<span class="sourceLineNo">3189</span>     *                    &lt;ul&gt;<a name="line.3189"></a>
<span class="sourceLineNo">3190</span>     *                     &lt;li&gt;如果srcKeyType等于{@link EPedKeyType#TLK}时，索引为1.&lt;/li&gt;<a name="line.3190"></a>
<span class="sourceLineNo">3191</span>     *                     &lt;li&gt;如果srcKeyType等于{@link EPedKeyType#TMK}时，索引为[1~100].&lt;/li&gt;<a name="line.3191"></a>
<span class="sourceLineNo">3192</span>     *                     &lt;li&gt;如果srcKeyType等于{@link EPedKeyType#AES_TMK}时，索引为[1~100].&lt;/li&gt;<a name="line.3192"></a>
<span class="sourceLineNo">3193</span>     *                    &lt;/ul&gt;&lt;/div&gt;<a name="line.3193"></a>
<span class="sourceLineNo">3194</span>     *                    &lt;div class="en"&gt;The source key index.<a name="line.3194"></a>
<span class="sourceLineNo">3195</span>     *                    &lt;ul&gt;<a name="line.3195"></a>
<span class="sourceLineNo">3196</span>     *                     &lt;li&gt;If srcKeyType is equal to {@link EPedKeyType#TLK}, the index is 1.&lt;/li&gt;<a name="line.3196"></a>
<span class="sourceLineNo">3197</span>     *                     &lt;li&gt;If srcKeyType is equal to {@link EPedKeyType#TMK}, the index is [1~100].&lt;/li&gt;<a name="line.3197"></a>
<span class="sourceLineNo">3198</span>     *                     &lt;li&gt;If srcKeyType is equal to {@link EPedKeyType#AES_TMK}, the index is [1~100].&lt;/li&gt;<a name="line.3198"></a>
<span class="sourceLineNo">3199</span>     *                    &lt;/ul&gt;&lt;/div&gt;<a name="line.3199"></a>
<span class="sourceLineNo">3200</span>     * @param dstKeyIndex &lt;div class="zh"&gt;目的密钥索引。<a name="line.3200"></a>
<span class="sourceLineNo">3201</span>     *                    &lt;ul&gt;<a name="line.3201"></a>
<span class="sourceLineNo">3202</span>     *                     &lt;li&gt;如果dstKeyType等于{@link EPedKeyType#AES_TIK}时，索引为[1~40].&lt;/li&gt;<a name="line.3202"></a>
<span class="sourceLineNo">3203</span>     *                     &lt;li&gt;其他类型时，索引为[1~100].&lt;/li&gt;<a name="line.3203"></a>
<span class="sourceLineNo">3204</span>     *                    &lt;/ul&gt;&lt;/div&gt;<a name="line.3204"></a>
<span class="sourceLineNo">3205</span>     *                    &lt;div class="en"&gt;Destination key index.<a name="line.3205"></a>
<span class="sourceLineNo">3206</span>     *                    &lt;ul&gt;<a name="line.3206"></a>
<span class="sourceLineNo">3207</span>     *                     &lt;li&gt;If dstKeyType is equal to {@link EPedKeyType#AES_TIK}, the index is [1~40]&lt;/li&gt;<a name="line.3207"></a>
<span class="sourceLineNo">3208</span>     *                     &lt;li&gt;Other key types, the index is [1~100]&lt;/li&gt;<a name="line.3208"></a>
<span class="sourceLineNo">3209</span>     *                    &lt;/ul&gt;&lt;/div&gt;<a name="line.3209"></a>
<span class="sourceLineNo">3210</span>     * @param TR31KeyBlock &lt;div class="zh"&gt;TR31格式的密钥块。<a name="line.3210"></a>
<span class="sourceLineNo">3211</span>     *                     &lt;ul&gt;<a name="line.3211"></a>
<span class="sourceLineNo">3212</span>     *                      &lt;li&gt;Key Block Version ID (1 byte):<a name="line.3212"></a>
<span class="sourceLineNo">3213</span>     *                       &lt;br&gt;"B"-TDEA<a name="line.3213"></a>
<span class="sourceLineNo">3214</span>     *                       &lt;br&gt;"D"-AES&lt;/li&gt;<a name="line.3214"></a>
<span class="sourceLineNo">3215</span>     *                      &lt;li&gt;Key Block Length (4 bytes):编码后提供密钥块长度的ASCII十进制数字。例如，“0080”&lt;/li&gt;<a name="line.3215"></a>
<span class="sourceLineNo">3216</span>     *                      &lt;li&gt;Key Usage (2 bytes):<a name="line.3216"></a>
<span class="sourceLineNo">3217</span>     *                       &lt;br&gt;"P0"-PIN encryption<a name="line.3217"></a>
<span class="sourceLineNo">3218</span>     *                       &lt;br&gt;"B1"-DUKPT TIK<a name="line.3218"></a>
<span class="sourceLineNo">3219</span>     *                       &lt;br&gt;"K0"-TMK<a name="line.3219"></a>
<span class="sourceLineNo">3220</span>     *                       &lt;br&gt;"D0"-TDK<a name="line.3220"></a>
<span class="sourceLineNo">3221</span>     *                       &lt;br&gt;"Mx"-TAK<a name="line.3221"></a>
<span class="sourceLineNo">3222</span>     *                       &lt;br&gt;"C1"-TCHDK&lt;/li&gt;<a name="line.3222"></a>
<span class="sourceLineNo">3223</span>     *                      &lt;li&gt;Algorithm (1 byte):<a name="line.3223"></a>
<span class="sourceLineNo">3224</span>     *                       &lt;br&gt;"T"-TDEA<a name="line.3224"></a>
<span class="sourceLineNo">3225</span>     *                       &lt;br&gt;"A"-AES&lt;/li&gt;<a name="line.3225"></a>
<span class="sourceLineNo">3226</span>     *                      &lt;li&gt;Mode of Use (1 byte):ignore&lt;/li&gt;<a name="line.3226"></a>
<span class="sourceLineNo">3227</span>     *                      &lt;li&gt;Key Version Number (2 bytes):ignore&lt;/li&gt;<a name="line.3227"></a>
<span class="sourceLineNo">3228</span>     *                      &lt;li&gt;Exportability (1 byte):ignore&lt;/li&gt;<a name="line.3228"></a>
<span class="sourceLineNo">3229</span>     *                      &lt;li&gt;Number of Optional Blocks (2 bytes):00/01/02&lt;/li&gt;<a name="line.3229"></a>
<span class="sourceLineNo">3230</span>     *                      &lt;li&gt;Reserved field (2 bytes):ignore&lt;/li&gt;<a name="line.3230"></a>
<span class="sourceLineNo">3231</span>     *                      &lt;li&gt;Optional Blocks(密钥块中所有可选块的总长度将是加密块大小的倍数（TDES 为 8，AES 为 16）。<a name="line.3231"></a>
<span class="sourceLineNo">3232</span>     *                      这可能需要填充，如果需要填充，则包含在一个特殊的最终可选块中 填充了适当数量的填充字符。):<a name="line.3232"></a>
<span class="sourceLineNo">3233</span>     *                       &lt;br&gt;“KS”-(2 bytes option id) + len (2 bytes, hex-ASCII “18”) + 20 hex-ASCII characters KSN, (PED_TIK KSN)<a name="line.3233"></a>
<span class="sourceLineNo">3234</span>     *                       &lt;br&gt;“IK”-(2 bytes option id) + len (2 bytes, hex-ASCII “14”) + 16 hex-ASCII characters KSN (PED_AES_TIK Initial Key Identifier)<a name="line.3234"></a>
<span class="sourceLineNo">3235</span>     *                       &lt;br&gt;“PB”-(2 bytes option id) + len (2 bytes, hex-ASCII “0C”) + hex-ASCII characters padding&lt;/li&gt;<a name="line.3235"></a>
<span class="sourceLineNo">3236</span>     *                      &lt;li&gt;Encryption body:Cipher text (2 bytes len + key + padding)&lt;/li&gt;<a name="line.3236"></a>
<span class="sourceLineNo">3237</span>     *                      &lt;li&gt;MAC(TDES is 16 bytes, AES is 32 bytes):MAC&lt;/li&gt;<a name="line.3237"></a>
<span class="sourceLineNo">3238</span>     *                     &lt;/ul&gt;&lt;/div&gt;<a name="line.3238"></a>
<span class="sourceLineNo">3239</span>     *                     &lt;div class="en"&gt;Key blocks in TR31 format.<a name="line.3239"></a>
<span class="sourceLineNo">3240</span>     *                     &lt;ul&gt;<a name="line.3240"></a>
<span class="sourceLineNo">3241</span>     *                      &lt;li&gt;Key Block Version ID (1 byte):<a name="line.3241"></a>
<span class="sourceLineNo">3242</span>     *                       &lt;br&gt;"B"-TDEA<a name="line.3242"></a>
<span class="sourceLineNo">3243</span>     *                       &lt;br&gt;"D"-AES&lt;/li&gt;<a name="line.3243"></a>
<span class="sourceLineNo">3244</span>     *                     &lt;li&gt;Key Block Length (4 bytes):ASCII decimal numeric digits providing key block length after encoding.for example, “0080”&lt;/li&gt;<a name="line.3244"></a>
<span class="sourceLineNo">3245</span>     *                     &lt;li&gt;Key Usage (2 bytes):<a name="line.3245"></a>
<span class="sourceLineNo">3246</span>     *                      &lt;br&gt;"P0"-PIN encryption<a name="line.3246"></a>
<span class="sourceLineNo">3247</span>     *                      &lt;br&gt;"B1"-DUKPT TIK<a name="line.3247"></a>
<span class="sourceLineNo">3248</span>     *                      &lt;br&gt;"K0"-TMK<a name="line.3248"></a>
<span class="sourceLineNo">3249</span>     *                      &lt;br&gt;"D0"-TDK<a name="line.3249"></a>
<span class="sourceLineNo">3250</span>     *                      &lt;br&gt;"Mx"-TAK<a name="line.3250"></a>
<span class="sourceLineNo">3251</span>     *                      &lt;br&gt;"C1"-TCHDK&lt;/li&gt;<a name="line.3251"></a>
<span class="sourceLineNo">3252</span>     *                     &lt;li&gt;Algorithm (1 byte):<a name="line.3252"></a>
<span class="sourceLineNo">3253</span>     *                      &lt;br&gt;"T"-TDEA<a name="line.3253"></a>
<span class="sourceLineNo">3254</span>     *                      &lt;br&gt;"A"-AES&lt;/li&gt;<a name="line.3254"></a>
<span class="sourceLineNo">3255</span>     *                     &lt;li&gt;Mode of Use (1 byte):ignore&lt;/li&gt;<a name="line.3255"></a>
<span class="sourceLineNo">3256</span>     *                     &lt;li&gt;Key Version Number (2 bytes):ignore&lt;/li&gt;<a name="line.3256"></a>
<span class="sourceLineNo">3257</span>     *                     &lt;li&gt;Exportability (1 byte):ignore&lt;/li&gt;<a name="line.3257"></a>
<span class="sourceLineNo">3258</span>     *                     &lt;li&gt;Number of Optional Blocks (2 bytes):00/01/02&lt;/li&gt;<a name="line.3258"></a>
<span class="sourceLineNo">3259</span>     *                     &lt;li&gt;Reserved field (2 bytes):ignore&lt;/li&gt;<a name="line.3259"></a>
<span class="sourceLineNo">3260</span>     *                     &lt;li&gt;Optional Blocks((The total length of all optional blocks in the key block will be a multiple of the encryption block size (TDES is 8, AES is 16). This may require padding, and if padding is needed it is included in a special final optional block that is filled with an appropriate number of padding characters.):<a name="line.3260"></a>
<span class="sourceLineNo">3261</span>     *                      &lt;br&gt;“KS”-(2 bytes option id) + len (2 bytes, hex-ASCII “18”) + 20 hex-ASCII characters KSN, (PED_TIK KSN)<a name="line.3261"></a>
<span class="sourceLineNo">3262</span>     *                      &lt;br&gt;“IK”-(2 bytes option id) + len (2 bytes, hex-ASCII “14”) + 16 hex-ASCII characters KSN (PED_AES_TIK Initial Key Identifier)<a name="line.3262"></a>
<span class="sourceLineNo">3263</span>     *                      &lt;br&gt;“PB”-(2 bytes option id) + len (2 bytes, hex-ASCII “0C”) + hex-ASCII characters padding&lt;/li&gt;<a name="line.3263"></a>
<span class="sourceLineNo">3264</span>     *                     &lt;li&gt;Encryption body:Cipher text (2 bytes len + key + padding)&lt;/li&gt;<a name="line.3264"></a>
<span class="sourceLineNo">3265</span>     *                     &lt;li&gt;MAC(TDES is 16 bytes, AES is 32 bytes):MAC&lt;/li&gt;<a name="line.3265"></a>
<span class="sourceLineNo">3266</span>     *                    &lt;/ul&gt;&lt;/div&gt;<a name="line.3266"></a>
<span class="sourceLineNo">3267</span>     * @throws PedDevException<a name="line.3267"></a>
<span class="sourceLineNo">3268</span>     * @since V3.17.00<a name="line.3268"></a>
<span class="sourceLineNo">3269</span>     */<a name="line.3269"></a>
<span class="sourceLineNo">3270</span>    void writeTR31Key(byte srcKeyType, byte srcKeyIndex, byte dstKeyIndex, byte[] TR31KeyBlock) throws PedDevException;<a name="line.3270"></a>
<span class="sourceLineNo">3271</span><a name="line.3271"></a>
<span class="sourceLineNo">3272</span>    /**<a name="line.3272"></a>
<span class="sourceLineNo">3273</span>     * &lt;div class="zh"&gt;生成证书签名请求。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.3273"></a>
<span class="sourceLineNo">3274</span>     * &lt;div class="en"&gt;Generate the Certificate Signing Request. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3274"></a>
<span class="sourceLineNo">3275</span>     *<a name="line.3275"></a>
<span class="sourceLineNo">3276</span>     * @param pubKeyIndex &lt;div class="zh"&gt;RSA公钥索引。&lt;/div&gt; &lt;div class="en"&gt;RSA public key index.&lt;/div&gt;<a name="line.3276"></a>
<span class="sourceLineNo">3277</span>     *<a name="line.3277"></a>
<span class="sourceLineNo">3278</span>     * @param pvkKeyIndex &lt;div class="zh"&gt;RSA私钥索引。&lt;/div&gt; &lt;div class="en"&gt;RSA private key index.&lt;/div&gt;<a name="line.3278"></a>
<span class="sourceLineNo">3279</span>     *<a name="line.3279"></a>
<span class="sourceLineNo">3280</span>     * @param dn &lt;div class="zh"&gt;证书信息，如："C=CN,ST=GD,L=SZ,O=PAX,OU=PAX_DEV,CN=paxsz,E=inno_dev@paxsz.com"。常用如下:<a name="line.3280"></a>
<span class="sourceLineNo">3281</span>     *  &lt;table border="1"&gt;<a name="line.3281"></a>
<span class="sourceLineNo">3282</span>     *      &lt;tr&gt;<a name="line.3282"></a>
<span class="sourceLineNo">3283</span>     *          &lt;th&gt;字段&lt;/th&gt;<a name="line.3283"></a>
<span class="sourceLineNo">3284</span>     *          &lt;th&gt;说明&lt;/th&gt;<a name="line.3284"></a>
<span class="sourceLineNo">3285</span>     *          &lt;th&gt;示例&lt;/th&gt;<a name="line.3285"></a>
<span class="sourceLineNo">3286</span>     *      &lt;/tr&gt;<a name="line.3286"></a>
<span class="sourceLineNo">3287</span>     *      &lt;tr&gt;<a name="line.3287"></a>
<span class="sourceLineNo">3288</span>     *          &lt;td&gt;C&lt;/td&gt;<a name="line.3288"></a>
<span class="sourceLineNo">3289</span>     *          &lt;td&gt;Country Name&lt;/td&gt;<a name="line.3289"></a>
<span class="sourceLineNo">3290</span>     *          &lt;td&gt;CN&lt;/td&gt;<a name="line.3290"></a>
<span class="sourceLineNo">3291</span>     *      &lt;/tr&gt;<a name="line.3291"></a>
<span class="sourceLineNo">3292</span>     *      &lt;tr&gt;<a name="line.3292"></a>
<span class="sourceLineNo">3293</span>     *          &lt;td&gt;ST&lt;/td&gt;<a name="line.3293"></a>
<span class="sourceLineNo">3294</span>     *          &lt;td&gt;State or Province Name&lt;/td&gt;<a name="line.3294"></a>
<span class="sourceLineNo">3295</span>     *          &lt;td&gt;GD&lt;/td&gt;<a name="line.3295"></a>
<span class="sourceLineNo">3296</span>     *      &lt;/tr&gt;<a name="line.3296"></a>
<span class="sourceLineNo">3297</span>     *      &lt;tr&gt;<a name="line.3297"></a>
<span class="sourceLineNo">3298</span>     *          &lt;td&gt;L&lt;/td&gt;<a name="line.3298"></a>
<span class="sourceLineNo">3299</span>     *          &lt;td&gt;Locality Name&lt;/td&gt;<a name="line.3299"></a>
<span class="sourceLineNo">3300</span>     *          &lt;td&gt;SZ&lt;/td&gt;<a name="line.3300"></a>
<span class="sourceLineNo">3301</span>     *      &lt;/tr&gt;<a name="line.3301"></a>
<span class="sourceLineNo">3302</span>     *      &lt;tr&gt;<a name="line.3302"></a>
<span class="sourceLineNo">3303</span>     *          &lt;td&gt;O&lt;/td&gt;<a name="line.3303"></a>
<span class="sourceLineNo">3304</span>     *          &lt;td&gt;Organization Name&lt;/td&gt;<a name="line.3304"></a>
<span class="sourceLineNo">3305</span>     *          &lt;td&gt;PAX&lt;/td&gt;<a name="line.3305"></a>
<span class="sourceLineNo">3306</span>     *      &lt;/tr&gt;<a name="line.3306"></a>
<span class="sourceLineNo">3307</span>     *      &lt;tr&gt;<a name="line.3307"></a>
<span class="sourceLineNo">3308</span>     *          &lt;td&gt;OU&lt;/td&gt;<a name="line.3308"></a>
<span class="sourceLineNo">3309</span>     *          &lt;td&gt;Organization Unit Name&lt;/td&gt;<a name="line.3309"></a>
<span class="sourceLineNo">3310</span>     *          &lt;td&gt;PAX_DEV&lt;/td&gt;<a name="line.3310"></a>
<span class="sourceLineNo">3311</span>     *      &lt;/tr&gt;<a name="line.3311"></a>
<span class="sourceLineNo">3312</span>     *      &lt;tr&gt;<a name="line.3312"></a>
<span class="sourceLineNo">3313</span>     *          &lt;td&gt;CN&lt;/td&gt;<a name="line.3313"></a>
<span class="sourceLineNo">3314</span>     *          &lt;td&gt;Common Name&lt;/td&gt;<a name="line.3314"></a>
<span class="sourceLineNo">3315</span>     *          &lt;td&gt;paxsz&lt;/td&gt;<a name="line.3315"></a>
<span class="sourceLineNo">3316</span>     *      &lt;/tr&gt;<a name="line.3316"></a>
<span class="sourceLineNo">3317</span>     *      &lt;tr&gt;<a name="line.3317"></a>
<span class="sourceLineNo">3318</span>     *          &lt;td&gt;E&lt;/td&gt;<a name="line.3318"></a>
<span class="sourceLineNo">3319</span>     *          &lt;td&gt;Email Address&lt;/td&gt;<a name="line.3319"></a>
<span class="sourceLineNo">3320</span>     *          &lt;td&gt;inno_dev@paxsz.com&lt;/td&gt;<a name="line.3320"></a>
<span class="sourceLineNo">3321</span>     *      &lt;/tr&gt;<a name="line.3321"></a>
<span class="sourceLineNo">3322</span>     *  &lt;/table&gt;<a name="line.3322"></a>
<span class="sourceLineNo">3323</span>     * &lt;/div&gt;<a name="line.3323"></a>
<span class="sourceLineNo">3324</span>     * &lt;div class="en"&gt;Certificate information, such as: "C=CN,ST=GD,L=SZ,O=PAX,OU=PAX_DEV,CN=paxsz,E=inno_dev@paxsz.com".Commonly used as follows:<a name="line.3324"></a>
<span class="sourceLineNo">3325</span>     *  &lt;table border="1"&gt;<a name="line.3325"></a>
<span class="sourceLineNo">3326</span>     *      &lt;tr&gt;<a name="line.3326"></a>
<span class="sourceLineNo">3327</span>     *          &lt;th&gt;Field&lt;/th&gt;<a name="line.3327"></a>
<span class="sourceLineNo">3328</span>     *          &lt;th&gt;Instruction&lt;/th&gt;<a name="line.3328"></a>
<span class="sourceLineNo">3329</span>     *          &lt;th&gt;Sample&lt;/th&gt;<a name="line.3329"></a>
<span class="sourceLineNo">3330</span>     *      &lt;/tr&gt;<a name="line.3330"></a>
<span class="sourceLineNo">3331</span>     *      &lt;tr&gt;<a name="line.3331"></a>
<span class="sourceLineNo">3332</span>     *          &lt;td&gt;C&lt;/td&gt;<a name="line.3332"></a>
<span class="sourceLineNo">3333</span>     *          &lt;td&gt;Country Name&lt;/td&gt;<a name="line.3333"></a>
<span class="sourceLineNo">3334</span>     *          &lt;td&gt;CN&lt;/td&gt;<a name="line.3334"></a>
<span class="sourceLineNo">3335</span>     *      &lt;/tr&gt;<a name="line.3335"></a>
<span class="sourceLineNo">3336</span>     *      &lt;tr&gt;<a name="line.3336"></a>
<span class="sourceLineNo">3337</span>     *          &lt;td&gt;ST&lt;/td&gt;<a name="line.3337"></a>
<span class="sourceLineNo">3338</span>     *          &lt;td&gt;State or Province Name&lt;/td&gt;<a name="line.3338"></a>
<span class="sourceLineNo">3339</span>     *          &lt;td&gt;GD&lt;/td&gt;<a name="line.3339"></a>
<span class="sourceLineNo">3340</span>     *      &lt;/tr&gt;<a name="line.3340"></a>
<span class="sourceLineNo">3341</span>     *      &lt;tr&gt;<a name="line.3341"></a>
<span class="sourceLineNo">3342</span>     *          &lt;td&gt;L&lt;/td&gt;<a name="line.3342"></a>
<span class="sourceLineNo">3343</span>     *          &lt;td&gt;Locality Name&lt;/td&gt;<a name="line.3343"></a>
<span class="sourceLineNo">3344</span>     *          &lt;td&gt;SZ&lt;/td&gt;<a name="line.3344"></a>
<span class="sourceLineNo">3345</span>     *      &lt;/tr&gt;<a name="line.3345"></a>
<span class="sourceLineNo">3346</span>     *      &lt;tr&gt;<a name="line.3346"></a>
<span class="sourceLineNo">3347</span>     *          &lt;td&gt;O&lt;/td&gt;<a name="line.3347"></a>
<span class="sourceLineNo">3348</span>     *          &lt;td&gt;Organization Name&lt;/td&gt;<a name="line.3348"></a>
<span class="sourceLineNo">3349</span>     *          &lt;td&gt;PAX&lt;/td&gt;<a name="line.3349"></a>
<span class="sourceLineNo">3350</span>     *      &lt;/tr&gt;<a name="line.3350"></a>
<span class="sourceLineNo">3351</span>     *      &lt;tr&gt;<a name="line.3351"></a>
<span class="sourceLineNo">3352</span>     *          &lt;td&gt;OU&lt;/td&gt;<a name="line.3352"></a>
<span class="sourceLineNo">3353</span>     *          &lt;td&gt;Organization Unit Name&lt;/td&gt;<a name="line.3353"></a>
<span class="sourceLineNo">3354</span>     *          &lt;td&gt;PAX_DEV&lt;/td&gt;<a name="line.3354"></a>
<span class="sourceLineNo">3355</span>     *      &lt;/tr&gt;<a name="line.3355"></a>
<span class="sourceLineNo">3356</span>     *      &lt;tr&gt;<a name="line.3356"></a>
<span class="sourceLineNo">3357</span>     *          &lt;td&gt;CN&lt;/td&gt;<a name="line.3357"></a>
<span class="sourceLineNo">3358</span>     *          &lt;td&gt;Common Name&lt;/td&gt;<a name="line.3358"></a>
<span class="sourceLineNo">3359</span>     *          &lt;td&gt;paxsz&lt;/td&gt;<a name="line.3359"></a>
<span class="sourceLineNo">3360</span>     *      &lt;/tr&gt;<a name="line.3360"></a>
<span class="sourceLineNo">3361</span>     *      &lt;tr&gt;<a name="line.3361"></a>
<span class="sourceLineNo">3362</span>     *          &lt;td&gt;E&lt;/td&gt;<a name="line.3362"></a>
<span class="sourceLineNo">3363</span>     *          &lt;td&gt;Email Address&lt;/td&gt;<a name="line.3363"></a>
<span class="sourceLineNo">3364</span>     *          &lt;td&gt;inno_dev@paxsz.com&lt;/td&gt;<a name="line.3364"></a>
<span class="sourceLineNo">3365</span>     *      &lt;/tr&gt;<a name="line.3365"></a>
<span class="sourceLineNo">3366</span>     *  &lt;/table&gt;<a name="line.3366"></a>
<span class="sourceLineNo">3367</span>     * &lt;/div&gt;<a name="line.3367"></a>
<span class="sourceLineNo">3368</span>     *<a name="line.3368"></a>
<span class="sourceLineNo">3369</span>     * @return &lt;div class="zh"&gt;CSR。&lt;/div&gt; &lt;div class="en"&gt;CSR.&lt;/div&gt;<a name="line.3369"></a>
<span class="sourceLineNo">3370</span>     *<a name="line.3370"></a>
<span class="sourceLineNo">3371</span>     * @throws PedDevException<a name="line.3371"></a>
<span class="sourceLineNo">3372</span>     * @since V3.19.00<a name="line.3372"></a>
<span class="sourceLineNo">3373</span>     */<a name="line.3373"></a>
<span class="sourceLineNo">3374</span>    String genCSR(byte pubKeyIndex, byte pvkKeyIndex, String dn) throws PedDevException;<a name="line.3374"></a>
<span class="sourceLineNo">3375</span><a name="line.3375"></a>
<span class="sourceLineNo">3376</span>    /**<a name="line.3376"></a>
<span class="sourceLineNo">3377</span>     * &lt;div class="zh"&gt;用keyIndex指定的Salt密钥以及dataIn，依照指定mode做HMAC运算。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.3377"></a>
<span class="sourceLineNo">3378</span>     * &lt;div class="en"&gt;Do the HMAC operation in the specified mode with the Salt key specified in keyIndex and dataIn. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3378"></a>
<span class="sourceLineNo">3379</span>     *<a name="line.3379"></a>
<span class="sourceLineNo">3380</span>     * @param keyIndex &lt;div class="zh"&gt;Salt Key的索引。1或2 。&lt;/div&gt; &lt;div class="en"&gt;Index of the Salt 1 or 2.&lt;/div&gt;<a name="line.3380"></a>
<span class="sourceLineNo">3381</span>     * @param dataIn   &lt;div class="zh"&gt;需进行HMAC运算的数据。最长1024字节。&lt;/div&gt;<a name="line.3381"></a>
<span class="sourceLineNo">3382</span>     *                 &lt;div class="en"&gt;Data that require HMAC operations.Maximum 1024 bytes.&lt;/div&gt;<a name="line.3382"></a>
<span class="sourceLineNo">3383</span>     * @param mode     &lt;div class="zh"&gt;<a name="line.3383"></a>
<span class="sourceLineNo">3384</span>     *                  &lt;ul&gt;<a name="line.3384"></a>
<span class="sourceLineNo">3385</span>     *                      &lt;li&gt;0x01:HMAC-SHA1.&lt;/li&gt;<a name="line.3385"></a>
<span class="sourceLineNo">3386</span>     *                      &lt;li&gt;0x02:HMAC-SHA256.&lt;/li&gt;<a name="line.3386"></a>
<span class="sourceLineNo">3387</span>     *                  &lt;/ul&gt;<a name="line.3387"></a>
<span class="sourceLineNo">3388</span>     *                 &lt;/div&gt;<a name="line.3388"></a>
<span class="sourceLineNo">3389</span>     *                 &lt;div class="en"&gt;<a name="line.3389"></a>
<span class="sourceLineNo">3390</span>     *                  &lt;ul&gt;<a name="line.3390"></a>
<span class="sourceLineNo">3391</span>     *                      &lt;li&gt;0x01:HMAC-SHA1.&lt;/li&gt;<a name="line.3391"></a>
<span class="sourceLineNo">3392</span>     *                      &lt;li&gt;0x02:HMAC-SHA256.&lt;/li&gt;<a name="line.3392"></a>
<span class="sourceLineNo">3393</span>     *                  &lt;/ul&gt;<a name="line.3393"></a>
<span class="sourceLineNo">3394</span>     *                 &lt;/div&gt;<a name="line.3394"></a>
<span class="sourceLineNo">3395</span>     * @return &lt;div class="zh"&gt;HMAC结果。&lt;/div&gt; &lt;div class="en"&gt;HMAC results.&lt;/div&gt;<a name="line.3395"></a>
<span class="sourceLineNo">3396</span>     * @throws PedDevException<a name="line.3396"></a>
<span class="sourceLineNo">3397</span>     * @since V3.19.00<a name="line.3397"></a>
<span class="sourceLineNo">3398</span>     */<a name="line.3398"></a>
<span class="sourceLineNo">3399</span>    byte[] calcHMAC(int keyIndex, byte[] dataIn, int mode) throws PedDevException;<a name="line.3399"></a>
<span class="sourceLineNo">3400</span><a name="line.3400"></a>
<span class="sourceLineNo">3401</span>    /**<a name="line.3401"></a>
<span class="sourceLineNo">3402</span>     * &lt;div class="zh"&gt;写入salt密钥。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Write salt key. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3402"></a>
<span class="sourceLineNo">3403</span>     *<a name="line.3403"></a>
<span class="sourceLineNo">3404</span>     * @param salt &lt;div class="zh"&gt;salt明文密钥。长度最长128字节。&lt;/div&gt; &lt;div class="en"&gt;Salt plaintext key.The maximum length is 128 bytes.&lt;/div&gt;<a name="line.3404"></a>
<span class="sourceLineNo">3405</span>     * @throws PedDevException<a name="line.3405"></a>
<span class="sourceLineNo">3406</span>     * @since V3.19.00<a name="line.3406"></a>
<span class="sourceLineNo">3407</span>     */<a name="line.3407"></a>
<span class="sourceLineNo">3408</span>    void writeSaltKey(byte[] salt) throws PedDevException;<a name="line.3408"></a>
<span class="sourceLineNo">3409</span><a name="line.3409"></a>
<span class="sourceLineNo">3410</span>    /**<a name="line.3410"></a>
<span class="sourceLineNo">3411</span>     * &lt;div class="zh"&gt;写入 AES DUKPT 初始密钥 AESTIK，并可以选择使用 KCV 验证密钥正确性。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Write the AES DUKPT initial key AESTIK, and you can choose to use KCV to verify the correctness of the key. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3411"></a>
<span class="sourceLineNo">3412</span>     *<a name="line.3412"></a>
<span class="sourceLineNo">3413</span>     * @param groupIndex  &lt;div class="zh"&gt;AES DUKPT密钥组索引。范围1~40。&lt;/div&gt; &lt;div class="en"&gt;AES DUKPT key group index. The range is 1~40.&lt;/div&gt;<a name="line.3413"></a>
<span class="sourceLineNo">3414</span>     * @param srcKeyIndex &lt;div class="zh"&gt;保护密钥的密钥索引。0表示明文写入。目前仅支持明文写入。&lt;/div&gt;<a name="line.3414"></a>
<span class="sourceLineNo">3415</span>     *                    &lt;div class="en"&gt;The index of the key protecting the key. 0 means writing in plaintext. Currently only plaintext writing is supported.&lt;/div&gt;<a name="line.3415"></a>
<span class="sourceLineNo">3416</span>     * @param keyValue    &lt;div class="zh"&gt;AESTIK 的明文。目前AES DUKPT 算法支持 16/24/32 字节长度的密钥。&lt;/div&gt; &lt;div class="en"&gt;The plain text of AESTIK. Currently, the AES DUKPT algorithm supports keys with a length of 16/24/32 bytes.&lt;/div&gt;<a name="line.3416"></a>
<span class="sourceLineNo">3417</span>     * @param ksn         &lt;div class="zh"&gt;初始化 KSN。长度10/12 字节，只有在兼容模式才会是 10 字节。&lt;/div&gt; &lt;div class="en"&gt;Initialize KSN. The length is 10/12 bytes, only in compatibility mode will it be 10 bytes.&lt;/div&gt;<a name="line.3417"></a>
<span class="sourceLineNo">3418</span>     * @param checkMode   &lt;div class="zh"&gt;验证模式。<a name="line.3418"></a>
<span class="sourceLineNo">3419</span>     *                                         &lt;ul&gt;<a name="line.3419"></a>
<span class="sourceLineNo">3420</span>     *                                           &lt;li&gt;0x00:无校验。&lt;/li&gt;<a name="line.3420"></a>
<span class="sourceLineNo">3421</span>     *                                           &lt;li&gt;0x05:对16个字节的 0x00进行AES加密,得到的密文的前3个字节即为KCV。&lt;/li&gt;<a name="line.3421"></a>
<span class="sourceLineNo">3422</span>     *                                           &lt;li&gt;0x06:对16个字节的 0x00进行AES CMAC加密,得到的密文的前3个字节即为KCV。&lt;/li&gt;<a name="line.3422"></a>
<span class="sourceLineNo">3423</span>     *                                         &lt;/ul&gt;<a name="line.3423"></a>
<span class="sourceLineNo">3424</span>     *                                       &lt;/div&gt; &lt;div class="en"&gt;Check mode.<a name="line.3424"></a>
<span class="sourceLineNo">3425</span>     *                                         &lt;ul&gt;<a name="line.3425"></a>
<span class="sourceLineNo">3426</span>     *                                           &lt;li&gt;0x00: No check.&lt;/li&gt;<a name="line.3426"></a>
<span class="sourceLineNo">3427</span>     *                                           &lt;li&gt;0x05:Perform AES encryption on the 16 bytes of 0x00, and the first 3 bytes of the ciphertext obtained are KCV.&lt;/li&gt;<a name="line.3427"></a>
<span class="sourceLineNo">3428</span>     *                                           &lt;li&gt;0x06:Perform AES CMAC encryption on the 16 bytes of 0x00, and the first 3 bytes of the ciphertext obtained are KCV.&lt;/li&gt;<a name="line.3428"></a>
<span class="sourceLineNo">3429</span>     *                                         &lt;/ul&gt;    &lt;/div&gt;<a name="line.3429"></a>
<span class="sourceLineNo">3430</span>     * @param checkBuf    &lt;div class="zh"&gt;<a name="line.3430"></a>
<span class="sourceLineNo">3431</span>     *                                         &lt;ul&gt;<a name="line.3431"></a>
<span class="sourceLineNo">3432</span>     *                                           &lt;li&gt;当checkMode=0x00时，checkBuf的值无效，系统认为不验证KCV。&lt;/li&gt;<a name="line.3432"></a>
<span class="sourceLineNo">3433</span>     *                                           &lt;li&gt;当checkMode=0x05/0x06时，checkBuf[0]=KCV的长度，checkBuf[1]开始是KCV的值。&lt;/li&gt;<a name="line.3433"></a>
<span class="sourceLineNo">3434</span>     *                                         &lt;/ul&gt;<a name="line.3434"></a>
<span class="sourceLineNo">3435</span>     *                                       &lt;/div&gt; &lt;div class="en"&gt;<a name="line.3435"></a>
<span class="sourceLineNo">3436</span>     *                                         &lt;ul&gt;<a name="line.3436"></a>
<span class="sourceLineNo">3437</span>     *                                           &lt;li&gt;When checkMode=0x00, the value of checkBuf is invalid, and the system considers that KCV is not verified.&lt;/li&gt;<a name="line.3437"></a>
<span class="sourceLineNo">3438</span>     *                                           &lt;li&gt;When checkMode=0x05/0x06, checkBuf[0]=KCV length, checkBuf[1] starts with the value of KCV.&lt;/li&gt;<a name="line.3438"></a>
<span class="sourceLineNo">3439</span>     *                                         &lt;/ul&gt;<a name="line.3439"></a>
<span class="sourceLineNo">3440</span>     *                                           &lt;/div&gt;<a name="line.3440"></a>
<span class="sourceLineNo">3441</span>     * @throws PedDevException PedDevException<a name="line.3441"></a>
<span class="sourceLineNo">3442</span>     * @since V3.22.00<a name="line.3442"></a>
<span class="sourceLineNo">3443</span>     */<a name="line.3443"></a>
<span class="sourceLineNo">3444</span>    void writeAesDUKPTTIK(byte groupIndex, byte srcKeyIndex, byte[] keyValue, byte[] ksn, byte checkMode,<a name="line.3444"></a>
<span class="sourceLineNo">3445</span>            byte[] checkBuf) throws PedDevException;<a name="line.3445"></a>
<span class="sourceLineNo">3446</span><a name="line.3446"></a>
<span class="sourceLineNo">3447</span>    /**<a name="line.3447"></a>
<span class="sourceLineNo">3448</span>     * &lt;div class="zh"&gt;在 PED 上输入 PIN,并使 AES DUKPT 的 PIN 密钥计算 PINBlock。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Enter the PIN on the PED, and use the PIN key of AES DUKPT to calculate the PINBlock. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3448"></a>
<span class="sourceLineNo">3449</span>     *<a name="line.3449"></a>
<span class="sourceLineNo">3450</span>     * @param groupIndex    &lt;div class="zh"&gt;AES DUKPT密钥组索引。范围1~40。&lt;/div&gt; &lt;div class="en"&gt;AES DUKPT key group index. The range is 1~40.&lt;/div&gt;<a name="line.3450"></a>
<span class="sourceLineNo">3451</span>     * @param exPinLen      &lt;div class="zh"&gt;可输入的合法密码长度字符串，应用程序把允许的密码长度全部枚举出来，并且用","号隔开每个长度，密码长度的有效取值为：0，4~12。若允许输入 4、6 位密码并且允许无密码直接按确认，则该字符串应该设置为"0，4，6"。<a name="line.3451"></a>
<span class="sourceLineNo">3452</span>     *                      若枚举 0 长度则示意可以不输任何数字而直接按确认键返回。若枚举字符串中存在长度的无效值，比如"2，6，7，10"，无效值将被忽略。&lt;/div&gt; &lt;div class="en"&gt;The valid password length string that can be entered, the application enumerates all the allowable password lengths,<a name="line.3452"></a>
<span class="sourceLineNo">3453</span>     *                      and separates each length with a "," sign. The valid value of the password length is 0, 4~12. If 4 or 6-digit passwords are allowed and you can press confirm without a password, the character string should be set to "0, 4, 6".<a name="line.3453"></a>
<span class="sourceLineNo">3454</span>     *                      If the length of the enumeration is 0, it means that you can directly press the enter key to return without entering any number. If there are invalid values of length in the enumerated string, such as "2, 6, 7, 10", the invalid value will be ignored.&lt;/div&gt;<a name="line.3454"></a>
<span class="sourceLineNo">3455</span>     * @param dataIn        &lt;div class="zh"&gt;<a name="line.3455"></a>
<span class="sourceLineNo">3456</span>     *                                             &lt;ul&gt;<a name="line.3456"></a>
<span class="sourceLineNo">3457</span>     *                                               &lt;li&gt;当mode=0x20时，dataIn指向卡号移位后生成的16位主帐号，不包含校验位。&lt;/li&gt;<a name="line.3457"></a>
<span class="sourceLineNo">3458</span>     *                                               &lt;li&gt;当mode=0x21时，dataIn未使用，但是不能为NULL。 &lt;/li&gt;<a name="line.3458"></a>
<span class="sourceLineNo">3459</span>     *                                               &lt;li&gt;当mode=0x22时，dataIn指向卡号移位后生成的16位主帐号，不包含校验位。&lt;/li&gt;<a name="line.3459"></a>
<span class="sourceLineNo">3460</span>     *                                               &lt;li&gt;当mode=0x23时，为交易流水号ISN [6 Bytes,ASCII码]。&lt;/li&gt;<a name="line.3460"></a>
<span class="sourceLineNo">3461</span>     *                                               &lt;li&gt;当mode=0x24时，dataIn为主账号。&lt;/li&gt;<a name="line.3461"></a>
<span class="sourceLineNo">3462</span>     *                                             &lt;/ul&gt;&lt;/div&gt;<a name="line.3462"></a>
<span class="sourceLineNo">3463</span>     *                                           &lt;div class="en"&gt;<a name="line.3463"></a>
<span class="sourceLineNo">3464</span>     *                                             &lt;ul&gt;<a name="line.3464"></a>
<span class="sourceLineNo">3465</span>     *                                               &lt;li&gt;When mode=0x20, dataIn points to the 16-bit primary account generated after the card number shift, excluding the check bit.&lt;/li&gt;<a name="line.3465"></a>
<span class="sourceLineNo">3466</span>     *                                               &lt;li&gt;When mode=0x21, dataIn is not in use, but cannot be NULL.&lt;/li&gt;<a name="line.3466"></a>
<span class="sourceLineNo">3467</span>     *                                               &lt;li&gt;When mode=0x22, dataIn points to the 16-bit primary account generated after the card number shift, excluding the check bit.&lt;/li&gt;<a name="line.3467"></a>
<span class="sourceLineNo">3468</span>     *                                               &lt;li&gt;When mode=0x23, is the transaction current number [6 Bytes,ASCII code].&lt;/li&gt;<a name="line.3468"></a>
<span class="sourceLineNo">3469</span>     *                                               &lt;li&gt;When mode=0x24, dataIn is primary account.&lt;/li&gt;<a name="line.3469"></a>
<span class="sourceLineNo">3470</span>     *                                             &lt;/ul&gt;&lt;/div&gt;<a name="line.3470"></a>
<span class="sourceLineNo">3471</span>     * @param algorithmType {@link EAlgorithmType} &lt;div class="zh"&gt;<a name="line.3471"></a>
<span class="sourceLineNo">3472</span>     *                                               &lt;ul&gt;<a name="line.3472"></a>
<span class="sourceLineNo">3473</span>     *                                                 &lt;li&gt;为{@link EAlgorithmType#_2TDEA_}或者{@link EAlgorithmType#_3TDEA_}时，使用 TDES算法计算(mode不能为0x24)。&lt;/li&gt;<a name="line.3473"></a>
<span class="sourceLineNo">3474</span>     *                                                 &lt;li&gt;为{@link EAlgorithmType#_AES128_}或者{@link EAlgorithmType#_AES192_}或者{@link EAlgorithmType#_AES256_}时，使用 AES 算法计算(mode只能为0x24)。&lt;/li&gt;<a name="line.3474"></a>
<span class="sourceLineNo">3475</span>     *                                               &lt;/ul&gt;<a name="line.3475"></a>
<span class="sourceLineNo">3476</span>     *                                            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.3476"></a>
<span class="sourceLineNo">3477</span>     *                                               &lt;ul&gt;<a name="line.3477"></a>
<span class="sourceLineNo">3478</span>     *                                                 &lt;li&gt;When it is {@link EAlgorithmType#_2TDEA_} or {@link EAlgorithmType#_3TDEA_}, use the TDES algorithm for calculation (mode cannot be 0x24).&lt;/li&gt;<a name="line.3478"></a>
<span class="sourceLineNo">3479</span>     *                                                 &lt;li&gt;When it is {@link EAlgorithmType#_AES128_} or {@link EAlgorithmType#_AES192_} or {@link EAlgorithmType#_AES256_}, use the AES algorithm for calculation (mode can only be 0x24).&lt;/li&gt;<a name="line.3479"></a>
<span class="sourceLineNo">3480</span>     *                                               &lt;/ul&gt;<a name="line.3480"></a>
<span class="sourceLineNo">3481</span>     *                                                &lt;/div&gt;<a name="line.3481"></a>
<span class="sourceLineNo">3482</span>     * @param mode          &lt;div class="zh"&gt;<a name="line.3482"></a>
<span class="sourceLineNo">3483</span>     *                                             &lt;ul&gt;<a name="line.3483"></a>
<span class="sourceLineNo">3484</span>     *                                               &lt;li&gt;0x20:ISO9564 格式0，KSN不自动加1。&lt;/li&gt;<a name="line.3484"></a>
<span class="sourceLineNo">3485</span>     *                                               &lt;li&gt;0x21:ISO9564 格式1，KSN不自动加1。&lt;/li&gt;<a name="line.3485"></a>
<span class="sourceLineNo">3486</span>     *                                               &lt;li&gt;0x22:ISO9564 格式3，KSN不自动加1。&lt;/li&gt;<a name="line.3486"></a>
<span class="sourceLineNo">3487</span>     *                                               &lt;li&gt;0x23:HK EPS格式， KSN不自动加1。&lt;/li&gt;<a name="line.3487"></a>
<span class="sourceLineNo">3488</span>     *                                               &lt;li&gt;0x24:ISO9564 格式4，KSN不自动加1。&lt;/li&gt;<a name="line.3488"></a>
<span class="sourceLineNo">3489</span>     *                                             &lt;/ul&gt;&lt;/div&gt;<a name="line.3489"></a>
<span class="sourceLineNo">3490</span>     *                                           &lt;div class="en"&gt;<a name="line.3490"></a>
<span class="sourceLineNo">3491</span>     *                                             &lt;ul&gt;<a name="line.3491"></a>
<span class="sourceLineNo">3492</span>     *                                               &lt;li&gt;0x20:ISO9564 format 0,KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3492"></a>
<span class="sourceLineNo">3493</span>     *                                               &lt;li&gt;0x21:ISO9564 format 1,KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3493"></a>
<span class="sourceLineNo">3494</span>     *                                               &lt;li&gt;0x22:ISO9564 format 3,KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3494"></a>
<span class="sourceLineNo">3495</span>     *                                               &lt;li&gt;0x23:HK EPS format, KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3495"></a>
<span class="sourceLineNo">3496</span>     *                                               &lt;li&gt;0x24:ISO9564 format 4,KSN doesn't automatically add 1。&lt;/li&gt;<a name="line.3496"></a>
<span class="sourceLineNo">3497</span>     *                                             &lt;/ul&gt;&lt;/div&gt;<a name="line.3497"></a>
<span class="sourceLineNo">3498</span>     * @param timeoutMs     &lt;div class="zh"&gt;&lt;/div&gt; &lt;div class="en"&gt;&lt;/div&gt;<a name="line.3498"></a>
<span class="sourceLineNo">3499</span>     * @return &lt;div class="zh"&gt;输入 PIN 的超时时间。单位：毫秒，最大值为 300000ms。0表示没有超时时间，PED 不做超时控制。&lt;/div&gt;<a name="line.3499"></a>
<span class="sourceLineNo">3500</span>     * &lt;div class="en"&gt;Enter the PIN timeout period. Unit: milliseconds, the maximum value is 300000ms. 0 means there is no timeout period, and PED does not do timeout control.&lt;/div&gt;<a name="line.3500"></a>
<span class="sourceLineNo">3501</span>     * @throws PedDevException PedDevException<a name="line.3501"></a>
<span class="sourceLineNo">3502</span>     * @since V3.22.00<a name="line.3502"></a>
<span class="sourceLineNo">3503</span>     */<a name="line.3503"></a>
<span class="sourceLineNo">3504</span>    DUKPTResult getAesDUKPTPin(byte groupIndex, String exPinLen, byte[] dataIn, EAlgorithmType algorithmType, byte mode,<a name="line.3504"></a>
<span class="sourceLineNo">3505</span>            long timeoutMs) throws PedDevException;<a name="line.3505"></a>
<span class="sourceLineNo">3506</span><a name="line.3506"></a>
<span class="sourceLineNo">3507</span>    /**<a name="line.3507"></a>
<span class="sourceLineNo">3508</span>     * &lt;div class="zh"&gt;使用 AES DUKPT 的数据加解密密钥，对输入缓存内数据进行加密或解密。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Use the AES DUKPT data encryption and decryption key to encrypt or decrypt the data in the input buffer. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3508"></a>
<span class="sourceLineNo">3509</span>     *<a name="line.3509"></a>
<span class="sourceLineNo">3510</span>     * @param groupIndex    &lt;div class="zh"&gt;AES DUKPT密钥组索引。范围1~40。&lt;/div&gt; &lt;div class="en"&gt;AES DUKPT key group index. The range is 1~40.&lt;/div&gt;<a name="line.3510"></a>
<span class="sourceLineNo">3511</span>     * @param keyVarType    &lt;div class="zh"&gt;<a name="line.3511"></a>
<span class="sourceLineNo">3512</span>     *                                             &lt;ul&gt;<a name="line.3512"></a>
<span class="sourceLineNo">3513</span>     *                                               &lt;li&gt;0x01: 用 AES DUKPT 数据加解密密钥运算。&lt;/li&gt;<a name="line.3513"></a>
<span class="sourceLineNo">3514</span>     *                                               &lt;li&gt;0x04: 使用应答数据密钥，仅支持加密模式，即mode 值只能为 0x01、0x03。&lt;/li&gt;<a name="line.3514"></a>
<span class="sourceLineNo">3515</span>     *                                               &lt;li&gt;0x05: 使用请求数据密钥，仅支持解密模式，即mode 值只能为 0x00、0x02。&lt;/li&gt;<a name="line.3515"></a>
<span class="sourceLineNo">3516</span>     *                                             &lt;/ul&gt;<a name="line.3516"></a>
<span class="sourceLineNo">3517</span>     *                                           &lt;/div&gt; &lt;div class="en"&gt;<a name="line.3517"></a>
<span class="sourceLineNo">3518</span>     *                                             &lt;ul&gt;<a name="line.3518"></a>
<span class="sourceLineNo">3519</span>     *                                               &lt;li&gt;0x01: Use AES DUKPT data encryption and decryption key operations.&lt;/li&gt;<a name="line.3519"></a>
<span class="sourceLineNo">3520</span>     *                                               &lt;li&gt;0x04: Using the response data key, only supports the encryption mode, that is, the mode value can only be 0x01, 0x03.&lt;/li&gt;<a name="line.3520"></a>
<span class="sourceLineNo">3521</span>     *                                               &lt;li&gt;0x05: When using the requested data key, only the decryption mode is supported, that is, the mode value can only be 0x00, 0x02.&lt;/li&gt;<a name="line.3521"></a>
<span class="sourceLineNo">3522</span>     *                                             &lt;/ul&gt;<a name="line.3522"></a>
<span class="sourceLineNo">3523</span>     *                                               &lt;/div&gt;<a name="line.3523"></a>
<span class="sourceLineNo">3524</span>     * @param iv            &lt;div class="zh"&gt; 8/16字节初始向量，CBC加解密时需要，如果传入NULL，将默认用“\x00\x00\x00\x00\x00\x00\x00\x00”或<a name="line.3524"></a>
<span class="sourceLineNo">3525</span>     *                                        “\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00”作为初始向量 &lt;/div&gt;<a name="line.3525"></a>
<span class="sourceLineNo">3526</span>     *                                        &lt;div class="en"&gt; 8/16 bytes initialization vector, used for CBC encryption or decryption. If set it to NULL,<a name="line.3526"></a>
<span class="sourceLineNo">3527</span>     *                                        it will use “\x00\x00\x00\x00\x00\x00\x00\x00” or “\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00”<a name="line.3527"></a>
<span class="sourceLineNo">3528</span>     *                                        as the initialization vector by default. &lt;/div&gt;<a name="line.3528"></a>
<span class="sourceLineNo">3529</span>     * @param dataIn        &lt;div class="zh"&gt;需要进行运算的数据。数据长度&lt;=8192，8(TDES)/16(AES)整除。&lt;/div&gt; &lt;div class="en"&gt;The data to be calculated. Data length&lt;=8192, evenly divided by 8(TDES)/16(AES).&lt;/div&gt;<a name="line.3529"></a>
<span class="sourceLineNo">3530</span>     * @param algorithmType &lt;div class="zh"&gt;<a name="line.3530"></a>
<span class="sourceLineNo">3531</span>     *                                             &lt;ul&gt;<a name="line.3531"></a>
<span class="sourceLineNo">3532</span>     *                                               &lt;li&gt;为{@link EAlgorithmType#_2TDEA_}或{@link EAlgorithmType#_3TDEA_}时，使用TDES算法计算。&lt;/li&gt;<a name="line.3532"></a>
<span class="sourceLineNo">3533</span>     *                                               &lt;li&gt;为{@link EAlgorithmType#_AES128_}或{@link EAlgorithmType#_AES192_}或{@link EAlgorithmType#_AES256_}时，使用AES算法计算。&lt;/li&gt;<a name="line.3533"></a>
<span class="sourceLineNo">3534</span>     *                                             &lt;/ul&gt;<a name="line.3534"></a>
<span class="sourceLineNo">3535</span>     *                                           &lt;/div&gt; &lt;div class="en"&gt;<a name="line.3535"></a>
<span class="sourceLineNo">3536</span>     *                                             &lt;ul&gt;<a name="line.3536"></a>
<span class="sourceLineNo">3537</span>     *                                               &lt;li&gt;When it is {@link EAlgorithmType#_2TDEA_} or {@link EAlgorithmType#_3TDEA_}, use the TDES algorithm for calculation.&lt;/li&gt;<a name="line.3537"></a>
<span class="sourceLineNo">3538</span>     *                                               &lt;li&gt;When it is {@link EAlgorithmType#_AES128_} or {@link EAlgorithmType#_AES192_} or {@link EAlgorithmType#_AES256_}, use the AES algorithm for calculation.&lt;/li&gt;<a name="line.3538"></a>
<span class="sourceLineNo">3539</span>     *                                             &lt;/ul&gt;<a name="line.3539"></a>
<span class="sourceLineNo">3540</span>     *                                               &lt;/div&gt;<a name="line.3540"></a>
<span class="sourceLineNo">3541</span>     * @param mode          &lt;div class="zh"&gt;<a name="line.3541"></a>
<span class="sourceLineNo">3542</span>     *                                             &lt;ul&gt;<a name="line.3542"></a>
<span class="sourceLineNo">3543</span>     *                                               &lt;li&gt;0x00: ECB 解密&lt;/li&gt;<a name="line.3543"></a>
<span class="sourceLineNo">3544</span>     *                                               &lt;li&gt;0x01: ECB 加密&lt;/li&gt;<a name="line.3544"></a>
<span class="sourceLineNo">3545</span>     *                                               &lt;li&gt;0x02: CBC 解密&lt;/li&gt;<a name="line.3545"></a>
<span class="sourceLineNo">3546</span>     *                                               &lt;li&gt;0x03: CBC 加密&lt;/li&gt;<a name="line.3546"></a>
<span class="sourceLineNo">3547</span>     *                                             &lt;/ul&gt;<a name="line.3547"></a>
<span class="sourceLineNo">3548</span>     *                                           &lt;/div&gt; &lt;div class="en"&gt;<a name="line.3548"></a>
<span class="sourceLineNo">3549</span>     *                                             &lt;ul&gt;<a name="line.3549"></a>
<span class="sourceLineNo">3550</span>     *                                               &lt;li&gt;0x00: ECB decryption.&lt;/li&gt;<a name="line.3550"></a>
<span class="sourceLineNo">3551</span>     *                                               &lt;li&gt;0x01: ECB encryption.&lt;/li&gt;<a name="line.3551"></a>
<span class="sourceLineNo">3552</span>     *                                               &lt;li&gt;0x02: CBC decryption.&lt;/li&gt;<a name="line.3552"></a>
<span class="sourceLineNo">3553</span>     *                                               &lt;li&gt;0x03: CBC encryption.&lt;/li&gt;<a name="line.3553"></a>
<span class="sourceLineNo">3554</span>     *                                             &lt;/ul&gt;<a name="line.3554"></a>
<span class="sourceLineNo">3555</span>     *                                               &lt;/div&gt;<a name="line.3555"></a>
<span class="sourceLineNo">3556</span>     * @return {@link DUKPTResult}<a name="line.3556"></a>
<span class="sourceLineNo">3557</span>     * @throws PedDevException PedDevException<a name="line.3557"></a>
<span class="sourceLineNo">3558</span>     * @since V3.22.00<a name="line.3558"></a>
<span class="sourceLineNo">3559</span>     */<a name="line.3559"></a>
<span class="sourceLineNo">3560</span>    DUKPTResult calcAesDUKPTData(byte groupIndex, byte keyVarType, byte[] iv, byte[] dataIn,<a name="line.3560"></a>
<span class="sourceLineNo">3561</span>            EAlgorithmType algorithmType, byte mode) throws PedDevException;<a name="line.3561"></a>
<span class="sourceLineNo">3562</span><a name="line.3562"></a>
<span class="sourceLineNo">3563</span>    /**<a name="line.3563"></a>
<span class="sourceLineNo">3564</span>     * &lt;div class="zh"&gt;使用 AES DUKPT 的 MAC 密钥计算 MAC。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Use AES DUKPT's MAC key to calculate MAC. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3564"></a>
<span class="sourceLineNo">3565</span>     *<a name="line.3565"></a>
<span class="sourceLineNo">3566</span>     * @param groupIndex    &lt;div class="zh"&gt;AES DUKPT密钥组索引。范围1~40。&lt;/div&gt; &lt;div class="en"&gt;AES DUKPT key group index. The range is 1~40.&lt;/div&gt;<a name="line.3566"></a>
<span class="sourceLineNo">3567</span>     * @param dataIn        &lt;div class="zh"&gt;要进行 MAC 运算的数据内容。数据的长度&lt;=2048，长度不能被 8(TDES)/16(AES)整除，则自动补 0x00。&lt;/div&gt; &lt;div class="en"&gt;The data content to be MAC operation. The length of the data &lt;=2048, and the length cannot be divisible by 8(TDES)/16(AES), then 0x00 will be automatically added.&lt;/div&gt;<a name="line.3567"></a>
<span class="sourceLineNo">3568</span>     * @param algorithmType &lt;div class="zh"&gt;<a name="line.3568"></a>
<span class="sourceLineNo">3569</span>     *                        &lt;ul&gt;<a name="line.3569"></a>
<span class="sourceLineNo">3570</span>     *                          &lt;li&gt;为{@link EAlgorithmType#_2TDEA_}或{@link EAlgorithmType#_3TDEA_}时，使用TDES算法计算。&lt;/li&gt;<a name="line.3570"></a>
<span class="sourceLineNo">3571</span>     *                          &lt;li&gt;为{@link EAlgorithmType#_AES128_}或{@link EAlgorithmType#_AES192_}或{@link EAlgorithmType#_AES256_}时，使用AES算法计算。&lt;/li&gt;<a name="line.3571"></a>
<span class="sourceLineNo">3572</span>     *                          &lt;li&gt;为{@link EAlgorithmType#_HMAC128_}或{@link EAlgorithmType#_HMAC192_}或{@link EAlgorithmType#_HMAC256_}时，仅支持HMAC-SHA256算法计算。即mode为0x25/0x45/0x65。&lt;/li&gt;<a name="line.3572"></a>
<span class="sourceLineNo">3573</span>     *                        &lt;/ul&gt;<a name="line.3573"></a>
<span class="sourceLineNo">3574</span>     *                      &lt;/div&gt; &lt;div class="en"&gt;<a name="line.3574"></a>
<span class="sourceLineNo">3575</span>     *                        &lt;ul&gt;<a name="line.3575"></a>
<span class="sourceLineNo">3576</span>     *                          &lt;li&gt;When it is {@link EAlgorithmType#_2TDEA_} or {@link EAlgorithmType#_3TDEA_}, use the TDES algorithm for calculation.&lt;/li&gt;<a name="line.3576"></a>
<span class="sourceLineNo">3577</span>     *                          &lt;li&gt;When it is {@link EAlgorithmType#_AES128_} or {@link EAlgorithmType#_AES192_} or {@link EAlgorithmType#_AES256_}, use the AES algorithm for calculation.&lt;/li&gt;<a name="line.3577"></a>
<span class="sourceLineNo">3578</span>     *                          &lt;li&gt;When it is {@link EAlgorithmType#_HMAC128_} or {@link EAlgorithmType#_HMAC192_} or {@link EAlgorithmType#_HMAC256_}, only HMAC-SHA256 algorithm calculation is supported. That is, the mode is 0x25/0x45/0x65.&lt;/li&gt;<a name="line.3578"></a>
<span class="sourceLineNo">3579</span>     *                        &lt;/ul&gt;<a name="line.3579"></a>
<span class="sourceLineNo">3580</span>     *                      &lt;/div&gt;<a name="line.3580"></a>
<span class="sourceLineNo">3581</span>     * @param mode          &lt;div class="zh"&gt;<a name="line.3581"></a>
<span class="sourceLineNo">3582</span>     *                        &lt;ul&gt;<a name="line.3582"></a>
<span class="sourceLineNo">3583</span>     *                          &lt;li&gt;0x20: 根据ANSI X9.9规范，将 BLOCK1 用 MAC密钥做 TDES/AES 加密，加密结果与 BLOCK2进行逐位异或后再用MAC密钥做 TDES/AES加密，依次进行得到 8(TDES)/16(AES)字节的加密结果。 KSN 不自动加 1。&lt;/li&gt;<a name="line.3583"></a>
<span class="sourceLineNo">3584</span>     *                          &lt;li&gt;0x21: Hypercom Fast Mode，将 BLOCK1 和BLOCK2 进行逐位异或，异或结果与 BLOCK3进 行 逐 位 异 或 ， 依 次 进 行 ， 最 后 得 到8(TDES)/16(AES)字节的异或结果，将该结果用MAC 密钥进行 TDES/AES 加密运算。KSN 不自动加 1。&lt;/li&gt;<a name="line.3584"></a>
<span class="sourceLineNo">3585</span>     *                          &lt;li&gt;0x22: 根据 ANSIX9.19 规范，将 BLOCK1 用MAC密钥做DES 加密(只取前8个字节的key)，加密结果与 BLOCK2 进行逐位异或后再用MAC 密钥做 DES 加密，依次进行得到 8 字节的加密结果，直到最后一次采用 TDES 加密。 KSN不自动加 1。 (不支持 AES 算法。)&lt;/li&gt;<a name="line.3585"></a>
<span class="sourceLineNo">3586</span>     *                          &lt;li&gt;0x23: CMAC算法。 KSN不自动加1。其它值保留扩展MAC算法。&lt;/li&gt;<a name="line.3586"></a>
<span class="sourceLineNo">3587</span>     *                          &lt;li&gt;0x25: HMAC-SHA256算法。 KSN不自动加1。&lt;/li&gt;<a name="line.3587"></a>
<span class="sourceLineNo">3588</span>     *                          &lt;li&gt;0x40: 根据ANSI X9.9规范，将 BLOCK1 用 MAC密钥做 TDES/AES 加密，加密结果与 BLOCK2进行逐位异或后再用MAC密钥做 TDES/AES加密，依次进行得到 8(TDES)/16(AES)字节的加密结果。 KSN 不自动加 1。&lt;/li&gt;<a name="line.3588"></a>
<span class="sourceLineNo">3589</span>     *                          &lt;li&gt;0x41: Hypercom Fast Mode，将 BLOCK1 和BLOCK2 进行逐位异或，异或结果与 BLOCK3进 行 逐 位 异 或 ， 依 次 进 行 ， 最 后 得 到8(TDES)/16(AES)字节的异或结果，将该结果用MAC 密钥进行 TDES/AES 加密运算。KSN 不自动加 1 。&lt;/li&gt;<a name="line.3589"></a>
<span class="sourceLineNo">3590</span>     *                          &lt;li&gt;0x42: 根据 ANSIX9.19 规范，将 BLOCK1 用MAC密钥做DES 加密(只取前8个字节的key)，加密结果与 BLOCK2 进行逐位异或后再用MAC 密钥做 DES 加密，依次进行得到 8 字节的加密结果，直到最后一次采用 TDES 加密。 KSN不自动加 1。 (不支持 AES 算法。) &lt;/li&gt;<a name="line.3590"></a>
<span class="sourceLineNo">3591</span>     *                          &lt;li&gt;0x43: CMAC算法。 KSN不自动加1。其它值保留扩展MAC算法。&lt;/li&gt;<a name="line.3591"></a>
<span class="sourceLineNo">3592</span>     *                          &lt;li&gt;0x45: HMAC-SHA256算法。 KSN不自动加1。&lt;/li&gt;<a name="line.3592"></a>
<span class="sourceLineNo">3593</span>     *                          &lt;li&gt;0x60: 据ANSI X9.9规范，将 BLOCK1 用 MAC密钥做 TDES/AES 加密，加密结果与 BLOCK2进行逐位异或后再用MAC密钥做 TDES/AES加密，依次进行得到 8(TDES)/16(AES)字节的加密结果。 KSN 不自动加 1。&lt;/li&gt;<a name="line.3593"></a>
<span class="sourceLineNo">3594</span>     *                          &lt;li&gt;0x61: Hypercom Fast Mode，将 BLOCK1 和BLOCK2 进行逐位异或，异或结果与 BLOCK3进 行 逐 位 异 或 ， 依 次 进 行 ， 最 后 得 到8(TDES)/16(AES)字节的异或结果，将该结果用MAC 密钥进行 TDES/AES 加密运算。KSN 不自动加 1。&lt;/li&gt;<a name="line.3594"></a>
<span class="sourceLineNo">3595</span>     *                          &lt;li&gt;0x62: 根据 ANSIX9.19 规范，将 BLOCK1 用MAC密钥做DES 加密(只取前8个字节的key)，加密结果与 BLOCK2 进行逐位异或后再用MAC 密钥做 DES 加密，依次进行得到 8 字节的加密结果，直到最后一次采用 TDES 加密。 KSN不自动加 1。 (不支持 AES 算法。) &lt;/li&gt;<a name="line.3595"></a>
<span class="sourceLineNo">3596</span>     *                          &lt;li&gt;0x63: CMAC算法。KSN不自动加1。 其它值保留扩展MAC算法。&lt;/li&gt;<a name="line.3596"></a>
<span class="sourceLineNo">3597</span>     *                          &lt;li&gt;0x65: HMAC-SHA256算法。 KSN不自动加1。&lt;/li&gt;<a name="line.3597"></a>
<span class="sourceLineNo">3598</span>     *                        &lt;/ul&gt;<a name="line.3598"></a>
<span class="sourceLineNo">3599</span>     *                      &lt;/div&gt; &lt;div class="en"&gt;<a name="line.3599"></a>
<span class="sourceLineNo">3600</span>     *                        &lt;ul&gt;<a name="line.3600"></a>
<span class="sourceLineNo">3601</span>     *                          &lt;li&gt;0x20: According to the ANSI X9.9 specification, BLOCK1 is encrypted with MAC key for TDES/AES, the encrypted result is XORed with BLOCK2 bit by bit, and then the MAC key is used for TDES/AES encryption, and then proceed to get 8(TDES)/16( AES) byte encryption result. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3601"></a>
<span class="sourceLineNo">3602</span>     *                          &lt;li&gt;0x21: In Hypercom Fast Mode, BLOCK1 and BLOCK2 are XORed bit by bit, and the XOR result is XORed bit by bit with BLOCK3, and then proceeded in sequence. Finally, an XOR result of 8 (TDES)/16 (AES) bytes is obtained. Use this result The MAC key performs TDES/AES encryption operations. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3602"></a>
<span class="sourceLineNo">3603</span>     *                          &lt;li&gt;0x22: According to the ANSIX9.19 specification, BLOCK1 is encrypted with MAC key for DES (only the key of the first 8 bytes is taken), and the encrypted result is XORed with BLOCK2 bit by bit, and then the MAC key is used for DES encryption, and then proceed to get 8 The result of byte encryption until the last TDES encryption. KSN does not automatically increase by 1. (The AES algorithm is not supported.)&lt;/li&gt;<a name="line.3603"></a>
<span class="sourceLineNo">3604</span>     *                          &lt;li&gt;0x23: CMAC algorithm. KSN does not automatically increase by 1. Other values retain the extended MAC algorithm.&lt;/li&gt;<a name="line.3604"></a>
<span class="sourceLineNo">3605</span>     *                          &lt;li&gt;0x25: HMAC-SHA256 algorithm. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3605"></a>
<span class="sourceLineNo">3606</span>     *                          &lt;li&gt;0x40: According to the ANSI X9.9 specification, BLOCK1 is encrypted with MAC key for TDES/AES, the encrypted result is XORed with BLOCK2 bit by bit, and then the MAC key is used for TDES/AES encryption, and then proceed to get 8(TDES)/16( AES) byte encryption result. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3606"></a>
<span class="sourceLineNo">3607</span>     *                          &lt;li&gt;0x41: In Hypercom Fast Mode, BLOCK1 and BLOCK2 are XORed bit by bit, and the XOR result is XORed bit by bit with BLOCK3, and then proceeded in sequence. Finally, an XOR result of 8 (TDES)/16 (AES) bytes is obtained. Use this result The MAC key performs TDES/AES encryption operations. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3607"></a>
<span class="sourceLineNo">3608</span>     *                          &lt;li&gt;0x42: According to the ANSIX9.19 specification, BLOCK1 is encrypted with MAC key for DES (only the key of the first 8 bytes is taken), and the encrypted result is XORed with BLOCK2 bit by bit, and then the MAC key is used for DES encryption, and then proceed to get 8 The result of byte encryption until the last TDES encryption. KSN does not automatically increase by 1. (The AES algorithm is not supported.)&lt;/li&gt;<a name="line.3608"></a>
<span class="sourceLineNo">3609</span>     *                          &lt;li&gt;0x43: CMAC algorithm. KSN does not automatically increase by 1. Other values retain the extended MAC algorithm.&lt;/li&gt;<a name="line.3609"></a>
<span class="sourceLineNo">3610</span>     *                          &lt;li&gt;0x45: HMAC-SHA256 algorithm. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3610"></a>
<span class="sourceLineNo">3611</span>     *                          &lt;li&gt;0x60: According to the ANSI X9.9 specification, BLOCK1 is encrypted with MAC key for TDES/AES, the encrypted result is XORed with BLOCK2 bit by bit, and then the MAC key is used for TDES/AES encryption, and then proceed to get 8(TDES)/16( AES) byte encryption result. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3611"></a>
<span class="sourceLineNo">3612</span>     *                          &lt;li&gt;0x61: In Hypercom Fast Mode, BLOCK1 and BLOCK2 are XORed bit by bit, and the XOR result is XORed bit by bit with BLOCK3, and then proceeded in sequence. Finally, an XOR result of 8 (TDES)/16 (AES) bytes is obtained. Use this result The MAC key performs TDES/AES encryption operations. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3612"></a>
<span class="sourceLineNo">3613</span>     *                          &lt;li&gt;0x62: According to the ANSIX9.19 specification, BLOCK1 is encrypted with MAC key for DES (only the key of the first 8 bytes is taken), and the encrypted result is XORed with BLOCK2 bit by bit, and then the MAC key is used for DES encryption, and then proceed to get 8 The result of byte encryption until the last TDES encryption. KSN does not automatically increase by 1. (The AES algorithm is not supported.)&lt;/li&gt;<a name="line.3613"></a>
<span class="sourceLineNo">3614</span>     *                          &lt;li&gt;0x63: CMAC algorithm. KSN does not automatically increase by 1. Other values retain the extended MAC algorithm.&lt;/li&gt;<a name="line.3614"></a>
<span class="sourceLineNo">3615</span>     *                          &lt;li&gt;0x65: HMAC-SHA256 algorithm. KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3615"></a>
<span class="sourceLineNo">3616</span>     *                        &lt;/ul&gt;<a name="line.3616"></a>
<span class="sourceLineNo">3617</span>     *                          &lt;/div&gt;<a name="line.3617"></a>
<span class="sourceLineNo">3618</span>     * @return {@link DUKPTResult} &lt;div class="zh"&gt;当mode等于HMAC-SHA256算法是，输出长度为32字节。&lt;/div&gt;<a name="line.3618"></a>
<span class="sourceLineNo">3619</span>     *         &lt;div class="en"&gt;When the mode is equal to the HMAC-SHA256 algorithm, the output length is 32 bytes.&lt;/div&gt;<a name="line.3619"></a>
<span class="sourceLineNo">3620</span>     * @throws PedDevException PedDevException<a name="line.3620"></a>
<span class="sourceLineNo">3621</span>     * @since V3.22.00<a name="line.3621"></a>
<span class="sourceLineNo">3622</span>     */<a name="line.3622"></a>
<span class="sourceLineNo">3623</span>    DUKPTResult getAesDUKPTMac(byte groupIndex, byte[] dataIn, EAlgorithmType algorithmType, byte mode) throws<a name="line.3623"></a>
<span class="sourceLineNo">3624</span>            PedDevException;<a name="line.3624"></a>
<span class="sourceLineNo">3625</span><a name="line.3625"></a>
<span class="sourceLineNo">3626</span>    /**<a name="line.3626"></a>
<span class="sourceLineNo">3627</span>     * &lt;div class="zh"&gt;读取当前的 KSN，将在下一次计算使用。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Read the current KSN, which will be used in the next calculation. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3627"></a>
<span class="sourceLineNo">3628</span>     *<a name="line.3628"></a>
<span class="sourceLineNo">3629</span>     * @param groupIndex &lt;div class="zh"&gt;AES DUKPT密钥组索引。范围1~40。&lt;/div&gt; &lt;div class="en"&gt;AES DUKPT key group index. The range is 1~40.&lt;/div&gt;<a name="line.3629"></a>
<span class="sourceLineNo">3630</span>     * @return &lt;div class="zh"&gt;当前的 KSN 。&lt;/div&gt; &lt;div class="en"&gt;The current KSN.&lt;/div&gt;<a name="line.3630"></a>
<span class="sourceLineNo">3631</span>     * @throws PedDevException PedDevException<a name="line.3631"></a>
<span class="sourceLineNo">3632</span>     * @since V3.22.00<a name="line.3632"></a>
<span class="sourceLineNo">3633</span>     */<a name="line.3633"></a>
<span class="sourceLineNo">3634</span>    byte[] getAesDUKPTKsn(byte groupIndex) throws PedDevException;<a name="line.3634"></a>
<span class="sourceLineNo">3635</span><a name="line.3635"></a>
<span class="sourceLineNo">3636</span>    /**<a name="line.3636"></a>
<span class="sourceLineNo">3637</span>     * &lt;div class="zh"&gt;KSN 加 1。对应于KSN的单个DUKPT密钥最多只能使用256次，在达到最大次数后，进一步使用该密钥将返回{@link EPedDevException#PED_ERR_DUKPT_NEED_INC_KSN}异常，<a name="line.3637"></a>
<span class="sourceLineNo">3638</span>     *      所以请在使用钥匙次数超过最大次数之前增加KSN。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Add 1 to KSN. A single DUKPT key corresponding to KSN can only be used up to 256 times. After the maximum number of times is reached, further use of this key will return {@link EPedDevException#PED_ERR_DUKPT_NEED_INC_KSN} exception, so please increase KSN before using the key more than the maximum number of times.{@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3638"></a>
<span class="sourceLineNo">3639</span>     *<a name="line.3639"></a>
<span class="sourceLineNo">3640</span>     * @param groupIndex &lt;div class="zh"&gt;AES DUKPT密钥组索引。范围1~40。&lt;/div&gt; &lt;div class="en"&gt;AES DUKPT key group index. The range is 1~40.&lt;/div&gt;<a name="line.3640"></a>
<span class="sourceLineNo">3641</span>     * @throws PedDevException PedDevException<a name="line.3641"></a>
<span class="sourceLineNo">3642</span>     * @since V3.22.00<a name="line.3642"></a>
<span class="sourceLineNo">3643</span>     */<a name="line.3643"></a>
<span class="sourceLineNo">3644</span>    void incAesDUKPTKsn(byte groupIndex) throws PedDevException;<a name="line.3644"></a>
<span class="sourceLineNo">3645</span><a name="line.3645"></a>
<span class="sourceLineNo">3646</span>    /**<a name="line.3646"></a>
<span class="sourceLineNo">3647</span>     * &lt;div class="zh"&gt;写入由源密钥加密的特殊要求的密码密钥。&lt;/div&gt;<a name="line.3647"></a>
<span class="sourceLineNo">3648</span>     * &lt;div class="en"&gt;Write a specially required cryptographic key encrypted by the source key.&lt;/div&gt;<a name="line.3648"></a>
<span class="sourceLineNo">3649</span>     *<a name="line.3649"></a>
<span class="sourceLineNo">3650</span>     * @param srcKeyType &lt;div class="zh"&gt;源密钥类型。必须是{@link com.pax.dal.entity.EPedKeyType#TMK}。&lt;/div&gt;<a name="line.3650"></a>
<span class="sourceLineNo">3651</span>     *                   &lt;div class="en"&gt;Source key type. Must be {@link com.pax.dal.entity.EPedKeyType#TMK}.&lt;/div&gt;<a name="line.3651"></a>
<span class="sourceLineNo">3652</span>     * @param srcKeyIndex &lt;div class="zh"&gt;源密钥索引。&lt;/div&gt; &lt;div class="en"&gt;Source key index.&lt;/div&gt;<a name="line.3652"></a>
<span class="sourceLineNo">3653</span>     * @param keyInfo &lt;div class="zh"&gt;密钥内容<a name="line.3653"></a>
<span class="sourceLineNo">3654</span>     *                  &lt;ul&gt;<a name="line.3654"></a>
<span class="sourceLineNo">3655</span>     *                  &lt;li&gt;mode = 0时<a name="line.3655"></a>
<span class="sourceLineNo">3656</span>     *                      &lt;br&gt;keyInfo有3个字节:keyType(1个字节)+ keyIndex(1个字节)+ keyCipherFormat(1个字节)<a name="line.3656"></a>
<span class="sourceLineNo">3657</span>     *                      &lt;br&gt;keyType必须是PED_RSA<a name="line.3657"></a>
<span class="sourceLineNo">3658</span>     *                      &lt;br&gt;keyIndex必须是1~10,keyCipherFormat必须是0&lt;/li&gt;<a name="line.3658"></a>
<span class="sourceLineNo">3659</span>     *                  &lt;li&gt;mode = 1时<a name="line.3659"></a>
<span class="sourceLineNo">3660</span>     *                      &lt;br&gt;KeyInfo有6个字节：keyType(1个字节)+ keyIndex(1个字节)+ keyCipherFormat(1个字节)+keyTypeInfo(1个字节)+keyVersion(1个字节)+ keyLen(1个字节)<a name="line.3660"></a>
<span class="sourceLineNo">3661</span>     *                      &lt;br&gt;keyType必须是PED_TCUSTK和PED_AES_TDK<a name="line.3661"></a>
<span class="sourceLineNo">3662</span>     *                      &lt;br&gt;keyIndex必须是1~100,keyCipherFormat为0(ECB)或1(CBC)<a name="line.3662"></a>
<span class="sourceLineNo">3663</span>     *                      &lt;br&gt;keyTypeInfo在keyType是PED_TCUSTK情况下，必须是SaltKey/MacKey/TableKey/DesfireMasterKey<a name="line.3663"></a>
<span class="sourceLineNo">3664</span>     *                      &lt;br&gt;SaltKey 0x00<a name="line.3664"></a>
<span class="sourceLineNo">3665</span>     *                      &lt;br&gt;MacKey 0x01<a name="line.3665"></a>
<span class="sourceLineNo">3666</span>     *                      &lt;br&gt;TableKey 0x02<a name="line.3666"></a>
<span class="sourceLineNo">3667</span>     *                      &lt;br&gt;DesfireMasterKey 0x03 &lt;/li&gt;<a name="line.3667"></a>
<span class="sourceLineNo">3668</span>     *                  &lt;/ul&gt;&lt;/div&gt;<a name="line.3668"></a>
<span class="sourceLineNo">3669</span>     *                &lt;div class="en"&gt;Key content<a name="line.3669"></a>
<span class="sourceLineNo">3670</span>     *                  &lt;ul&gt;<a name="line.3670"></a>
<span class="sourceLineNo">3671</span>     *                  &lt;li&gt;mode = 0<a name="line.3671"></a>
<span class="sourceLineNo">3672</span>     *                      &lt;br&gt;keyInfo has three bytes: keyType (1 byte) + keyIndex (1 byte) + keyCipherFormat (1 byte)<a name="line.3672"></a>
<span class="sourceLineNo">3673</span>     *                      &lt;br&gt;keyType must be PED_RSA<a name="line.3673"></a>
<span class="sourceLineNo">3674</span>     *                      &lt;br&gt;keyIndex must be 1 ~ 10, keyCipherFormat must cbe 0.&lt;/li&gt;<a name="line.3674"></a>
<span class="sourceLineNo">3675</span>     *                  &lt;li&gt;mode = 1<a name="line.3675"></a>
<span class="sourceLineNo">3676</span>     *                      &lt;br&gt;KeyInfo has 6 bytes: keyType (1 byte) + keyIndex (1 byte) + keyCipherFormat (1 byte) + keyTypeInfo (1 byte) + keyVersion (1 byte) + keyLen(1 Bytes)<a name="line.3676"></a>
<span class="sourceLineNo">3677</span>     *                      &lt;br&gt;keyType must be PED_TCUSTK and PED_AES_TDK<a name="line.3677"></a>
<span class="sourceLineNo">3678</span>     *                      &lt;br&gt;keyIndex must be 1~100, keyCipherFormat must be 0 (ECB) or 1 (CBC)<a name="line.3678"></a>
<span class="sourceLineNo">3679</span>     *                      &lt;br&gt;keyTypeInfo must be SaltKey/MacKey/TableKey/DesfireMasterKey when the keyType is PED_TCUSTK<a name="line.3679"></a>
<span class="sourceLineNo">3680</span>     *                      &lt;br&gt;SaltKey 0x00<a name="line.3680"></a>
<span class="sourceLineNo">3681</span>     *                      &lt;br&gt;MacKey 0x01<a name="line.3681"></a>
<span class="sourceLineNo">3682</span>     *                      &lt;br&gt;TableKey 0x02<a name="line.3682"></a>
<span class="sourceLineNo">3683</span>     *                      &lt;br&gt;DesfireMasterKey 0x03 &lt;/li&gt;<a name="line.3683"></a>
<span class="sourceLineNo">3684</span>     *                  &lt;/ul&gt;&lt;/div&gt;<a name="line.3684"></a>
<span class="sourceLineNo">3685</span>     * @param keyBlock &lt;div class="zh"&gt;密码密钥块。&lt;/div&gt; &lt;div class="en"&gt;Cipher key block.&lt;/div&gt;<a name="line.3685"></a>
<span class="sourceLineNo">3686</span>     * @param mode &lt;div class="zh"&gt;模式<a name="line.3686"></a>
<span class="sourceLineNo">3687</span>     *             &lt;ul&gt;<a name="line.3687"></a>
<span class="sourceLineNo">3688</span>     *             &lt;li&gt;0,写入由{@link com.pax.dal.entity.EPedKeyType#TMK}加密的TCU RSA。&lt;/li&gt;<a name="line.3688"></a>
<span class="sourceLineNo">3689</span>     *             &lt;li&gt;1,写入由{@link com.pax.dal.entity.EPedKeyType#TMK}加密的PED_TCUSTK和PED_AES_TDK。&lt;/li&gt;<a name="line.3689"></a>
<span class="sourceLineNo">3690</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3690"></a>
<span class="sourceLineNo">3691</span>     *             &lt;div class="en"&gt;Mode<a name="line.3691"></a>
<span class="sourceLineNo">3692</span>     *             &lt;ul&gt;<a name="line.3692"></a>
<span class="sourceLineNo">3693</span>     *             &lt;li&gt;0, Writt TCU RSA encrypted by {@link com.pax.dal.entity.EPedKeyType#TMK}.&lt;/li&gt;<a name="line.3693"></a>
<span class="sourceLineNo">3694</span>     *             &lt;li&gt;1, Write PED_TCUSTK and PED_AES_TDK encrypted by {@link com.pax.dal.entity.EPedKeyType#TMK}.&lt;/li&gt;<a name="line.3694"></a>
<span class="sourceLineNo">3695</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3695"></a>
<span class="sourceLineNo">3696</span>     * @throws PedDevException PedDevException<a name="line.3696"></a>
<span class="sourceLineNo">3697</span>     * @since V3.23.00<a name="line.3697"></a>
<span class="sourceLineNo">3698</span>     */<a name="line.3698"></a>
<span class="sourceLineNo">3699</span>    void writeCipherKey(byte srcKeyType, byte srcKeyIndex, byte[] keyInfo, byte[] keyBlock, byte mode) throws PedDevException;<a name="line.3699"></a>
<span class="sourceLineNo">3700</span><a name="line.3700"></a>
<span class="sourceLineNo">3701</span><a name="line.3701"></a>
<span class="sourceLineNo">3702</span>    /**<a name="line.3702"></a>
<span class="sourceLineNo">3703</span>     * &lt;div class="zh"&gt;查询密钥信息。&lt;/div&gt;<a name="line.3703"></a>
<span class="sourceLineNo">3704</span>     * &lt;div class="en"&gt;Query key information.&lt;/div&gt;<a name="line.3704"></a>
<span class="sourceLineNo">3705</span>     *<a name="line.3705"></a>
<span class="sourceLineNo">3706</span>     * @param keyType &lt;div class="zh"&gt;密钥类型。<a name="line.3706"></a>
<span class="sourceLineNo">3707</span>     *                &lt;ul&gt;<a name="line.3707"></a>
<span class="sourceLineNo">3708</span>     *                 &lt;li&gt;0x01: TLK&lt;/li&gt;<a name="line.3708"></a>
<span class="sourceLineNo">3709</span>     *                 &lt;li&gt;0x02: TMK&lt;/li&gt;<a name="line.3709"></a>
<span class="sourceLineNo">3710</span>     *                 &lt;li&gt;0x0A: TWK&lt;/li&gt;<a name="line.3710"></a>
<span class="sourceLineNo">3711</span>     *                 &lt;li&gt;0x07: TIK&lt;/li&gt;<a name="line.3711"></a>
<span class="sourceLineNo">3712</span>     *                 &lt;li&gt;0x20: TAESK&lt;/li&gt;<a name="line.3712"></a>
<span class="sourceLineNo">3713</span>     *                 &lt;li&gt;0x0B: RSA&lt;/li&gt;<a name="line.3713"></a>
<span class="sourceLineNo">3714</span>     *                 &lt;li&gt;0x0C: AES_TWK&lt;/li&gt;<a name="line.3714"></a>
<span class="sourceLineNo">3715</span>     *                 &lt;li&gt;0x22: AES_TMK&lt;/li&gt;<a name="line.3715"></a>
<span class="sourceLineNo">3716</span>     *                 &lt;li&gt;0x51: AES_TIK&lt;/li&gt;<a name="line.3716"></a>
<span class="sourceLineNo">3717</span>     *                &lt;/ul&gt;&lt;/div&gt;<a name="line.3717"></a>
<span class="sourceLineNo">3718</span>     *                &lt;div class="en"&gt;key type.<a name="line.3718"></a>
<span class="sourceLineNo">3719</span>     *                &lt;ul&gt;<a name="line.3719"></a>
<span class="sourceLineNo">3720</span>     *                 &lt;li&gt;0x01: TLK&lt;/li&gt;<a name="line.3720"></a>
<span class="sourceLineNo">3721</span>     *                 &lt;li&gt;0x02: TMK&lt;/li&gt;<a name="line.3721"></a>
<span class="sourceLineNo">3722</span>     *                 &lt;li&gt;0x0A: TWK&lt;/li&gt;<a name="line.3722"></a>
<span class="sourceLineNo">3723</span>     *                 &lt;li&gt;0x07: TIK&lt;/li&gt;<a name="line.3723"></a>
<span class="sourceLineNo">3724</span>     *                 &lt;li&gt;0x20: TAESK&lt;/li&gt;<a name="line.3724"></a>
<span class="sourceLineNo">3725</span>     *                 &lt;li&gt;0x0B: RSA&lt;/li&gt;<a name="line.3725"></a>
<span class="sourceLineNo">3726</span>     *                 &lt;li&gt;0x0C: AES_TWK&lt;/li&gt;<a name="line.3726"></a>
<span class="sourceLineNo">3727</span>     *                 &lt;li&gt;0x22: AES_TMK&lt;/li&gt;<a name="line.3727"></a>
<span class="sourceLineNo">3728</span>     *                 &lt;li&gt;0x51: AES_TIK&lt;/li&gt;<a name="line.3728"></a>
<span class="sourceLineNo">3729</span>     *                &lt;/ul&gt;&lt;/div&gt;<a name="line.3729"></a>
<span class="sourceLineNo">3730</span>     * @param keyIndex &lt;div class="zh"&gt;密钥索引.<a name="line.3730"></a>
<span class="sourceLineNo">3731</span>     *                   &lt;ul&gt;<a name="line.3731"></a>
<span class="sourceLineNo">3732</span>     *                   &lt;li&gt;TLK: 1&lt;/li&gt;<a name="line.3732"></a>
<span class="sourceLineNo">3733</span>     *                   &lt;li&gt;TMK: 1-100&lt;/li&gt;<a name="line.3733"></a>
<span class="sourceLineNo">3734</span>     *                   &lt;li&gt;TWK: 1-100&lt;/li&gt;<a name="line.3734"></a>
<span class="sourceLineNo">3735</span>     *                   &lt;li&gt;TIK: 1-100&lt;/li&gt;<a name="line.3735"></a>
<span class="sourceLineNo">3736</span>     *                   &lt;li&gt;TAESK: 1-40&lt;/li&gt;<a name="line.3736"></a>
<span class="sourceLineNo">3737</span>     *                   &lt;li&gt;RSA: 1-10&lt;/li&gt;<a name="line.3737"></a>
<span class="sourceLineNo">3738</span>     *                   &lt;li&gt;AES_TWK: 1-100&lt;/li&gt;<a name="line.3738"></a>
<span class="sourceLineNo">3739</span>     *                   &lt;li&gt;AES_TMK: 1-100&lt;/li&gt;<a name="line.3739"></a>
<span class="sourceLineNo">3740</span>     *                   &lt;li&gt;AES_TIK: 1-100&lt;/li&gt;<a name="line.3740"></a>
<span class="sourceLineNo">3741</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.3741"></a>
<span class="sourceLineNo">3742</span>     *                   &lt;div class="en"&gt;key index.<a name="line.3742"></a>
<span class="sourceLineNo">3743</span>     *                    &lt;ul&gt;<a name="line.3743"></a>
<span class="sourceLineNo">3744</span>     *                    &lt;li&gt;TLK: 1&lt;/li&gt;<a name="line.3744"></a>
<span class="sourceLineNo">3745</span>     *                    &lt;li&gt;TMK: 1-100&lt;/li&gt;<a name="line.3745"></a>
<span class="sourceLineNo">3746</span>     *                    &lt;li&gt;TWK: 1-100&lt;/li&gt;<a name="line.3746"></a>
<span class="sourceLineNo">3747</span>     *                    &lt;li&gt;TIK: 1-100&lt;/li&gt;<a name="line.3747"></a>
<span class="sourceLineNo">3748</span>     *                    &lt;li&gt;TAESK: 1-40&lt;/li&gt;<a name="line.3748"></a>
<span class="sourceLineNo">3749</span>     *                    &lt;li&gt;RSA: 1-10&lt;/li&gt;<a name="line.3749"></a>
<span class="sourceLineNo">3750</span>     *                    &lt;li&gt;AES_TWK: 1-100&lt;/li&gt;<a name="line.3750"></a>
<span class="sourceLineNo">3751</span>     *                    &lt;li&gt;AES_TMK: 1-100&lt;/li&gt;<a name="line.3751"></a>
<span class="sourceLineNo">3752</span>     *                    &lt;/ul&gt;&lt;/div&gt;<a name="line.3752"></a>
<span class="sourceLineNo">3753</span>     * @throws PedDevException PedDevException<a name="line.3753"></a>
<span class="sourceLineNo">3754</span>     * @since V3.25.00<a name="line.3754"></a>
<span class="sourceLineNo">3755</span>     */<a name="line.3755"></a>
<span class="sourceLineNo">3756</span>    KeyInfo queryKeyInfo(byte keyType, byte keyIndex) throws PedDevException;<a name="line.3756"></a>
<span class="sourceLineNo">3757</span><a name="line.3757"></a>
<span class="sourceLineNo">3758</span>    /**<a name="line.3758"></a>
<span class="sourceLineNo">3759</span>     * &lt;div class="zh"&gt;设置盲人输入法语音播报的语言。此接口需在{@link #getPinBlock(byte, String, byte[], byte, int)}之前设置才有效。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt;<a name="line.3759"></a>
<span class="sourceLineNo">3760</span>     * &lt;div class="en"&gt;Set the language for the voice broadcast of the blind input method. This interface needs to be set before<a name="line.3760"></a>
<span class="sourceLineNo">3761</span>     * {@link #getPinBlock(byte, String, byte[], byte, int)} to be effective. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.3761"></a>
<span class="sourceLineNo">3762</span>     *<a name="line.3762"></a>
<span class="sourceLineNo">3763</span>     * @param language &lt;div class="zh"&gt;语言类型。<a name="line.3763"></a>
<span class="sourceLineNo">3764</span>     *                   &lt;ul&gt;<a name="line.3764"></a>
<span class="sourceLineNo">3765</span>     *                     &lt;li&gt;0x00: 英语。&lt;/li&gt;<a name="line.3765"></a>
<span class="sourceLineNo">3766</span>     *                     &lt;li&gt;0x0A: 波兰语。&lt;/li&gt;<a name="line.3766"></a>
<span class="sourceLineNo">3767</span>     *                     &lt;li&gt;0x0B: 法语。&lt;/li&gt;<a name="line.3767"></a>
<span class="sourceLineNo">3768</span>     *                     &lt;li&gt;0x0C: 西班牙语。&lt;/li&gt;<a name="line.3768"></a>
<span class="sourceLineNo">3769</span>     *                     &lt;li&gt;0x0D: 澳大利亚英语。&lt;/li&gt;<a name="line.3769"></a>
<span class="sourceLineNo">3770</span>     *                     &lt;li&gt;0x0E: 意大利语。&lt;/li&gt;<a name="line.3770"></a>
<span class="sourceLineNo">3771</span>     *                     &lt;li&gt;0x0F: 英语(意大利客户)。&lt;/li&gt;<a name="line.3771"></a>
<span class="sourceLineNo">3772</span>     *                     &lt;li&gt;0x10: 普通话。&lt;/li&gt;<a name="line.3772"></a>
<span class="sourceLineNo">3773</span>     *                     &lt;li&gt;0x11: 粤语。&lt;/li&gt;<a name="line.3773"></a>
<span class="sourceLineNo">3774</span>     *                     &lt;li&gt;0x12: 葡萄牙语（巴西）。&lt;/li&gt;<a name="line.3774"></a>
<span class="sourceLineNo">3775</span>     *                   &lt;/ul&gt;<a name="line.3775"></a>
<span class="sourceLineNo">3776</span>     *                 &lt;/div&gt;<a name="line.3776"></a>
<span class="sourceLineNo">3777</span>     *                 &lt;div class="en"&gt;Language type.<a name="line.3777"></a>
<span class="sourceLineNo">3778</span>     *                   &lt;ul&gt;<a name="line.3778"></a>
<span class="sourceLineNo">3779</span>     *                     &lt;li&gt;0x00: English.&lt;/li&gt;<a name="line.3779"></a>
<span class="sourceLineNo">3780</span>     *                     &lt;li&gt;0x0A: Polish.&lt;/li&gt;<a name="line.3780"></a>
<span class="sourceLineNo">3781</span>     *                     &lt;li&gt;0x0B: French.&lt;/li&gt;<a name="line.3781"></a>
<span class="sourceLineNo">3782</span>     *                     &lt;li&gt;0x0C: Spanish.&lt;/li&gt;<a name="line.3782"></a>
<span class="sourceLineNo">3783</span>     *                     &lt;li&gt;0x0D: Australian.&lt;/li&gt;<a name="line.3783"></a>
<span class="sourceLineNo">3784</span>     *                     &lt;li&gt;0x0E: Italian.&lt;/li&gt;<a name="line.3784"></a>
<span class="sourceLineNo">3785</span>     *                     &lt;li&gt;0x0F: English(for Italian).&lt;/li&gt;<a name="line.3785"></a>
<span class="sourceLineNo">3786</span>     *                     &lt;li&gt;0x10: Chinese_Mandarin.&lt;/li&gt;<a name="line.3786"></a>
<span class="sourceLineNo">3787</span>     *                     &lt;li&gt;0x11: Chinese_Cantonese.&lt;/li&gt;<a name="line.3787"></a>
<span class="sourceLineNo">3788</span>     *                     &lt;li&gt;0x12: Portuguese (Brazil)&lt;/li&gt;<a name="line.3788"></a>
<span class="sourceLineNo">3789</span>     *                   &lt;/ul&gt;<a name="line.3789"></a>
<span class="sourceLineNo">3790</span>     *                 &lt;/div&gt;<a name="line.3790"></a>
<span class="sourceLineNo">3791</span>     * @throws PedDevException PedDevException<a name="line.3791"></a>
<span class="sourceLineNo">3792</span>     * @since V3.26.00<a name="line.3792"></a>
<span class="sourceLineNo">3793</span>     */<a name="line.3793"></a>
<span class="sourceLineNo">3794</span>    void setDoubleTapKeyboardLanguage(byte language) throws PedDevException;<a name="line.3794"></a>
<span class="sourceLineNo">3795</span><a name="line.3795"></a>
<span class="sourceLineNo">3796</span><a name="line.3796"></a>
<span class="sourceLineNo">3797</span>    /**<a name="line.3797"></a>
<span class="sourceLineNo">3798</span>     * &lt;div class="zh"&gt;通过M1MasterKey去发散M1key，给非接驱动提供秘钥实现M1的认证。&lt;/div&gt;<a name="line.3798"></a>
<span class="sourceLineNo">3799</span>     * &lt;div class="en"&gt;Distribute M1key through M1MasterKey, and provide secret key to contactless driver to realize M1 authentication.&lt;/div&gt;<a name="line.3799"></a>
<span class="sourceLineNo">3800</span>     *<a name="line.3800"></a>
<span class="sourceLineNo">3801</span>     * @param type &lt;div class="zh"&gt;'A'或'a': 提交的是A密码&lt;br/&gt;<a name="line.3801"></a>
<span class="sourceLineNo">3802</span>     *             'B'或'b': 提交的是B密码<a name="line.3802"></a>
<span class="sourceLineNo">3803</span>     *                 &lt;/div&gt;<a name="line.3803"></a>
<span class="sourceLineNo">3804</span>     *                 &lt;div class="en"&gt;'A' or'a': A password is submitted&lt;br/&gt;<a name="line.3804"></a>
<span class="sourceLineNo">3805</span>     *             'B' or 'b': B password is submitted<a name="line.3805"></a>
<span class="sourceLineNo">3806</span>     *                 &lt;/div&gt;<a name="line.3806"></a>
<span class="sourceLineNo">3807</span>     * @param m1KeyIdx &lt;div class="zh"&gt;{@link EPedKeyType#PED_TM1K} 密钥索引&lt;/div&gt;<a name="line.3807"></a>
<span class="sourceLineNo">3808</span>     *                 &lt;div class="en"&gt;{@link EPedKeyType#PED_TM1K} key index&lt;/div&gt;<a name="line.3808"></a>
<span class="sourceLineNo">3809</span>     * @param m1MasterKeyIdx &lt;div class="zh"&gt;PED_TCUSTK密钥索引，密钥信息必须为DesfireMifareMasterKey&lt;/div&gt;<a name="line.3809"></a>
<span class="sourceLineNo">3810</span>     *                       &lt;div class="en"&gt;PED_TCUSTK key index, the key information must be DesfireMifareMasterKey&lt;/div&gt;<a name="line.3810"></a>
<span class="sourceLineNo">3811</span>     * @param blkNo &lt;div class="zh"&gt;要访问的块号 &lt;/div&gt;<a name="line.3811"></a>
<span class="sourceLineNo">3812</span>     *              &lt;div class="en"&gt;Block number to be accessed&lt;/div&gt;<a name="line.3812"></a>
<span class="sourceLineNo">3813</span>     * @param serialNo &lt;div class="zh"&gt;卡片序列号，长度必须为4 &lt;/div&gt;<a name="line.3813"></a>
<span class="sourceLineNo">3814</span>     *                 &lt;div class="en"&gt;Card serial number, length must be 4&lt;/div&gt;<a name="line.3814"></a>
<span class="sourceLineNo">3815</span>     * @throws PedDevException PedDevException<a name="line.3815"></a>
<span class="sourceLineNo">3816</span>     * @since V3.28.00<a name="line.3816"></a>
<span class="sourceLineNo">3817</span>     */<a name="line.3817"></a>
<span class="sourceLineNo">3818</span>    void m1AuthorityDiversified(byte type, byte m1KeyIdx, byte m1MasterKeyIdx, byte blkNo, byte[] serialNo) throws PedDevException;<a name="line.3818"></a>
<span class="sourceLineNo">3819</span><a name="line.3819"></a>
<span class="sourceLineNo">3820</span>    /**<a name="line.3820"></a>
<span class="sourceLineNo">3821</span>     * &lt;div class="zh"&gt;使用DesfireMasterKey和DiversificationKey来计算认证数据。&lt;/div&gt;<a name="line.3821"></a>
<span class="sourceLineNo">3822</span>     * &lt;div class="en"&gt;Use DesfireMasterKey and DiversificationKey to calculate authentication data.&lt;/div&gt;<a name="line.3822"></a>
<span class="sourceLineNo">3823</span>     *<a name="line.3823"></a>
<span class="sourceLineNo">3824</span>     * @param keyIndex1 &lt;div class="zh"&gt;DesfireMaster Key(PED_TCUSTK) 密钥索引, keyinfo 必须是 DesfireMasterKey。&lt;/div&gt;<a name="line.3824"></a>
<span class="sourceLineNo">3825</span>     *                  &lt;div class="en"&gt;DesfireMaster Key(PED_TCUSTK) key index, keyinfo must be DesfireMasterKey.&lt;/div&gt;<a name="line.3825"></a>
<span class="sourceLineNo">3826</span>     * @param keyIndex2 &lt;div class="zh"&gt;Diversification key(PED_AES_TDK) 密钥索引。&lt;/div&gt;<a name="line.3826"></a>
<span class="sourceLineNo">3827</span>     *                   &lt;div class="en"&gt;Diversification key(PED_AES_TDK) key index.&lt;/div&gt;<a name="line.3827"></a>
<span class="sourceLineNo">3828</span>     * @param csn &lt;div class="zh"&gt;长度为7的序列号&lt;/div&gt;<a name="line.3828"></a>
<span class="sourceLineNo">3829</span>     *            &lt;div class="en"&gt;Serial number of length 7&lt;/div&gt;<a name="line.3829"></a>
<span class="sourceLineNo">3830</span>     * @param dataIn &lt;div class="zh"&gt;需要进行运算的数据&lt;/div&gt;<a name="line.3830"></a>
<span class="sourceLineNo">3831</span>     *               &lt;div class="en"&gt;Data to be calculated&lt;/div&gt;<a name="line.3831"></a>
<span class="sourceLineNo">3832</span>     * @param initVector &lt;div class="zh"&gt;向量，仅适用于CBC模式，若传NULL则用0填充，如果ECB模式，该参数被忽略。&lt;/div&gt;<a name="line.3832"></a>
<span class="sourceLineNo">3833</span>     *                   &lt;div class="en"&gt;Vector, only applicable to CBC mode. If NULL is passed, it will be filled with 0. If ECB mode, this parameter is ignored.&lt;/div&gt;<a name="line.3833"></a>
<span class="sourceLineNo">3834</span>     * @param mode &lt;div class="zh"&gt;运算模式<a name="line.3834"></a>
<span class="sourceLineNo">3835</span>     *             &lt;ul&gt;<a name="line.3835"></a>
<span class="sourceLineNo">3836</span>     *                 &lt;li&gt;0x00:ECB解密模式&lt;/li&gt;<a name="line.3836"></a>
<span class="sourceLineNo">3837</span>     *                 &lt;li&gt;0x01:ECB加密模式&lt;/li&gt;<a name="line.3837"></a>
<span class="sourceLineNo">3838</span>     *                 &lt;li&gt;0x02:CBC解密模式&lt;/li&gt;<a name="line.3838"></a>
<span class="sourceLineNo">3839</span>     *                 &lt;li&gt;0x03:CBC加密模式&lt;/li&gt;<a name="line.3839"></a>
<span class="sourceLineNo">3840</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3840"></a>
<span class="sourceLineNo">3841</span>     *             &lt;div class="en"&gt;Operation mode<a name="line.3841"></a>
<span class="sourceLineNo">3842</span>     *             &lt;ul&gt;<a name="line.3842"></a>
<span class="sourceLineNo">3843</span>     *             &lt;li&gt;0x00: ECB decryption mode&lt;/li&gt;<a name="line.3843"></a>
<span class="sourceLineNo">3844</span>     *             &lt;li&gt;0x01: ECB encryption mode&lt;/li&gt;<a name="line.3844"></a>
<span class="sourceLineNo">3845</span>     *             &lt;li&gt;0x02: CBC decryption mode&lt;/li&gt;<a name="line.3845"></a>
<span class="sourceLineNo">3846</span>     *             &lt;li&gt;0x03: CBC encryption mode&lt;/li&gt;<a name="line.3846"></a>
<span class="sourceLineNo">3847</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3847"></a>
<span class="sourceLineNo">3848</span>     * @return &lt;div class="zh"&gt;运算后的数据&lt;/div&gt;<a name="line.3848"></a>
<span class="sourceLineNo">3849</span>     *         &lt;div class="en"&gt;Data after calculation&lt;/div&gt;<a name="line.3849"></a>
<span class="sourceLineNo">3850</span>     * @throws PedDevException PedDevException<a name="line.3850"></a>
<span class="sourceLineNo">3851</span>     * @since V3.27.00<a name="line.3851"></a>
<span class="sourceLineNo">3852</span>     */<a name="line.3852"></a>
<span class="sourceLineNo">3853</span>    byte[] calcDesfireAuth(byte keyIndex1, byte keyIndex2, byte[] csn, byte[] dataIn, byte[] initVector, byte mode) throws PedDevException;<a name="line.3853"></a>
<span class="sourceLineNo">3854</span><a name="line.3854"></a>
<span class="sourceLineNo">3855</span>    /**<a name="line.3855"></a>
<span class="sourceLineNo">3856</span>     * &lt;div class="zh"&gt;读取客户定制TCUSTK密钥信息。&lt;/div&gt;<a name="line.3856"></a>
<span class="sourceLineNo">3857</span>     * &lt;div class="en"&gt;Read customer customized TCUTK key information.&lt;/div&gt;<a name="line.3857"></a>
<span class="sourceLineNo">3858</span>     *<a name="line.3858"></a>
<span class="sourceLineNo">3859</span>     * @param keyType &lt;div class="zh"&gt;TCUSTK密钥类型。&lt;/div&gt;<a name="line.3859"></a>
<span class="sourceLineNo">3860</span>     *                   &lt;div class="en"&gt;TCUSTK key type.&lt;/div&gt;<a name="line.3860"></a>
<span class="sourceLineNo">3861</span>     * @param keyIndex &lt;div class="zh"&gt;TCUSTK密钥索引。&lt;/div&gt; &lt;div class="en"&gt;TCUSTK key index.&lt;/div&gt;<a name="line.3861"></a>
<span class="sourceLineNo">3862</span>     * @param infoType &lt;div class="zh"&gt; 数据类型<a name="line.3862"></a>
<span class="sourceLineNo">3863</span>     *                 &lt;br&gt;目前只支持0。&lt;/div&gt;<a name="line.3863"></a>
<span class="sourceLineNo">3864</span>     *                &lt;div class="en"&gt;type of data<a name="line.3864"></a>
<span class="sourceLineNo">3865</span>     *                 &lt;br&gt;Currently only supports 0.&lt;/div&gt;<a name="line.3865"></a>
<span class="sourceLineNo">3866</span>     *<a name="line.3866"></a>
<span class="sourceLineNo">3867</span>     * @return &lt;div class="zh"&gt;密钥信息，根据不同的InfoType输出不同的值，目前只支持0模式(keyTypeInfo + keyVersion)。&lt;/div&gt;<a name="line.3867"></a>
<span class="sourceLineNo">3868</span>     *         &lt;div class="en"&gt;Key information, output different values according to different InfoType, currently only supports 0 mode(keyTypeInfo + keyVersion).&lt;/div&gt;<a name="line.3868"></a>
<span class="sourceLineNo">3869</span>     * @throws PedDevException PedDevException<a name="line.3869"></a>
<span class="sourceLineNo">3870</span>     * @since V3.27.00<a name="line.3870"></a>
<span class="sourceLineNo">3871</span>     */<a name="line.3871"></a>
<span class="sourceLineNo">3872</span>    byte[] readKeyInfo(byte keyType, byte keyIndex, byte infoType) throws PedDevException;<a name="line.3872"></a>
<span class="sourceLineNo">3873</span><a name="line.3873"></a>
<span class="sourceLineNo">3874</span><a name="line.3874"></a>
<span class="sourceLineNo">3875</span>    /**<a name="line.3875"></a>
<span class="sourceLineNo">3876</span>     * &lt;div class="zh"&gt;使用MAC密钥进行MAC运算。&lt;/div&gt;<a name="line.3876"></a>
<span class="sourceLineNo">3877</span>     * &lt;div class="en"&gt;Use MAC keys for MAC operations.&lt;/div&gt;<a name="line.3877"></a>
<span class="sourceLineNo">3878</span>     *<a name="line.3878"></a>
<span class="sourceLineNo">3879</span>     * @param keyType &lt;div class="zh"&gt;TCUSTK密钥类型。&lt;/div&gt;<a name="line.3879"></a>
<span class="sourceLineNo">3880</span>     *                   &lt;div class="en"&gt;TCUSTK key type.&lt;/div&gt;<a name="line.3880"></a>
<span class="sourceLineNo">3881</span>     * @param keyIdx &lt;div class="zh"&gt;TCUSTK密钥索引。&lt;/div&gt; &lt;div class="en"&gt;TCUSTK key index.&lt;/div&gt;<a name="line.3881"></a>
<span class="sourceLineNo">3882</span>     * @param dataIn &lt;div class="zh"&gt; 需要进行运算的数据。&lt;/div&gt;<a name="line.3882"></a>
<span class="sourceLineNo">3883</span>     *                &lt;div class="en"&gt;Data to be calculated.&lt;/div&gt;<a name="line.3883"></a>
<span class="sourceLineNo">3884</span>     * @param mode &lt;div class="zh"&gt;运算模式<a name="line.3884"></a>
<span class="sourceLineNo">3885</span>     *             &lt;ul&gt;<a name="line.3885"></a>
<span class="sourceLineNo">3886</span>     *              &lt;li&gt;CBC(16 bytes) 0x00 &lt;/li&gt;<a name="line.3886"></a>
<span class="sourceLineNo">3887</span>     *              &lt;li&gt;&lt;STRIKE&gt;CMAC(16 bytes) 0x03 &lt;/STRIKE&gt;&lt;/li&gt;<a name="line.3887"></a>
<span class="sourceLineNo">3888</span>     *              &lt;li&gt;&lt;STRIKE&gt;HMAC-SHA256(32 bytes) 0x05 &lt;/STRIKE&gt;&lt;/li&gt;<a name="line.3888"></a>
<span class="sourceLineNo">3889</span>     *              &lt;li&gt;SHA256(32 bytes) 0x06 &lt;/li&gt;<a name="line.3889"></a>
<span class="sourceLineNo">3890</span>     *              &lt;li&gt;HMAC-SHA1(20 bytes) 0x07 &lt;/li&gt;<a name="line.3890"></a>
<span class="sourceLineNo">3891</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3891"></a>
<span class="sourceLineNo">3892</span>     *             &lt;div class="en"&gt;Operation mode<a name="line.3892"></a>
<span class="sourceLineNo">3893</span>     *             &lt;ul&gt;<a name="line.3893"></a>
<span class="sourceLineNo">3894</span>     *              &lt;li&gt;CBC(16 bytes) 0x00 &lt;/li&gt;<a name="line.3894"></a>
<span class="sourceLineNo">3895</span>     *              &lt;li&gt;&lt;STRIKE&gt;CMAC(16 bytes) 0x03 &lt;/STRIKE&gt;&lt;/li&gt;<a name="line.3895"></a>
<span class="sourceLineNo">3896</span>     *              &lt;li&gt;&lt;STRIKE&gt;HMAC-SHA256(32 bytes) 0x05 &lt;/STRIKE&gt;&lt;/li&gt;<a name="line.3896"></a>
<span class="sourceLineNo">3897</span>     *              &lt;li&gt;SHA256(32 bytes) 0x06 &lt;/li&gt;<a name="line.3897"></a>
<span class="sourceLineNo">3898</span>     *              &lt;li&gt;HMAC-SHA1(20 bytes) 0x07 &lt;/li&gt;<a name="line.3898"></a>
<span class="sourceLineNo">3899</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3899"></a>
<span class="sourceLineNo">3900</span>     * @return &lt;div class="zh"&gt;运算后的数据，根据mode不同，输出不同长度的值。&lt;/div&gt;<a name="line.3900"></a>
<span class="sourceLineNo">3901</span>     *         &lt;div class="en"&gt;The calculated data, according to different modes, output values of different lengths.&lt;/div&gt;<a name="line.3901"></a>
<span class="sourceLineNo">3902</span>     * @throws PedDevException PedDevException<a name="line.3902"></a>
<span class="sourceLineNo">3903</span>     * @since V3.27.00<a name="line.3903"></a>
<span class="sourceLineNo">3904</span>     */<a name="line.3904"></a>
<span class="sourceLineNo">3905</span>    byte[] keyCalcMac(byte keyType, byte keyIdx, byte[] dataIn, byte mode) throws PedDevException;<a name="line.3905"></a>
<span class="sourceLineNo">3906</span><a name="line.3906"></a>
<span class="sourceLineNo">3907</span>    /**<a name="line.3907"></a>
<span class="sourceLineNo">3908</span>     * &lt;div class="zh"&gt;使用预装PAX CA公钥或者私钥进行签名、加密、解密。&lt;/div&gt;<a name="line.3908"></a>
<span class="sourceLineNo">3909</span>     * &lt;div class="en"&gt;Use the pre-installed Pax CA for signature, encryption and decryption.&lt;/div&gt;<a name="line.3909"></a>
<span class="sourceLineNo">3910</span>     *<a name="line.3910"></a>
<span class="sourceLineNo">3911</span>     * @param keyIdx &lt;div class="zh"&gt;<a name="line.3911"></a>
<span class="sourceLineNo">3912</span>     *                   &lt;ul&gt;<a name="line.3912"></a>
<span class="sourceLineNo">3913</span>     *                     &lt;li&gt;102: PAXCA_DSIG_IDX &lt;br&gt;当它作为私钥时，只能用于签名，<a name="line.3913"></a>
<span class="sourceLineNo">3914</span>     *                     因此输入数据的首字节必须为0x00&lt;/li&gt;<a name="line.3914"></a>
<span class="sourceLineNo">3915</span>     *                     &lt;li&gt;103: PAXCA_DID_IDX 当它作为私钥时，私钥仅用于解密，因此输入数据首字节不能为0x00 &lt;/li&gt;<a name="line.3915"></a>
<span class="sourceLineNo">3916</span>     *                     &lt;li&gt;104: PAXCA_DTLS_IDX 暂不做限制&lt;/li&gt;<a name="line.3916"></a>
<span class="sourceLineNo">3917</span>     *                     &lt;li&gt;105: PAXCA_DC_IDX 暂不做限制&lt;/li&gt;<a name="line.3917"></a>
<span class="sourceLineNo">3918</span>     *                   &lt;/ul&gt;<a name="line.3918"></a>
<span class="sourceLineNo">3919</span>     *                 &lt;/div&gt;<a name="line.3919"></a>
<span class="sourceLineNo">3920</span>     *                 &lt;div class="en"&gt;<a name="line.3920"></a>
<span class="sourceLineNo">3921</span>     *                   &lt;ul&gt;<a name="line.3921"></a>
<span class="sourceLineNo">3922</span>     *                     &lt;li&gt;102: PAXCA_DSIG_IDX &lt;br&gt; When it is used as a private key,<a name="line.3922"></a>
<span class="sourceLineNo">3923</span>     *                     it can only be used for signing, so the first byte of the input data must be 0x00&lt;/li&gt;<a name="line.3923"></a>
<span class="sourceLineNo">3924</span>     *                     &lt;li&gt;103: PAXCA_DID_IDX When it is used as a private key, the private key is only used for decryption,<a name="line.3924"></a>
<span class="sourceLineNo">3925</span>     *                     so the first byte of input data cannot be 0x00&lt;/li&gt;<a name="line.3925"></a>
<span class="sourceLineNo">3926</span>     *                     &lt;li&gt;104: PAXCA_DTLS_IDX No restrictions&lt;/li&gt;<a name="line.3926"></a>
<span class="sourceLineNo">3927</span>     *                     &lt;li&gt;105: PAXCA_DC_IDX No restrictions&lt;/li&gt;<a name="line.3927"></a>
<span class="sourceLineNo">3928</span>     *                   &lt;/ul&gt;<a name="line.3928"></a>
<span class="sourceLineNo">3929</span>     *                 &lt;/div&gt;<a name="line.3929"></a>
<span class="sourceLineNo">3930</span>     * @param pvkPukSelect &lt;div class="zh"&gt;0: 公钥  1: 私钥。&lt;/div&gt;<a name="line.3930"></a>
<span class="sourceLineNo">3931</span>     *                     &lt;div class="en"&gt;0: public key 1: private key.&lt;/div&gt;<a name="line.3931"></a>
<span class="sourceLineNo">3932</span>     * @param dataIn  &lt;div class="zh"&gt;输入的数据，长度必须为256。&lt;/div&gt;<a name="line.3932"></a>
<span class="sourceLineNo">3933</span>     *                &lt;div class="en"&gt;Input data, the length must be 256.&lt;/div&gt;<a name="line.3933"></a>
<span class="sourceLineNo">3934</span>     * @return &lt;div class="zh"&gt;运算结果&lt;/div&gt;<a name="line.3934"></a>
<span class="sourceLineNo">3935</span>     *         &lt;div class="en"&gt;Result&lt;/div&gt;<a name="line.3935"></a>
<span class="sourceLineNo">3936</span>     * @throws PedDevException PedDevException<a name="line.3936"></a>
<span class="sourceLineNo">3937</span>     * @since V3.27.00<a name="line.3937"></a>
<span class="sourceLineNo">3938</span>     */<a name="line.3938"></a>
<span class="sourceLineNo">3939</span>    byte[] paxCARecover (byte keyIdx, byte pvkPukSelect, byte[] dataIn) throws PedDevException;<a name="line.3939"></a>
<span class="sourceLineNo">3940</span><a name="line.3940"></a>
<span class="sourceLineNo">3941</span><a name="line.3941"></a>
<span class="sourceLineNo">3942</span>    /**<a name="line.3942"></a>
<span class="sourceLineNo">3943</span>     * &lt;div class="zh"&gt;使用AES_TAK对DataIn用Mode指定的算法进行MAC运算，将16字节的MAC结果输出到MacOut MAC运算密钥是主密钥/工作密钥体系或固定密钥体系密钥或DUKPT密钥体系。<a name="line.3943"></a>
<span class="sourceLineNo">3944</span>     *                  &lt;br/&gt;用法：<a name="line.3944"></a>
<span class="sourceLineNo">3945</span>     *                  &lt;br/&gt;1.敏感服务授权：在此接口内部，先进行认证以获取敏感服务授权，若授权失败则退出。<a name="line.3945"></a>
<span class="sourceLineNo">3946</span>     *                  &lt;br/&gt;2.补零规则：将报文数据分割成若干16个字节的BLOCK，最后一个BLOCK不满16个字节则后补0x00。&lt;/div&gt;<a name="line.3946"></a>
<span class="sourceLineNo">3947</span>     * &lt;div class="en"&gt;Use AES_TAK to perform MAC operation on dataIn with the algorithm specified by Mode, and output the 16-byte MAC result to MacOut.<a name="line.3947"></a>
<span class="sourceLineNo">3948</span>     * The MAC operation key is the master key/working key system or fixed key system key or DUKPT key system.<a name="line.3948"></a>
<span class="sourceLineNo">3949</span>     *                  &lt;br/&gt;usage:<a name="line.3949"></a>
<span class="sourceLineNo">3950</span>     *                  &lt;br/&gt;1.Sensitive service authorization: In this interface, first perform authentication to obtain sensitive service authorization,<a name="line.3950"></a>
<span class="sourceLineNo">3951</span>     *                  and exit if authorization fails.<a name="line.3951"></a>
<span class="sourceLineNo">3952</span>     *                  &lt;br/&gt;2.Zero-filling rule: divide the message data into 16-byte BLOCKs, and add 0x00 after the last BLOCK is less than 16 bytes.&lt;/div&gt;<a name="line.3952"></a>
<span class="sourceLineNo">3953</span>     *<a name="line.3953"></a>
<span class="sourceLineNo">3954</span>     * @param keyIdx &lt;div class="zh"&gt;AES_TAK 1~100索引&lt;/div&gt;<a name="line.3954"></a>
<span class="sourceLineNo">3955</span>     *                 &lt;div class="en"&gt;AES_TAK 1~100 index&lt;/div&gt;<a name="line.3955"></a>
<span class="sourceLineNo">3956</span>     * @param dataIn  &lt;div class="zh"&gt;需进行 MAC 运算的数据包. 长度InLen&lt;=2048，长度不能被16整除时，则自动补0x00&lt;/div&gt;<a name="line.3956"></a>
<span class="sourceLineNo">3957</span>     *                &lt;div class="en"&gt;Data packet that needs MAC operation. Length&lt;=2048, when the length is not divisible by 16, it will automatically add 0x00&lt;/div&gt;<a name="line.3957"></a>
<span class="sourceLineNo">3958</span>     * @param mode &lt;div class="zh"&gt;<a name="line.3958"></a>
<span class="sourceLineNo">3959</span>     *             &lt;ul&gt;<a name="line.3959"></a>
<span class="sourceLineNo">3960</span>     *             &lt;li&gt;0x00: 将BLOCK1用MAC密钥做AES加密，加密结果与BLOCK2进行逐位异或后再用MAC密钥做AES加密，依次进行得到16字节的加密结果， KSN不自动加1。&lt;/li&gt;<a name="line.3960"></a>
<span class="sourceLineNo">3961</span>     *             &lt;li&gt;0x01: Hypercom Fast Mode，将BLOCK1和BLOCK2进行逐位异或，异或结果与BLOCK3进行逐位异或，依次进行，最后得到16字节的异或结果，将该结果用MAC密钥进行AES加密运算，KSN不自动加1。&lt;/li&gt;<a name="line.3961"></a>
<span class="sourceLineNo">3962</span>     *             &lt;li&gt;0x03: CMAC算法，KSN不自动加1。&lt;/li&gt;<a name="line.3962"></a>
<span class="sourceLineNo">3963</span>     *             &lt;li&gt;0x05: HMAC-SHA256算法，KSN不自动加1。&lt;/li&gt;<a name="line.3963"></a>
<span class="sourceLineNo">3964</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3964"></a>
<span class="sourceLineNo">3965</span>     *             &lt;div class="en"&gt;<a name="line.3965"></a>
<span class="sourceLineNo">3966</span>     *             &lt;ul&gt;<a name="line.3966"></a>
<span class="sourceLineNo">3967</span>     *             &lt;li&gt;0x00: Use MAC key for AES encryption of BLOCK1, and perform bitwise XOR between the encrypted result and BLOCK2 and then use MAC key for AES encryption.<a name="line.3967"></a>
<span class="sourceLineNo">3968</span>     *             The 16-byte encryption result is obtained in sequence, and KSN does not automatically add 1.&lt;/li&gt;<a name="line.3968"></a>
<span class="sourceLineNo">3969</span>     *             &lt;li&gt;0x01: Hypercom Fast Mode, XOR BLOCK1 and BLOCK2 bit by bit, XOR result and BLOCK3 bit by bit XOR, in turn, finally get a 16-byte XOR result, the result is encrypted with MAC key AES Operation,<a name="line.3969"></a>
<span class="sourceLineNo">3970</span>     *             KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3970"></a>
<span class="sourceLineNo">3971</span>     *             &lt;li&gt;0x03: CMAC algorithm, KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3971"></a>
<span class="sourceLineNo">3972</span>     *             &lt;li&gt;0x05: HMAC-SHA256 algorithm, KSN does not automatically increase by 1.&lt;/li&gt;<a name="line.3972"></a>
<span class="sourceLineNo">3973</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3973"></a>
<span class="sourceLineNo">3974</span>     * @return &lt;div class="zh"&gt;MAC输出，模式5的时候是32字节输出，其他模式16字节输出&lt;/div&gt;<a name="line.3974"></a>
<span class="sourceLineNo">3975</span>     *         &lt;div class="en"&gt;MAC output, 32-byte output in mode 5, 16-byte output in other modes&lt;/div&gt;<a name="line.3975"></a>
<span class="sourceLineNo">3976</span>     * @throws PedDevException PedDevException<a name="line.3976"></a>
<span class="sourceLineNo">3977</span>     * @since V3.28.00<a name="line.3977"></a>
<span class="sourceLineNo">3978</span>     */<a name="line.3978"></a>
<span class="sourceLineNo">3979</span>    byte[] getMacAes(byte keyIdx, byte[] dataIn, byte mode) throws PedDevException;<a name="line.3979"></a>
<span class="sourceLineNo">3980</span><a name="line.3980"></a>
<span class="sourceLineNo">3981</span>    /**<a name="line.3981"></a>
<span class="sourceLineNo">3982</span>     * &lt;div class="zh"&gt;读取RKI信息。&lt;/div&gt;<a name="line.3982"></a>
<span class="sourceLineNo">3983</span>     * &lt;div class="en"&gt;Read RKI information.&lt;/div&gt;<a name="line.3983"></a>
<span class="sourceLineNo">3984</span>     *<a name="line.3984"></a>
<span class="sourceLineNo">3985</span>     * @param item &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.3985"></a>
<span class="sourceLineNo">3986</span>     *             &lt;li&gt;0x01:当前PED状态(出厂状态、激活状态，个人化状态)&lt;/li&gt;<a name="line.3986"></a>
<span class="sourceLineNo">3987</span>     *             &lt;li&gt;0x02:RKI KMS ID &lt;/li&gt;<a name="line.3987"></a>
<span class="sourceLineNo">3988</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3988"></a>
<span class="sourceLineNo">3989</span>     *             &lt;div class="en"&gt;&lt;ul&gt;<a name="line.3989"></a>
<span class="sourceLineNo">3990</span>     *             &lt;li&gt;0x01:Current PED state (factory state, activated state, personalized state)&lt;/li&gt;<a name="line.3990"></a>
<span class="sourceLineNo">3991</span>     *             &lt;li&gt;0x02:RKI KMS ID&lt;/li&gt;<a name="line.3991"></a>
<span class="sourceLineNo">3992</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3992"></a>
<span class="sourceLineNo">3993</span>     * @return &lt;div class="zh"&gt;当item是0x01时，返回数组的首位含义如下:<a name="line.3993"></a>
<span class="sourceLineNo">3994</span>     *              &lt;ul&gt;<a name="line.3994"></a>
<span class="sourceLineNo">3995</span>     *                  &lt;li&gt;0x00:出厂态&lt;/li&gt;<a name="line.3995"></a>
<span class="sourceLineNo">3996</span>     *                  &lt;li&gt;0x01:绑定态/激活态&lt;/li&gt;<a name="line.3996"></a>
<span class="sourceLineNo">3997</span>     *                  &lt;li&gt;0x02:个人化状态&lt;/li&gt;<a name="line.3997"></a>
<span class="sourceLineNo">3998</span>     *                  &lt;li&gt;0x03:绑定态&lt;/li&gt;<a name="line.3998"></a>
<span class="sourceLineNo">3999</span>     *              &lt;/ul&gt;&lt;/div&gt;<a name="line.3999"></a>
<span class="sourceLineNo">4000</span>     *         &lt;div class="en"&gt;When item is 0x01, the first bit of the returned array has the following meaning:<a name="line.4000"></a>
<span class="sourceLineNo">4001</span>     *              &lt;ul&gt;<a name="line.4001"></a>
<span class="sourceLineNo">4002</span>     *                  &lt;li&gt;0x00:Factory state&lt;/li&gt;<a name="line.4002"></a>
<span class="sourceLineNo">4003</span>     *                  &lt;li&gt;0x01:Bound state/active state&lt;/li&gt;<a name="line.4003"></a>
<span class="sourceLineNo">4004</span>     *                  &lt;li&gt;0x02:Personalized state&lt;/li&gt;<a name="line.4004"></a>
<span class="sourceLineNo">4005</span>     *                  &lt;li&gt;0x03:Bound state&lt;/li&gt;<a name="line.4005"></a>
<span class="sourceLineNo">4006</span>     *              &lt;/ul&gt;&lt;/div&gt;<a name="line.4006"></a>
<span class="sourceLineNo">4007</span>     * @throws PedDevException PedDevException<a name="line.4007"></a>
<span class="sourceLineNo">4008</span>     * @since V3.31.00<a name="line.4008"></a>
<span class="sourceLineNo">4009</span>     */<a name="line.4009"></a>
<span class="sourceLineNo">4010</span>    byte[] readRkiInfo(byte item) throws PedDevException;<a name="line.4010"></a>
<span class="sourceLineNo">4011</span><a name="line.4011"></a>
<span class="sourceLineNo">4012</span>    /**<a name="line.4012"></a>
<span class="sourceLineNo">4013</span>     * &lt;div class="zh"&gt;设置输PIN时是否静音。&lt;/div&gt;<a name="line.4013"></a>
<span class="sourceLineNo">4014</span>     * &lt;div class="en"&gt;Set whether to mute the PIN input.&lt;/div&gt;<a name="line.4014"></a>
<span class="sourceLineNo">4015</span>     *<a name="line.4015"></a>
<span class="sourceLineNo">4016</span>     * @param mute &lt;div class="zh"&gt;true: 静音 false：非静音。&lt;/div&gt;<a name="line.4016"></a>
<span class="sourceLineNo">4017</span>     *                   &lt;div class="en"&gt;true: muted false: unmuted..&lt;/div&gt;<a name="line.4017"></a>
<span class="sourceLineNo">4018</span>     * @throws PedDevException PedDevException<a name="line.4018"></a>
<span class="sourceLineNo">4019</span>     * @since V3.32.00<a name="line.4019"></a>
<span class="sourceLineNo">4020</span>     */<a name="line.4020"></a>
<span class="sourceLineNo">4021</span>    void setPinMute(boolean mute) throws PedDevException;<a name="line.4021"></a>
<span class="sourceLineNo">4022</span><a name="line.4022"></a>
<span class="sourceLineNo">4023</span><a name="line.4023"></a>
<span class="sourceLineNo">4024</span>    /**<a name="line.4024"></a>
<span class="sourceLineNo">4025</span>     * &lt;div class="zh"&gt;使用SecureData作为datain发散目的密钥。&lt;/div&gt;<a name="line.4025"></a>
<span class="sourceLineNo">4026</span>     * &lt;div class="en"&gt;Use SecureData as the datain diverges the destination key.&lt;/div&gt;<a name="line.4026"></a>
<span class="sourceLineNo">4027</span>     *<a name="line.4027"></a>
<span class="sourceLineNo">4028</span>     * @param srcKeyType &lt;div&gt;source key type, DerivationMode 0: must be TMK(0x02).&lt;/div&gt;<a name="line.4028"></a>
<span class="sourceLineNo">4029</span>     * @param srcKeyIdx &lt;div&gt;source key index, 1-100 in TMK area.&lt;/div&gt;<a name="line.4029"></a>
<span class="sourceLineNo">4030</span>     * @param dstKeyType &lt;div&gt;destination key type, DerivationMode 0: must be TMK(0x02).&lt;/div&gt;<a name="line.4030"></a>
<span class="sourceLineNo">4031</span>     * @param dstKeyIdx &lt;div&gt;destination key, 1-100 in TMK area.&lt;/div&gt;<a name="line.4031"></a>
<span class="sourceLineNo">4032</span>     * @param secureDataIndex &lt;div&gt; SecureData Index, 1-100 in working key area &lt;/div&gt;<a name="line.4032"></a>
<span class="sourceLineNo">4033</span>     * @param additionalDataIn &lt;div&gt;64 bytes Additional Data. DerivationMode 0: if not used, can be null. &lt;/div&gt;<a name="line.4033"></a>
<span class="sourceLineNo">4034</span>     * @param derivationMode &lt;div&gt;only support 0, GOWF algorithm &lt;/div&gt;<a name="line.4034"></a>
<span class="sourceLineNo">4035</span>     *<a name="line.4035"></a>
<span class="sourceLineNo">4036</span>     * @throws PedDevException PedDevException<a name="line.4036"></a>
<span class="sourceLineNo">4037</span>     * @since V3.33.00<a name="line.4037"></a>
<span class="sourceLineNo">4038</span>     */<a name="line.4038"></a>
<span class="sourceLineNo">4039</span>    void deriveKeyBySecureData(byte srcKeyType, byte srcKeyIdx, byte dstKeyType, byte dstKeyIdx, byte secureDataIndex,<a name="line.4039"></a>
<span class="sourceLineNo">4040</span>                               byte[] additionalDataIn, byte derivationMode) throws PedDevException;<a name="line.4040"></a>
<span class="sourceLineNo">4041</span><a name="line.4041"></a>
<span class="sourceLineNo">4042</span>    /**<a name="line.4042"></a>
<span class="sourceLineNo">4043</span>     * &lt;div class="zh"&gt;写入Stack UKPT Key。&lt;/div&gt;<a name="line.4043"></a>
<span class="sourceLineNo">4044</span>     * &lt;div class="en"&gt;Write Stack UKPT Key.&lt;/div&gt;<a name="line.4044"></a>
<span class="sourceLineNo">4045</span>     *<a name="line.4045"></a>
<span class="sourceLineNo">4046</span>     * @param groupIdx &lt;div class="zh"&gt;[1~10] 密钥组索引号 &lt;/div&gt;<a name="line.4046"></a>
<span class="sourceLineNo">4047</span>     *             &lt;div class="en"&gt;[1~10] Key group index&lt;/div&gt;<a name="line.4047"></a>
<span class="sourceLineNo">4048</span>     * @param tscIdentifier &lt;div class="zh"&gt;TSC标识 &lt;/div&gt; &lt;div class="en"&gt;TSC Identifier&lt;/div&gt;<a name="line.4048"></a>
<span class="sourceLineNo">4049</span>     * @param tscSeedKey &lt;div class="zh"&gt;TSC种子密钥&lt;/div&gt; &lt;div class="en"&gt;TSC seed key&lt;/div&gt;<a name="line.4049"></a>
<span class="sourceLineNo">4050</span>     * @param tscSeedKeyDepth &lt;div class="zh"&gt;TSC种子密钥深度&lt;/div&gt; &lt;div class="en"&gt;TSC seed key depth&lt;/div&gt;<a name="line.4050"></a>
<span class="sourceLineNo">4051</span>     * @param mode &lt;div class="zh"&gt;目前只支持0&lt;/div&gt; &lt;div class="en"&gt;Currently only supports 0&lt;/div&gt;<a name="line.4051"></a>
<span class="sourceLineNo">4052</span>     * @throws PedDevException PedDevException<a name="line.4052"></a>
<span class="sourceLineNo">4053</span>     * @since V3.32.00<a name="line.4053"></a>
<span class="sourceLineNo">4054</span>     */<a name="line.4054"></a>
<span class="sourceLineNo">4055</span>    void writeStackUKPTKey(byte groupIdx, byte[] tscIdentifier, byte[] tscSeedKey, byte tscSeedKeyDepth, byte mode) throws PedDevException;<a name="line.4055"></a>
<span class="sourceLineNo">4056</span><a name="line.4056"></a>
<span class="sourceLineNo">4057</span>    /**<a name="line.4057"></a>
<span class="sourceLineNo">4058</span>     * &lt;div class="zh"&gt;Stack UKPT Key演算。&lt;/div&gt;<a name="line.4058"></a>
<span class="sourceLineNo">4059</span>     * &lt;div class="en"&gt;Stack UKPT Key evolution.&lt;/div&gt;<a name="line.4059"></a>
<span class="sourceLineNo">4060</span>     *<a name="line.4060"></a>
<span class="sourceLineNo">4061</span>     * @param groupIdx &lt;div class="zh"&gt;[1~10] 密钥组索引号 &lt;/div&gt;<a name="line.4061"></a>
<span class="sourceLineNo">4062</span>     *             &lt;div class="en"&gt;[1~10] Key group index&lt;/div&gt;<a name="line.4062"></a>
<span class="sourceLineNo">4063</span>     * @throws PedDevException PedDevException<a name="line.4063"></a>
<span class="sourceLineNo">4064</span>     * @since V3.32.00<a name="line.4064"></a>
<span class="sourceLineNo">4065</span>     */<a name="line.4065"></a>
<span class="sourceLineNo">4066</span>    void evolveStackUKPT(byte groupIdx) throws PedDevException;<a name="line.4066"></a>
<span class="sourceLineNo">4067</span><a name="line.4067"></a>
<span class="sourceLineNo">4068</span>    /**<a name="line.4068"></a>
<span class="sourceLineNo">4069</span>     * &lt;div class="zh"&gt;获取Stack UKPT Key信息。&lt;/div&gt;<a name="line.4069"></a>
<span class="sourceLineNo">4070</span>     * &lt;div class="en"&gt;Get Stack UKPT Key information.&lt;/div&gt;<a name="line.4070"></a>
<span class="sourceLineNo">4071</span>     *<a name="line.4071"></a>
<span class="sourceLineNo">4072</span>     * @param groupIdx &lt;div class="zh"&gt;[1~10] 密钥组索引号 &lt;/div&gt;<a name="line.4072"></a>
<span class="sourceLineNo">4073</span>     *             &lt;div class="en"&gt;[1~10] Key group index&lt;/div&gt;<a name="line.4073"></a>
<span class="sourceLineNo">4074</span>     * @param mode &lt;div class="zh"&gt;目前只支持0&lt;/div&gt;&lt;div class="en"&gt;Currently only supports 0&lt;/div&gt;<a name="line.4074"></a>
<span class="sourceLineNo">4075</span>     * @return &lt;div class="zh"&gt; Stack UKPT Key信息， TSC Identifier(6 bytes) + Key Evolution Identifier(5 bytes) &lt;/div&gt;<a name="line.4075"></a>
<span class="sourceLineNo">4076</span>     *         &lt;div class="en"&gt;Stack UKPT Key information, TSC Identifier(6 bytes) + Key Evolution Identifier(5 bytes)&lt;/div&gt;<a name="line.4076"></a>
<span class="sourceLineNo">4077</span>     * @throws PedDevException PedDevException<a name="line.4077"></a>
<span class="sourceLineNo">4078</span>     * @since V3.32.00<a name="line.4078"></a>
<span class="sourceLineNo">4079</span>     */<a name="line.4079"></a>
<span class="sourceLineNo">4080</span>    byte[] getInfoStackUKPT(byte groupIdx, byte mode) throws PedDevException;<a name="line.4080"></a>
<span class="sourceLineNo">4081</span><a name="line.4081"></a>
<span class="sourceLineNo">4082</span>    /**<a name="line.4082"></a>
<span class="sourceLineNo">4083</span>     * &lt;div class="zh"&gt;使用Stack UKPT Key进行MAC加密运算。&lt;/div&gt;<a name="line.4083"></a>
<span class="sourceLineNo">4084</span>     * &lt;div class="en"&gt;Use Stack UKPT Key for MAC encryption operation.&lt;/div&gt;<a name="line.4084"></a>
<span class="sourceLineNo">4085</span>     *<a name="line.4085"></a>
<span class="sourceLineNo">4086</span>     * @param groupIdx &lt;div class="zh"&gt;[1~10] 密钥组索引号 &lt;/div&gt;<a name="line.4086"></a>
<span class="sourceLineNo">4087</span>     *             &lt;div class="en"&gt;[1~10] Key group index&lt;/div&gt;<a name="line.4087"></a>
<span class="sourceLineNo">4088</span>     * @param keyVarType &lt;div class="zh"&gt;MAC运算的密钥类型 &lt;/div&gt;&lt;div class="en"&gt;Key type for MAC&lt;/div&gt;<a name="line.4088"></a>
<span class="sourceLineNo">4089</span>     * @param data &lt;div class="zh"&gt; 需进行 MAC 运算的数据包&lt;/div&gt; &lt;div class="en"&gt;Data packet that needs MAC operation&lt;/div&gt;<a name="line.4089"></a>
<span class="sourceLineNo">4090</span>     * @param mode &lt;div class="zh"&gt; &lt;ul&gt;<a name="line.4090"></a>
<span class="sourceLineNo">4091</span>     *             &lt;li&gt;0x00: 将BLOCK1用MAC密钥做DES/TDES加密,加密结果与BLOCK2进行逐位异或后再用TAK做DES/TDES加密, 依次进行得到8字节的加密结果. &lt;/li&gt;<a name="line.4091"></a>
<span class="sourceLineNo">4092</span>     *             &lt;li&gt;0x01: 将BLOCK1和BLOCK2进行逐位异或,异或结果与BLOCK3进行逐位异或,依次进行,最后得到8字节的异或结果, 将该结果用TAK进行DES/TDES加密运算. &lt;/li&gt;<a name="line.4092"></a>
<span class="sourceLineNo">4093</span>     *             &lt;li&gt;0x02: ANSIX9.19规范,将BLOCK1用TAK做DES加密(只取前8个字节的key), 加密结果与BLOCK2进行逐位异或后再用TAK做DES加密,依次进行得到8字节的加密结果,直到最后一次采用DES/TDES加密.&lt;/li&gt;<a name="line.4093"></a>
<span class="sourceLineNo">4094</span>     *             &lt;li&gt;0x03: CMAC算法&lt;/li&gt;<a name="line.4094"></a>
<span class="sourceLineNo">4095</span>     *             &lt;li&gt;0x05: hmac-sha256模式&lt;/li&gt;<a name="line.4095"></a>
<span class="sourceLineNo">4096</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.4096"></a>
<span class="sourceLineNo">4097</span>     *             &lt;div class="en"&gt;&lt;ul&gt;<a name="line.4097"></a>
<span class="sourceLineNo">4098</span>     *             &lt;li&gt;0x00: Encrypt BLOCK1 with MAC key for DES/TDES, perform bit-by-bit XOR with BLOCK2, and then perform DES/TDES encryption with TAK,<a name="line.4098"></a>
<span class="sourceLineNo">4099</span>     *             and proceed in turn to obtain an 8-byte encryption result. &lt;/li&gt;<a name="line.4099"></a>
<span class="sourceLineNo">4100</span>     *             &lt;li&gt;0x01: The BLOCK1 and BLOCK2 are XOR bit by bit, the XOR result is XOR bit by bit with BLOCK3, and the sequence is performed in turn,<a name="line.4100"></a>
<span class="sourceLineNo">4101</span>     *             and finally an 8-byte XOR result is obtained, and the result is encrypted by DES/TDES with TAK. &lt;/li&gt;<a name="line.4101"></a>
<span class="sourceLineNo">4102</span>     *             &lt;li&gt;0x02: According to the ANSIX9.19 specification, BLOCK1 is encrypted with TAK for DES (only the key of the first 8 bytes is taken),<a name="line.4102"></a>
<span class="sourceLineNo">4103</span>     *             the encryption result is XOR bit by bit with BLOCK2, and then TAK is used for DES encryption, and the encryption result of 8 bytes is obtained in turn,<a name="line.4103"></a>
<span class="sourceLineNo">4104</span>     *             until the last DES/TDES encryption.&lt;/li&gt;<a name="line.4104"></a>
<span class="sourceLineNo">4105</span>     *             &lt;li&gt;0x03: CMAC algorithm&lt;/li&gt;<a name="line.4105"></a>
<span class="sourceLineNo">4106</span>     *             &lt;li&gt;0x05: hmac-sha256 mode&lt;/li&gt;<a name="line.4106"></a>
<span class="sourceLineNo">4107</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.4107"></a>
<span class="sourceLineNo">4108</span>     * @return &lt;div class="zh"&gt; MAC输出(0x05模式为32字节，其他为8字节)。  &lt;/div&gt;<a name="line.4108"></a>
<span class="sourceLineNo">4109</span>     *         &lt;div class="en"&gt;MAC output (32 bytes for 0x05 mode, 8 bytes for others).&lt;/div&gt;<a name="line.4109"></a>
<span class="sourceLineNo">4110</span>     * @throws PedDevException PedDevException<a name="line.4110"></a>
<span class="sourceLineNo">4111</span>     * @since V3.32.00<a name="line.4111"></a>
<span class="sourceLineNo">4112</span>     */<a name="line.4112"></a>
<span class="sourceLineNo">4113</span>    byte[] getMacStackUKPT(byte groupIdx, byte keyVarType, byte[] data, byte mode) throws PedDevException;<a name="line.4113"></a>
<span class="sourceLineNo">4114</span><a name="line.4114"></a>
<span class="sourceLineNo">4115</span>    /**<a name="line.4115"></a>
<span class="sourceLineNo">4116</span>     * &lt;div class="zh"&gt;扫描键盘上输入的PIN并输出由 Mode指定算法加密的 PIN BLOCK，用于Stack UKPT Key。&lt;/div&gt;<a name="line.4116"></a>
<span class="sourceLineNo">4117</span>     * &lt;div class="en"&gt;Scan the PIN entered on the keyboard and output the PIN BLOCK encrypted by the algorithm specified by Mode for Stack UKPT Key.&lt;/div&gt;<a name="line.4117"></a>
<span class="sourceLineNo">4118</span>     *<a name="line.4118"></a>
<span class="sourceLineNo">4119</span>     * @param groupIdx &lt;div class="zh"&gt;[1~10] 密钥组索引号 &lt;/div&gt;<a name="line.4119"></a>
<span class="sourceLineNo">4120</span>     *             &lt;div class="en"&gt;[1~10] Key group index&lt;/div&gt;<a name="line.4120"></a>
<span class="sourceLineNo">4121</span>     * @param expPinLen &lt;div class="zh"&gt; 0~12 的枚举集合&lt;br/&gt;<a name="line.4121"></a>
<span class="sourceLineNo">4122</span>     *                  可输入的合法密码长度字符串,应用程序把允许的密码长度全部枚举出来,并且用“，”号隔开每个长度,密码长度的有效取值为：0，4~12。&lt;br/&gt;<a name="line.4122"></a>
<span class="sourceLineNo">4123</span>     *                  如允许输入 4、 6 位密码并且允许无密码直接按确认,则该字符串应该设置为“0,4,6”。 &lt;br/&gt;<a name="line.4123"></a>
<span class="sourceLineNo">4124</span>     *                  若枚举 0 长度则示意可以不输任何数字而直接按确认键返回。&lt;br/&gt;<a name="line.4124"></a>
<span class="sourceLineNo">4125</span>     *                  若枚举长度存在无效值，则忽略无效值。若输入长度超过设置长度，则忽略超出的输入。&lt;/div&gt;<a name="line.4125"></a>
<span class="sourceLineNo">4126</span>     *                  &lt;div class="en"&gt;An enumeration set of 0~12&lt;br/&gt;<a name="line.4126"></a>
<span class="sourceLineNo">4127</span>     *                  The legal password length string that can be entered. The application program enumerates all the allowed password lengths, and separates each length with ",".<a name="line.4127"></a>
<span class="sourceLineNo">4128</span>     *                  The valid values of the password length are: 0, 4~12.&lt;br/&gt;<a name="line.4128"></a>
<span class="sourceLineNo">4129</span>     *                  For example, 4 or 6-digit passwords are allowed to be entered and no password is allowed to be pressed directly, then the string should be set to "0,4,6".&lt;br/&gt;<a name="line.4129"></a>
<span class="sourceLineNo">4130</span>     *                  If the length of the enumeration is 0, it means that you can directly press the OK key to return without entering any number.&lt;br/&gt;<a name="line.4130"></a>
<span class="sourceLineNo">4131</span>     *                  If an invalid value exists for the enumeration length, the invalid value is ignored. If the input length exceeds the set length, the exceeding input is ignored.<a name="line.4131"></a>
<span class="sourceLineNo">4132</span>     *                  &lt;/div&gt;<a name="line.4132"></a>
<span class="sourceLineNo">4133</span>     * @param data &lt;div class="zh"&gt;<a name="line.4133"></a>
<span class="sourceLineNo">4134</span>     * &lt;ul&gt;<a name="line.4134"></a>
<span class="sourceLineNo">4135</span>     *  &lt;li&gt;当mode=0x00时，dataIn指向卡号移位后生成的16位主帐号。&lt;/li&gt;<a name="line.4135"></a>
<span class="sourceLineNo">4136</span>     *  &lt;li&gt;当mode=0x01时，参考 ISO9564规范。 &lt;/li&gt;<a name="line.4136"></a>
<span class="sourceLineNo">4137</span>     *  &lt;li&gt;当mode=0x02时，参考 ISO9564规范。&lt;/li&gt;<a name="line.4137"></a>
<span class="sourceLineNo">4138</span>     *  &lt;li&gt;当mode=0x03时，为交易流水号ISN [6 Bytes,ASCII码]。&lt;/li&gt;<a name="line.4138"></a>
<span class="sourceLineNo">4139</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.4139"></a>
<span class="sourceLineNo">4140</span>     * &lt;div class="en"&gt;<a name="line.4140"></a>
<span class="sourceLineNo">4141</span>     * &lt;ul&gt;<a name="line.4141"></a>
<span class="sourceLineNo">4142</span>     *  &lt;li&gt;When mode=0x00, dataIn points to the 16-bit primary account generated after the card number shift.&lt;/li&gt;<a name="line.4142"></a>
<span class="sourceLineNo">4143</span>     *  &lt;li&gt;When mode=0x01, Refer to ISO9564 specification.&lt;/li&gt;<a name="line.4143"></a>
<span class="sourceLineNo">4144</span>     *  &lt;li&gt;When mode=0x02, Refer to ISO9564 specification.&lt;/li&gt;<a name="line.4144"></a>
<span class="sourceLineNo">4145</span>     *  &lt;li&gt;When mode=0x03, is the transaction current number [6 Bytes,ASCII code].&lt;/li&gt;<a name="line.4145"></a>
<span class="sourceLineNo">4146</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.4146"></a>
<span class="sourceLineNo">4147</span>     * @param mode &lt;div class="zh"&gt; PIN BLOCK的格式。<a name="line.4147"></a>
<span class="sourceLineNo">4148</span>     * &lt;ul&gt;<a name="line.4148"></a>
<span class="sourceLineNo">4149</span>     *  &lt;li&gt;0x00:ISO9564 格式0。&lt;/li&gt;<a name="line.4149"></a>
<span class="sourceLineNo">4150</span>     *  &lt;li&gt;0x01:ISO9564 格式1。&lt;/li&gt;<a name="line.4150"></a>
<span class="sourceLineNo">4151</span>     *  &lt;li&gt;0x02:ISO9564 格式3。&lt;/li&gt;<a name="line.4151"></a>
<span class="sourceLineNo">4152</span>     *  &lt;li&gt;0x03:HK EPS 格式。&lt;/li&gt;<a name="line.4152"></a>
<span class="sourceLineNo">4153</span>     * &lt;/ul&gt;&lt;/div&gt;<a name="line.4153"></a>
<span class="sourceLineNo">4154</span>     * &lt;div class="en"&gt; PIN BLOCK Format.<a name="line.4154"></a>
<span class="sourceLineNo">4155</span>     *  &lt;ul&gt;<a name="line.4155"></a>
<span class="sourceLineNo">4156</span>     *   &lt;li&gt;0x00:ISO9564 format 0.&lt;/li&gt;<a name="line.4156"></a>
<span class="sourceLineNo">4157</span>     *   &lt;li&gt;0x01:ISO9564 format 1.&lt;/li&gt;<a name="line.4157"></a>
<span class="sourceLineNo">4158</span>     *   &lt;li&gt;0x02:ISO9564 format 3.&lt;/li&gt;<a name="line.4158"></a>
<span class="sourceLineNo">4159</span>     *   &lt;li&gt;0x03:HK EPS format.&lt;/li&gt;<a name="line.4159"></a>
<span class="sourceLineNo">4160</span>     *  &lt;/ul&gt;&lt;/div&gt;<a name="line.4160"></a>
<span class="sourceLineNo">4161</span>     * @param timeoutMs &lt;div class="zh"&gt;输入 PIN 的超时时间,单位：毫秒 最大值为 300000ms &lt;/div&gt;<a name="line.4161"></a>
<span class="sourceLineNo">4162</span>     *                  &lt;div class="en"&gt;Timeout time for entering PIN, unit: milliseconds, the maximum value is 300000ms&lt;/div&gt;<a name="line.4162"></a>
<span class="sourceLineNo">4163</span>     *<a name="line.4163"></a>
<span class="sourceLineNo">4164</span>     * @return &lt;div class="zh"&gt;8字节的PinBlock。&lt;/div&gt; &lt;div class="en"&gt;8-byte PinBlock.&lt;/div&gt;<a name="line.4164"></a>
<span class="sourceLineNo">4165</span>     *<a name="line.4165"></a>
<span class="sourceLineNo">4166</span>     * @throws PedDevException<a name="line.4166"></a>
<span class="sourceLineNo">4167</span>     * @since V3.32.00<a name="line.4167"></a>
<span class="sourceLineNo">4168</span>     */<a name="line.4168"></a>
<span class="sourceLineNo">4169</span>    byte[] getPinBlockStackUKPT(byte groupIdx, String expPinLen, byte[] data, byte mode, int timeoutMs) throws PedDevException;<a name="line.4169"></a>
<span class="sourceLineNo">4170</span><a name="line.4170"></a>
<span class="sourceLineNo">4171</span>    /**<a name="line.4171"></a>
<span class="sourceLineNo">4172</span>     * &lt;div class="zh"&gt;使用Stack UKPT Key进行数据加解密。&lt;/div&gt;<a name="line.4172"></a>
<span class="sourceLineNo">4173</span>     * &lt;div class="en"&gt;Use Stack UKPT Key to encrypt and decrypt data.&lt;/div&gt;<a name="line.4173"></a>
<span class="sourceLineNo">4174</span>     *<a name="line.4174"></a>
<span class="sourceLineNo">4175</span>     * @param groupIdx &lt;div class="zh"&gt;[1~10] 密钥组索引号 &lt;/div&gt;<a name="line.4175"></a>
<span class="sourceLineNo">4176</span>     *             &lt;div class="en"&gt;[1~10] Key group index&lt;/div&gt;<a name="line.4176"></a>
<span class="sourceLineNo">4177</span>     * @param keyVarType &lt;div class="zh"&gt;密钥类型,必须为解密/加密类型密钥,且加解密时需使用对应Mode参数。<a name="line.4177"></a>
<span class="sourceLineNo">4178</span>     *                   &lt;/div&gt;&lt;div class="en"&gt;Key type. It must be a decryption/encryption type key, and the corresponding Mode parameter must be used.&lt;/div&gt;<a name="line.4178"></a>
<span class="sourceLineNo">4179</span>     * @param iv &lt;div class="zh"&gt;向量,CBC模式下使用,长度为8字节,若为NULL则用0填充&lt;/div&gt;<a name="line.4179"></a>
<span class="sourceLineNo">4180</span>     *           &lt;div class="en"&gt;Vector, used in CBC mode, the length is 8 bytes, if it is NULL, it will be padded with 0&lt;/div&gt;<a name="line.4180"></a>
<span class="sourceLineNo">4181</span>     * @param data &lt;div class="zh"&gt; 用于运算的数据.输入长度最大支持2048并且能被8整除。 &lt;/div&gt;<a name="line.4181"></a>
<span class="sourceLineNo">4182</span>     *             &lt;div class="en"&gt;The data used for the operation. The input length supports a maximum of 2048 and is divisible by 8.&lt;/div&gt;<a name="line.4182"></a>
<span class="sourceLineNo">4183</span>     * @param mode &lt;div class="zh"&gt; &lt;ul&gt;<a name="line.4183"></a>
<span class="sourceLineNo">4184</span>     *             &lt;li&gt;ECB解密 0x00  &lt;/li&gt;<a name="line.4184"></a>
<span class="sourceLineNo">4185</span>     *             &lt;li&gt;ECB加密 0x01  &lt;/li&gt;<a name="line.4185"></a>
<span class="sourceLineNo">4186</span>     *             &lt;li&gt;CBC解密 0x02 &lt;/li&gt;<a name="line.4186"></a>
<span class="sourceLineNo">4187</span>     *             &lt;li&gt;CBC加密 0x03 &lt;/li&gt;<a name="line.4187"></a>
<span class="sourceLineNo">4188</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.4188"></a>
<span class="sourceLineNo">4189</span>     *             &lt;div class="en"&gt;&lt;ul&gt;<a name="line.4189"></a>
<span class="sourceLineNo">4190</span>     *             &lt;li&gt; ECB decryption 0x00&lt;/li&gt;<a name="line.4190"></a>
<span class="sourceLineNo">4191</span>     *             &lt;li&gt; ECB encryption 0x01&lt;/li&gt;<a name="line.4191"></a>
<span class="sourceLineNo">4192</span>     *             &lt;li&gt; CBC decryption 0x02&lt;/li&gt;<a name="line.4192"></a>
<span class="sourceLineNo">4193</span>     *             &lt;li&gt; CBC encryption 0x03&lt;/li&gt;<a name="line.4193"></a>
<span class="sourceLineNo">4194</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.4194"></a>
<span class="sourceLineNo">4195</span>     * @return &lt;div class="zh"&gt; 运算的结果。 &lt;/div&gt;<a name="line.4195"></a>
<span class="sourceLineNo">4196</span>     *         &lt;div class="en"&gt;the result of the operation.&lt;/div&gt;<a name="line.4196"></a>
<span class="sourceLineNo">4197</span>     * @throws PedDevException PedDevException<a name="line.4197"></a>
<span class="sourceLineNo">4198</span>     * @since V3.32.00<a name="line.4198"></a>
<span class="sourceLineNo">4199</span>     */<a name="line.4199"></a>
<span class="sourceLineNo">4200</span>    byte[] calcStackUKPT(byte groupIdx, byte keyVarType, byte[] iv, byte[] data, byte mode) throws PedDevException;<a name="line.4200"></a>
<span class="sourceLineNo">4201</span><a name="line.4201"></a>
<span class="sourceLineNo">4202</span>    /**<a name="line.4202"></a>
<span class="sourceLineNo">4203</span>     * &lt;div class="zh"&gt;设置脱机PIN模式，并为外部PINPAD提供一些参数。&lt;/div&gt;<a name="line.4203"></a>
<span class="sourceLineNo">4204</span>     * &lt;div class="en"&gt;Set offline PIN mode and provide some parameters for external PINPAD.&lt;/div&gt;<a name="line.4204"></a>
<span class="sourceLineNo">4205</span>     *<a name="line.4205"></a>
<span class="sourceLineNo">4206</span>     * @param mode &lt;div class="zh"&gt;<a name="line.4206"></a>
<span class="sourceLineNo">4207</span>     *  &lt;ul&gt;<a name="line.4207"></a>
<span class="sourceLineNo">4208</span>     *   &lt;li&gt;0x00:内部PINPAD，默认模式。&lt;/li&gt;<a name="line.4208"></a>
<span class="sourceLineNo">4209</span>     *   &lt;li&gt;0x01:外部PINPAD。&lt;/li&gt;<a name="line.4209"></a>
<span class="sourceLineNo">4210</span>     *  &lt;/ul&gt;<a name="line.4210"></a>
<span class="sourceLineNo">4211</span>     * &lt;/div&gt;<a name="line.4211"></a>
<span class="sourceLineNo">4212</span>     * &lt;div class="en"&gt;<a name="line.4212"></a>
<span class="sourceLineNo">4213</span>     *  &lt;ul&gt;<a name="line.4213"></a>
<span class="sourceLineNo">4214</span>     *   &lt;li&gt;0x00:Built-in PINPAD, default mode.&lt;/li&gt;<a name="line.4214"></a>
<span class="sourceLineNo">4215</span>     *   &lt;li&gt;0x01:External PINPAD.&lt;/li&gt;<a name="line.4215"></a>
<span class="sourceLineNo">4216</span>     *  &lt;/ul&gt;<a name="line.4216"></a>
<span class="sourceLineNo">4217</span>     * &lt;/div&gt;<a name="line.4217"></a>
<span class="sourceLineNo">4218</span>     *<a name="line.4218"></a>
<span class="sourceLineNo">4219</span>     * @param tpkIndex &lt;div class="zh"&gt;TPK秘钥索引。 &lt;/div&gt; &lt;div class="en"&gt;The index of TPK.&lt;/div&gt;<a name="line.4219"></a>
<span class="sourceLineNo">4220</span>     *<a name="line.4220"></a>
<span class="sourceLineNo">4221</span>     * @param pinBlock &lt;div class="zh"&gt;8字节ISO9564格式1的加密 PINBLOCK。&lt;/div&gt; &lt;div class="en"&gt;8-byte Cipher PINBLOCK with ISO9564 Format 1.&lt;/div&gt;<a name="line.4221"></a>
<span class="sourceLineNo">4222</span>     *<a name="line.4222"></a>
<span class="sourceLineNo">4223</span>     * @throws PedDevException<a name="line.4223"></a>
<span class="sourceLineNo">4224</span>     * @since V3.33.00<a name="line.4224"></a>
<span class="sourceLineNo">4225</span>     */<a name="line.4225"></a>
<span class="sourceLineNo">4226</span>    void setOfflinePinMode(byte mode, byte tpkIndex, byte[] pinBlock) throws PedDevException;<a name="line.4226"></a>
<span class="sourceLineNo">4227</span><a name="line.4227"></a>
<span class="sourceLineNo">4228</span>    /**<a name="line.4228"></a>
<span class="sourceLineNo">4229</span>     * &lt;div class="zh"&gt; 指定的时限内，扫描键盘上输入的PIN并输出PIN BLOCK加密数据块。仅支持{@link EPedType#EXTERNAL_TYPEA} 类型。 &lt;/div&gt;<a name="line.4229"></a>
<span class="sourceLineNo">4230</span>     * &lt;div class="en"&gt; Scan the keyboard PIN entry and output the PIN BLOCK encrypted data block in a specific time.{@link EPedType#EXTERNAL_TYPEA} is supported. &lt;/div&gt;<a name="line.4230"></a>
<span class="sourceLineNo">4231</span>     *<a name="line.4231"></a>
<span class="sourceLineNo">4232</span>     *<a name="line.4232"></a>
<span class="sourceLineNo">4233</span>     * @param keyIndex<a name="line.4233"></a>
<span class="sourceLineNo">4234</span>     *            &lt;div class="zh"&gt; [1~100] TPK的索引 &lt;/div&gt; &lt;div class="en"&gt; [1~100] TPK index &lt;/div&gt;<a name="line.4234"></a>
<span class="sourceLineNo">4235</span>     *<a name="line.4235"></a>
<span class="sourceLineNo">4236</span>     * @param keyLen &lt;div class="zh"&gt;8、16 或 24，指示 PINBLOCK 是用 DES/TDES 加密&lt;/div&gt;<a name="line.4236"></a>
<span class="sourceLineNo">4237</span>     *               &lt;div class="en"&gt;8, 16, or 24, indicating that PINBLOCK is encrypted with DES/TDES&lt;/div&gt;<a name="line.4237"></a>
<span class="sourceLineNo">4238</span>     *<a name="line.4238"></a>
<span class="sourceLineNo">4239</span>     * @param mode &lt;div class="zh"&gt;PIN Block的格式。<a name="line.4239"></a>
<span class="sourceLineNo">4240</span>     *               &lt;ul&gt;<a name="line.4240"></a>
<span class="sourceLineNo">4241</span>     *                &lt;li&gt;0x00:ISO9564 格式 0&lt;/li&gt;<a name="line.4241"></a>
<span class="sourceLineNo">4242</span>     *                &lt;li&gt;0x01:ISO9564 格式 1&lt;/li&gt;<a name="line.4242"></a>
<span class="sourceLineNo">4243</span>     *                &lt;li&gt;0x02:ISO9564 格式 3&lt;/li&gt;<a name="line.4243"></a>
<span class="sourceLineNo">4244</span>     *                &lt;li&gt;0x03:HK EPS 专用格式&lt;/li&gt;<a name="line.4244"></a>
<span class="sourceLineNo">4245</span>     *               &lt;/ul&gt;<a name="line.4245"></a>
<span class="sourceLineNo">4246</span>     *              &lt;/div&gt;<a name="line.4246"></a>
<span class="sourceLineNo">4247</span>     *              &lt;div class="en"&gt; PIN Block format.<a name="line.4247"></a>
<span class="sourceLineNo">4248</span>     *               &lt;ul&gt;<a name="line.4248"></a>
<span class="sourceLineNo">4249</span>     *                &lt;li&gt;0x00:ISO9564 format 0&lt;/li&gt;<a name="line.4249"></a>
<span class="sourceLineNo">4250</span>     *                &lt;li&gt;0x01:ISO9564 format 1&lt;/li&gt;<a name="line.4250"></a>
<span class="sourceLineNo">4251</span>     *                &lt;li&gt;0x02:ISO9564 format 3&lt;/li&gt;<a name="line.4251"></a>
<span class="sourceLineNo">4252</span>     *                &lt;li&gt;0x03:HK EPS -EPS PINBLOCK Format&lt;/li&gt;<a name="line.4252"></a>
<span class="sourceLineNo">4253</span>     *               &lt;/ul&gt;<a name="line.4253"></a>
<span class="sourceLineNo">4254</span>     *              &lt;/div&gt;<a name="line.4254"></a>
<span class="sourceLineNo">4255</span>     *<a name="line.4255"></a>
<span class="sourceLineNo">4256</span>     * @param inputMode &lt;div class="zh"&gt;0x01：只输入一次，0x02：输入两次密码，两次输入一致后返回 PINBLOCK&lt;/div&gt;<a name="line.4256"></a>
<span class="sourceLineNo">4257</span>     *                  &lt;div class="en"&gt;0x01: Enter the password only once, 0x02: Enter the password twice, and return PINBLOCK if the two inputs are the same&lt;/div&gt;<a name="line.4257"></a>
<span class="sourceLineNo">4258</span>     *<a name="line.4258"></a>
<span class="sourceLineNo">4259</span>     * @param inputMin &lt;div class="zh"&gt;允许输入的 PIN 的最小长度(大于等于 0, 为 0 时，按 ENTER 键返回，且输入 长度 Len=0，此时应答数据长度为 0，表示用户没有输入密码)。&lt;/div&gt;<a name="line.4259"></a>
<span class="sourceLineNo">4260</span>     *            &lt;div class="en"&gt;The minimum length of the allowed PIN (when greater than or equal to 0, when it is 0, press the ENTER key to return, and enter the length Len=0, at this time the response data length is 0, which means that the user did not enter a password).&lt;/div&gt;<a name="line.4260"></a>
<span class="sourceLineNo">4261</span>     *<a name="line.4261"></a>
<span class="sourceLineNo">4262</span>     * @param inputMax &lt;div class="zh"&gt;允许输入的 PIN 的最大长度(小于等于 14)。&lt;/div&gt;<a name="line.4262"></a>
<span class="sourceLineNo">4263</span>     *            &lt;div class="en"&gt;The maximum length of the PIN that can be entered (less than or equal to 14).&lt;/div&gt;<a name="line.4263"></a>
<span class="sourceLineNo">4264</span>     *<a name="line.4264"></a>
<span class="sourceLineNo">4265</span>     * @param dataIn<a name="line.4265"></a>
<span class="sourceLineNo">4266</span>     *            &lt;div class="zh"&gt;<a name="line.4266"></a>
<span class="sourceLineNo">4267</span>     *            &lt;ul&gt;<a name="line.4267"></a>
<span class="sourceLineNo">4268</span>     *            &lt;li&gt;当mode=0x00时, DataIn指向卡号移位后生成的16位主帐号。&lt;/li&gt;<a name="line.4268"></a>
<span class="sourceLineNo">4269</span>     *            &lt;li&gt;当mode=0x01时, DataIn被忽略,接口内部采用随机数填充PINBlock。&lt;/li&gt;<a name="line.4269"></a>
<span class="sourceLineNo">4270</span>     *            &lt;li&gt;当mode=0x02时, DataIn指向位移后的16位PAN。&lt;/li&gt;<a name="line.4270"></a>
<span class="sourceLineNo">4271</span>     *            &lt;li&gt;当mode=0x03时, 为交易流水号ISN [6 Bytes,ASCII码]&lt;/li&gt;<a name="line.4271"></a>
<span class="sourceLineNo">4272</span>     *            &lt;/ul&gt;<a name="line.4272"></a>
<span class="sourceLineNo">4273</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.4273"></a>
<span class="sourceLineNo">4274</span>     *            &lt;ul&gt;<a name="line.4274"></a>
<span class="sourceLineNo">4275</span>     *            &lt;li&gt;When mode=0x00, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.4275"></a>
<span class="sourceLineNo">4276</span>     *            &lt;li&gt;When mode=0x01, DataIn is ignored. The interface uses random numbers to fill PINBlock internally.&lt;/li&gt;<a name="line.4276"></a>
<span class="sourceLineNo">4277</span>     *            &lt;li&gt;When mode=0x02, DataIn is the 16 bytes primary account number after shifting.&lt;/li&gt;<a name="line.4277"></a>
<span class="sourceLineNo">4278</span>     *            &lt;li&gt;When mode=0x03, dataIn is ISN [6 Bytes, ASCII code]&lt;/li&gt;<a name="line.4278"></a>
<span class="sourceLineNo">4279</span>     *            &lt;/ul&gt;<a name="line.4279"></a>
<span class="sourceLineNo">4280</span>     *            &lt;/div&gt;<a name="line.4280"></a>
<span class="sourceLineNo">4281</span>     *<a name="line.4281"></a>
<span class="sourceLineNo">4282</span>     * @param timeoutMs<a name="line.4282"></a>
<span class="sourceLineNo">4283</span>     *            &lt;div class="zh"&gt;<a name="line.4283"></a>
<span class="sourceLineNo">4284</span>     *            &lt;p&gt;<a name="line.4284"></a>
<span class="sourceLineNo">4285</span>     *            输入PIN的超时时间,单位：毫秒 最大值为300000ms<a name="line.4285"></a>
<span class="sourceLineNo">4286</span>     *            &lt;/p&gt;<a name="line.4286"></a>
<span class="sourceLineNo">4287</span>     *            &lt;p&gt;<a name="line.4287"></a>
<span class="sourceLineNo">4288</span>     *            0:表示没有超时时间，PED不做超时控制<a name="line.4288"></a>
<span class="sourceLineNo">4289</span>     *            &lt;/p&gt;<a name="line.4289"></a>
<span class="sourceLineNo">4290</span>     *            &lt;/div&gt; &lt;div class="en"&gt;<a name="line.4290"></a>
<span class="sourceLineNo">4291</span>     *            &lt;p&gt;<a name="line.4291"></a>
<span class="sourceLineNo">4292</span>     *            The timeout of PIN entry [unit:ms] Maximum is 300000ms.<a name="line.4292"></a>
<span class="sourceLineNo">4293</span>     *            &lt;/p&gt;<a name="line.4293"></a>
<span class="sourceLineNo">4294</span>     *            &lt;p&gt;<a name="line.4294"></a>
<span class="sourceLineNo">4295</span>     *            0: No timeout time, not doing timeout control for PED.<a name="line.4295"></a>
<span class="sourceLineNo">4296</span>     *            &lt;/p&gt;<a name="line.4296"></a>
<span class="sourceLineNo">4297</span>     *            &lt;/div&gt;<a name="line.4297"></a>
<span class="sourceLineNo">4298</span>     *<a name="line.4298"></a>
<span class="sourceLineNo">4299</span>     * @return &lt;div class="zh"&gt; 返回pinBlock &lt;/div&gt; &lt;div class="en"&gt; Return pinBlock byte array.&lt;/div&gt;<a name="line.4299"></a>
<span class="sourceLineNo">4300</span>     *<a name="line.4300"></a>
<span class="sourceLineNo">4301</span>     * @throws PedDevException<a name="line.4301"></a>
<span class="sourceLineNo">4302</span>     * @since V3.33.00<a name="line.4302"></a>
<span class="sourceLineNo">4303</span>     */<a name="line.4303"></a>
<span class="sourceLineNo">4304</span>    public byte[] getPinBlock(byte keyIndex, int keyLen, byte mode, byte inputMode, int inputMin, int inputMax, byte[] dataIn, int timeoutMs)  // NOSONAR<a name="line.4304"></a>
<span class="sourceLineNo">4305</span>            throws PedDevException;<a name="line.4305"></a>
<span class="sourceLineNo">4306</span><a name="line.4306"></a>
<span class="sourceLineNo">4307</span><a name="line.4307"></a>
<span class="sourceLineNo">4308</span>    /**<a name="line.4308"></a>
<span class="sourceLineNo">4309</span>     * &lt;div class="zh"&gt;设置键盘按键音量值。&lt;/div&gt; &lt;div class="en"&gt;Set keyboard key volume value.&lt;/div&gt;<a name="line.4309"></a>
<span class="sourceLineNo">4310</span>     *<a name="line.4310"></a>
<span class="sourceLineNo">4311</span>     * @param volume   &lt;div class="zh"&gt;音量值（0~50）&lt;/div&gt;<a name="line.4311"></a>
<span class="sourceLineNo">4312</span>     *               &lt;div class="en"&gt;Volume value (0~50)&lt;/div&gt;<a name="line.4312"></a>
<span class="sourceLineNo">4313</span>     * @throws PedDevException<a name="line.4313"></a>
<span class="sourceLineNo">4314</span>     * @since V4.01.00<a name="line.4314"></a>
<span class="sourceLineNo">4315</span>     */<a name="line.4315"></a>
<span class="sourceLineNo">4316</span>    void setPinVolume(int volume) throws PedDevException;<a name="line.4316"></a>
<span class="sourceLineNo">4317</span><a name="line.4317"></a>
<span class="sourceLineNo">4318</span>    /**<a name="line.4318"></a>
<span class="sourceLineNo">4319</span>     * &lt;div class="zh"&gt;将salt写入指定索引位置。仅支持{@link EPedType#INTERNAL} 类型。&lt;/div&gt; &lt;div class="en"&gt;Write salt to the specified index. {@link EPedType#INTERNAL} only is supported.&lt;/div&gt;<a name="line.4319"></a>
<span class="sourceLineNo">4320</span>     *<a name="line.4320"></a>
<span class="sourceLineNo">4321</span>     * @param salt &lt;div class="zh"&gt;salt明文密钥。长度最长128字节。&lt;/div&gt; &lt;div class="en"&gt;Salt plaintext key.The maximum length is 128 bytes.&lt;/div&gt;<a name="line.4321"></a>
<span class="sourceLineNo">4322</span>     *<a name="line.4322"></a>
<span class="sourceLineNo">4323</span>     * @param index &lt;div class="zh"&gt;索引,1或2&lt;/div&gt; &lt;div class="en"&gt;index, 1 or 2&lt;/div&gt;<a name="line.4323"></a>
<span class="sourceLineNo">4324</span>     * @throws PedDevException<a name="line.4324"></a>
<span class="sourceLineNo">4325</span>     * @since V4.03.00<a name="line.4325"></a>
<span class="sourceLineNo">4326</span>     */<a name="line.4326"></a>
<span class="sourceLineNo">4327</span>    void writeSaltKey(byte[] salt, int index) throws PedDevException;<a name="line.4327"></a>
<span class="sourceLineNo">4328</span>}<a name="line.4328"></a>




























































</pre>
</div>
</body>
</html>
