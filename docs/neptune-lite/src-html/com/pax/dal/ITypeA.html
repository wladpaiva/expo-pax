<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet_en.css" title="Style">
</head>
<body>
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span>/*<a name="line.1"></a>
<span class="sourceLineNo">002</span> * ===========================================================================================<a name="line.2"></a>
<span class="sourceLineNo">003</span> * = COPYRIGHT<a name="line.3"></a>
<span class="sourceLineNo">004</span> *          PAX Computer Technology (Shenzhen) Co., Ltd. PROPRIETARY INFORMATION<a name="line.4"></a>
<span class="sourceLineNo">005</span> *   This software is supplied under the terms of a license agreement or nondisclosure<a name="line.5"></a>
<span class="sourceLineNo">006</span> *   agreement with PAX Computer Technology (Shenzhen) Co., Ltd. and may not be copied or<a name="line.6"></a>
<span class="sourceLineNo">007</span> *   disclosed except in accordance with the terms in that agreement.<a name="line.7"></a>
<span class="sourceLineNo">008</span> *     Copyright (C) 2017-2023 PAX Computer Technology (Shenzhen) Co., Ltd. All rights reserved.<a name="line.8"></a>
<span class="sourceLineNo">009</span> * Description: // Detail description about the function of this module,<a name="line.9"></a>
<span class="sourceLineNo">010</span> *             // interfaces with the other modules, and dependencies.<a name="line.10"></a>
<span class="sourceLineNo">011</span> * Revision History:<a name="line.11"></a>
<span class="sourceLineNo">012</span> * Date                         Author                        Action<a name="line.12"></a>
<span class="sourceLineNo">013</span> * 2017/04/01                   PAX                     Create/Add/Modify/Delete<a name="line.13"></a>
<span class="sourceLineNo">014</span> * ===========================================================================================<a name="line.14"></a>
<span class="sourceLineNo">015</span> */<a name="line.15"></a>
<span class="sourceLineNo">016</span>package com.pax.dal;<a name="line.16"></a>
<span class="sourceLineNo">017</span><a name="line.17"></a>
<span class="sourceLineNo">018</span>import com.pax.dal.entity.ApduRespInfo;<a name="line.18"></a>
<span class="sourceLineNo">019</span>import com.pax.dal.entity.ApduSendInfo;<a name="line.19"></a>
<span class="sourceLineNo">020</span>import com.pax.dal.entity.DUKPTResult;<a name="line.20"></a>
<span class="sourceLineNo">021</span>import com.pax.dal.entity.EBeepMode;<a name="line.21"></a>
<span class="sourceLineNo">022</span>import com.pax.dal.entity.EKeyCode;<a name="line.22"></a>
<span class="sourceLineNo">023</span>import com.pax.dal.entity.EM1KeyType;<a name="line.23"></a>
<span class="sourceLineNo">024</span>import com.pax.dal.entity.EM1OperateType;<a name="line.24"></a>
<span class="sourceLineNo">025</span>import com.pax.dal.entity.PiccCardInfo;<a name="line.25"></a>
<span class="sourceLineNo">026</span>import com.pax.dal.entity.PiccPara;<a name="line.26"></a>
<span class="sourceLineNo">027</span>import com.pax.dal.entity.SM2KeyPair;<a name="line.27"></a>
<span class="sourceLineNo">028</span>import com.pax.dal.entity.UartParam;<a name="line.28"></a>
<span class="sourceLineNo">029</span>import com.pax.dal.exceptions.TypeAException;<a name="line.29"></a>
<span class="sourceLineNo">030</span><a name="line.30"></a>
<span class="sourceLineNo">031</span>/**<a name="line.31"></a>
<span class="sourceLineNo">032</span> * &lt;div class="zh"&gt;TypeA。&lt;/div&gt; &lt;div class="en"&gt;TypeA.&lt;/div&gt;<a name="line.32"></a>
<span class="sourceLineNo">033</span> */<a name="line.33"></a>
<span class="sourceLineNo">034</span>public interface ITypeA {<a name="line.34"></a>
<span class="sourceLineNo">035</span>    /**<a name="line.35"></a>
<span class="sourceLineNo">036</span>     * &lt;div class="zh"&gt;设置默认通信配置。&lt;/div&gt; &lt;div class="en"&gt;Set the default UartParam.&lt;/div&gt;<a name="line.36"></a>
<span class="sourceLineNo">037</span>     *<a name="line.37"></a>
<span class="sourceLineNo">038</span>     * @param uartParam {@link UartParam}<a name="line.38"></a>
<span class="sourceLineNo">039</span>     * @throws TypeAException TypeAException<a name="line.39"></a>
<span class="sourceLineNo">040</span>     */<a name="line.40"></a>
<span class="sourceLineNo">041</span>    void setUartParam(UartParam uartParam) throws TypeAException;<a name="line.41"></a>
<span class="sourceLineNo">042</span><a name="line.42"></a>
<span class="sourceLineNo">043</span>    /**<a name="line.43"></a>
<span class="sourceLineNo">044</span>     * &lt;div class="zh"&gt;设置通信IComm。&lt;/div&gt; &lt;div class="en"&gt;Set the IComm.&lt;/div&gt;<a name="line.44"></a>
<span class="sourceLineNo">045</span>     *<a name="line.45"></a>
<span class="sourceLineNo">046</span>     * @param comm {@link IComm}<a name="line.46"></a>
<span class="sourceLineNo">047</span>     * @throws TypeAException TypeAException<a name="line.47"></a>
<span class="sourceLineNo">048</span>     */<a name="line.48"></a>
<span class="sourceLineNo">049</span>    void setComm(IComm comm) throws TypeAException;<a name="line.49"></a>
<span class="sourceLineNo">050</span><a name="line.50"></a>
<span class="sourceLineNo">051</span>    /**<a name="line.51"></a>
<span class="sourceLineNo">052</span>     * &lt;div class="zh"&gt;连接。&lt;/div&gt; &lt;div class="en"&gt;Connect.&lt;/div&gt;<a name="line.52"></a>
<span class="sourceLineNo">053</span>     *<a name="line.53"></a>
<span class="sourceLineNo">054</span>     * @throws TypeAException TypeAException<a name="line.54"></a>
<span class="sourceLineNo">055</span>     */<a name="line.55"></a>
<span class="sourceLineNo">056</span>    void connect() throws TypeAException;<a name="line.56"></a>
<span class="sourceLineNo">057</span><a name="line.57"></a>
<span class="sourceLineNo">058</span>    /**<a name="line.58"></a>
<span class="sourceLineNo">059</span>     * &lt;div class="zh"&gt;断开连接。&lt;/div&gt; &lt;div class="en"&gt;Disconnect.&lt;/div&gt;<a name="line.59"></a>
<span class="sourceLineNo">060</span>     *<a name="line.60"></a>
<span class="sourceLineNo">061</span>     * @throws TypeAException TypeAException<a name="line.61"></a>
<span class="sourceLineNo">062</span>     */<a name="line.62"></a>
<span class="sourceLineNo">063</span>    void disconnect() throws TypeAException;<a name="line.63"></a>
<span class="sourceLineNo">064</span><a name="line.64"></a>
<span class="sourceLineNo">065</span><a name="line.65"></a>
<span class="sourceLineNo">066</span>    /**<a name="line.66"></a>
<span class="sourceLineNo">067</span>     * &lt;div class="zh"&gt;控制密码键盘的硬件状态。&lt;/div&gt; &lt;div class="en"&gt;Control the hardware status of the password keyboard.&lt;/div&gt;<a name="line.67"></a>
<span class="sourceLineNo">068</span>     * @param item &lt;div class="zh"&gt;<a name="line.68"></a>
<span class="sourceLineNo">069</span>     *             &lt;ul&gt;<a name="line.69"></a>
<span class="sourceLineNo">070</span>     *              &lt;li&gt;D0：0-按键无声 1-按键发声&lt;/li&gt;<a name="line.70"></a>
<span class="sourceLineNo">071</span>     *              &lt;li&gt;D1：0-关闭语音提示 1-打开语音提示&lt;/li&gt;<a name="line.71"></a>
<span class="sourceLineNo">072</span>     *              &lt;li&gt;D2：0-按键无声 1-按键立即发声&lt;/li&gt;<a name="line.72"></a>
<span class="sourceLineNo">073</span>     *              &lt;li&gt;D3：红灯&lt;/li&gt;<a name="line.73"></a>
<span class="sourceLineNo">074</span>     *              &lt;li&gt;D4：黄灯&lt;/li&gt;<a name="line.74"></a>
<span class="sourceLineNo">075</span>     *              &lt;li&gt;D5：绿灯&lt;/li&gt;<a name="line.75"></a>
<span class="sourceLineNo">076</span>     *              &lt;li&gt;D6：1-PINPAD 将发出“嘀”的一声&lt;/li&gt;<a name="line.76"></a>
<span class="sourceLineNo">077</span>     *              &lt;li&gt;D7：0-关闭 LCD 背光 1-打开 LCD 背光&lt;/li&gt;<a name="line.77"></a>
<span class="sourceLineNo">078</span>     *             &lt;/ul&gt;<a name="line.78"></a>
<span class="sourceLineNo">079</span>     *             D0 与 D2 的区别：D0 设置为 1 后只有输入 PIN 时按键才发声，D2 设置后无论何时按键都发声&lt;/div&gt;<a name="line.79"></a>
<span class="sourceLineNo">080</span>     *             &lt;div class="en"&gt;<a name="line.80"></a>
<span class="sourceLineNo">081</span>     *             &lt;ul&gt;&lt;/li&gt;<a name="line.81"></a>
<span class="sourceLineNo">082</span>     *              &lt;li&gt; D0: 0-key is silent 1-key is sounded&lt;/li&gt;<a name="line.82"></a>
<span class="sourceLineNo">083</span>     *              &lt;li&gt;D1: 0-Turn off the voice prompt 1-Turn on the voice prompt&lt;/li&gt;<a name="line.83"></a>
<span class="sourceLineNo">084</span>     *              &lt;li&gt;D2: 0-key is silent 1-key is sounded immediately&lt;/li&gt;<a name="line.84"></a>
<span class="sourceLineNo">085</span>     *              &lt;li&gt;D3: Red light&lt;/li&gt;<a name="line.85"></a>
<span class="sourceLineNo">086</span>     *              &lt;li&gt;D4: Yellow light&lt;/li&gt;<a name="line.86"></a>
<span class="sourceLineNo">087</span>     *              &lt;li&gt;D5: Green light&lt;/li&gt;<a name="line.87"></a>
<span class="sourceLineNo">088</span>     *              &lt;li&gt;D6: 1-PINPAD will make a beep&lt;/li&gt;<a name="line.88"></a>
<span class="sourceLineNo">089</span>     *              &lt;li&gt;D7: 0-Turn off LCD backlight 1-Turn on LCD backlight&lt;/li&gt;<a name="line.89"></a>
<span class="sourceLineNo">090</span>     *             &lt;/ul&gt;<a name="line.90"></a>
<span class="sourceLineNo">091</span>     *             The difference between D0 and D2: After D0 is set to 1, the key will sound only when the PIN is input,<a name="line.91"></a>
<span class="sourceLineNo">092</span>     *             and whenever D2 is set, the key will sound whenever the key is pressed&lt;/div&gt;<a name="line.92"></a>
<span class="sourceLineNo">093</span>     * @param value &lt;div class="zh"&gt;D0-D7：1-设置数据有效，0-设置数据无效&lt;/div&gt;<a name="line.93"></a>
<span class="sourceLineNo">094</span>     *              &lt;div class="zh"&gt;D0-D7: 1-Set the data to be valid, 0-Set the data to be invalid&lt;/div&gt;<a name="line.94"></a>
<span class="sourceLineNo">095</span>     *<a name="line.95"></a>
<span class="sourceLineNo">096</span>     * @throws TypeAException TypeAException<a name="line.96"></a>
<span class="sourceLineNo">097</span>     */<a name="line.97"></a>
<span class="sourceLineNo">098</span>    void setup(byte item, byte value) throws TypeAException;<a name="line.98"></a>
<span class="sourceLineNo">099</span><a name="line.99"></a>
<span class="sourceLineNo">100</span>    /**<a name="line.100"></a>
<span class="sourceLineNo">101</span>     * &lt;div class="zh"&gt;读取密码键盘版本号。&lt;/div&gt; &lt;div class="en"&gt;Read the password keyboard version number.&lt;/div&gt;<a name="line.101"></a>
<span class="sourceLineNo">102</span>     *<a name="line.102"></a>
<span class="sourceLineNo">103</span>     * @return &lt;div class="zh"&gt;版本号，格式为“HvXXSvXX”。Hv代表硬件版本、XX为版本号，Sv 代表软件版本、XX 为版本号。&lt;/div&gt;<a name="line.103"></a>
<span class="sourceLineNo">104</span>     *         &lt;div class="en"&gt;Version number, the format is "HvXXSvXX". Hv represents the hardware version, XX is the version number, Sv represents the software version, and XX is the version number.&lt;/div&gt;<a name="line.104"></a>
<span class="sourceLineNo">105</span>     * @throws TypeAException TypeAException<a name="line.105"></a>
<span class="sourceLineNo">106</span>     */<a name="line.106"></a>
<span class="sourceLineNo">107</span>    String getVersion() throws TypeAException;<a name="line.107"></a>
<span class="sourceLineNo">108</span><a name="line.108"></a>
<span class="sourceLineNo">109</span>    /**<a name="line.109"></a>
<span class="sourceLineNo">110</span>     * &lt;div class="zh"&gt;设置及测试密码键盘。&lt;/div&gt; &lt;div class="en"&gt;Set up and test the password keyboard.&lt;/div&gt;<a name="line.110"></a>
<span class="sourceLineNo">111</span>     *<a name="line.111"></a>
<span class="sourceLineNo">112</span>     * @param item &lt;div class="zh"&gt;<a name="line.112"></a>
<span class="sourceLineNo">113</span>     *             &lt;ul&gt;&lt;li&gt;0x31:设置按键时蜂鸣器是否发声&lt;/li&gt;<a name="line.113"></a>
<span class="sourceLineNo">114</span>     *              &lt;li&gt;0x32:设置 LCD 背光或 LED 指示灯&lt;/li&gt;<a name="line.114"></a>
<span class="sourceLineNo">115</span>     *              &lt;li&gt;0x33:设置等待输入按键时的超时时间。&lt;/li&gt;<a name="line.115"></a>
<span class="sourceLineNo">116</span>     *              &lt;li&gt;0x3e:解锁&lt;/li&gt;<a name="line.116"></a>
<span class="sourceLineNo">117</span>     *              &lt;li&gt;0x3f:测试 PINPAD 内存。&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.117"></a>
<span class="sourceLineNo">118</span>     *             &lt;div class="en"&gt;<a name="line.118"></a>
<span class="sourceLineNo">119</span>     *              &lt;ul&gt;&lt;li&gt;0x31: Set whether the buzzer sounds when the key is pressed&lt;/li&gt;<a name="line.119"></a>
<span class="sourceLineNo">120</span>     *              &lt;li&gt;0x32: Set LCD backlight or LED indicator&lt;/li&gt;<a name="line.120"></a>
<span class="sourceLineNo">121</span>     *              &lt;li&gt;0x33: Set the timeout time when waiting for the key input.&lt;/li&gt;<a name="line.121"></a>
<span class="sourceLineNo">122</span>     *              &lt;li&gt;0x3e: Unlock&lt;/li&gt;<a name="line.122"></a>
<span class="sourceLineNo">123</span>     *              &lt;li&gt;0x3f: Test PINPAD memory.&lt;/li&gt;<a name="line.123"></a>
<span class="sourceLineNo">124</span>     *             &lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.124"></a>
<span class="sourceLineNo">125</span>     * @param value &lt;div class="zh"&gt;<a name="line.125"></a>
<span class="sourceLineNo">126</span>     *              &lt;ul&gt;&lt;li&gt;item=0x31 时，value=0 时，禁止蜂鸣器发声；value=1 时,可以发声。&lt;/li&gt;<a name="line.126"></a>
<span class="sourceLineNo">127</span>     *               &lt;li&gt;item=0x32 时，value=0 时，背光或 LED 指示灯熄；value=1 时,亮。&lt;/li&gt;<a name="line.127"></a>
<span class="sourceLineNo">128</span>     *               &lt;li&gt;item=0x33 时，value 为等待输入按键时的超时时间(秒)的 1/10。&lt;/li&gt;<a name="line.128"></a>
<span class="sourceLineNo">129</span>     *               &lt;li&gt;item=0x3e 时，value=0x3e 时,解锁。&lt;/li&gt;<a name="line.129"></a>
<span class="sourceLineNo">130</span>     *               &lt;li&gt;item=0x3f 时，内存测试。&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.130"></a>
<span class="sourceLineNo">131</span>     *              &lt;div class="zh"&gt;<a name="line.131"></a>
<span class="sourceLineNo">132</span>     *              &lt;ul&gt;&lt;li&gt;When item=0x31, when value=0, the buzzer is forbidden to sound; when value=1, it can sound.&lt;/li&gt;<a name="line.132"></a>
<span class="sourceLineNo">133</span>     *               &lt;li&gt;When item=0x32, when value=0, the backlight or LED indicator is off; when value=1, it is on.&lt;/li&gt;<a name="line.133"></a>
<span class="sourceLineNo">134</span>     *               &lt;li&gt;When item=0x33, the value is 1/10 of the timeout time (seconds) while waiting for the key input.&lt;/li&gt;<a name="line.134"></a>
<span class="sourceLineNo">135</span>     *               &lt;li&gt;When item=0x3e, value=0x3e, unlock.&lt;/li&gt;<a name="line.135"></a>
<span class="sourceLineNo">136</span>     *               &lt;li&gt;When item=0x3f, memory test.&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.136"></a>
<span class="sourceLineNo">137</span>     * @throws TypeAException TypeAException<a name="line.137"></a>
<span class="sourceLineNo">138</span>     */<a name="line.138"></a>
<span class="sourceLineNo">139</span>    void setupAndTest(byte item, byte value) throws TypeAException;<a name="line.139"></a>
<span class="sourceLineNo">140</span><a name="line.140"></a>
<span class="sourceLineNo">141</span>    /**<a name="line.141"></a>
<span class="sourceLineNo">142</span>     * &lt;div class="zh"&gt;读取序列号。&lt;/div&gt; &lt;div class="en"&gt;Read serial number.&lt;/div&gt;<a name="line.142"></a>
<span class="sourceLineNo">143</span>     *<a name="line.143"></a>
<span class="sourceLineNo">144</span>     * @return &lt;div class="zh"&gt;序列号。SN为10位数字的字符串&lt;/div&gt; &lt;div class="en"&gt;Serial number.SN is a string of 10 digits&lt;/div&gt;<a name="line.144"></a>
<span class="sourceLineNo">145</span>     * @throws TypeAException TypeAException<a name="line.145"></a>
<span class="sourceLineNo">146</span>     */<a name="line.146"></a>
<span class="sourceLineNo">147</span>    String getSN() throws TypeAException;<a name="line.147"></a>
<span class="sourceLineNo">148</span><a name="line.148"></a>
<span class="sourceLineNo">149</span>    /**<a name="line.149"></a>
<span class="sourceLineNo">150</span>     * &lt;div class="zh"&gt;蜂鸣器按参数指定的频率和持续时间发声。&lt;/div&gt; &lt;div class="en"&gt;The buzzer sounds according to the frequency and duration specified by the parameters.&lt;/div&gt;<a name="line.150"></a>
<span class="sourceLineNo">151</span>     *<a name="line.151"></a>
<span class="sourceLineNo">152</span>     * @param mode {@link EBeepMode}<a name="line.152"></a>
<span class="sourceLineNo">153</span>     * @param timeMs &lt;div class="zh"&gt;持续时间，单位毫秒&lt;/div&gt; &lt;div class="en"&gt;Duration in milliseconds&lt;/div&gt;<a name="line.153"></a>
<span class="sourceLineNo">154</span>     * @throws TypeAException TypeAException<a name="line.154"></a>
<span class="sourceLineNo">155</span>     */<a name="line.155"></a>
<span class="sourceLineNo">156</span>    void beep(EBeepMode mode, int timeMs) throws TypeAException;<a name="line.156"></a>
<span class="sourceLineNo">157</span>    /**<a name="line.157"></a>
<span class="sourceLineNo">158</span>     * &lt;div class="zh"&gt;4个LED灯的点亮和熄灭状态。。&lt;/div&gt; &lt;div class="en"&gt;The on and off status of 4 LED lights.&lt;/div&gt;<a name="line.158"></a>
<span class="sourceLineNo">159</span>     *<a name="line.159"></a>
<span class="sourceLineNo">160</span>     * @param ledIndex &lt;div class="en"&gt;&lt;ul&gt;<a name="line.160"></a>
<span class="sourceLineNo">161</span>     *                   &lt;li&gt;BIT0：红灯 &lt;/li&gt;<a name="line.161"></a>
<span class="sourceLineNo">162</span>     *                   &lt;li&gt;BIT1：绿灯 &lt;/li&gt;<a name="line.162"></a>
<span class="sourceLineNo">163</span>     *                   &lt;li&gt;BIT2：黄灯 &lt;/li&gt;<a name="line.163"></a>
<span class="sourceLineNo">164</span>     *                   &lt;li&gt;BIT3：蓝灯&lt;/li&gt;<a name="line.164"></a>
<span class="sourceLineNo">165</span>     *                   &lt;li&gt;BIT4-BIT7：保留&lt;/li&gt;<a name="line.165"></a>
<span class="sourceLineNo">166</span>     *                 &lt;/ul&gt;&lt;/div&gt;<a name="line.166"></a>
<span class="sourceLineNo">167</span>     *                 &lt;div class="en"&gt;&lt;ul&gt;<a name="line.167"></a>
<span class="sourceLineNo">168</span>     *                   &lt;li&gt;BIT0：red &lt;/li&gt;<a name="line.168"></a>
<span class="sourceLineNo">169</span>     *                   &lt;li&gt;BIT1：green &lt;/li&gt;<a name="line.169"></a>
<span class="sourceLineNo">170</span>     *                   &lt;li&gt;BIT2：yellow &lt;/li&gt;<a name="line.170"></a>
<span class="sourceLineNo">171</span>     *                   &lt;li&gt;BIT3：blue&lt;/li&gt;<a name="line.171"></a>
<span class="sourceLineNo">172</span>     *                   &lt;li&gt;BIT4-BIT7：reserved&lt;/li&gt;<a name="line.172"></a>
<span class="sourceLineNo">173</span>     *                 &lt;/ul&gt;&lt;/div&gt;<a name="line.173"></a>
<span class="sourceLineNo">174</span>     * @param control &lt;div class="zh"&gt;<a name="line.174"></a>
<span class="sourceLineNo">175</span>     *                &lt;ul&gt;<a name="line.175"></a>
<span class="sourceLineNo">176</span>     *                 &lt;li&gt;0：熄灭&lt;/li&gt;<a name="line.176"></a>
<span class="sourceLineNo">177</span>     *                 &lt;li&gt;非 0： 点亮&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.177"></a>
<span class="sourceLineNo">178</span>     *                &lt;div class="en"&gt;<a name="line.178"></a>
<span class="sourceLineNo">179</span>     *                &lt;ul&gt;<a name="line.179"></a>
<span class="sourceLineNo">180</span>     *                 &lt;li&gt;0: off&lt;/li&gt;<a name="line.180"></a>
<span class="sourceLineNo">181</span>     *                 &lt;li&gt;Non-zero: light up&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.181"></a>
<span class="sourceLineNo">182</span>     * @throws TypeAException TypeAException<a name="line.182"></a>
<span class="sourceLineNo">183</span>     */<a name="line.183"></a>
<span class="sourceLineNo">184</span>    void ledControl(byte ledIndex, byte control) throws TypeAException;<a name="line.184"></a>
<span class="sourceLineNo">185</span>    /**<a name="line.185"></a>
<span class="sourceLineNo">186</span>     * &lt;div class="zh"&gt;获取密码键盘系统信息。&lt;/div&gt; &lt;div class="en"&gt;Get password keyboard system information.&lt;/div&gt;<a name="line.186"></a>
<span class="sourceLineNo">187</span>     *<a name="line.187"></a>
<span class="sourceLineNo">188</span>     * @param item &lt;div class="zh"&gt;<a name="line.188"></a>
<span class="sourceLineNo">189</span>     *             &lt;ul&gt;<a name="line.189"></a>
<span class="sourceLineNo">190</span>     *               &lt;li&gt;0x01：终端名称&lt;/li&gt;<a name="line.190"></a>
<span class="sourceLineNo">191</span>     *               &lt;li&gt;0x02：终端配置信息&lt;/li&gt;<a name="line.191"></a>
<span class="sourceLineNo">192</span>     *               &lt;li&gt;0x03：序列号&lt;/li&gt;<a name="line.192"></a>
<span class="sourceLineNo">193</span>     *               &lt;li&gt;0x04：扩展序列号&lt;/li&gt;<a name="line.193"></a>
<span class="sourceLineNo">194</span>     *               &lt;li&gt;0x05：主板号&lt;/li&gt;<a name="line.194"></a>
<span class="sourceLineNo">195</span>     *               &lt;li&gt;0x06：扩展板号&lt;/li&gt;<a name="line.195"></a>
<span class="sourceLineNo">196</span>     *               &lt;li&gt;0x07：协议类型&lt;/li&gt;<a name="line.196"></a>
<span class="sourceLineNo">197</span>     *               &lt;li&gt;0x08：Boot 版本号&lt;/li&gt;<a name="line.197"></a>
<span class="sourceLineNo">198</span>     *               &lt;li&gt;0x09：Monitor 版本号&lt;/li&gt;<a name="line.198"></a>
<span class="sourceLineNo">199</span>     *               &lt;li&gt;0x0A：通讯方式&lt;/li&gt;<a name="line.199"></a>
<span class="sourceLineNo">200</span>     *               &lt;li&gt;0x0B：射频模块配置, “N”或“Y + 射频参数”&lt;/li&gt;<a name="line.200"></a>
<span class="sourceLineNo">201</span>     *               &lt;li&gt;0x0C：是否支持 NFC 功能&lt;/li&gt;<a name="line.201"></a>
<span class="sourceLineNo">202</span>     *               &lt;li&gt;0x0D：硬件国密配置信息，‘N’或‘Y+国密固件版本信息 xx.xx.xx’&lt;/li&gt;<a name="line.202"></a>
<span class="sourceLineNo">203</span>     *               &lt;li&gt;0x0E：识别支持语音芯片的型号&lt;/li&gt;&lt;/ul&gt;<a name="line.203"></a>
<span class="sourceLineNo">204</span>     *             对于终端配置信息项(0x02)，返回格式是：PN:PN 号:配置文件:配置文件版本。例如：<a name="line.204"></a>
<span class="sourceLineNo">205</span>     *             PN : SP20-121-9C0 : CONFIG_FILE_VER : V1.0，即每项之间用冒号隔开。并不是所有机型都能获取到有效的配置信息，<a name="line.205"></a>
<span class="sourceLineNo">206</span>     *             比如对于不使用配置文件的机型，由于无法获取相关信息，所以它的返回为 NULL: NULL: NULL: NULL。&lt;br/&gt;<a name="line.206"></a>
<span class="sourceLineNo">207</span>     *             对于射频模块配置项(0x0B)，在有配置文件的机型中，如果存在射频模块，则只返回 “Y”，射频参数需通过终端配置信息(0x02)所指明的配置文件来获取。&lt;/div&gt;<a name="line.207"></a>
<span class="sourceLineNo">208</span>     *             &lt;div class="en"&gt;<a name="line.208"></a>
<span class="sourceLineNo">209</span>     *             &lt;ul&gt;<a name="line.209"></a>
<span class="sourceLineNo">210</span>     *               &lt;li&gt;0x01: terminal name&lt;/li&gt;<a name="line.210"></a>
<span class="sourceLineNo">211</span>     *               &lt;li&gt;0x02: terminal configuration information&lt;/li&gt;<a name="line.211"></a>
<span class="sourceLineNo">212</span>     *               &lt;li&gt;0x03: serial number&lt;/li&gt;<a name="line.212"></a>
<span class="sourceLineNo">213</span>     *               &lt;li&gt;0x04: extended serial number&lt;/li&gt;<a name="line.213"></a>
<span class="sourceLineNo">214</span>     *               &lt;li&gt;0x05: Motherboard number&lt;/li&gt;<a name="line.214"></a>
<span class="sourceLineNo">215</span>     *               &lt;li&gt;0x06: extension board number&lt;/li&gt;<a name="line.215"></a>
<span class="sourceLineNo">216</span>     *               &lt;li&gt;0x07: Protocol type&lt;/li&gt;<a name="line.216"></a>
<span class="sourceLineNo">217</span>     *               &lt;li&gt;0x08: Boot version number&lt;/li&gt;<a name="line.217"></a>
<span class="sourceLineNo">218</span>     *               &lt;li&gt;0x09: Monitor version number&lt;/li&gt;<a name="line.218"></a>
<span class="sourceLineNo">219</span>     *               &lt;li&gt;0x0A: Communication method&lt;/li&gt;<a name="line.219"></a>
<span class="sourceLineNo">220</span>     *               &lt;li&gt;0x0B: RF module configuration, "N" or "Y + RF parameters"&lt;/li&gt;<a name="line.220"></a>
<span class="sourceLineNo">221</span>     *               &lt;li&gt;0x0C: Whether to support NFC function&lt;/li&gt;<a name="line.221"></a>
<span class="sourceLineNo">222</span>     *               &lt;li&gt;0x0D: hardware national secret configuration information, ‘N’ or ‘Y+ national secret firmware version information xx.xx.xx’&lt;/li&gt;<a name="line.222"></a>
<span class="sourceLineNo">223</span>     *               &lt;li&gt;0x0E: Identify the model that supports the voice chip&lt;/li&gt;&lt;/ul&gt;<a name="line.223"></a>
<span class="sourceLineNo">224</span>     *             For the terminal configuration information item (0x02), the return format is: PN: PN number: configuration file: configuration file version.<a name="line.224"></a>
<span class="sourceLineNo">225</span>     *             For example: PN: SP20-121-9C0: CONFIG_FILE_VER: V1.0, that is, each item is separated by a colon. Not all models can obtain valid configuration<a name="line.225"></a>
<span class="sourceLineNo">226</span>     *             information. For example, for models that do not use configuration files, since the relevant information cannot be obtained, it returns NULL: NULL: NULL: NULL.&lt;br/&gt;<a name="line.226"></a>
<span class="sourceLineNo">227</span>     *             For the radio frequency module configuration item (0x0B), in models with configuration files, if there is a radio frequency module, only "Y" is returned. The frequency<a name="line.227"></a>
<span class="sourceLineNo">228</span>     *             parameters need to be obtained through the configuration file specified in the terminal configuration information (0x02).&lt;/div&gt;<a name="line.228"></a>
<span class="sourceLineNo">229</span>     *<a name="line.229"></a>
<span class="sourceLineNo">230</span>     * @return &lt;div class="zh"&gt;系统信息<a name="line.230"></a>
<span class="sourceLineNo">231</span>     *          &lt;br&gt;返回信息长度：<a name="line.231"></a>
<span class="sourceLineNo">232</span>     *          &lt;br&gt;0x00：发送数据错误（比如信息类别错误），命令没有返回数据；<a name="line.232"></a>
<span class="sourceLineNo">233</span>     *          &lt;br&gt;其它：密码键盘返回的有效数据长度。&lt;/div&gt;<a name="line.233"></a>
<span class="sourceLineNo">234</span>     *         &lt;div class="en"&gt;system message<a name="line.234"></a>
<span class="sourceLineNo">235</span>     *          &lt;br&gt;Return message length:<a name="line.235"></a>
<span class="sourceLineNo">236</span>     *          &lt;br&gt;0x00: Sending data error (for example, the information type is wrong), the command does not return data;<a name="line.236"></a>
<span class="sourceLineNo">237</span>     *          &lt;br&gt;Others: The length of the valid data returned by the password keyboard.&lt;/div&gt;<a name="line.237"></a>
<span class="sourceLineNo">238</span>     * @throws TypeAException TypeAException<a name="line.238"></a>
<span class="sourceLineNo">239</span>     */<a name="line.239"></a>
<span class="sourceLineNo">240</span>    String getTerminalInfo(byte item) throws TypeAException;<a name="line.240"></a>
<span class="sourceLineNo">241</span>    /**<a name="line.241"></a>
<span class="sourceLineNo">242</span>     * &lt;div class="zh"&gt;向密码键盘写入扩展序列号。&lt;/div&gt; &lt;div class="en"&gt;Write the extended serial number to the password keyboard.&lt;/div&gt;<a name="line.242"></a>
<span class="sourceLineNo">243</span>     *<a name="line.243"></a>
<span class="sourceLineNo">244</span>     * @param extSN &lt;div class="zh"&gt;扩展序列号。长度小于31个字符，合法范围ASCII 0x21-0x7E。&lt;/div&gt;<a name="line.244"></a>
<span class="sourceLineNo">245</span>     *              &lt;div class="en"&gt;Extended serial number. The length is less than 31 characters, and the legal range is ASCII 0x21-0x7E.&lt;/div&gt;<a name="line.245"></a>
<span class="sourceLineNo">246</span>     * @throws TypeAException TypeAException<a name="line.246"></a>
<span class="sourceLineNo">247</span>     */<a name="line.247"></a>
<span class="sourceLineNo">248</span>    void setExtSN(String extSN) throws TypeAException;<a name="line.248"></a>
<span class="sourceLineNo">249</span>    /**<a name="line.249"></a>
<span class="sourceLineNo">250</span>     * &lt;div class="zh"&gt;测试键盘按键。<a name="line.250"></a>
<span class="sourceLineNo">251</span>     *                  &lt;br/&gt;测试时必须按屏幕指定的按键次序进行按键测试；<a name="line.251"></a>
<span class="sourceLineNo">252</span>     *                  &lt;br/&gt;命令执行后，且未完成测试前，如果超过 120 秒未按键，将超时退出。&lt;/div&gt;<a name="line.252"></a>
<span class="sourceLineNo">253</span>     * &lt;div class="en"&gt;Test keyboard keys.<a name="line.253"></a>
<span class="sourceLineNo">254</span>     *                  &lt;br/&gt;During the test, you must perform the keystroke test according to the key sequence specified on the screen;<a name="line.254"></a>
<span class="sourceLineNo">255</span>     *                  &lt;br/&gt;After the command is executed and before the test is completed, if no key is pressed for more than 120 seconds, it will time out and exit.&lt;/div&gt;<a name="line.255"></a>
<span class="sourceLineNo">256</span>     *<a name="line.256"></a>
<span class="sourceLineNo">257</span>     * @return &lt;div class="zh"&gt;0x00: 所有按键均通过测试。<a name="line.257"></a>
<span class="sourceLineNo">258</span>     *                     &lt;br&gt;其它： 未通过测试。该非 0 值表示未按指定次序完成测试的按键数&lt;/div&gt;<a name="line.258"></a>
<span class="sourceLineNo">259</span>     *         &lt;div class="en"&gt;0x00: All keys have passed the test.<a name="line.259"></a>
<span class="sourceLineNo">260</span>     *                     &lt;br&gt;Other: Failed the test. The non-zero value indicates the number of keystrokes that did not complete the test in the specified order&lt;/div&gt;<a name="line.260"></a>
<span class="sourceLineNo">261</span>     * @throws TypeAException TypeAException<a name="line.261"></a>
<span class="sourceLineNo">262</span>     */<a name="line.262"></a>
<span class="sourceLineNo">263</span>    byte testKeyboard() throws TypeAException;<a name="line.263"></a>
<span class="sourceLineNo">264</span>    /**<a name="line.264"></a>
<span class="sourceLineNo">265</span>     * &lt;div class="zh"&gt;恢复出厂设置。(蜂鸣器响一声，且键盘恢复出厂设置：输入 PIN 时按键发声，波特率 9600,8,E,1，按键时屏幕有背光。)&lt;/div&gt;<a name="line.265"></a>
<span class="sourceLineNo">266</span>     * &lt;div class="en"&gt;Recovery.(The buzzer beeps once, and the keyboard is restored to factory settings: when the PIN is input, the key is sounded, the baud rate is 9600, 8, E, 1, and the screen has backlight when the key is pressed.)&lt;/div&gt;<a name="line.266"></a>
<span class="sourceLineNo">267</span>     *<a name="line.267"></a>
<span class="sourceLineNo">268</span>     * @throws TypeAException TypeAException<a name="line.268"></a>
<span class="sourceLineNo">269</span>     */<a name="line.269"></a>
<span class="sourceLineNo">270</span>    void recovery() throws TypeAException;<a name="line.270"></a>
<span class="sourceLineNo">271</span>    /**<a name="line.271"></a>
<span class="sourceLineNo">272</span>     * &lt;div class="zh"&gt;清除密码键盘 LCD 屏幕上所有的显示内容。&lt;/div&gt; &lt;div class="en"&gt;Clear all the contents displayed on the LCD screen of the password keyboard.&lt;/div&gt;<a name="line.272"></a>
<span class="sourceLineNo">273</span>     *<a name="line.273"></a>
<span class="sourceLineNo">274</span>     * @throws TypeAException TypeAException<a name="line.274"></a>
<span class="sourceLineNo">275</span>     */<a name="line.275"></a>
<span class="sourceLineNo">276</span>    void clearScreen() throws TypeAException;<a name="line.276"></a>
<span class="sourceLineNo">277</span>    /**<a name="line.277"></a>
<span class="sourceLineNo">278</span>     * &lt;div class="zh"&gt;清除指定显示行。&lt;/div&gt; &lt;div class="en"&gt;Clear the specified display line.&lt;/div&gt;<a name="line.278"></a>
<span class="sourceLineNo">279</span>     *<a name="line.279"></a>
<span class="sourceLineNo">280</span>     * @param lineNo &lt;div class="zh"&gt;LCD 显示行号。每行均为 16 点高的行，0—第一行，1--第二行。&lt;/div&gt;<a name="line.280"></a>
<span class="sourceLineNo">281</span>     *               &lt;div class="en"&gt;Line number displayed on LCD. Each row is a 16-point high row, 0—the first row, and 1—the second row.&lt;/div&gt;<a name="line.281"></a>
<span class="sourceLineNo">282</span>     * @throws TypeAException TypeAException<a name="line.282"></a>
<span class="sourceLineNo">283</span>     */<a name="line.283"></a>
<span class="sourceLineNo">284</span>    void clearScreenByLine(byte lineNo) throws TypeAException;<a name="line.284"></a>
<span class="sourceLineNo">285</span>    /**<a name="line.285"></a>
<span class="sourceLineNo">286</span>     * &lt;div class="zh"&gt;显示英文字符。在指定位置显示 16x8 点阵的英文和字符，一行最多可以显示 15 个字符。在显示时，如果显示字符小于 15 但当前行显示不完(列号非 0)，则把多余的数据切掉，返回码为 OK。&lt;/div&gt;<a name="line.286"></a>
<span class="sourceLineNo">287</span>     * &lt;div class="en"&gt;Display English characters. Display 16x8 dot matrix English and characters at the specified position, up to 15 characters can be displayed on a line.<a name="line.287"></a>
<span class="sourceLineNo">288</span>     *                 When displaying, if the displayed character is less than 15 but the current line is not displayed completely (column number is not 0), the redundant<a name="line.288"></a>
<span class="sourceLineNo">289</span>     *                 data will be cut off, and the return code will be OK.&lt;/div&gt;<a name="line.289"></a>
<span class="sourceLineNo">290</span>     *<a name="line.290"></a>
<span class="sourceLineNo">291</span>     * @param x &lt;div class="zh"&gt;显示字符在 LCD 上的起始点阵列号(单位：点)，0≤x≤114；&lt;/div&gt;<a name="line.291"></a>
<span class="sourceLineNo">292</span>     *          &lt;div class="en"&gt;Display the starting point array number of the character on the LCD (unit: point), 0≤x≤114;&lt;/div&gt;<a name="line.292"></a>
<span class="sourceLineNo">293</span>     *<a name="line.293"></a>
<span class="sourceLineNo">294</span>     * @param y &lt;div class="zh"&gt;显示字符在 LCD 上的行号(单位：行)。每行均为 16 点高的行，0—第一行，1--第二行。&lt;/div&gt;<a name="line.294"></a>
<span class="sourceLineNo">295</span>     *          &lt;div class="en"&gt;Display the line number of the character on the LCD (unit: line). Each row is a 16-point high row, 0—the first row, and 1—the second row.&lt;/div&gt;<a name="line.295"></a>
<span class="sourceLineNo">296</span>     *<a name="line.296"></a>
<span class="sourceLineNo">297</span>     * @param chars &lt;div class="zh"&gt;字符。&lt;/div&gt;<a name="line.297"></a>
<span class="sourceLineNo">298</span>     *              &lt;div class="en"&gt;Character.&lt;/div&gt;<a name="line.298"></a>
<span class="sourceLineNo">299</span>     *<a name="line.299"></a>
<span class="sourceLineNo">300</span>     * @throws TypeAException TypeAException<a name="line.300"></a>
<span class="sourceLineNo">301</span>     */<a name="line.301"></a>
<span class="sourceLineNo">302</span>    void showChar(byte x, byte y, byte[] chars) throws TypeAException;<a name="line.302"></a>
<span class="sourceLineNo">303</span>    /**<a name="line.303"></a>
<span class="sourceLineNo">304</span>     * &lt;div class="zh"&gt;显示点阵。在指定 LCD 指定位置显示点阵。LCD 液晶显示共有两行，每一行分为上、下半行。在送点阵数据时，数据格式应该是：<a name="line.304"></a>
<span class="sourceLineNo">305</span>     *                 上半行数据（长度为 n）+下半行数据（长度为 n）=点阵数据（长度为 2n）<a name="line.305"></a>
<span class="sourceLineNo">306</span>     *                 显示数据的第 1 个字节对应 LCD 显示指定位置上半行的第 1 列，第 2 个字节对应上半行的第 2 列，……<a name="line.306"></a>
<span class="sourceLineNo">307</span>     *                 第 n+1 个字节对应 LCD 显示指定位置下半行的第 1 列，n+2 对应下半行的第 2 列，……<a name="line.307"></a>
<span class="sourceLineNo">308</span>     *                 点阵数据长度应小于等于 244。<a name="line.308"></a>
<span class="sourceLineNo">309</span>     *                 在显示时，如果显示点阵数据长度&lt;=244 但当前行显示不完(列号非 0)，则把多余的数据切掉，返回码<a name="line.309"></a>
<span class="sourceLineNo">310</span>     *                 为 OK。&lt;/div&gt;<a name="line.310"></a>
<span class="sourceLineNo">311</span>     * &lt;div class="en"&gt;Display dot matrix. Display the dot matrix at the specified position on the specified LCD.<a name="line.311"></a>
<span class="sourceLineNo">312</span>     *                 The LCD liquid crystal display has two lines, and each line is divided into upper and lower half lines.<a name="line.312"></a>
<span class="sourceLineNo">313</span>     *                 When sending dot matrix data, the data format should be: upper half line data (length n) + lower half line data (length n) = dot matrix data (length 2n).<a name="line.313"></a>
<span class="sourceLineNo">314</span>     *                 The first byte of the display data corresponds to LCD Display the first column of the upper half row of the specified position,<a name="line.314"></a>
<span class="sourceLineNo">315</span>     *                 the second byte corresponds to the second column of the upper half row, ... the n+1th byte corresponds to the first column of the lower half row of the LCD display specified position,<a name="line.315"></a>
<span class="sourceLineNo">316</span>     *                 n+2 Corresponding to the second column of the lower half of the row,... the length of the dot matrix data should be less than or equal to 244. During display,<a name="line.316"></a>
<span class="sourceLineNo">317</span>     *                 if the length of the displayed dot matrix data is less than 244 but the current line is not displayed completely (column number is not 0), the redundant data will be cut off, and the return code will be OK.&lt;/div&gt;<a name="line.317"></a>
<span class="sourceLineNo">318</span>     *<a name="line.318"></a>
<span class="sourceLineNo">319</span>     * @param x &lt;div class="zh"&gt;显示点阵在 LCD 上的起始点阵列号(单位：点)，0≤x&lt;122；&lt;/div&gt;<a name="line.319"></a>
<span class="sourceLineNo">320</span>     *          &lt;div class="en"&gt;Display the starting point array number of the dot matrix on the LCD (unit: dot), 0≤x&lt;122;&lt;/div&gt;<a name="line.320"></a>
<span class="sourceLineNo">321</span>     *<a name="line.321"></a>
<span class="sourceLineNo">322</span>     * @param y &lt;div class="zh"&gt;显示点阵在 LCD 上的行号(单位：行)。每行均为 16 点高的行，0—第一行，1--第二行。&lt;/div&gt;<a name="line.322"></a>
<span class="sourceLineNo">323</span>     *          &lt;div class="en"&gt;Display the line number (unit: line) of the dot matrix on the LCD. Each row is a 16-point high row, 0—the first row, and 1—the second row.&lt;/div&gt;<a name="line.323"></a>
<span class="sourceLineNo">324</span>     *<a name="line.324"></a>
<span class="sourceLineNo">325</span>     * @param data &lt;div class="zh"&gt;点阵数据。&lt;/div&gt;<a name="line.325"></a>
<span class="sourceLineNo">326</span>     *             &lt;div class="en"&gt;Dot matrix data.&lt;/div&gt;<a name="line.326"></a>
<span class="sourceLineNo">327</span>     *<a name="line.327"></a>
<span class="sourceLineNo">328</span>     * @throws TypeAException TypeAException<a name="line.328"></a>
<span class="sourceLineNo">329</span>     */<a name="line.329"></a>
<span class="sourceLineNo">330</span>    void showDotMatrix(byte x, byte y, byte[] data) throws TypeAException;<a name="line.330"></a>
<span class="sourceLineNo">331</span>    /**<a name="line.331"></a>
<span class="sourceLineNo">332</span>     * &lt;div class="zh"&gt;显示菜单或金额。<a name="line.332"></a>
<span class="sourceLineNo">333</span>     * &lt;br&gt;显示一段内容并等待输入，并返回该值（ASCII 码）。<a name="line.333"></a>
<span class="sourceLineNo">334</span>     * &lt;br&gt;当显示金额时，开始序号=0x3d（取消）;结束序号=0x3e（确认）。可以按 POS 上（取消）退出。<a name="line.334"></a>
<span class="sourceLineNo">335</span>     * &lt;/div&gt; &lt;div class="en"&gt;Display menu or amount.<a name="line.335"></a>
<span class="sourceLineNo">336</span>     * &lt;br&gt;Display a piece of content and wait for input, and return the value (ASCII code).<a name="line.336"></a>
<span class="sourceLineNo">337</span>     * &lt;br&gt;When the amount is displayed, the start serial number=0x3d (cancel); the end serial number=0x3e (confirm). You can press POS (Cancel) to exit.&lt;/div&gt;<a name="line.337"></a>
<span class="sourceLineNo">338</span>     *<a name="line.338"></a>
<span class="sourceLineNo">339</span>     * @param startNumber &lt;div class="zh"&gt;显示内容的开始序号；&lt;/div&gt;<a name="line.339"></a>
<span class="sourceLineNo">340</span>     *                    &lt;div class="en"&gt;The starting sequence number of the displayed content;&lt;/div&gt;<a name="line.340"></a>
<span class="sourceLineNo">341</span>     *<a name="line.341"></a>
<span class="sourceLineNo">342</span>     * @param endNumber &lt;div class="zh"&gt;显示内容的结束序号；&lt;/div&gt;<a name="line.342"></a>
<span class="sourceLineNo">343</span>     *                  &lt;div class="en"&gt;The ending sequence number of the displayed content;&lt;/div&gt;<a name="line.343"></a>
<span class="sourceLineNo">344</span>     *<a name="line.344"></a>
<span class="sourceLineNo">345</span>     * @param countLines &lt;div class="zh"&gt;显示内容的总行数；&lt;/div&gt;<a name="line.345"></a>
<span class="sourceLineNo">346</span>     *                   &lt;div class="en"&gt;The total number of lines of the displayed content;&lt;/div&gt;<a name="line.346"></a>
<span class="sourceLineNo">347</span>     *<a name="line.347"></a>
<span class="sourceLineNo">348</span>     * @param data &lt;div class="zh"&gt;为[行数][16BYTE]的数组。多页显示时用 F2，F3 翻页。&lt;/div&gt;<a name="line.348"></a>
<span class="sourceLineNo">349</span>     *             &lt;div class="en"&gt;It is an array of [number of rows] [16BYTE]. When multiple pages are displayed, use F2 and F3 to turn pages.&lt;/div&gt;<a name="line.349"></a>
<span class="sourceLineNo">350</span>     *<a name="line.350"></a>
<span class="sourceLineNo">351</span>     * @return &lt;div class="zh"&gt;返回的序号，在开始序号、结束序号之间&lt;/div&gt;<a name="line.351"></a>
<span class="sourceLineNo">352</span>     *         &lt;div class="en"&gt;The returned sequence number, between the start sequence number and the end sequence number&lt;/div&gt;<a name="line.352"></a>
<span class="sourceLineNo">353</span>     * @throws TypeAException TypeAException<a name="line.353"></a>
<span class="sourceLineNo">354</span>     */<a name="line.354"></a>
<span class="sourceLineNo">355</span>    byte showMenuOrAmount(byte startNumber, byte endNumber, byte countLines, byte[] data) throws TypeAException;<a name="line.355"></a>
<span class="sourceLineNo">356</span>    /**<a name="line.356"></a>
<span class="sourceLineNo">357</span>     * &lt;div class="zh"&gt;更换 LCD 显示缺省位图。<a name="line.357"></a>
<span class="sourceLineNo">358</span>     * &lt;br&gt;下载 LCD 显示位图，替代 LCD 缺省显示位图。<a name="line.358"></a>
<span class="sourceLineNo">359</span>     * &lt;br&gt;缺省的显示位图为如下两行字符：<a name="line.359"></a>
<span class="sourceLineNo">360</span>     * &lt;br&gt;WELCOME!<a name="line.360"></a>
<span class="sourceLineNo">361</span>     * &lt;br&gt;PAX TECHNOLOGY<a name="line.361"></a>
<span class="sourceLineNo">362</span>     * &lt;/div&gt; &lt;div class="en"&gt;Replace the LCD display default bitmap.<a name="line.362"></a>
<span class="sourceLineNo">363</span>     * &lt;br&gt;Download the LCD display bitmap to replace the LCD default display bitmap.<a name="line.363"></a>
<span class="sourceLineNo">364</span>     * &lt;br&gt;The default display bitmap is the following two lines of characters:<a name="line.364"></a>
<span class="sourceLineNo">365</span>     * &lt;br&gt;&gt;WELCOME!<a name="line.365"></a>
<span class="sourceLineNo">366</span>     * &lt;br&gt;PAX TECHNOLOGY&lt;/div&gt;<a name="line.366"></a>
<span class="sourceLineNo">367</span>     *<a name="line.367"></a>
<span class="sourceLineNo">368</span>     * @param mode &lt;div class="zh"&gt;<a name="line.368"></a>
<span class="sourceLineNo">369</span>     *             &lt;ul&gt;&lt;li&gt;mode = 1 替换位图 1（0 行显示的位图）&lt;/li&gt;<a name="line.369"></a>
<span class="sourceLineNo">370</span>     *              &lt;li&gt;mode = 2 替换位图 2（1 行显示的位图）&lt;/li&gt;<a name="line.370"></a>
<span class="sourceLineNo">371</span>     *              &lt;li&gt;mode = 0 恢复厂家缺省 LOG 图&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.371"></a>
<span class="sourceLineNo">372</span>     *             &lt;div class="en"&gt;<a name="line.372"></a>
<span class="sourceLineNo">373</span>     *             &lt;ul&gt;&lt;li&gt;mode = 1 Replace bitmap 1 (the bitmap displayed on line 0)&lt;/li&gt;<a name="line.373"></a>
<span class="sourceLineNo">374</span>     *              &lt;li&gt;mode = 2 Replace bitmap 2 (bitmap displayed in 1 row)&lt;/li&gt;<a name="line.374"></a>
<span class="sourceLineNo">375</span>     *              &lt;li&gt;mode = 0 Restore to factory default LOG chart&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.375"></a>
<span class="sourceLineNo">376</span>     *<a name="line.376"></a>
<span class="sourceLineNo">377</span>     * @param data &lt;div class="zh"&gt;位图数据的格式和显示点阵数据的格式一样。<a name="line.377"></a>
<span class="sourceLineNo">378</span>     * 上半行数据（n=122）+下半行数据（n=122）= 位图点阵数据（244）&lt;/div&gt;<a name="line.378"></a>
<span class="sourceLineNo">379</span>     *             &lt;div class="en"&gt;The format of bitmap data is the same as the format of displaying dot matrix data.<a name="line.379"></a>
<span class="sourceLineNo">380</span>     * Top half line data (n=122) + bottom half line data (n=122) = bitmap dot matrix data (244)&lt;/div&gt;<a name="line.380"></a>
<span class="sourceLineNo">381</span>     *<a name="line.381"></a>
<span class="sourceLineNo">382</span>     * @throws TypeAException TypeAException<a name="line.382"></a>
<span class="sourceLineNo">383</span>     */<a name="line.383"></a>
<span class="sourceLineNo">384</span>    void setLCDBitmap(byte mode, byte[] data) throws TypeAException;<a name="line.384"></a>
<span class="sourceLineNo">385</span>    /**<a name="line.385"></a>
<span class="sourceLineNo">386</span>     * &lt;div class="zh"&gt;密码键盘输入字符串。<a name="line.386"></a>
<span class="sourceLineNo">387</span>     * &lt;br&gt;将按键值以明码或者“*”的形式在 LCD 第二行的右下角显示出来，经过“确认”后，密码键盘将按键值全部返回给 POS 机。<a name="line.387"></a>
<span class="sourceLineNo">388</span>     * &lt;br&gt;密码键盘在收到该命令后，大陆版和越南版不在首行显示任何信息,如：“PLS INPUT PIN:”。香港版在首行显示任何信息,如：“PLS INPUT PIN:”。&lt;/div&gt;<a name="line.388"></a>
<span class="sourceLineNo">389</span>     * &lt;div class="en"&gt;Password keyboard input character string.<a name="line.389"></a>
<span class="sourceLineNo">390</span>     * &lt;br&gt;The key value is displayed in the lower right corner of the second line of the LCD in the form of clear code or "*".<a name="line.390"></a>
<span class="sourceLineNo">391</span>     * After "confirmation", the password keyboard will return all the key values to the POS machine.<a name="line.391"></a>
<span class="sourceLineNo">392</span>     * &lt;br&gt;After password keyboard received the order, the mainland version and Vietnam version will not display any information on the first line, such as: "PLS INPUT PIN:".<a name="line.392"></a>
<span class="sourceLineNo">393</span>     * The Hong Kong version displays any information on the first line, such as: "PLS INPUT PIN:".&lt;/div&gt;<a name="line.393"></a>
<span class="sourceLineNo">394</span>     *<a name="line.394"></a>
<span class="sourceLineNo">395</span>     * @param min &lt;div class="zh"&gt;字符串最小长度(为 0 时，按 ENTER 键返回，且输入长度 Len=0)&lt;/div&gt;<a name="line.395"></a>
<span class="sourceLineNo">396</span>     *            &lt;div class="en"&gt;The minimum length of the string (when it is 0, press ENTER to return, and enter the length Len=0)&lt;/div&gt;<a name="line.396"></a>
<span class="sourceLineNo">397</span>     *<a name="line.397"></a>
<span class="sourceLineNo">398</span>     * @param max &lt;div class="zh"&gt;字符串最大长度(小于等于 40 字节)&lt;/div&gt;<a name="line.398"></a>
<span class="sourceLineNo">399</span>     *            &lt;div class="en"&gt;Maximum string length (less than or equal to 40 bytes)&lt;/div&gt;<a name="line.399"></a>
<span class="sourceLineNo">400</span>     *<a name="line.400"></a>
<span class="sourceLineNo">401</span>     * @param mode &lt;div class="zh"&gt;0x00 显示明码；0x01 显示“*”号。&lt;/div&gt;<a name="line.401"></a>
<span class="sourceLineNo">402</span>     *             &lt;div class="en"&gt;0x00 displays plain code; 0x01 displays "*" sign.&lt;/div&gt;<a name="line.402"></a>
<span class="sourceLineNo">403</span>     *<a name="line.403"></a>
<span class="sourceLineNo">404</span>     * @return &lt;div class="zh"&gt;输入的字符串&lt;/div&gt;<a name="line.404"></a>
<span class="sourceLineNo">405</span>     *         &lt;div class="en"&gt;Input string&lt;/div&gt;<a name="line.405"></a>
<span class="sourceLineNo">406</span>     * @throws TypeAException TypeAException<a name="line.406"></a>
<span class="sourceLineNo">407</span>     */<a name="line.407"></a>
<span class="sourceLineNo">408</span>    String getInputString(byte min, byte max, byte mode) throws TypeAException;<a name="line.408"></a>
<span class="sourceLineNo">409</span>    /**<a name="line.409"></a>
<span class="sourceLineNo">410</span>     * &lt;div class="zh"&gt;输入金额。<a name="line.410"></a>
<span class="sourceLineNo">411</span>     * &lt;br&gt;等待输入金额，小数点自动增加在固定位置，经过“确认”后，密码键盘将所显示的值返回给 POS 机。&lt;/div&gt;<a name="line.411"></a>
<span class="sourceLineNo">412</span>     * &lt;div class="en"&gt;Enter the amount.<a name="line.412"></a>
<span class="sourceLineNo">413</span>     * &lt;br&gt;Waiting for the amount to be entered, the decimal point is automatically added to the fixed position,<a name="line.413"></a>
<span class="sourceLineNo">414</span>     * after "confirmation", the password keyboard will return the displayed value to the POS machine.&lt;/div&gt;<a name="line.414"></a>
<span class="sourceLineNo">415</span>     *<a name="line.415"></a>
<span class="sourceLineNo">416</span>     * @param min &lt;div class="zh"&gt;字符串最小长度(为 0 时，按 ENTER 键返回，且输入长度 Len=0)&lt;/div&gt;<a name="line.416"></a>
<span class="sourceLineNo">417</span>     *            &lt;div class="en"&gt;The minimum length of the string (when it is 0, press ENTER to return, and enter the length Len=0)&lt;/div&gt;<a name="line.417"></a>
<span class="sourceLineNo">418</span>     *<a name="line.418"></a>
<span class="sourceLineNo">419</span>     * @param max &lt;div class="zh"&gt;字符串最大长度(小于等于 16 字节)&lt;/div&gt;<a name="line.419"></a>
<span class="sourceLineNo">420</span>     *            &lt;div class="en"&gt;Maximum string length (less than or equal to 16 bytes)&lt;/div&gt;<a name="line.420"></a>
<span class="sourceLineNo">421</span>     *<a name="line.421"></a>
<span class="sourceLineNo">422</span>     * @param pointMode &lt;div class="zh"&gt;小数点方式，<a name="line.422"></a>
<span class="sourceLineNo">423</span>     *                  &lt;ul&gt;&lt;li&gt;0X00:小数点后有两位小数；&lt;/li&gt;<a name="line.423"></a>
<span class="sourceLineNo">424</span>     *                   &lt;li&gt;0X01:小数点后有三位小数；&lt;/li&gt;<a name="line.424"></a>
<span class="sourceLineNo">425</span>     *                   &lt;li&gt;0X02:无小数点（整数）；&lt;/li&gt;<a name="line.425"></a>
<span class="sourceLineNo">426</span>     *                   &lt;li&gt;0X03:小数点后有一位小数；&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.426"></a>
<span class="sourceLineNo">427</span>     *                  &lt;div class="en"&gt;Decimal point method,<a name="line.427"></a>
<span class="sourceLineNo">428</span>     *                  &lt;ul&gt;&lt;li&gt;0X00: There are two decimal places after the decimal point;&lt;/li&gt;<a name="line.428"></a>
<span class="sourceLineNo">429</span>     *                   &lt;li&gt;0X01: There are three decimal places after the decimal point;&lt;/li&gt;<a name="line.429"></a>
<span class="sourceLineNo">430</span>     *                   &lt;li&gt;0X02: No decimal point (integer);&lt;/li&gt;<a name="line.430"></a>
<span class="sourceLineNo">431</span>     *                   &lt;li&gt;0X03: There is one decimal place after the decimal point;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.431"></a>
<span class="sourceLineNo">432</span>     *<a name="line.432"></a>
<span class="sourceLineNo">433</span>     * @param prompMode &lt;div class="zh"&gt;无意义&lt;/div&gt;<a name="line.433"></a>
<span class="sourceLineNo">434</span>     *                  &lt;div class="en"&gt;Meaningless&lt;/div&gt;<a name="line.434"></a>
<span class="sourceLineNo">435</span>     *<a name="line.435"></a>
<span class="sourceLineNo">436</span>     * @return &lt;div class="zh"&gt;输入的金额字符串&lt;/div&gt;<a name="line.436"></a>
<span class="sourceLineNo">437</span>     *         &lt;div class="en"&gt;Entered amount string&lt;/div&gt;<a name="line.437"></a>
<span class="sourceLineNo">438</span>     * @throws TypeAException TypeAException<a name="line.438"></a>
<span class="sourceLineNo">439</span>     */<a name="line.439"></a>
<span class="sourceLineNo">440</span>    String getInputAmount(byte min, byte max, byte pointMode, byte prompMode) throws TypeAException;<a name="line.440"></a>
<span class="sourceLineNo">441</span>    /**<a name="line.441"></a>
<span class="sourceLineNo">442</span>     * &lt;div class="zh"&gt;密码键盘输入字符串[密文交互]<a name="line.442"></a>
<span class="sourceLineNo">443</span>     * &lt;br&gt;将按键值以明码或者“*”的形式在 LCD 第二行的右下角显示出来，经过“确认”后，密码键盘将按键值全部 返回给 POS 机。<a name="line.443"></a>
<span class="sourceLineNo">444</span>     * &lt;br&gt;大陆版和越南版本密码键盘在收到该命令后，不在首行显示任何信息,如：“PLS INPUT PIN:”。密码键盘回应的数据包中的DATA域由TXK加密。&lt;/div&gt;<a name="line.444"></a>
<span class="sourceLineNo">445</span>     * &lt;div class="en"&gt;Password keyboard input string [ciphertext interaction]<a name="line.445"></a>
<span class="sourceLineNo">446</span>     * &lt;br&gt;The key value is displayed in the lower right corner of the second line of the LCD in the form of clear code or "*".<a name="line.446"></a>
<span class="sourceLineNo">447</span>     * After "confirmation", the password keyboard will return all the key values to the POS machine.<a name="line.447"></a>
<span class="sourceLineNo">448</span>     * &lt;br&gt;After receiving this command, the mainland version and Vietnam version of the password keyboard will not display any information on the first line,<a name="line.448"></a>
<span class="sourceLineNo">449</span>     * such as: "PLS INPUT PIN:". The DATA field in the data packet responded by the password keyboard is encrypted by TXK.&lt;/div&gt;<a name="line.449"></a>
<span class="sourceLineNo">450</span>     *<a name="line.450"></a>
<span class="sourceLineNo">451</span>     * @param min &lt;div class="zh"&gt;字符串最小长度(为 0 时，按 ENTER 键返回，且输入长度 Len=0)&lt;/div&gt;<a name="line.451"></a>
<span class="sourceLineNo">452</span>     *            &lt;div class="en"&gt;The minimum length of the string (when it is 0, press ENTER to return, and enter the length Len=0)&lt;/div&gt;<a name="line.452"></a>
<span class="sourceLineNo">453</span>     *<a name="line.453"></a>
<span class="sourceLineNo">454</span>     * @param max &lt;div class="zh"&gt;字符串最大长度(小于等于 40 字节)&lt;/div&gt;<a name="line.454"></a>
<span class="sourceLineNo">455</span>     *            &lt;div class="en"&gt;Maximum string length (less than or equal to 40 bytes)&lt;/div&gt;<a name="line.455"></a>
<span class="sourceLineNo">456</span>     *<a name="line.456"></a>
<span class="sourceLineNo">457</span>     * @param mode &lt;div class="zh"&gt;0x00: 显示明码；<a name="line.457"></a>
<span class="sourceLineNo">458</span>     *                            &lt;br&gt;0x01: 显示“*”号。&lt;/div&gt;<a name="line.458"></a>
<span class="sourceLineNo">459</span>     *             &lt;div class="en"&gt;0x00: Display plain code;<a name="line.459"></a>
<span class="sourceLineNo">460</span>     *                            &lt;br&gt;0x01: Display "*" sign.&lt;/div&gt;<a name="line.460"></a>
<span class="sourceLineNo">461</span>     *<a name="line.461"></a>
<span class="sourceLineNo">462</span>     * @return  &lt;div class="zh"&gt;输入的字符串&lt;/div&gt;<a name="line.462"></a>
<span class="sourceLineNo">463</span>     *          &lt;div class=“en"&gt;Input string&lt;/div&gt;<a name="line.463"></a>
<span class="sourceLineNo">464</span>     * @throws TypeAException TypeAException<a name="line.464"></a>
<span class="sourceLineNo">465</span>     */<a name="line.465"></a>
<span class="sourceLineNo">466</span>    String getInputCipherString(byte min, byte max, byte mode) throws TypeAException;<a name="line.466"></a>
<span class="sourceLineNo">467</span>    /**<a name="line.467"></a>
<span class="sourceLineNo">468</span>     * &lt;div class="zh"&gt;按键缓冲区。<a name="line.468"></a>
<span class="sourceLineNo">469</span>     * &lt;br&gt;1.设置为清空按键缓冲区，则用户输入密码前会对按键缓冲区做一次清空(默认) 。<a name="line.469"></a>
<span class="sourceLineNo">470</span>     * &lt;br&gt;2.设置为不清空按键缓冲区，则发送该命令后的按键缓冲不做清除，发送该命令前的按键缓冲区会做 一次清除。&lt;/div&gt;<a name="line.470"></a>
<span class="sourceLineNo">471</span>     * &lt;div class="en"&gt;Key buffer.<a name="line.471"></a>
<span class="sourceLineNo">472</span>     * &lt;br&gt;1. Set to clear the key buffer, then the key buffer will be cleared once before the user enters the password (default).<a name="line.472"></a>
<span class="sourceLineNo">473</span>     * &lt;br&gt;2. If it is set to not clear the key buffer, the key buffer after sending this command will not be cleared,<a name="line.473"></a>
<span class="sourceLineNo">474</span>     *        and the key buffer before sending this command will be cleared once.&lt;/div&gt;<a name="line.474"></a>
<span class="sourceLineNo">475</span>     *<a name="line.475"></a>
<span class="sourceLineNo">476</span>     * @param mode &lt;div class="zh"&gt;0：不清空按键缓冲区<a name="line.476"></a>
<span class="sourceLineNo">477</span>     *                           &lt;br&gt;1：清空按键缓冲区&lt;/div&gt;<a name="line.477"></a>
<span class="sourceLineNo">478</span>     *             &lt;div class="en"&gt;0: Do not clear the key buffer<a name="line.478"></a>
<span class="sourceLineNo">479</span>     *                            &lt;br&gt; 1: Clear the key buffer&lt;/div&gt;<a name="line.479"></a>
<span class="sourceLineNo">480</span>     * @throws TypeAException TypeAException<a name="line.480"></a>
<span class="sourceLineNo">481</span>     */<a name="line.481"></a>
<span class="sourceLineNo">482</span>    void clearKeyBuffer(byte mode) throws TypeAException;<a name="line.482"></a>
<span class="sourceLineNo">483</span>    /**<a name="line.483"></a>
<span class="sourceLineNo">484</span>     * &lt;div class="zh"&gt;获取当前按键缓冲区(非 PIN 输入状态下)的按键值。&lt;/div&gt;<a name="line.484"></a>
<span class="sourceLineNo">485</span>     * &lt;div class="en"&gt;Get the key value of the current key buffer (in non-PIN input state).&lt;/div&gt;<a name="line.485"></a>
<span class="sourceLineNo">486</span>     *<a name="line.486"></a>
<span class="sourceLineNo">487</span>     * @return {@link EKeyCode}<a name="line.487"></a>
<span class="sourceLineNo">488</span>     * @throws TypeAException TypeAException<a name="line.488"></a>
<span class="sourceLineNo">489</span>     */<a name="line.489"></a>
<span class="sourceLineNo">490</span>    EKeyCode getKey() throws TypeAException;<a name="line.490"></a>
<span class="sourceLineNo">491</span>    /**<a name="line.491"></a>
<span class="sourceLineNo">492</span>     * &lt;div class="zh"&gt;传送主密钥或 DES 密钥。<a name="line.492"></a>
<span class="sourceLineNo">493</span>     * &lt;br&gt;按照 mode 方式将 Key 存储在主密钥区或 DES 密钥区的指定（KeyID）位置。&lt;/div&gt;<a name="line.493"></a>
<span class="sourceLineNo">494</span>     * &lt;div class="en"&gt;Transfer the master key or DES key.<a name="line.494"></a>
<span class="sourceLineNo">495</span>     * &lt;br&gt;Store the Key in the designated (KeyID) location of the master key area or DES key area according to mode.&lt;/div&gt;<a name="line.495"></a>
<span class="sourceLineNo">496</span>     *<a name="line.496"></a>
<span class="sourceLineNo">497</span>     * @param keyIndex &lt;div class="zh"&gt;最高位[bit7]来区分主密钥和 DES 密钥的索引，为 0 表示为主密钥索引，为 1 表示 DES 密钥索引。(使用时DES密钥索引最高位[bit7]为0)<a name="line.497"></a>
<span class="sourceLineNo">498</span>     *                  &lt;br&gt;KeyID=0xxxxxxxb 主密钥区的密钥索引<a name="line.498"></a>
<span class="sourceLineNo">499</span>     *                  &lt;br&gt;KeyID=1xxxxxxxb DES 密钥区的索引&lt;/div&gt;<a name="line.499"></a>
<span class="sourceLineNo">500</span>     *                 &lt;div class="en"&gt;The most significant bit [bit7] distinguishes the index of the master key and the DES key, 0 means the master key index,<a name="line.500"></a>
<span class="sourceLineNo">501</span>     *                 and 1 means the DES key index.(The highest bit of the DES key index [bit7] is 0 when in use)<a name="line.501"></a>
<span class="sourceLineNo">502</span>     *                  &lt;br&gt;KeyID=0xxxxxxxb The key index of the master key zone<a name="line.502"></a>
<span class="sourceLineNo">503</span>     *                  &lt;br&gt;KeyID=1xxxxxxxb DES key area index&lt;/div&gt;<a name="line.503"></a>
<span class="sourceLineNo">504</span>     *<a name="line.504"></a>
<span class="sourceLineNo">505</span>     * @param mode &lt;div class="zh"&gt;<a name="line.505"></a>
<span class="sourceLineNo">506</span>     *             &lt;ul&gt;&lt;li&gt;mode=0x01 单 DES 密钥， len=10；&lt;/li&gt;<a name="line.506"></a>
<span class="sourceLineNo">507</span>     *              &lt;li&gt;mode=0x03 3 倍 DES 密钥， len=18；&lt;/li&gt;<a name="line.507"></a>
<span class="sourceLineNo">508</span>     *              &lt;li&gt;mode=0x07 3 倍 DES 密钥， len=26；&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.508"></a>
<span class="sourceLineNo">509</span>     *             &lt;div class="en"&gt;<a name="line.509"></a>
<span class="sourceLineNo">510</span>     *              &lt;ul&gt;&lt;li&gt;mode=0x01 single DES key, len=10;&lt;/li&gt;<a name="line.510"></a>
<span class="sourceLineNo">511</span>     *               &lt;li&gt;mode=0x03 3 times the DES key, len=18;&lt;/li&gt;<a name="line.511"></a>
<span class="sourceLineNo">512</span>     *               &lt;li&gt;mode=0x07 3 times the DES key, len=26;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.512"></a>
<span class="sourceLineNo">513</span>     *<a name="line.513"></a>
<span class="sourceLineNo">514</span>     * @param plainKeyValue &lt;div class="zh"&gt;密钥值(8 字节或 16 字节或者 24 字节)。&lt;/div&gt;<a name="line.514"></a>
<span class="sourceLineNo">515</span>     *                      &lt;div class="en"&gt;Key value (8 bytes or 16 bytes or 24 bytes).&lt;/div&gt;<a name="line.515"></a>
<span class="sourceLineNo">516</span>     * @throws TypeAException TypeAException<a name="line.516"></a>
<span class="sourceLineNo">517</span>     */<a name="line.517"></a>
<span class="sourceLineNo">518</span>    void writePlainKey(byte keyIndex, byte mode, byte[] plainKeyValue) throws TypeAException;<a name="line.518"></a>
<span class="sourceLineNo">519</span>    /**<a name="line.519"></a>
<span class="sourceLineNo">520</span>     * &lt;div class="zh"&gt;密文传送主密钥或 DES 密钥。<a name="line.520"></a>
<span class="sourceLineNo">521</span>     * &lt;br&gt;将 Key 存储在主密钥区或 DES 密钥区的指定（KeyID）位置。DATA 由 TXK 加密。&lt;/div&gt;<a name="line.521"></a>
<span class="sourceLineNo">522</span>     * &lt;div class="en"&gt;The master key or DES key is transmitted in cipher text.<a name="line.522"></a>
<span class="sourceLineNo">523</span>     * &lt;br&gt;Store the Key in the designated (KeyID) location of the master key area or DES key area. DATA is encrypted by TXK.&lt;/div&gt;<a name="line.523"></a>
<span class="sourceLineNo">524</span>     *<a name="line.524"></a>
<span class="sourceLineNo">525</span>     * @param cipherKeyValue &lt;div class="zh"&gt;由 TXK 加密。<a name="line.525"></a>
<span class="sourceLineNo">526</span>     *                       &lt;table border="1"&gt;<a name="line.526"></a>
<span class="sourceLineNo">527</span>     *                   &lt;tr&gt;<a name="line.527"></a>
<span class="sourceLineNo">528</span>     *                    &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.528"></a>
<span class="sourceLineNo">529</span>     *                    &lt;th&gt;长度（byte）&lt;/th&gt;<a name="line.529"></a>
<span class="sourceLineNo">530</span>     *                    &lt;th&gt;变量名称&lt;/th&gt;<a name="line.530"></a>
<span class="sourceLineNo">531</span>     *                    &lt;th&gt;意义&lt;/th&gt;<a name="line.531"></a>
<span class="sourceLineNo">532</span>     *                   &lt;/tr&gt;<a name="line.532"></a>
<span class="sourceLineNo">533</span>     *                   &lt;tr&gt;<a name="line.533"></a>
<span class="sourceLineNo">534</span>     *                       &lt;td&gt;0x0000&lt;/td&gt;<a name="line.534"></a>
<span class="sourceLineNo">535</span>     *                       &lt;td&gt;1&lt;/td&gt;<a name="line.535"></a>
<span class="sourceLineNo">536</span>     *                       &lt;td&gt;keyIndex&lt;/td&gt;<a name="line.536"></a>
<span class="sourceLineNo">537</span>     *                       &lt;td&gt;1－100<a name="line.537"></a>
<span class="sourceLineNo">538</span>     *                           &lt;br&gt;KeyID=0xxxxxxxb 主密钥区的密钥索引<a name="line.538"></a>
<span class="sourceLineNo">539</span>     *                           &lt;br&gt;KeyID=1xxxxxxxb DES 密钥区的索引&lt;/td&gt;<a name="line.539"></a>
<span class="sourceLineNo">540</span>     *                   &lt;/tr&gt;<a name="line.540"></a>
<span class="sourceLineNo">541</span>     *                   &lt;tr&gt;<a name="line.541"></a>
<span class="sourceLineNo">542</span>     *                       &lt;td&gt;0x0001&lt;/td&gt;<a name="line.542"></a>
<span class="sourceLineNo">543</span>     *                       &lt;td&gt;1&lt;/td&gt;<a name="line.543"></a>
<span class="sourceLineNo">544</span>     *                       &lt;td&gt;keyLen&lt;/td&gt;<a name="line.544"></a>
<span class="sourceLineNo">545</span>     *                       &lt;td&gt;8、16 或 24，&lt;/td&gt;<a name="line.545"></a>
<span class="sourceLineNo">546</span>     *                   &lt;/tr&gt;<a name="line.546"></a>
<span class="sourceLineNo">547</span>     *                   &lt;tr&gt;<a name="line.547"></a>
<span class="sourceLineNo">548</span>     *                       &lt;td&gt;0x0002&lt;/td&gt;<a name="line.548"></a>
<span class="sourceLineNo">549</span>     *                       &lt;td&gt;N&lt;/td&gt;<a name="line.549"></a>
<span class="sourceLineNo">550</span>     *                       &lt;td&gt;key&lt;/td&gt;<a name="line.550"></a>
<span class="sourceLineNo">551</span>     *                       &lt;td&gt;key&lt;/td&gt;<a name="line.551"></a>
<span class="sourceLineNo">552</span>     *                   &lt;/tr&gt;<a name="line.552"></a>
<span class="sourceLineNo">553</span>     *                   &lt;tr&gt;<a name="line.553"></a>
<span class="sourceLineNo">554</span>     *                       &lt;td&gt;0x0002+N&lt;/td&gt;<a name="line.554"></a>
<span class="sourceLineNo">555</span>     *                       &lt;td&gt;M&lt;/td&gt;<a name="line.555"></a>
<span class="sourceLineNo">556</span>     *                       &lt;td&gt;Fill&lt;/td&gt;<a name="line.556"></a>
<span class="sourceLineNo">557</span>     *                       &lt;td&gt;填充字节，以上数据长度不被 8 字节整除时，填充至 8 字节整除的个数。&lt;/td&gt;<a name="line.557"></a>
<span class="sourceLineNo">558</span>     *                   &lt;/tr&gt;<a name="line.558"></a>
<span class="sourceLineNo">559</span>     *<a name="line.559"></a>
<span class="sourceLineNo">560</span>     *                      &lt;/table&gt;&lt;/div&gt;<a name="line.560"></a>
<span class="sourceLineNo">561</span>     *                       &lt;div class="en"&gt;Encrypted by TXK.<a name="line.561"></a>
<span class="sourceLineNo">562</span>     *                            &lt;table border="1"&gt;<a name="line.562"></a>
<span class="sourceLineNo">563</span>     *                        &lt;tr&gt;<a name="line.563"></a>
<span class="sourceLineNo">564</span>     *                         &lt;th&gt;Offset&lt;/th&gt;<a name="line.564"></a>
<span class="sourceLineNo">565</span>     *                         &lt;th&gt;Length (byte)&lt;/th&gt;<a name="line.565"></a>
<span class="sourceLineNo">566</span>     *                         &lt;th&gt;Variable name&lt;/th&gt;<a name="line.566"></a>
<span class="sourceLineNo">567</span>     *                         &lt;th&gt;Description&lt;/th&gt;<a name="line.567"></a>
<span class="sourceLineNo">568</span>     *                        &lt;/tr&gt;<a name="line.568"></a>
<span class="sourceLineNo">569</span>     *                        &lt;tr&gt;<a name="line.569"></a>
<span class="sourceLineNo">570</span>     *                            &lt;td&gt;0x0000&lt;/td&gt;<a name="line.570"></a>
<span class="sourceLineNo">571</span>     *                            &lt;td&gt;1&lt;/td&gt;<a name="line.571"></a>
<span class="sourceLineNo">572</span>     *                            &lt;td&gt;keyIndex&lt;/td&gt;<a name="line.572"></a>
<span class="sourceLineNo">573</span>     *                            &lt;td&gt;1－100<a name="line.573"></a>
<span class="sourceLineNo">574</span>     *                                &lt;br&gt;KeyID=0xxxxxxxb Key index of the master key area<a name="line.574"></a>
<span class="sourceLineNo">575</span>     *                                &lt;br&gt;KeyID=1xxxxxxxb key index of DES key&lt;/td&gt;<a name="line.575"></a>
<span class="sourceLineNo">576</span>     *                        &lt;/tr&gt;<a name="line.576"></a>
<span class="sourceLineNo">577</span>     *                        &lt;tr&gt;<a name="line.577"></a>
<span class="sourceLineNo">578</span>     *                            &lt;td&gt;0x0001&lt;/td&gt;<a name="line.578"></a>
<span class="sourceLineNo">579</span>     *                            &lt;td&gt;1&lt;/td&gt;<a name="line.579"></a>
<span class="sourceLineNo">580</span>     *                            &lt;td&gt;keyLen&lt;/td&gt;<a name="line.580"></a>
<span class="sourceLineNo">581</span>     *                            &lt;td&gt;8、16 or 24，&lt;/td&gt;<a name="line.581"></a>
<span class="sourceLineNo">582</span>     *                        &lt;/tr&gt;<a name="line.582"></a>
<span class="sourceLineNo">583</span>     *                        &lt;tr&gt;<a name="line.583"></a>
<span class="sourceLineNo">584</span>     *                            &lt;td&gt;0x0002&lt;/td&gt;<a name="line.584"></a>
<span class="sourceLineNo">585</span>     *                            &lt;td&gt;N&lt;/td&gt;<a name="line.585"></a>
<span class="sourceLineNo">586</span>     *                            &lt;td&gt;key&lt;/td&gt;<a name="line.586"></a>
<span class="sourceLineNo">587</span>     *                            &lt;td&gt;key&lt;/td&gt;<a name="line.587"></a>
<span class="sourceLineNo">588</span>     *                        &lt;/tr&gt;<a name="line.588"></a>
<span class="sourceLineNo">589</span>     *                        &lt;tr&gt;<a name="line.589"></a>
<span class="sourceLineNo">590</span>     *                            &lt;td&gt;0x0002+N&lt;/td&gt;<a name="line.590"></a>
<span class="sourceLineNo">591</span>     *                            &lt;td&gt;M&lt;/td&gt;<a name="line.591"></a>
<span class="sourceLineNo">592</span>     *                            &lt;td&gt;Fill&lt;/td&gt;<a name="line.592"></a>
<span class="sourceLineNo">593</span>     *                            &lt;td&gt;Filling bytes, when the above data length is not evenly divisible by 8 bytes, it is filled to the number evenly divisible by 8 bytes.&lt;/td&gt;<a name="line.593"></a>
<span class="sourceLineNo">594</span>     *                        &lt;/tr&gt;<a name="line.594"></a>
<span class="sourceLineNo">595</span>     *<a name="line.595"></a>
<span class="sourceLineNo">596</span>     *                           &lt;/table&gt;&lt;/div&gt;<a name="line.596"></a>
<span class="sourceLineNo">597</span>     * @throws TypeAException TypeAException<a name="line.597"></a>
<span class="sourceLineNo">598</span>     */<a name="line.598"></a>
<span class="sourceLineNo">599</span>    void writeCipherKey(byte[] cipherKeyValue) throws TypeAException;<a name="line.599"></a>
<span class="sourceLineNo">600</span>    /**<a name="line.600"></a>
<span class="sourceLineNo">601</span>     * &lt;div class="zh"&gt;写入工作密钥。<a name="line.601"></a>
<span class="sourceLineNo">602</span>     * &lt;br&gt;通常用来写入 PIN-BLOCK 生成和 MAC 运算的密钥。用 srcKeyIndex 指定的主密钥对 keyValue 进行 mode 指定方式的加密或解密后，将结果存储在 keyIndex 指定的工作密钥区位置。如果 srcKeyIndex 为 0，则不对 keyValue 进行加密或解密，而直接将 keyValue 存储在工作密钥区的keyIndex 指定的位置。&lt;/div&gt;<a name="line.602"></a>
<span class="sourceLineNo">603</span>     * &lt;div class="en"&gt;Write the work key.<a name="line.603"></a>
<span class="sourceLineNo">604</span>     * &lt;br&gt;It is usually used to write the key for PIN-BLOCK generation and MAC operation. Use the master key specified by srcKeyIndex to encrypt or decrypt keyValue in the mode specified by mode, and store the result in the working key area specified by keyIndex. If srcKeyIndex is 0, the keyValue is not encrypted or decrypted, and the keyValue is directly stored in the location specified by the keyIndex of the working key area.&lt;/div&gt;<a name="line.604"></a>
<span class="sourceLineNo">605</span>     *<a name="line.605"></a>
<span class="sourceLineNo">606</span>     * @param srcKeyIndex &lt;div class="zh"&gt;主密钥索引号，该密钥将用作生成工作密钥明文加/解密运算的密钥。&lt;/div&gt;<a name="line.606"></a>
<span class="sourceLineNo">607</span>     *                    &lt;div class="en"&gt;The index number of the master key, which will be used as the key for the plaintext encryption/decryption operation to generate the working key.&lt;/div&gt;<a name="line.607"></a>
<span class="sourceLineNo">608</span>     *<a name="line.608"></a>
<span class="sourceLineNo">609</span>     * @param destKeyIndex &lt;div class="zh"&gt;工作密钥索引号，传入的密钥值密文经过 mode 指定的运算后，生成明文，该明文将写入该索引号对应的密钥位置。当 srcKeyIndex 为 0 时，传入的密钥值为明文，无需运算；mode 的设置仅指示长度。&lt;/div&gt;<a name="line.609"></a>
<span class="sourceLineNo">610</span>     *                     &lt;div class="en"&gt;Working key index number. After the passed-in key value ciphertext undergoes the operation specified by mode, a plaintext is generated, and the plaintext will be written into the key position corresponding to the index number. When srcKeyIndex is 0, the key value passed in is plain text, no operation is required; the setting of mode only indicates the length.&lt;/div&gt;<a name="line.610"></a>
<span class="sourceLineNo">611</span>     *<a name="line.611"></a>
<span class="sourceLineNo">612</span>     * @param mode &lt;div class="zh"&gt;指示最终工作密钥明文的生成运算方式，取值共有 16 种，具体如下所示，<a name="line.612"></a>
<span class="sourceLineNo">613</span>     *             &lt;ul&gt;<a name="line.613"></a>
<span class="sourceLineNo">614</span>     *             &lt;li&gt;0x01-- DES 加密&lt;/li&gt;<a name="line.614"></a>
<span class="sourceLineNo">615</span>     *             &lt;li&gt;0x81-- DES 解密<a name="line.615"></a>
<span class="sourceLineNo">616</span>     *             &lt;br&gt;srcdestKeyIndex 与 destKeyIndex 均为单 DES/ 8 字节密钥，Len＝11。&lt;/li&gt;<a name="line.616"></a>
<span class="sourceLineNo">617</span>     *             &lt;li&gt;0x03-- 3DES 加密&lt;/li&gt;<a name="line.617"></a>
<span class="sourceLineNo">618</span>     *             &lt;li&gt;0x31-- 3DES 加密&lt;/li&gt;<a name="line.618"></a>
<span class="sourceLineNo">619</span>     *             &lt;li&gt;0x83-- 3DES 解密&lt;/li&gt;<a name="line.619"></a>
<span class="sourceLineNo">620</span>     *             &lt;li&gt;0xb1-- 3DES 解密<a name="line.620"></a>
<span class="sourceLineNo">621</span>     *             &lt;br&gt;srcdestKeyIndex 为 3DES/16 字节密钥，destKeyIndex 为单 DES/8 字节密钥，Len＝11。&lt;/li&gt;<a name="line.621"></a>
<span class="sourceLineNo">622</span>     *             &lt;li&gt;0x07-- 3DES 加密&lt;/li&gt;<a name="line.622"></a>
<span class="sourceLineNo">623</span>     *             &lt;li&gt;0x87-- 3DES 解密<a name="line.623"></a>
<span class="sourceLineNo">624</span>     *             &lt;br&gt;srcdestKeyIndex 为 3DES/24 字节密钥，destKeyIndex 为单 DES/8 字节密钥，Len＝11。&lt;/li&gt;<a name="line.624"></a>
<span class="sourceLineNo">625</span>     *             &lt;li&gt;0x33-- 3DES 加密&lt;/li&gt;<a name="line.625"></a>
<span class="sourceLineNo">626</span>     *             &lt;li&gt;0xb3-- 3DES 解密<a name="line.626"></a>
<span class="sourceLineNo">627</span>     *             &lt;br&gt;srcdestKeyIndex 与 destKeyIndex 均为 3DES/16 字节密钥，Len＝19。&lt;/li&gt;<a name="line.627"></a>
<span class="sourceLineNo">628</span>     *             &lt;li&gt;0x71-- 3DES 加密&lt;/li&gt;<a name="line.628"></a>
<span class="sourceLineNo">629</span>     *             &lt;li&gt;0xf1-- 3DES 解密<a name="line.629"></a>
<span class="sourceLineNo">630</span>     *             &lt;br&gt;srcdestKeyIndex 为 3DES/24 字节密钥, destKeyIndex 为单 DES/8 字节密钥，Len＝11。&lt;/li&gt;<a name="line.630"></a>
<span class="sourceLineNo">631</span>     *             &lt;li&gt;0x73-- 3DES 加密&lt;/li&gt;<a name="line.631"></a>
<span class="sourceLineNo">632</span>     *             &lt;li&gt;0xf3-- 3DES 解密<a name="line.632"></a>
<span class="sourceLineNo">633</span>     *             &lt;br&gt;srcdestKeyIndex 为 3DES/24 字节密钥, destKeyIndex 为 3DES－16 字节密钥，Len＝19。&lt;/li&gt;<a name="line.633"></a>
<span class="sourceLineNo">634</span>     *             &lt;li&gt;0x77-- 3DES 加密&lt;/li&gt;<a name="line.634"></a>
<span class="sourceLineNo">635</span>     *             &lt;li&gt;0xf7-- 3DES 解密<a name="line.635"></a>
<span class="sourceLineNo">636</span>     *             &lt;br&gt;srcdestKeyIndex 与 destKeyIndex 均为 3DES/24 字节密钥，Len＝27。&lt;/li&gt;<a name="line.636"></a>
<span class="sourceLineNo">637</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.637"></a>
<span class="sourceLineNo">638</span>     *             &lt;div class="en"&gt;Indicate the calculation method for generating the final working key plaintext. There are 16 values in total, as shown below.<a name="line.638"></a>
<span class="sourceLineNo">639</span>     *             &lt;ul&gt;<a name="line.639"></a>
<span class="sourceLineNo">640</span>     *             &lt;li&gt;0x01-- DES encryption&lt;/li&gt;<a name="line.640"></a>
<span class="sourceLineNo">641</span>     *             &lt;li&gt;0x81-- DES decrypt<a name="line.641"></a>
<span class="sourceLineNo">642</span>     *             &lt;br&gt;Both srcdestKeyIndex and destKeyIndex are single DES/8-byte keys, Len=11.&lt;/li&gt;<a name="line.642"></a>
<span class="sourceLineNo">643</span>     *             &lt;li&gt;0x03-- 3DES encryption&lt;/li&gt;<a name="line.643"></a>
<span class="sourceLineNo">644</span>     *             &lt;li&gt;0x31-- 3DES encryption&lt;/li&gt;<a name="line.644"></a>
<span class="sourceLineNo">645</span>     *             &lt;li&gt;0x83-- 3DES decryption&lt;/li&gt;<a name="line.645"></a>
<span class="sourceLineNo">646</span>     *             &lt;li&gt;0xb1-- 3DES decryption<a name="line.646"></a>
<span class="sourceLineNo">647</span>     *             &lt;br&gt;srcdestKeyIndex is a 3DES/16 byte key, destKeyIndex is a single DES/8 byte key, Len=11.&lt;/li&gt;<a name="line.647"></a>
<span class="sourceLineNo">648</span>     *             &lt;li&gt;0x07-- 3DES encryption&lt;/li&gt;<a name="line.648"></a>
<span class="sourceLineNo">649</span>     *             &lt;li&gt;0x87-- 3DES decryption<a name="line.649"></a>
<span class="sourceLineNo">650</span>     *             &lt;br&gt;srcdestKeyIndex is a 3DES/24-byte key, destKeyIndex is a single DES/8-byte key, Len=11.&lt;/li&gt;<a name="line.650"></a>
<span class="sourceLineNo">651</span>     *             &lt;li&gt;0x33-- 3DES encryption&lt;/li&gt;<a name="line.651"></a>
<span class="sourceLineNo">652</span>     *             &lt;li&gt;0xb3-- 3DES decryption<a name="line.652"></a>
<span class="sourceLineNo">653</span>     *             &lt;br&gt;Both srcdestKeyIndex and destKeyIndex are 3DES/16 byte keys, Len=19.&lt;/li&gt;<a name="line.653"></a>
<span class="sourceLineNo">654</span>     *             &lt;li&gt;0x71-- 3DES encryption&lt;/li&gt;<a name="line.654"></a>
<span class="sourceLineNo">655</span>     *             &lt;li&gt;0xf1-- 3DES decrypt<a name="line.655"></a>
<span class="sourceLineNo">656</span>     *             &lt;br&gt;srcdestKeyIndex is a 3DES/24-byte key, destKeyIndex is a single DES/8-byte key, Len=11.&lt;/li&gt;<a name="line.656"></a>
<span class="sourceLineNo">657</span>     *             &lt;li&gt;0x73-- 3DES encryption&lt;/li&gt;<a name="line.657"></a>
<span class="sourceLineNo">658</span>     *             &lt;li&gt;0xf3-- 3DES decryption<a name="line.658"></a>
<span class="sourceLineNo">659</span>     *             &lt;br&gt;srcdestKeyIndex is a 3DES/24 byte key, destKeyIndex is a 3DES-16 byte key, Len=19.&lt;/li&gt;<a name="line.659"></a>
<span class="sourceLineNo">660</span>     *             &lt;li&gt;0x77-- 3DES encryption&lt;/li&gt;<a name="line.660"></a>
<span class="sourceLineNo">661</span>     *             &lt;li&gt;0xf7-- 3DES decryption<a name="line.661"></a>
<span class="sourceLineNo">662</span>     *             &lt;br&gt;Both srcdestKeyIndex and destKeyIndex are 3DES/24-byte keys, Len=27.&lt;/li&gt;<a name="line.662"></a>
<span class="sourceLineNo">663</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.663"></a>
<span class="sourceLineNo">664</span>     *<a name="line.664"></a>
<span class="sourceLineNo">665</span>     * @param keyValue &lt;div class="zh"&gt;需写入的密钥值(8、16 或 24 字节, 由 mode 决定)。&lt;/div&gt;<a name="line.665"></a>
<span class="sourceLineNo">666</span>     *                 &lt;div class="en"&gt;The key value to be written (8, 16 or 24 bytes, determined by mode).&lt;/div&gt;<a name="line.666"></a>
<span class="sourceLineNo">667</span>     * @throws TypeAException TypeAException<a name="line.667"></a>
<span class="sourceLineNo">668</span>     */<a name="line.668"></a>
<span class="sourceLineNo">669</span>    void writeTWK(byte srcKeyIndex, byte destKeyIndex, byte mode, byte[] keyValue) throws TypeAException;<a name="line.669"></a>
<span class="sourceLineNo">670</span>    /**<a name="line.670"></a>
<span class="sourceLineNo">671</span>     * &lt;div class="zh"&gt;发散密钥。<a name="line.671"></a>
<span class="sourceLineNo">672</span>     * &lt;br&gt;用derivedKeyIndex指定的主密钥或工作密钥对 srcKeyIndex 指定的工作密钥进行 mode 方式的加密或解密后，将 结果存储在工作密钥区的 destKeyIndex 指定的位置。&lt;/div&gt;<a name="line.672"></a>
<span class="sourceLineNo">673</span>     * &lt;div class="en"&gt;Diverge the key.<a name="line.673"></a>
<span class="sourceLineNo">674</span>     * &lt;br&gt;After using the master key or working key specified by derivedKeyIndex to encrypt or decrypt the working key specified by srcKeyIndex in mode, the result is stored in the location specified by destKeyIndex in the working key area.&lt;/div&gt;<a name="line.674"></a>
<span class="sourceLineNo">675</span>     *<a name="line.675"></a>
<span class="sourceLineNo">676</span>     * @param derivedKeyIndex &lt;div class="zh"&gt;用来对 srcKeyIndex指定的工作密钥进行 mode 方式运算的主密钥或工作密钥索引。<a name="line.676"></a>
<span class="sourceLineNo">677</span>     * &lt;br&gt;= 0xxxxxxxb 时，用主密钥来发散<a name="line.677"></a>
<span class="sourceLineNo">678</span>     * &lt;br&gt;= 1xxxxxxxb 时，用工作密钥来发散。&lt;/div&gt;<a name="line.678"></a>
<span class="sourceLineNo">679</span>     *                        &lt;div class="en"&gt;The master key or working key index used to perform mode operation on the working key specified by srcKeyIndex.<a name="line.679"></a>
<span class="sourceLineNo">680</span>     * &lt;br&gt;= 0xxxxxxxb, use the master key to diverge<a name="line.680"></a>
<span class="sourceLineNo">681</span>     * &lt;br&gt;= 1xxxxxxxb, use the working key to diverge.&lt;/div&gt;<a name="line.681"></a>
<span class="sourceLineNo">682</span>     *<a name="line.682"></a>
<span class="sourceLineNo">683</span>     * @param srcKeyIndex &lt;div class="zh"&gt;需进行分散的工作密钥的索引。&lt;/div&gt;<a name="line.683"></a>
<span class="sourceLineNo">684</span>     *                    &lt;div class="en"&gt;Index of the working key that needs to be diverged&lt;/div&gt;<a name="line.684"></a>
<span class="sourceLineNo">685</span>     *<a name="line.685"></a>
<span class="sourceLineNo">686</span>     * @param destKeyIndex &lt;div class="zh"&gt;对 srcKeyIndex分散后的结果存储在工作密钥区的索引。&lt;/div&gt;<a name="line.686"></a>
<span class="sourceLineNo">687</span>     *                     &lt;div class="en"&gt;The result of divergence of srcKeyIndex is stored in the index of the working key area.&lt;/div&gt;<a name="line.687"></a>
<span class="sourceLineNo">688</span>     *<a name="line.688"></a>
<span class="sourceLineNo">689</span>     * @param mode &lt;div class="zh"&gt;指示最终工作密钥明文的生成运算方式，取值共有 16 种，具体如下所示，<a name="line.689"></a>
<span class="sourceLineNo">690</span>     *             &lt;ul&gt;<a name="line.690"></a>
<span class="sourceLineNo">691</span>     *             &lt;li&gt;0x01-- DES 加密&lt;/li&gt;<a name="line.691"></a>
<span class="sourceLineNo">692</span>     *             &lt;li&gt;0x81-- DES 解密<a name="line.692"></a>
<span class="sourceLineNo">693</span>     *             &lt;br&gt;derivedKeyIndex 与 srcKeyIndex 均为单 DES/ 8 字节密钥，Len＝11。&lt;/li&gt;<a name="line.693"></a>
<span class="sourceLineNo">694</span>     *             &lt;li&gt;0x03-- 3DES 加密&lt;/li&gt;<a name="line.694"></a>
<span class="sourceLineNo">695</span>     *             &lt;li&gt;0x31-- 3DES 加密&lt;/li&gt;<a name="line.695"></a>
<span class="sourceLineNo">696</span>     *             &lt;li&gt;0x83-- 3DES 解密&lt;/li&gt;<a name="line.696"></a>
<span class="sourceLineNo">697</span>     *             &lt;li&gt;0xb1-- 3DES 解密<a name="line.697"></a>
<span class="sourceLineNo">698</span>     *             &lt;br&gt;derivedKeyIndex 为 3DES/16 字节密钥，srcKeyIndex 为单 DES/8 字节密钥，Len＝11。&lt;/li&gt;<a name="line.698"></a>
<span class="sourceLineNo">699</span>     *             &lt;li&gt;0x07-- 3DES 加密&lt;/li&gt;<a name="line.699"></a>
<span class="sourceLineNo">700</span>     *             &lt;li&gt;0x87-- 3DES 解密<a name="line.700"></a>
<span class="sourceLineNo">701</span>     *             &lt;br&gt;derivedKeyIndex 为 3DES/24 字节密钥，srcKeyIndex 为单 DES/8 字节密钥，Len＝11。&lt;/li&gt;<a name="line.701"></a>
<span class="sourceLineNo">702</span>     *             &lt;li&gt;0x33-- 3DES 加密&lt;/li&gt;<a name="line.702"></a>
<span class="sourceLineNo">703</span>     *             &lt;li&gt;0xb3-- 3DES 解密<a name="line.703"></a>
<span class="sourceLineNo">704</span>     *             &lt;br&gt;derivedKeyIndex 与 srcKeyIndex 均为 3DES/16 字节密钥，Len＝19。&lt;/li&gt;<a name="line.704"></a>
<span class="sourceLineNo">705</span>     *             &lt;li&gt;0x71-- 3DES 加密&lt;/li&gt;<a name="line.705"></a>
<span class="sourceLineNo">706</span>     *             &lt;li&gt;0xf1-- 3DES 解密<a name="line.706"></a>
<span class="sourceLineNo">707</span>     *             &lt;br&gt;derivedKeyIndex 为 3DES/24 字节密钥, srcKeyIndex 为单 DES/8 字节密钥，Len＝11。&lt;/li&gt;<a name="line.707"></a>
<span class="sourceLineNo">708</span>     *             &lt;li&gt;0x73-- 3DES 加密&lt;/li&gt;<a name="line.708"></a>
<span class="sourceLineNo">709</span>     *             &lt;li&gt;0xf3-- 3DES 解密<a name="line.709"></a>
<span class="sourceLineNo">710</span>     *             &lt;br&gt;derivedKeyIndex 为 3DES/24 字节密钥, srcKeyIndex 为 3DES－16 字节密钥，Len＝19。&lt;/li&gt;<a name="line.710"></a>
<span class="sourceLineNo">711</span>     *             &lt;li&gt;0x77-- 3DES 加密&lt;/li&gt;<a name="line.711"></a>
<span class="sourceLineNo">712</span>     *             &lt;li&gt;0xf7-- 3DES 解密<a name="line.712"></a>
<span class="sourceLineNo">713</span>     *             &lt;br&gt;derivedKeyIndex 与 srcKeyIndex 均为 3DES/24 字节密钥，Len＝27。&lt;/li&gt;<a name="line.713"></a>
<span class="sourceLineNo">714</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.714"></a>
<span class="sourceLineNo">715</span>     *             &lt;div class="en"&gt;Indicate the calculation method for generating the final working key plaintext. There are 16 values in total, as shown below.<a name="line.715"></a>
<span class="sourceLineNo">716</span>     *             &lt;ul&gt;<a name="line.716"></a>
<span class="sourceLineNo">717</span>     *             &lt;li&gt;0x01-- DES encryption&lt;/li&gt;<a name="line.717"></a>
<span class="sourceLineNo">718</span>     *             &lt;li&gt;0x81-- DES decrypt<a name="line.718"></a>
<span class="sourceLineNo">719</span>     *             &lt;br&gt;Both derivedKeyIndex and srcKeyIndex are single DES/8-byte keys, Len=11.&lt;/li&gt;<a name="line.719"></a>
<span class="sourceLineNo">720</span>     *             &lt;li&gt;0x03-- 3DES encryption&lt;/li&gt;<a name="line.720"></a>
<span class="sourceLineNo">721</span>     *             &lt;li&gt;0x31-- 3DES encryption&lt;/li&gt;<a name="line.721"></a>
<span class="sourceLineNo">722</span>     *             &lt;li&gt;0x83-- 3DES decryption&lt;/li&gt;<a name="line.722"></a>
<span class="sourceLineNo">723</span>     *             &lt;li&gt;0xb1-- 3DES decryption<a name="line.723"></a>
<span class="sourceLineNo">724</span>     *             &lt;br&gt;derivedKeyIndex is a 3DES/16 byte key, srcKeyIndex is a single DES/8 byte key, Len=11.&lt;/li&gt;<a name="line.724"></a>
<span class="sourceLineNo">725</span>     *             &lt;li&gt;0x07-- 3DES encryption&lt;/li&gt;<a name="line.725"></a>
<span class="sourceLineNo">726</span>     *             &lt;li&gt;0x87-- 3DES decryption<a name="line.726"></a>
<span class="sourceLineNo">727</span>     *             &lt;br&gt;derivedKeyIndex is a 3DES/24-byte key, srcKeyIndex is a single DES/8-byte key, Len=11.&lt;/li&gt;<a name="line.727"></a>
<span class="sourceLineNo">728</span>     *             &lt;li&gt;0x33-- 3DES encryption&lt;/li&gt;<a name="line.728"></a>
<span class="sourceLineNo">729</span>     *             &lt;li&gt;0xb3-- 3DES decryption<a name="line.729"></a>
<span class="sourceLineNo">730</span>     *             &lt;br&gt;Both derivedKeyIndex and srcKeyIndex are 3DES/16 byte keys, Len=19.&lt;/li&gt;<a name="line.730"></a>
<span class="sourceLineNo">731</span>     *             &lt;li&gt;0x71-- 3DES encryption&lt;/li&gt;<a name="line.731"></a>
<span class="sourceLineNo">732</span>     *             &lt;li&gt;0xf1-- 3DES decrypt<a name="line.732"></a>
<span class="sourceLineNo">733</span>     *             &lt;br&gt;derivedKeyIndex is a 3DES/24-byte key, srcKeyIndex is a single DES/8-byte key, Len=11.&lt;/li&gt;<a name="line.733"></a>
<span class="sourceLineNo">734</span>     *             &lt;li&gt;0x73-- 3DES encryption&lt;/li&gt;<a name="line.734"></a>
<span class="sourceLineNo">735</span>     *             &lt;li&gt;0xf3-- 3DES decryption<a name="line.735"></a>
<span class="sourceLineNo">736</span>     *             &lt;br&gt;derivedKeyIndex is a 3DES/24 byte key, srcKeyIndex is a 3DES-16 byte key, Len=19.&lt;/li&gt;<a name="line.736"></a>
<span class="sourceLineNo">737</span>     *             &lt;li&gt;0x77-- 3DES encryption&lt;/li&gt;<a name="line.737"></a>
<span class="sourceLineNo">738</span>     *             &lt;li&gt;0xf7-- 3DES decryption<a name="line.738"></a>
<span class="sourceLineNo">739</span>     *             &lt;br&gt;Both derivedKeyIndex and srcKeyIndex are 3DES/24-byte keys, Len=27.&lt;/li&gt;<a name="line.739"></a>
<span class="sourceLineNo">740</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.740"></a>
<span class="sourceLineNo">741</span>     * @throws TypeAException TypeAException<a name="line.741"></a>
<span class="sourceLineNo">742</span>     */<a name="line.742"></a>
<span class="sourceLineNo">743</span>    void derivedTWK(byte derivedKeyIndex, byte srcKeyIndex, byte destKeyIndex, byte mode) throws TypeAException;<a name="line.743"></a>
<span class="sourceLineNo">744</span>    /**<a name="line.744"></a>
<span class="sourceLineNo">745</span>     * &lt;div class="zh"&gt;向密码键盘请求获取 TXK。<a name="line.745"></a>
<span class="sourceLineNo">746</span>     * &lt;br&gt;该命令用于上位机从 PED 获取读取传输密钥。 传输密钥 TXK 固定为 16 字节。上位机临时产生一组模长 512bit 的 RSA 公私钥对，并将公钥传给 PED， PED 产生传输密钥 TXK，并保存在安全存储器中，然后用公钥加密后，将密文发给上位机。<a name="line.746"></a>
<span class="sourceLineNo">747</span>     * &lt;/div&gt; &lt;div class="en"&gt;Request a TXK from the password keyboard.<a name="line.747"></a>
<span class="sourceLineNo">748</span>     * &lt;br&gt;This command is used by the host computer to obtain and read the exchange key from the PED. The exchange key TXK is fixed at 16 bytes. The host computer temporarily generates a set of RSA public-private key pairs with a modulus of 512 bits, and transmits the public key to the PED. The PED generates the exchange key TXK and saves it in the secure memory. After encrypting with the public key, the cipher text is sent to the host. machine.&lt;/div&gt;<a name="line.748"></a>
<span class="sourceLineNo">749</span>     *<a name="line.749"></a>
<span class="sourceLineNo">750</span>     * @param modulus &lt;div class="zh"&gt;公钥模&lt;/div&gt;<a name="line.750"></a>
<span class="sourceLineNo">751</span>     *                &lt;div class="en"&gt;Public key module.&lt;/div&gt;<a name="line.751"></a>
<span class="sourceLineNo">752</span>     *<a name="line.752"></a>
<span class="sourceLineNo">753</span>     * @param exponent &lt;div class="zh"&gt;公钥指数，高字节在前。&lt;/div&gt;<a name="line.753"></a>
<span class="sourceLineNo">754</span>     *                 &lt;div class="en"&gt;Public key index, high byte first.&lt;/div&gt;<a name="line.754"></a>
<span class="sourceLineNo">755</span>     *<a name="line.755"></a>
<span class="sourceLineNo">756</span>     * @return &lt;div class="zh"&gt;TXK，PED 产生的 16 字节随机数。&lt;/div&gt;<a name="line.756"></a>
<span class="sourceLineNo">757</span>     *         &lt;div class="en"&gt;TXK, 16-byte random number generated by PED.&lt;/div&gt;<a name="line.757"></a>
<span class="sourceLineNo">758</span>     * @throws TypeAException TypeAException<a name="line.758"></a>
<span class="sourceLineNo">759</span>     */<a name="line.759"></a>
<span class="sourceLineNo">760</span>    byte[] getTXK(byte[] modulus, byte[] exponent) throws TypeAException;<a name="line.760"></a>
<span class="sourceLineNo">761</span>    /**<a name="line.761"></a>
<span class="sourceLineNo">762</span>     * &lt;div class="zh"&gt;获取 TXK 校验值。<a name="line.762"></a>
<span class="sourceLineNo">763</span>     * &lt;br&gt;该命令用于上位机检查 TXK 是否同步。<a name="line.763"></a>
<span class="sourceLineNo">764</span>     * &lt;br&gt;密码键盘产生 8 字节随机数，并用 TXK 加密，把随机数和加密后的值，发给上位机。上位机可以由自身的 TXK 进行相关验证。&lt;/div&gt;<a name="line.764"></a>
<span class="sourceLineNo">765</span>     * &lt;div class="en"&gt;Get TXK check value.<a name="line.765"></a>
<span class="sourceLineNo">766</span>     * &lt;br&gt;This command is used by the host computer to check whether the TXK is synchronized.<a name="line.766"></a>
<span class="sourceLineNo">767</span>     * &lt;br&gt;The password keyboard generates an 8-byte random number and encrypts it with TXK, and sends the random number and the encrypted value to the upper computer. The upper computer can be verified by its own TXK.&lt;/div&gt;<a name="line.767"></a>
<span class="sourceLineNo">768</span>     *<a name="line.768"></a>
<span class="sourceLineNo">769</span>     * @return &lt;div class="zh"&gt;8字节随即数＋8字节随机数密文（用TXK加密）。&lt;/div&gt;<a name="line.769"></a>
<span class="sourceLineNo">770</span>     *         &lt;div class="en"&gt;8-byte random number + 8-byte random number ciphertext (encrypted with TXK).&lt;/div&gt;<a name="line.770"></a>
<span class="sourceLineNo">771</span>     * @throws TypeAException TypeAException<a name="line.771"></a>
<span class="sourceLineNo">772</span>     */<a name="line.772"></a>
<span class="sourceLineNo">773</span>    byte[] getTXKCheckValue() throws TypeAException;<a name="line.773"></a>
<span class="sourceLineNo">774</span>    /**<a name="line.774"></a>
<span class="sourceLineNo">775</span>     * &lt;div class="zh"&gt;清空所有秘钥。&lt;/div&gt; &lt;div class="en"&gt;Clear all keys.&lt;/div&gt;<a name="line.775"></a>
<span class="sourceLineNo">776</span>     *<a name="line.776"></a>
<span class="sourceLineNo">777</span>     * @throws TypeAException TypeAException<a name="line.777"></a>
<span class="sourceLineNo">778</span>     */<a name="line.778"></a>
<span class="sourceLineNo">779</span>    void eraseKey() throws TypeAException;<a name="line.779"></a>
<span class="sourceLineNo">780</span>    /**<a name="line.780"></a>
<span class="sourceLineNo">781</span>     * &lt;div class="zh"&gt;用户输入密码。<a name="line.781"></a>
<span class="sourceLineNo">782</span>     * &lt;br&gt;触发用户输入账户密码，在输入密码并按“确认”键后，密码键盘用POS机传下来的数据（卡号或 ISN），<a name="line.782"></a>
<span class="sourceLineNo">783</span>     * 根据 ANSI X9.8 标准或 ANSI X3.92 标准和 WKeyID 指定的 PIN 密钥对 PIN 进行加密。在输入密码时，用户能取消操作，<a name="line.783"></a>
<span class="sourceLineNo">784</span>     * POS 机一端通过发送操作取消命令也可中止密码输入。大陆版和越南版本密码键盘在收到该命令后，不在首行显示任何信息,如：“PLS INPUT PIN:”。<a name="line.784"></a>
<span class="sourceLineNo">785</span>     * 缺省的密码输入超时为 120 秒，但可由后述的相关超时设置命令重新设定。&lt;/div&gt;<a name="line.785"></a>
<span class="sourceLineNo">786</span>     * &lt;div class="en"&gt;The user enters the password.<a name="line.786"></a>
<span class="sourceLineNo">787</span>     * &lt;br&gt;Trigger the user to enter the account password. After entering the password and pressing the "confirm" key,<a name="line.787"></a>
<span class="sourceLineNo">788</span>     * the password keyboard uses the data (card number or ISN) transmitted from the POS machine,<a name="line.788"></a>
<span class="sourceLineNo">789</span>     * according to the ANSI X9.8 standard or the ANSI X3.92 standard and the PIN password specified by WKeyID The key encrypts the PIN.<a name="line.789"></a>
<span class="sourceLineNo">790</span>     * When entering the password, the user can cancel the operation, and the POS terminal can also stop the password input by sending the operation cancel command.<a name="line.790"></a>
<span class="sourceLineNo">791</span>     * After receiving this command, the mainland version and Vietnam version of the PIN keyboard will not display any information on the first line, such as: "PLS INPUT PIN:".<a name="line.791"></a>
<span class="sourceLineNo">792</span>     * The default password input timeout is 120 seconds, but it can be reset by the related timeout setting command described later.&lt;/div&gt;<a name="line.792"></a>
<span class="sourceLineNo">793</span>     *<a name="line.793"></a>
<span class="sourceLineNo">794</span>     * @param isNewAccount &lt;div class="zh"&gt;是否是新开户。<a name="line.794"></a>
<span class="sourceLineNo">795</span>     *                      &lt;br&gt;True：新开户<a name="line.795"></a>
<span class="sourceLineNo">796</span>     *                      &lt;br&gt;False：不是新开户&lt;/div&gt;<a name="line.796"></a>
<span class="sourceLineNo">797</span>     *                     &lt;div class="en"&gt;Whether it is a new account.<a name="line.797"></a>
<span class="sourceLineNo">798</span>     *                      &lt;br&gt;True: New account<a name="line.798"></a>
<span class="sourceLineNo">799</span>     *                      &lt;br&gt;False: Not a new account&lt;/div&gt;<a name="line.799"></a>
<span class="sourceLineNo">800</span>     * @param mode &lt;div class="zh"&gt;指定加密标准<a name="line.800"></a>
<span class="sourceLineNo">801</span>     *             &lt;ul&gt;&lt;li&gt;0x01：按照 ANSI X9.8 标准，PIN 输入时当最小长度不为 0 时,允许按"确认"退出&lt;/li&gt;<a name="line.801"></a>
<span class="sourceLineNo">802</span>     *                 &lt;li&gt;0x31：16 字节密钥 DES 按照 ANSI X9.8 标准，PIN 输入时当最小长度不为 0 时,允许按"确认"退出&lt;/li&gt;<a name="line.802"></a>
<span class="sourceLineNo">803</span>     *                 &lt;li&gt;0x71：24 字节密钥 DES 按照 ANSI X9.8 标准，PIN 输入时当最小长度不为 0 时,允许按"确认"退出&lt;/li&gt;<a name="line.803"></a>
<span class="sourceLineNo">804</span>     *                 &lt;li&gt;0x04：按照 ANSI X9.8 标准,采用 3DES 加密方法&lt;/li&gt;<a name="line.804"></a>
<span class="sourceLineNo">805</span>     *                 &lt;li&gt;0x02：des 按照 ANSI X3.92 标准&lt;/li&gt;<a name="line.805"></a>
<span class="sourceLineNo">806</span>     *                 &lt;li&gt;0x32：16 字节密钥 DES 按照 ANSI X3.92 标准&lt;/li&gt;<a name="line.806"></a>
<span class="sourceLineNo">807</span>     *                 &lt;li&gt;0x72：24 字节密钥 DES 按照 ANSI X3.92 标准&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.807"></a>
<span class="sourceLineNo">808</span>     *             &lt;div class="en"&gt;Specify encryption standards<a name="line.808"></a>
<span class="sourceLineNo">809</span>     *             &lt;ul&gt;&lt;li&gt;0x01: According to ANSI X9.8 standard, when the minimum length of PIN input is not 0, it is allowed to press "OK" to exit&lt;/li&gt;<a name="line.809"></a>
<span class="sourceLineNo">810</span>     *                 &lt;li&gt;0x31: 16-byte key DES According to the ANSI X9.8 standard, when the minimum length of PIN input is not 0, it is allowed to press "OK" to exit&lt;/li&gt;<a name="line.810"></a>
<span class="sourceLineNo">811</span>     *                 &lt;li&gt;0x71: 24-byte key DES According to ANSI X9.8 standard, when the minimum length of PIN input is not 0, it is allowed to press "OK" to exit&lt;/li&gt;<a name="line.811"></a>
<span class="sourceLineNo">812</span>     *                 &lt;li&gt;0x04: According to ANSI X9.8 standard, using 3DES encryption method&lt;/li&gt;<a name="line.812"></a>
<span class="sourceLineNo">813</span>     *                 &lt;li&gt;0x02: des is in accordance with ANSI X3.92 standard&lt;/li&gt;<a name="line.813"></a>
<span class="sourceLineNo">814</span>     *                 &lt;li&gt;0x32: 16-byte key DES according to ANSI X3.92 standard&lt;/li&gt;<a name="line.814"></a>
<span class="sourceLineNo">815</span>     *                 &lt;li&gt;0x72: 24-byte key DES according to ANSI X3.92 standard&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.815"></a>
<span class="sourceLineNo">816</span>     * @param keyIndex &lt;div class="zh"&gt;工作密钥的索引。&lt;/div&gt;&lt;div class="en"&gt;The index of the working key.&lt;/div&gt;<a name="line.816"></a>
<span class="sourceLineNo">817</span>     * @param min &lt;div class="zh"&gt;允许输入的 PIN 的最小长度(大于等于 0, 为 0 时，按 ENTER 键返回，且输入 长度 Len=0，此时应答数据长度为 0，表示用户没有输入密码)。&lt;/div&gt;<a name="line.817"></a>
<span class="sourceLineNo">818</span>     *            &lt;div class="en"&gt;The minimum length of the allowed PIN (when greater than or equal to 0, when it is 0, press the ENTER key to return, and enter the length Len=0, at this time the response data length is 0, which means that the user did not enter a password).&lt;/div&gt;<a name="line.818"></a>
<span class="sourceLineNo">819</span>     * @param max &lt;div class="zh"&gt;允许输入的 PIN 的最大长度(小于等于 14)。&lt;/div&gt;<a name="line.819"></a>
<span class="sourceLineNo">820</span>     *            &lt;div class="en"&gt;The maximum length of the PIN that can be entered (less than or equal to 14).&lt;/div&gt;<a name="line.820"></a>
<span class="sourceLineNo">821</span>     * @param data &lt;div class="zh"&gt;按照ANSI X9.8 标准，16字节卡号。&lt;br&gt;按照ANSI X3.92标准，6字节交易流水号ISN。&lt;/div&gt;<a name="line.821"></a>
<span class="sourceLineNo">822</span>     *             &lt;div class="en"&gt;According to ANSI X9.8 standard, 16-byte card number.<a name="line.822"></a>
<span class="sourceLineNo">823</span>     *                             &lt;br&gt;According to ANSI X3.92 standard, 6-byte transaction serial number ISN.&lt;/div&gt;<a name="line.823"></a>
<span class="sourceLineNo">824</span>     * @param timeoutMs &lt;div class="zh"&gt;超时时间。单位: 毫秒。&lt;/div&gt; &lt;div class="en"&gt;Timeout. Unit: milliseconds.&lt;/div&gt;<a name="line.824"></a>
<span class="sourceLineNo">825</span>     *<a name="line.825"></a>
<span class="sourceLineNo">826</span>     * @return &lt;div class="zh"&gt;如果输入长度为0，则返回new byte[0]。&lt;br&gt;如果输入长度不为0，则返回8字节的PinBlock。&lt;/div&gt;<a name="line.826"></a>
<span class="sourceLineNo">827</span>     *         &lt;div class="en"&gt;If the input length is 0, new byte[0] is returned.<a name="line.827"></a>
<span class="sourceLineNo">828</span>     *                     &lt;br&gt;If the input length is not 0, an 8-byte PinBlock is returned.&lt;/div&gt;<a name="line.828"></a>
<span class="sourceLineNo">829</span>     * @throws TypeAException TypeAException<a name="line.829"></a>
<span class="sourceLineNo">830</span>     */<a name="line.830"></a>
<span class="sourceLineNo">831</span>    byte[] getPinBlock(boolean isNewAccount, byte mode, byte keyIndex, byte min, byte max, byte[] data, int timeoutMs) throws TypeAException;<a name="line.831"></a>
<span class="sourceLineNo">832</span>    /**<a name="line.832"></a>
<span class="sourceLineNo">833</span>     * &lt;div class="zh"&gt;用于在密码键盘处于密码输入状态时，POS 机取消密码输入。&lt;/div&gt; &lt;div class="en"&gt;It is used to cancel the password input by the POS machine when the password keyboard is in the password input state.&lt;/div&gt;<a name="line.833"></a>
<span class="sourceLineNo">834</span>     *<a name="line.834"></a>
<span class="sourceLineNo">835</span>     * @throws TypeAException TypeAException<a name="line.835"></a>
<span class="sourceLineNo">836</span>     */<a name="line.836"></a>
<span class="sourceLineNo">837</span>    void cancelInputPin() throws TypeAException;<a name="line.837"></a>
<span class="sourceLineNo">838</span>    /**<a name="line.838"></a>
<span class="sourceLineNo">839</span>     * &lt;div class="zh"&gt;PIN 输入超时设置。<a name="line.839"></a>
<span class="sourceLineNo">840</span>     * &lt;br&gt;PINPAD 每次开机后的缺省值是 120 秒（2 分钟）。<a name="line.840"></a>
<span class="sourceLineNo">841</span>     * &lt;br&gt;设置的键盘超时值为：Time_High×256＋Time_Low，单位为 10 毫秒（Timeout&lt;655.36 秒）。当设置为0 时，其超时时间为 2 分钟。&lt;/div&gt;<a name="line.841"></a>
<span class="sourceLineNo">842</span>     * &lt;div class="en"&gt;PIN input timeout setting.<a name="line.842"></a>
<span class="sourceLineNo">843</span>     * &lt;br&gt;The default value of PINPAD after each power-on is 120 seconds (2 minutes).<a name="line.843"></a>
<span class="sourceLineNo">844</span>     * &lt;br&gt;The set keyboard timeout value is: Time_High×256+Time_Low, the unit is 10 milliseconds (Timeout&lt;655.36 seconds). When set to 0, the timeout period is 2 minutes..&lt;/div&gt;<a name="line.844"></a>
<span class="sourceLineNo">845</span>     *<a name="line.845"></a>
<span class="sourceLineNo">846</span>     * @param high &lt;div class="zh"&gt;设置的键盘超时值为：Time_High×256＋Time_Low。&lt;/div&gt;<a name="line.846"></a>
<span class="sourceLineNo">847</span>     *             &lt;div class="en"&gt;The set keyboard timeout value is: Time_High×256+Time_Low.&lt;/div&gt;<a name="line.847"></a>
<span class="sourceLineNo">848</span>     * @param low &lt;div class="zh"&gt;设置的键盘超时值为：Time_High×256＋Time_Low。&lt;/div&gt;<a name="line.848"></a>
<span class="sourceLineNo">849</span>     *            &lt;div class="en"&gt;The set keyboard timeout value is: Time_High×256+Time_Low.&lt;/div&gt;<a name="line.849"></a>
<span class="sourceLineNo">850</span>     * @throws TypeAException TypeAException<a name="line.850"></a>
<span class="sourceLineNo">851</span>     */<a name="line.851"></a>
<span class="sourceLineNo">852</span>    void setPinTimeout(byte high, byte low) throws TypeAException;<a name="line.852"></a>
<span class="sourceLineNo">853</span>    /**<a name="line.853"></a>
<span class="sourceLineNo">854</span>     * &lt;div class="zh"&gt;扩展获取 PINBLOCK [密文传输]。&lt;/div&gt; &lt;div class="en"&gt;Extended access to PINBLOCK [ciphertext transmission].&lt;/div&gt;<a name="line.854"></a>
<span class="sourceLineNo">855</span>     *<a name="line.855"></a>
<span class="sourceLineNo">856</span>     * @param cipherByTXK &lt;div class="zh"&gt;<a name="line.856"></a>
<span class="sourceLineNo">857</span>     *                       &lt;table border="1"&gt;<a name="line.857"></a>
<span class="sourceLineNo">858</span>     *                    &lt;tr&gt;<a name="line.858"></a>
<span class="sourceLineNo">859</span>     *                        &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.859"></a>
<span class="sourceLineNo">860</span>     *                        &lt;th&gt;长度 byte&lt;/th&gt;<a name="line.860"></a>
<span class="sourceLineNo">861</span>     *                        &lt;th&gt;变量名称&lt;/th&gt;<a name="line.861"></a>
<span class="sourceLineNo">862</span>     *                        &lt;th&gt;意义&lt;/th&gt;<a name="line.862"></a>
<span class="sourceLineNo">863</span>     *                    &lt;/tr&gt;<a name="line.863"></a>
<span class="sourceLineNo">864</span>     *                    &lt;tr&gt;<a name="line.864"></a>
<span class="sourceLineNo">865</span>     *                        &lt;td&gt;0x0000&lt;/td&gt;<a name="line.865"></a>
<span class="sourceLineNo">866</span>     *                        &lt;td&gt;1&lt;/td&gt;<a name="line.866"></a>
<span class="sourceLineNo">867</span>     *                        &lt;td&gt;WKeyID&lt;/td&gt;<a name="line.867"></a>
<span class="sourceLineNo">868</span>     *                        &lt;td&gt;1-100&lt;/td&gt;<a name="line.868"></a>
<span class="sourceLineNo">869</span>     *                    &lt;/tr&gt;<a name="line.869"></a>
<span class="sourceLineNo">870</span>     *                    &lt;tr&gt;<a name="line.870"></a>
<span class="sourceLineNo">871</span>     *                        &lt;td&gt;0x0001&lt;/td&gt;<a name="line.871"></a>
<span class="sourceLineNo">872</span>     *                        &lt;td&gt;1&lt;/td&gt;<a name="line.872"></a>
<span class="sourceLineNo">873</span>     *                        &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.873"></a>
<span class="sourceLineNo">874</span>     *                        &lt;td&gt;8、16 或 24，指示 PINBLOCK 是用 DES/TDES 加密&lt;/td&gt;<a name="line.874"></a>
<span class="sourceLineNo">875</span>     *                    &lt;/tr&gt;<a name="line.875"></a>
<span class="sourceLineNo">876</span>     *                    &lt;tr&gt;<a name="line.876"></a>
<span class="sourceLineNo">877</span>     *                          &lt;td&gt;0x0002&lt;/td&gt;<a name="line.877"></a>
<span class="sourceLineNo">878</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.878"></a>
<span class="sourceLineNo">879</span>     *                          &lt;td&gt;mode&lt;/td&gt;<a name="line.879"></a>
<span class="sourceLineNo">880</span>     *                          &lt;td&gt;选择 PIN BLOCK 的格式，<a name="line.880"></a>
<span class="sourceLineNo">881</span>     *                              &lt;br&gt;0x00 ISO9564 格式 0<a name="line.881"></a>
<span class="sourceLineNo">882</span>     *                              &lt;br&gt;0x01 ISO9564 格式 1<a name="line.882"></a>
<span class="sourceLineNo">883</span>     *                              &lt;br&gt;0x02 ISO9564 格式 3<a name="line.883"></a>
<span class="sourceLineNo">884</span>     *                              &lt;br&gt;0x03 HK EPS 专用格式[详见附录]&lt;/td&gt;<a name="line.884"></a>
<span class="sourceLineNo">885</span>     *                    &lt;/tr&gt;<a name="line.885"></a>
<span class="sourceLineNo">886</span>     *                    &lt;tr&gt;<a name="line.886"></a>
<span class="sourceLineNo">887</span>     *                          &lt;td&gt;0x0003&lt;/td&gt;<a name="line.887"></a>
<span class="sourceLineNo">888</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.888"></a>
<span class="sourceLineNo">889</span>     *                          &lt;td&gt;InputMode&lt;/td&gt;<a name="line.889"></a>
<span class="sourceLineNo">890</span>     *                          &lt;td&gt;0x01：只输入一次，0x02：输入两次密码，两次输入一致后返回 PINBLOCK&lt;/td&gt;<a name="line.890"></a>
<span class="sourceLineNo">891</span>     *                    &lt;/tr&gt;<a name="line.891"></a>
<span class="sourceLineNo">892</span>     *                    &lt;tr&gt;<a name="line.892"></a>
<span class="sourceLineNo">893</span>     *                          &lt;td&gt;0x0004&lt;/td&gt;<a name="line.893"></a>
<span class="sourceLineNo">894</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.894"></a>
<span class="sourceLineNo">895</span>     *                          &lt;td&gt;Min&lt;/td&gt;<a name="line.895"></a>
<span class="sourceLineNo">896</span>     *                          &lt;td&gt;PinPad 输入最小长度，&gt;=0&lt;/td&gt;<a name="line.896"></a>
<span class="sourceLineNo">897</span>     *                    &lt;/tr&gt;<a name="line.897"></a>
<span class="sourceLineNo">898</span>     *                    &lt;tr&gt;<a name="line.898"></a>
<span class="sourceLineNo">899</span>     *                          &lt;td&gt;0x0005&lt;/td&gt;<a name="line.899"></a>
<span class="sourceLineNo">900</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.900"></a>
<span class="sourceLineNo">901</span>     *                          &lt;td&gt;Max&lt;/td&gt;<a name="line.901"></a>
<span class="sourceLineNo">902</span>     *                          &lt;td&gt;PinPad 输入最大长度，&lt;=14&lt;/td&gt;<a name="line.902"></a>
<span class="sourceLineNo">903</span>     *                    &lt;/tr&gt;<a name="line.903"></a>
<span class="sourceLineNo">904</span>     *                    &lt;tr&gt;<a name="line.904"></a>
<span class="sourceLineNo">905</span>     *                          &lt;td&gt;0x0006&lt;/td&gt;<a name="line.905"></a>
<span class="sourceLineNo">906</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.906"></a>
<span class="sourceLineNo">907</span>     *                          &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.907"></a>
<span class="sourceLineNo">908</span>     *                          &lt;td&gt;DataIn的长度&lt;/td&gt;<a name="line.908"></a>
<span class="sourceLineNo">909</span>     *                    &lt;/tr&gt;<a name="line.909"></a>
<span class="sourceLineNo">910</span>     *                    &lt;tr&gt;<a name="line.910"></a>
<span class="sourceLineNo">911</span>     *                          &lt;td&gt;0x0007&lt;/td&gt;<a name="line.911"></a>
<span class="sourceLineNo">912</span>     *                          &lt;td&gt;N&lt;/td&gt;<a name="line.912"></a>
<span class="sourceLineNo">913</span>     *                          &lt;td&gt;DataIn&lt;/td&gt;<a name="line.913"></a>
<span class="sourceLineNo">914</span>     *                          &lt;td&gt;当 Mode=0x00 时DataIn 指向卡号移位后生成的 16 位主帐号。<a name="line.914"></a>
<span class="sourceLineNo">915</span>     *                          &lt;br&gt;当 Mode=0x01 时输入参数为参与 PinBlock 的格式化，8 字节数据（根据 ISO9564 的规范，该数据可以是随机数、交易流水号或时间戳等）。<a name="line.915"></a>
<span class="sourceLineNo">916</span>     *                          &lt;br&gt;当 Mode=0x02 时DataIn 指向卡号移位后生成的 16 位主帐号，DataIn+16 指向参与 PinBlock 格式化的 8 字节数据（根据 ISO9564 的规范，该数据可以是随机数、交易流水号或时间戳等，但是每个字节的高 4 位和低 4位，均必须在 0xA-0xF 之间，所以当 Mode 为 0x02时，底层将该 8 字节的数据做此检查，如果不满足要求将返回错误）。<a name="line.916"></a>
<span class="sourceLineNo">917</span>     *                          &lt;br&gt;当 Mode=0x03 时为交易流水号 ISN [6 Bytes，ASCII 码]] [输入]。&lt;/td&gt;<a name="line.917"></a>
<span class="sourceLineNo">918</span>     *                    &lt;/tr&gt;<a name="line.918"></a>
<span class="sourceLineNo">919</span>     *                    &lt;tr&gt;<a name="line.919"></a>
<span class="sourceLineNo">920</span>     *                          &lt;td&gt;0x0007+N&lt;/td&gt;<a name="line.920"></a>
<span class="sourceLineNo">921</span>     *                          &lt;td&gt;M&lt;/td&gt;<a name="line.921"></a>
<span class="sourceLineNo">922</span>     *                          &lt;td&gt;Fill&lt;/td&gt;<a name="line.922"></a>
<span class="sourceLineNo">923</span>     *                          &lt;td&gt;填充字节，以上数据长度不被 8 字节整除时，填充至8 字节整除。&lt;/td&gt;<a name="line.923"></a>
<span class="sourceLineNo">924</span>     *                    &lt;/tr&gt;<a name="line.924"></a>
<span class="sourceLineNo">925</span>     *                    &lt;/table&gt;&lt;/div&gt;<a name="line.925"></a>
<span class="sourceLineNo">926</span>     *<a name="line.926"></a>
<span class="sourceLineNo">927</span>     * &lt;div class="en"&gt;Encrypted by TXK。<a name="line.927"></a>
<span class="sourceLineNo">928</span>     *                    &lt;table border="1"&gt;<a name="line.928"></a>
<span class="sourceLineNo">929</span>     *                    &lt;tr&gt;<a name="line.929"></a>
<span class="sourceLineNo">930</span>     *                        &lt;th&gt;Offset&lt;/th&gt;<a name="line.930"></a>
<span class="sourceLineNo">931</span>     *                        &lt;th&gt;Length (byte)&lt;/th&gt;<a name="line.931"></a>
<span class="sourceLineNo">932</span>     *                        &lt;th&gt;Variable name&lt;/th&gt;<a name="line.932"></a>
<span class="sourceLineNo">933</span>     *                        &lt;th&gt;Description&lt;/th&gt;<a name="line.933"></a>
<span class="sourceLineNo">934</span>     *                    &lt;/tr&gt;<a name="line.934"></a>
<span class="sourceLineNo">935</span>     *                    &lt;tr&gt;<a name="line.935"></a>
<span class="sourceLineNo">936</span>     *                        &lt;td&gt;0x0000&lt;/td&gt;<a name="line.936"></a>
<span class="sourceLineNo">937</span>     *                        &lt;td&gt;1&lt;/td&gt;<a name="line.937"></a>
<span class="sourceLineNo">938</span>     *                        &lt;td&gt;WKeyID&lt;/td&gt;<a name="line.938"></a>
<span class="sourceLineNo">939</span>     *                        &lt;td&gt;1-100&lt;/td&gt;<a name="line.939"></a>
<span class="sourceLineNo">940</span>     *                    &lt;/tr&gt;<a name="line.940"></a>
<span class="sourceLineNo">941</span>     *                    &lt;tr&gt;<a name="line.941"></a>
<span class="sourceLineNo">942</span>     *                        &lt;td&gt;0x0001&lt;/td&gt;<a name="line.942"></a>
<span class="sourceLineNo">943</span>     *                        &lt;td&gt;1&lt;/td&gt;<a name="line.943"></a>
<span class="sourceLineNo">944</span>     *                        &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.944"></a>
<span class="sourceLineNo">945</span>     *                        &lt;td&gt;8, 16 or 24, indicating that PINBLOCK is encrypted with DES/TDES&lt;/td&gt;<a name="line.945"></a>
<span class="sourceLineNo">946</span>     *                    &lt;/tr&gt;<a name="line.946"></a>
<span class="sourceLineNo">947</span>     *                    &lt;tr&gt;<a name="line.947"></a>
<span class="sourceLineNo">948</span>     *                          &lt;td&gt;0x0002&lt;/td&gt;<a name="line.948"></a>
<span class="sourceLineNo">949</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.949"></a>
<span class="sourceLineNo">950</span>     *                          &lt;td&gt;mode&lt;/td&gt;<a name="line.950"></a>
<span class="sourceLineNo">951</span>     *                          &lt;td&gt;Choose the format of PIN BLOCK,<a name="line.951"></a>
<span class="sourceLineNo">952</span>     *                              &lt;br&gt;0x00 ISO9564 format 0<a name="line.952"></a>
<span class="sourceLineNo">953</span>     *                              &lt;br&gt;0x01 ISO9564 format 1<a name="line.953"></a>
<span class="sourceLineNo">954</span>     *                              &lt;br&gt;0x02 ISO9564 format 3<a name="line.954"></a>
<span class="sourceLineNo">955</span>     *                              &lt;br&gt;0x03 HK EPS special format [see appendix for details]&lt;/td&gt;<a name="line.955"></a>
<span class="sourceLineNo">956</span>     *                    &lt;/tr&gt;<a name="line.956"></a>
<span class="sourceLineNo">957</span>     *                    &lt;tr&gt;<a name="line.957"></a>
<span class="sourceLineNo">958</span>     *                          &lt;td&gt;0x0003&lt;/td&gt;<a name="line.958"></a>
<span class="sourceLineNo">959</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.959"></a>
<span class="sourceLineNo">960</span>     *                          &lt;td&gt;InputMode&lt;/td&gt;<a name="line.960"></a>
<span class="sourceLineNo">961</span>     *                          &lt;td&gt;0x01: Enter the password only once, 0x02: Enter the password twice, and return to PINBLOCK after the two entries are consistent&lt;/td&gt;<a name="line.961"></a>
<span class="sourceLineNo">962</span>     *                    &lt;/tr&gt;<a name="line.962"></a>
<span class="sourceLineNo">963</span>     *                    &lt;tr&gt;<a name="line.963"></a>
<span class="sourceLineNo">964</span>     *                          &lt;td&gt;0x0004&lt;/td&gt;<a name="line.964"></a>
<span class="sourceLineNo">965</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.965"></a>
<span class="sourceLineNo">966</span>     *                          &lt;td&gt;Min&lt;/td&gt;<a name="line.966"></a>
<span class="sourceLineNo">967</span>     *                          &lt;td&gt;PinPad input minimum length, &gt;=0&lt;/td&gt;<a name="line.967"></a>
<span class="sourceLineNo">968</span>     *                    &lt;/tr&gt;<a name="line.968"></a>
<span class="sourceLineNo">969</span>     *                    &lt;tr&gt;<a name="line.969"></a>
<span class="sourceLineNo">970</span>     *                          &lt;td&gt;0x0005&lt;/td&gt;<a name="line.970"></a>
<span class="sourceLineNo">971</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.971"></a>
<span class="sourceLineNo">972</span>     *                          &lt;td&gt;Max&lt;/td&gt;<a name="line.972"></a>
<span class="sourceLineNo">973</span>     *                          &lt;td&gt;PinPad input maximum length, &lt;=14&lt;/td&gt;<a name="line.973"></a>
<span class="sourceLineNo">974</span>     *                    &lt;/tr&gt;<a name="line.974"></a>
<span class="sourceLineNo">975</span>     *                    &lt;tr&gt;<a name="line.975"></a>
<span class="sourceLineNo">976</span>     *                          &lt;td&gt;0x0006&lt;/td&gt;<a name="line.976"></a>
<span class="sourceLineNo">977</span>     *                          &lt;td&gt;1&lt;/td&gt;<a name="line.977"></a>
<span class="sourceLineNo">978</span>     *                          &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.978"></a>
<span class="sourceLineNo">979</span>     *                          &lt;td&gt;Length of DataIn&lt;/td&gt;<a name="line.979"></a>
<span class="sourceLineNo">980</span>     *                    &lt;/tr&gt;<a name="line.980"></a>
<span class="sourceLineNo">981</span>     *                    &lt;tr&gt;<a name="line.981"></a>
<span class="sourceLineNo">982</span>     *                          &lt;td&gt;0x0007&lt;/td&gt;<a name="line.982"></a>
<span class="sourceLineNo">983</span>     *                          &lt;td&gt;N&lt;/td&gt;<a name="line.983"></a>
<span class="sourceLineNo">984</span>     *                          &lt;td&gt;DataIn&lt;/td&gt;<a name="line.984"></a>
<span class="sourceLineNo">985</span>     *                          &lt;td&gt;When Mode=0x00, DataIn points to the 16-bit master account number generated after the card number is shifted.<a name="line.985"></a>
<span class="sourceLineNo">986</span>     *                          &lt;br&gt;When Mode=0x01, the input parameter is to participate in the formatting of PinBlock, 8 bytes of data (according to the ISO9564 specification, the data can be random numbers, transaction serial numbers or timestamps, etc.).<a name="line.986"></a>
<span class="sourceLineNo">987</span>     *                          &lt;br&gt;When Mode=0x02, DataIn points to the 16-bit main account number generated after the card number is shifted, and DataIn+16 points to 8-byte data that participates in PinBlock formatting (according to the ISO9564 specification, this data can be a random number, transaction serial number, or time stamp And so on, but the upper 4 bits and lower 4 bits of each byte must be between 0xA-0xF, so when Mode is 0x02, the bottom layer will do this check for the 8-byte data, and if it does not meet the requirements, it will return Mistake).<a name="line.987"></a>
<span class="sourceLineNo">988</span>     *                          &lt;br&gt;When Mode=0x03, it is the transaction serial number ISN [6 Bytes, ASCII code]] [input].&lt;/td&gt;<a name="line.988"></a>
<span class="sourceLineNo">989</span>     *                    &lt;/tr&gt;<a name="line.989"></a>
<span class="sourceLineNo">990</span>     *                    &lt;tr&gt;<a name="line.990"></a>
<span class="sourceLineNo">991</span>     *                          &lt;td&gt;0x0007+N&lt;/td&gt;<a name="line.991"></a>
<span class="sourceLineNo">992</span>     *                          &lt;td&gt;M&lt;/td&gt;<a name="line.992"></a>
<span class="sourceLineNo">993</span>     *                          &lt;td&gt;Fill&lt;/td&gt;<a name="line.993"></a>
<span class="sourceLineNo">994</span>     *                          &lt;td&gt;Filling byte, when the above data length is not divisible by 8 bytes, it is filled to 8 bytes.&lt;/td&gt;<a name="line.994"></a>
<span class="sourceLineNo">995</span>     *                    &lt;/tr&gt;<a name="line.995"></a>
<span class="sourceLineNo">996</span>     *                    &lt;/table&gt;&lt;/div&gt;<a name="line.996"></a>
<span class="sourceLineNo">997</span>     * @param timeoutMs &lt;div class="zh"&gt;超时时间。单位: 毫秒。&lt;/div&gt; &lt;div class="en"&gt;Timeout. Unit: milliseconds.&lt;/div&gt;<a name="line.997"></a>
<span class="sourceLineNo">998</span>     * @return &lt;div class="zh"&gt;如果输入长度为0，则返回new byte[0]。<a name="line.998"></a>
<span class="sourceLineNo">999</span>     *                     &lt;br&gt;如果输入长度不为0，则返回8字节的PinBlock。&lt;/div&gt;<a name="line.999"></a>
<span class="sourceLineNo">1000</span>     *         &lt;div class="en"&gt;If the input length is 0, new byte[0] is returned.<a name="line.1000"></a>
<span class="sourceLineNo">1001</span>     *                     &lt;br&gt;If the input length is not 0, an 8-byte PinBlock is returned.&lt;/div&gt;<a name="line.1001"></a>
<span class="sourceLineNo">1002</span>     * @throws TypeAException TypeAException<a name="line.1002"></a>
<span class="sourceLineNo">1003</span>     */<a name="line.1003"></a>
<span class="sourceLineNo">1004</span>    byte[] getPinBlock(byte[] cipherByTXK, int timeoutMs) throws TypeAException;<a name="line.1004"></a>
<span class="sourceLineNo">1005</span>    /**<a name="line.1005"></a>
<span class="sourceLineNo">1006</span>     * &lt;div class="zh"&gt;用指定的 MAC 密钥对 Data 作 MAC 加密运算。<a name="line.1006"></a>
<span class="sourceLineNo">1007</span>     * &lt;br&gt;当其最高位为 1 时，先用指定的工作密钥对 Data 前 8 字节进行一次 DES 或 3DES 解密，其结果覆盖 Data 前 8 字节，然后再按 Mode 指定的算法对最新的 Data 数据块进行相应 MAC 运算。&lt;/div&gt;<a name="line.1007"></a>
<span class="sourceLineNo">1008</span>     * &lt;div class="en"&gt;Use the specified MAC key to perform MAC encryption operations on Data.<a name="line.1008"></a>
<span class="sourceLineNo">1009</span>     * &lt;br&gt;When the highest bit is 1, use the specified working key to decrypt the first 8 bytes of Data with DES or 3DES, and the result will cover the first 8 bytes of Data, and then perform the latest Data block according to the algorithm specified by Mode Carry out the corresponding MAC operation.&lt;/div&gt;<a name="line.1009"></a>
<span class="sourceLineNo">1010</span>     *<a name="line.1010"></a>
<span class="sourceLineNo">1011</span>     * @param macMode &lt;div class="zh"&gt;MAC算法类型<a name="line.1011"></a>
<span class="sourceLineNo">1012</span>     *                &lt;ul&gt;&lt;li&gt;0x00－算法 1\3 &lt;/li&gt;<a name="line.1012"></a>
<span class="sourceLineNo">1013</span>     *                    &lt;li&gt;0x01－算法 2&lt;/li&gt;<a name="line.1013"></a>
<span class="sourceLineNo">1014</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1014"></a>
<span class="sourceLineNo">1015</span>     *                &lt;div class="en"&gt;MAC algorithm type<a name="line.1015"></a>
<span class="sourceLineNo">1016</span>     *                &lt;ul&gt;&lt;li&gt;0x00－algorithm 1\3 &lt;/li&gt;<a name="line.1016"></a>
<span class="sourceLineNo">1017</span>     *                    &lt;li&gt;0x01－algorithm 2&lt;/li&gt;<a name="line.1017"></a>
<span class="sourceLineNo">1018</span>     *                  &lt;/ul&gt;&lt;/div&gt;<a name="line.1018"></a>
<span class="sourceLineNo">1019</span>     *<a name="line.1019"></a>
<span class="sourceLineNo">1020</span>     * @param keyIndex &lt;div class="zh"&gt;低 7 位是 MAC 工作密钥的索引。 当其最高位为 1 时，将在 Mode 指定的算法进行之前增加一次额外的解密运算&lt;/div&gt;<a name="line.1020"></a>
<span class="sourceLineNo">1021</span>     *                 &lt;div class="en"&gt;The lower 7 bits are the index of the MAC working key. When the highest bit is 1, an additional decryption operation will be added before the algorithm specified by Mode is performed&lt;/div&gt;<a name="line.1021"></a>
<span class="sourceLineNo">1022</span>     * @param algorithmMode &lt;div class="zh"&gt;<a name="line.1022"></a>
<span class="sourceLineNo">1023</span>     *                      &lt;ul&gt;&lt;li&gt;0x01 DES 加密 算法 1\2&lt;/li&gt;<a name="line.1023"></a>
<span class="sourceLineNo">1024</span>     *                          &lt;li&gt;0x03 3DES 加密[密钥为 16 字节] 算法 1\2&lt;/li&gt;<a name="line.1024"></a>
<span class="sourceLineNo">1025</span>     *                          &lt;li&gt;0x07 3DES 加密[密钥为 24 字节] 算法 1\2&lt;/li&gt;<a name="line.1025"></a>
<span class="sourceLineNo">1026</span>     *                          &lt;li&gt;0x13: 3DES 加密[密钥为 16 字节] 算法 3&lt;/li&gt;<a name="line.1026"></a>
<span class="sourceLineNo">1027</span>     *                          &lt;li&gt;0x17: 3DES 加密[密钥为 24 字节] 算法 3&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;<a name="line.1027"></a>
<span class="sourceLineNo">1028</span>     *<a name="line.1028"></a>
<span class="sourceLineNo">1029</span>     * @param dataIn &lt;div class="zh"&gt;要进行 MAC 加密的数据。 WKeyID 最高位为 1 时，需至少 9 字节。&lt;/div&gt;<a name="line.1029"></a>
<span class="sourceLineNo">1030</span>     *               &lt;div class="en"&gt;Data to be MAC encrypted. When the most significant bit of WKeyID is 1, at least 9 bytes are required.&lt;/div&gt;<a name="line.1030"></a>
<span class="sourceLineNo">1031</span>     *<a name="line.1031"></a>
<span class="sourceLineNo">1032</span>     * @return &lt;div class="zh"&gt;计算得到的MAC&lt;/div&gt;<a name="line.1032"></a>
<span class="sourceLineNo">1033</span>     *         &lt;div class="en"&gt;Calculated MAC&lt;/div&gt;<a name="line.1033"></a>
<span class="sourceLineNo">1034</span>     * @throws TypeAException TypeAException<a name="line.1034"></a>
<span class="sourceLineNo">1035</span>     */<a name="line.1035"></a>
<span class="sourceLineNo">1036</span>    byte[] getMac(byte macMode, byte keyIndex, byte algorithmMode, byte[] dataIn) throws TypeAException;<a name="line.1036"></a>
<span class="sourceLineNo">1037</span>    /**<a name="line.1037"></a>
<span class="sourceLineNo">1038</span>     * &lt;div class="zh"&gt;用指定的 DES 密钥对 Data 作 DES 或者 3DES 加密或解密运算。&lt;/div&gt;<a name="line.1038"></a>
<span class="sourceLineNo">1039</span>     * &lt;div class="en"&gt;Use the specified DES key to perform DES or 3DES encryption or decryption operations on Data.&lt;/div&gt;<a name="line.1039"></a>
<span class="sourceLineNo">1040</span>     *<a name="line.1040"></a>
<span class="sourceLineNo">1041</span>     * @param keyIndex &lt;div class="zh"&gt;DES（3DES）密钥索引（DES 密钥区）&lt;/div&gt;<a name="line.1041"></a>
<span class="sourceLineNo">1042</span>     *                 &lt;div class="en"&gt;DES (3DES) key index (DES key area)&lt;/div&gt;<a name="line.1042"></a>
<span class="sourceLineNo">1043</span>     *<a name="line.1043"></a>
<span class="sourceLineNo">1044</span>     * @param mode &lt;div class="zh"&gt;<a name="line.1044"></a>
<span class="sourceLineNo">1045</span>     *             &lt;ul&gt;<a name="line.1045"></a>
<span class="sourceLineNo">1046</span>     *             &lt;li&gt;mode = 0x01 DES 加密 &lt;/li&gt;<a name="line.1046"></a>
<span class="sourceLineNo">1047</span>     *             &lt;li&gt;mode = 0x03 3DES 加密 （密钥为 16 字节） &lt;/li&gt;<a name="line.1047"></a>
<span class="sourceLineNo">1048</span>     *             &lt;li&gt;mode = 0x81 DES 解密 （EPS 无此项） &lt;/li&gt;<a name="line.1048"></a>
<span class="sourceLineNo">1049</span>     *             &lt;li&gt;mode = 0x83 3DES 解密 （EPS 无此项） &lt;/li&gt;<a name="line.1049"></a>
<span class="sourceLineNo">1050</span>     *             &lt;li&gt;mode = 0x07 3DES 加密 [密钥为 24 字节] &lt;/li&gt;<a name="line.1050"></a>
<span class="sourceLineNo">1051</span>     *             &lt;li&gt;mode = 0x87 3DES 解密 [密钥为 24 字节]&lt;/li&gt;<a name="line.1051"></a>
<span class="sourceLineNo">1052</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.1052"></a>
<span class="sourceLineNo">1053</span>     *             &lt;div class="en"&gt;<a name="line.1053"></a>
<span class="sourceLineNo">1054</span>     *             &lt;ul&gt;<a name="line.1054"></a>
<span class="sourceLineNo">1055</span>     *             &lt;li&gt;mode = 0x01 DES encryption&lt;/li&gt;<a name="line.1055"></a>
<span class="sourceLineNo">1056</span>     *             &lt;li&gt;mode = 0x03 3DES encryption (the key is 16 bytes)&lt;/li&gt;<a name="line.1056"></a>
<span class="sourceLineNo">1057</span>     *             &lt;li&gt;mode = 0x81 DES decryption (EPS does not have this option)&lt;/li&gt;<a name="line.1057"></a>
<span class="sourceLineNo">1058</span>     *             &lt;li&gt;mode = 0x83 3DES decryption (EPS does not have this option)&lt;/li&gt;<a name="line.1058"></a>
<span class="sourceLineNo">1059</span>     *             &lt;li&gt;mode = 0x07 3DES encryption [key is 24 bytes]&lt;/li&gt;<a name="line.1059"></a>
<span class="sourceLineNo">1060</span>     *             &lt;li&gt;mode = 0x87 3DES decryption [key is 24 bytes]&lt;/li&gt;<a name="line.1060"></a>
<span class="sourceLineNo">1061</span>     *             &lt;/ul&gt;    &lt;/div&gt;<a name="line.1061"></a>
<span class="sourceLineNo">1062</span>     *<a name="line.1062"></a>
<span class="sourceLineNo">1063</span>     * @param dataIn &lt;div class="zh"&gt;要进行 DES（3DES）加密或解密的数据。（8 字节）&lt;/div&gt;<a name="line.1063"></a>
<span class="sourceLineNo">1064</span>     *               &lt;div class="en"&gt;The data to be encrypted or decrypted by DES (3DES). (8 bytes)&lt;/div&gt;<a name="line.1064"></a>
<span class="sourceLineNo">1065</span>     *<a name="line.1065"></a>
<span class="sourceLineNo">1066</span>     * @return &lt;div class="zh"&gt;运算结果&lt;/div&gt;<a name="line.1066"></a>
<span class="sourceLineNo">1067</span>     *         &lt;div clsss="en"&gt;Calculation result&lt;/div&gt;<a name="line.1067"></a>
<span class="sourceLineNo">1068</span>     * @throws TypeAException TypeAException<a name="line.1068"></a>
<span class="sourceLineNo">1069</span>     */<a name="line.1069"></a>
<span class="sourceLineNo">1070</span>    byte[] calcDes(byte keyIndex, byte mode, byte[] dataIn) throws TypeAException;<a name="line.1070"></a>
<span class="sourceLineNo">1071</span>    /**<a name="line.1071"></a>
<span class="sourceLineNo">1072</span>     * &lt;div class="zh"&gt;用指定的 MAC 密钥对 Data 作 MAC 加密运算。&lt;/div&gt;<a name="line.1072"></a>
<span class="sourceLineNo">1073</span>     * &lt;div class="en"&gt;Use the specified MAC key to perform MAC encryption operations on Data.&lt;/div&gt;<a name="line.1073"></a>
<span class="sourceLineNo">1074</span>     *<a name="line.1074"></a>
<span class="sourceLineNo">1075</span>     * @param cipherFlag &lt;div class="zh"&gt;0x00：DATA 域是明文<a name="line.1075"></a>
<span class="sourceLineNo">1076</span>     *                               &lt;br&gt;0x01: DATA 域，由传输密加密&lt;/div&gt;<a name="line.1076"></a>
<span class="sourceLineNo">1077</span>     *                   &lt;div class="en"&gt;0x00: DATA field is plain text<a name="line.1077"></a>
<span class="sourceLineNo">1078</span>     *                               &lt;br&gt;0x01: DATA field, encrypted by transmission secret&lt;/div&gt;<a name="line.1078"></a>
<span class="sourceLineNo">1079</span>     *<a name="line.1079"></a>
<span class="sourceLineNo">1080</span>     * @param dataIn &lt;div class="zh"&gt;<a name="line.1080"></a>
<span class="sourceLineNo">1081</span>     *               &lt;table border="1"&gt;<a name="line.1081"></a>
<span class="sourceLineNo">1082</span>     *               &lt;tr&gt;<a name="line.1082"></a>
<span class="sourceLineNo">1083</span>     *                  &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.1083"></a>
<span class="sourceLineNo">1084</span>     *                  &lt;th&gt;长度（byte）&lt;/th&gt;<a name="line.1084"></a>
<span class="sourceLineNo">1085</span>     *                  &lt;th&gt;变量名称&lt;/th&gt;<a name="line.1085"></a>
<span class="sourceLineNo">1086</span>     *                  &lt;th&gt;意义&lt;/th&gt;<a name="line.1086"></a>
<span class="sourceLineNo">1087</span>     *               &lt;/tr&gt;<a name="line.1087"></a>
<span class="sourceLineNo">1088</span>     *               &lt;tr&gt;<a name="line.1088"></a>
<span class="sourceLineNo">1089</span>     *                  &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1089"></a>
<span class="sourceLineNo">1090</span>     *                  &lt;td&gt;1&lt;/td&gt;<a name="line.1090"></a>
<span class="sourceLineNo">1091</span>     *                  &lt;td&gt;WKeyID&lt;/td&gt;<a name="line.1091"></a>
<span class="sourceLineNo">1092</span>     *                  &lt;td&gt;1-100&lt;/td&gt;<a name="line.1092"></a>
<span class="sourceLineNo">1093</span>     *               &lt;/tr&gt;<a name="line.1093"></a>
<span class="sourceLineNo">1094</span>     *               &lt;tr&gt;<a name="line.1094"></a>
<span class="sourceLineNo">1095</span>     *                  &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1095"></a>
<span class="sourceLineNo">1096</span>     *                  &lt;td&gt;1&lt;/td&gt;<a name="line.1096"></a>
<span class="sourceLineNo">1097</span>     *                  &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.1097"></a>
<span class="sourceLineNo">1098</span>     *                  &lt;td&gt;8、16 或 24，指示 MAC 运算采用的是 DES 还是 TDES&lt;/td&gt;<a name="line.1098"></a>
<span class="sourceLineNo">1099</span>     *               &lt;/tr&gt;<a name="line.1099"></a>
<span class="sourceLineNo">1100</span>     *               &lt;tr&gt;<a name="line.1100"></a>
<span class="sourceLineNo">1101</span>     *                  &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1101"></a>
<span class="sourceLineNo">1102</span>     *                  &lt;td&gt;1&lt;/td&gt;<a name="line.1102"></a>
<span class="sourceLineNo">1103</span>     *                  &lt;td&gt;Mode&lt;/td&gt;<a name="line.1103"></a>
<span class="sourceLineNo">1104</span>     *                  &lt;td&gt;0x00－算法 1<a name="line.1104"></a>
<span class="sourceLineNo">1105</span>     *                    &lt;br&gt;0x01－算法 2<a name="line.1105"></a>
<span class="sourceLineNo">1106</span>     *                    &lt;br&gt;0x02－算法 3&lt;/td&gt;<a name="line.1106"></a>
<span class="sourceLineNo">1107</span>     *               &lt;/tr&gt;<a name="line.1107"></a>
<span class="sourceLineNo">1108</span>     *               &lt;tr&gt;<a name="line.1108"></a>
<span class="sourceLineNo">1109</span>     *                  &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1109"></a>
<span class="sourceLineNo">1110</span>     *                  &lt;td&gt;2&lt;/td&gt;<a name="line.1110"></a>
<span class="sourceLineNo">1111</span>     *                  &lt;td&gt;MAC_DATA_LEN&lt;/td&gt;<a name="line.1111"></a>
<span class="sourceLineNo">1112</span>     *                  &lt;td&gt;MAC_DATA 长度，小于等于 1024，两字节， 高字节在前，低字节在后&lt;/td&gt;<a name="line.1112"></a>
<span class="sourceLineNo">1113</span>     *               &lt;/tr&gt;<a name="line.1113"></a>
<span class="sourceLineNo">1114</span>     *               &lt;tr&gt;<a name="line.1114"></a>
<span class="sourceLineNo">1115</span>     *                  &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1115"></a>
<span class="sourceLineNo">1116</span>     *                  &lt;td&gt;N&lt;/td&gt;<a name="line.1116"></a>
<span class="sourceLineNo">1117</span>     *                  &lt;td&gt;MAC_DATA&lt;/td&gt;<a name="line.1117"></a>
<span class="sourceLineNo">1118</span>     *                  &lt;td&gt;待计算 MAC 的数据&lt;/td&gt;<a name="line.1118"></a>
<span class="sourceLineNo">1119</span>     *               &lt;/tr&gt;<a name="line.1119"></a>
<span class="sourceLineNo">1120</span>     *               &lt;tr&gt;<a name="line.1120"></a>
<span class="sourceLineNo">1121</span>     *                  &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.1121"></a>
<span class="sourceLineNo">1122</span>     *                  &lt;td&gt;M&lt;/td&gt;<a name="line.1122"></a>
<span class="sourceLineNo">1123</span>     *                  &lt;td&gt;FILL&lt;/td&gt;<a name="line.1123"></a>
<span class="sourceLineNo">1124</span>     *                  &lt;td&gt;填充字节，DATA 域上述数据长度不被 8 字节整除时，填充至 8 字节整除&lt;/td&gt;<a name="line.1124"></a>
<span class="sourceLineNo">1125</span>     *               &lt;/tr&gt;<a name="line.1125"></a>
<span class="sourceLineNo">1126</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1126"></a>
<span class="sourceLineNo">1127</span>     *               &lt;div class="en"&gt;<a name="line.1127"></a>
<span class="sourceLineNo">1128</span>     *                   &lt;table border="1"&gt;<a name="line.1128"></a>
<span class="sourceLineNo">1129</span>     *                   &lt;tr&gt;<a name="line.1129"></a>
<span class="sourceLineNo">1130</span>     *                      &lt;th&gt;Offset&lt;/th&gt;<a name="line.1130"></a>
<span class="sourceLineNo">1131</span>     *                      &lt;th&gt;Length（byte）&lt;/th&gt;<a name="line.1131"></a>
<span class="sourceLineNo">1132</span>     *                      &lt;th&gt;Variable name&lt;/th&gt;<a name="line.1132"></a>
<span class="sourceLineNo">1133</span>     *                      &lt;th&gt;Description&lt;/th&gt;<a name="line.1133"></a>
<span class="sourceLineNo">1134</span>     *                   &lt;/tr&gt;<a name="line.1134"></a>
<span class="sourceLineNo">1135</span>     *                   &lt;tr&gt;<a name="line.1135"></a>
<span class="sourceLineNo">1136</span>     *                      &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1136"></a>
<span class="sourceLineNo">1137</span>     *                      &lt;td&gt;1&lt;/td&gt;<a name="line.1137"></a>
<span class="sourceLineNo">1138</span>     *                      &lt;td&gt;WKeyID&lt;/td&gt;<a name="line.1138"></a>
<span class="sourceLineNo">1139</span>     *                      &lt;td&gt;1-100&lt;/td&gt;<a name="line.1139"></a>
<span class="sourceLineNo">1140</span>     *                   &lt;/tr&gt;<a name="line.1140"></a>
<span class="sourceLineNo">1141</span>     *                   &lt;tr&gt;<a name="line.1141"></a>
<span class="sourceLineNo">1142</span>     *                      &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1142"></a>
<span class="sourceLineNo">1143</span>     *                      &lt;td&gt;1&lt;/td&gt;<a name="line.1143"></a>
<span class="sourceLineNo">1144</span>     *                      &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.1144"></a>
<span class="sourceLineNo">1145</span>     *                      &lt;td&gt;8, 16, or 24, indicating whether the MAC operation uses DES or TDES&lt;/td&gt;<a name="line.1145"></a>
<span class="sourceLineNo">1146</span>     *                   &lt;/tr&gt;<a name="line.1146"></a>
<span class="sourceLineNo">1147</span>     *                   &lt;tr&gt;<a name="line.1147"></a>
<span class="sourceLineNo">1148</span>     *                      &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1148"></a>
<span class="sourceLineNo">1149</span>     *                      &lt;td&gt;1&lt;/td&gt;<a name="line.1149"></a>
<span class="sourceLineNo">1150</span>     *                      &lt;td&gt;Mode&lt;/td&gt;<a name="line.1150"></a>
<span class="sourceLineNo">1151</span>     *                      &lt;td&gt;0x00－algorithm 1<a name="line.1151"></a>
<span class="sourceLineNo">1152</span>     *                        &lt;br&gt;0x01－algorithm 2<a name="line.1152"></a>
<span class="sourceLineNo">1153</span>     *                        &lt;br&gt;0x02－algorithm 3&lt;/td&gt;<a name="line.1153"></a>
<span class="sourceLineNo">1154</span>     *                   &lt;/tr&gt;<a name="line.1154"></a>
<span class="sourceLineNo">1155</span>     *                   &lt;tr&gt;<a name="line.1155"></a>
<span class="sourceLineNo">1156</span>     *                      &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1156"></a>
<span class="sourceLineNo">1157</span>     *                      &lt;td&gt;2&lt;/td&gt;<a name="line.1157"></a>
<span class="sourceLineNo">1158</span>     *                      &lt;td&gt;MAC_DATA_LEN&lt;/td&gt;<a name="line.1158"></a>
<span class="sourceLineNo">1159</span>     *                      &lt;td&gt;MAC_DATA length, less than or equal to 1024, two bytes, high byte first, low byte last&lt;/td&gt;<a name="line.1159"></a>
<span class="sourceLineNo">1160</span>     *                   &lt;/tr&gt;<a name="line.1160"></a>
<span class="sourceLineNo">1161</span>     *                   &lt;tr&gt;<a name="line.1161"></a>
<span class="sourceLineNo">1162</span>     *                      &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1162"></a>
<span class="sourceLineNo">1163</span>     *                      &lt;td&gt;N&lt;/td&gt;<a name="line.1163"></a>
<span class="sourceLineNo">1164</span>     *                      &lt;td&gt;MAC_DATA&lt;/td&gt;<a name="line.1164"></a>
<span class="sourceLineNo">1165</span>     *                      &lt;td&gt;Data to be calculated MAC&lt;/td&gt;<a name="line.1165"></a>
<span class="sourceLineNo">1166</span>     *                   &lt;/tr&gt;<a name="line.1166"></a>
<span class="sourceLineNo">1167</span>     *                   &lt;tr&gt;<a name="line.1167"></a>
<span class="sourceLineNo">1168</span>     *                      &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.1168"></a>
<span class="sourceLineNo">1169</span>     *                      &lt;td&gt;M&lt;/td&gt;<a name="line.1169"></a>
<span class="sourceLineNo">1170</span>     *                      &lt;td&gt;FILL&lt;/td&gt;<a name="line.1170"></a>
<span class="sourceLineNo">1171</span>     *                      &lt;td&gt;Filling byte, when the above data length in DATA field is not divisible by 8 bytes, it is filled to 8 bytes.&lt;/td&gt;<a name="line.1171"></a>
<span class="sourceLineNo">1172</span>     *                   &lt;/tr&gt;<a name="line.1172"></a>
<span class="sourceLineNo">1173</span>     *                   &lt;/table&gt;&lt;/div&gt;<a name="line.1173"></a>
<span class="sourceLineNo">1174</span>     *<a name="line.1174"></a>
<span class="sourceLineNo">1175</span>     * @return &lt;div class="zh"&gt;输出的MAC&lt;/div&gt;<a name="line.1175"></a>
<span class="sourceLineNo">1176</span>     *         &lt;div class="en"&gt;Output MAC&lt;/div&gt;<a name="line.1176"></a>
<span class="sourceLineNo">1177</span>     * @throws TypeAException TypeAException<a name="line.1177"></a>
<span class="sourceLineNo">1178</span>     */<a name="line.1178"></a>
<span class="sourceLineNo">1179</span>    byte[] getExtMac(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.1179"></a>
<span class="sourceLineNo">1180</span>    /**<a name="line.1180"></a>
<span class="sourceLineNo">1181</span>     * &lt;div class="zh"&gt;用指定的 DES 密钥对 Data 作 DES 或者 3DES 加密或解密运算。&lt;/div&gt;<a name="line.1181"></a>
<span class="sourceLineNo">1182</span>     * &lt;div class="en"&gt;Use the specified DES key to perform DES or 3DES encryption or decryption operations on Data.&lt;/div&gt;<a name="line.1182"></a>
<span class="sourceLineNo">1183</span>     *<a name="line.1183"></a>
<span class="sourceLineNo">1184</span>     * @param cipherFlag &lt;div class="zh"&gt;0x00：DATA_IN 与 acuIV 是明文<a name="line.1184"></a>
<span class="sourceLineNo">1185</span>     *                               &lt;br&gt;0x01: DATA_IN 与 acuIV，由传输密钥加密&lt;/div&gt;<a name="line.1185"></a>
<span class="sourceLineNo">1186</span>     *                   &lt;div class="en"&gt;0x00: DATA_IN and acuIV are plain text<a name="line.1186"></a>
<span class="sourceLineNo">1187</span>     *                               &lt;br&gt;0x01: DATA_IN and acuIV, encrypted by the transmission key&lt;/div&gt;<a name="line.1187"></a>
<span class="sourceLineNo">1188</span>     *<a name="line.1188"></a>
<span class="sourceLineNo">1189</span>     * @param dataIn &lt;div class="zh"&gt;<a name="line.1189"></a>
<span class="sourceLineNo">1190</span>     *               &lt;table border="1"&gt;<a name="line.1190"></a>
<span class="sourceLineNo">1191</span>     *               &lt;tr&gt;<a name="line.1191"></a>
<span class="sourceLineNo">1192</span>     *                  &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.1192"></a>
<span class="sourceLineNo">1193</span>     *                  &lt;th&gt;长度（byte）&lt;/th&gt;<a name="line.1193"></a>
<span class="sourceLineNo">1194</span>     *                  &lt;th&gt;变量名称&lt;/th&gt;<a name="line.1194"></a>
<span class="sourceLineNo">1195</span>     *                  &lt;th&gt;意义&lt;/th&gt;<a name="line.1195"></a>
<span class="sourceLineNo">1196</span>     *               &lt;/tr&gt;<a name="line.1196"></a>
<span class="sourceLineNo">1197</span>     *               &lt;tr&gt;<a name="line.1197"></a>
<span class="sourceLineNo">1198</span>     *                  &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1198"></a>
<span class="sourceLineNo">1199</span>     *                  &lt;td&gt;1&lt;/td&gt;<a name="line.1199"></a>
<span class="sourceLineNo">1200</span>     *                  &lt;td&gt;DKeyID&lt;/td&gt;<a name="line.1200"></a>
<span class="sourceLineNo">1201</span>     *                  &lt;td&gt;1-100&lt;/td&gt;<a name="line.1201"></a>
<span class="sourceLineNo">1202</span>     *               &lt;/tr&gt;<a name="line.1202"></a>
<span class="sourceLineNo">1203</span>     *               &lt;tr&gt;<a name="line.1203"></a>
<span class="sourceLineNo">1204</span>     *                  &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1204"></a>
<span class="sourceLineNo">1205</span>     *                  &lt;td&gt;1&lt;/td&gt;<a name="line.1205"></a>
<span class="sourceLineNo">1206</span>     *                  &lt;td&gt;DKeyLen&lt;/td&gt;<a name="line.1206"></a>
<span class="sourceLineNo">1207</span>     *                  &lt;td&gt;8、16 或 24，指示数据加解密是采用的是 DES 还 是 TDES&lt;/td&gt;<a name="line.1207"></a>
<span class="sourceLineNo">1208</span>     *               &lt;/tr&gt;<a name="line.1208"></a>
<span class="sourceLineNo">1209</span>     *               &lt;tr&gt;<a name="line.1209"></a>
<span class="sourceLineNo">1210</span>     *                  &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1210"></a>
<span class="sourceLineNo">1211</span>     *                  &lt;td&gt;1&lt;/td&gt;<a name="line.1211"></a>
<span class="sourceLineNo">1212</span>     *                  &lt;td&gt;Mode&lt;/td&gt;<a name="line.1212"></a>
<span class="sourceLineNo">1213</span>     *                  &lt;td&gt;<a name="line.1213"></a>
<span class="sourceLineNo">1214</span>     *                      &lt;ul&gt;<a name="line.1214"></a>
<span class="sourceLineNo">1215</span>     *                          &lt;li&gt;0x00: ECB decryption&lt;/li&gt;<a name="line.1215"></a>
<span class="sourceLineNo">1216</span>     *                          &lt;li&gt;0x01: ECB encryption&lt;/li&gt;<a name="line.1216"></a>
<span class="sourceLineNo">1217</span>     *                          &lt;li&gt;0x02: CBC decryption&lt;/li&gt;<a name="line.1217"></a>
<span class="sourceLineNo">1218</span>     *                          &lt;li&gt;0x03: CBC encryption&lt;/li&gt;<a name="line.1218"></a>
<span class="sourceLineNo">1219</span>     *                          &lt;li&gt;0x04: OFB decryption&lt;/li&gt;<a name="line.1219"></a>
<span class="sourceLineNo">1220</span>     *                          &lt;li&gt;0x05: OFB encryption&lt;/li&gt;<a name="line.1220"></a>
<span class="sourceLineNo">1221</span>     *                      &lt;/ul&gt;<a name="line.1221"></a>
<span class="sourceLineNo">1222</span>     *                  &lt;/td&gt;<a name="line.1222"></a>
<span class="sourceLineNo">1223</span>     *               &lt;/tr&gt;<a name="line.1223"></a>
<span class="sourceLineNo">1224</span>     *               &lt;tr&gt;<a name="line.1224"></a>
<span class="sourceLineNo">1225</span>     *                  &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1225"></a>
<span class="sourceLineNo">1226</span>     *                  &lt;td&gt;2&lt;/td&gt;<a name="line.1226"></a>
<span class="sourceLineNo">1227</span>     *                  &lt;td&gt;DATA_LEN&lt;/td&gt;<a name="line.1227"></a>
<span class="sourceLineNo">1228</span>     *                  &lt;td&gt;DATA 长度，小于等于 1024，两字节，高 字节在前，低字节在后,8 字节整除。&lt;/td&gt;<a name="line.1228"></a>
<span class="sourceLineNo">1229</span>     *               &lt;/tr&gt;<a name="line.1229"></a>
<span class="sourceLineNo">1230</span>     *               &lt;tr&gt;<a name="line.1230"></a>
<span class="sourceLineNo">1231</span>     *                  &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1231"></a>
<span class="sourceLineNo">1232</span>     *                  &lt;td&gt;N&lt;/td&gt;<a name="line.1232"></a>
<span class="sourceLineNo">1233</span>     *                  &lt;td&gt;DATA_IN_IN&lt;/td&gt;<a name="line.1233"></a>
<span class="sourceLineNo">1234</span>     *                  &lt;td&gt;待加解密的数据&lt;/td&gt;<a name="line.1234"></a>
<span class="sourceLineNo">1235</span>     *               &lt;/tr&gt;<a name="line.1235"></a>
<span class="sourceLineNo">1236</span>     *               &lt;tr&gt;<a name="line.1236"></a>
<span class="sourceLineNo">1237</span>     *                  &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.1237"></a>
<span class="sourceLineNo">1238</span>     *                  &lt;td&gt;8&lt;/td&gt;<a name="line.1238"></a>
<span class="sourceLineNo">1239</span>     *                  &lt;td&gt;aucIV&lt;/td&gt;<a name="line.1239"></a>
<span class="sourceLineNo">1240</span>     *                  &lt;td&gt;初始向量，ECB 时不需要。&lt;/td&gt;<a name="line.1240"></a>
<span class="sourceLineNo">1241</span>     *               &lt;/tr&gt;<a name="line.1241"></a>
<span class="sourceLineNo">1242</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1242"></a>
<span class="sourceLineNo">1243</span>     *               &lt;div class="en"&gt;<a name="line.1243"></a>
<span class="sourceLineNo">1244</span>     *                   &lt;table border="1"&gt;<a name="line.1244"></a>
<span class="sourceLineNo">1245</span>     *                   &lt;tr&gt;<a name="line.1245"></a>
<span class="sourceLineNo">1246</span>     *                      &lt;th&gt;Offset&lt;/th&gt;<a name="line.1246"></a>
<span class="sourceLineNo">1247</span>     *                      &lt;th&gt;Length（byte）&lt;/th&gt;<a name="line.1247"></a>
<span class="sourceLineNo">1248</span>     *                      &lt;th&gt;Variable name&lt;/th&gt;<a name="line.1248"></a>
<span class="sourceLineNo">1249</span>     *                      &lt;th&gt;Description&lt;/th&gt;<a name="line.1249"></a>
<span class="sourceLineNo">1250</span>     *                   &lt;/tr&gt;<a name="line.1250"></a>
<span class="sourceLineNo">1251</span>     *                   &lt;tr&gt;<a name="line.1251"></a>
<span class="sourceLineNo">1252</span>     *                      &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1252"></a>
<span class="sourceLineNo">1253</span>     *                      &lt;td&gt;1&lt;/td&gt;<a name="line.1253"></a>
<span class="sourceLineNo">1254</span>     *                      &lt;td&gt;DKeyID&lt;/td&gt;<a name="line.1254"></a>
<span class="sourceLineNo">1255</span>     *                      &lt;td&gt;1-100&lt;/td&gt;<a name="line.1255"></a>
<span class="sourceLineNo">1256</span>     *                   &lt;/tr&gt;<a name="line.1256"></a>
<span class="sourceLineNo">1257</span>     *                   &lt;tr&gt;<a name="line.1257"></a>
<span class="sourceLineNo">1258</span>     *                      &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1258"></a>
<span class="sourceLineNo">1259</span>     *                      &lt;td&gt;1&lt;/td&gt;<a name="line.1259"></a>
<span class="sourceLineNo">1260</span>     *                      &lt;td&gt;DKeyLen&lt;/td&gt;<a name="line.1260"></a>
<span class="sourceLineNo">1261</span>     *                      &lt;td&gt;8, 16 or 24, indicating whether the data encryption and decryption use DES or TDES&lt;/td&gt;<a name="line.1261"></a>
<span class="sourceLineNo">1262</span>     *                   &lt;/tr&gt;<a name="line.1262"></a>
<span class="sourceLineNo">1263</span>     *                   &lt;tr&gt;<a name="line.1263"></a>
<span class="sourceLineNo">1264</span>     *                      &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1264"></a>
<span class="sourceLineNo">1265</span>     *                      &lt;td&gt;1&lt;/td&gt;<a name="line.1265"></a>
<span class="sourceLineNo">1266</span>     *                      &lt;td&gt;Mode&lt;/td&gt;<a name="line.1266"></a>
<span class="sourceLineNo">1267</span>     *                      &lt;td&gt;<a name="line.1267"></a>
<span class="sourceLineNo">1268</span>     *                          &lt;ul&gt;<a name="line.1268"></a>
<span class="sourceLineNo">1269</span>     *                              &lt;li&gt;0x00: ECB decryption&lt;/li&gt;<a name="line.1269"></a>
<span class="sourceLineNo">1270</span>     *                              &lt;li&gt;0x01: ECB encryption&lt;/li&gt;<a name="line.1270"></a>
<span class="sourceLineNo">1271</span>     *                              &lt;li&gt;0x02: CBC decryption&lt;/li&gt;<a name="line.1271"></a>
<span class="sourceLineNo">1272</span>     *                              &lt;li&gt;0x03: CBC encryption&lt;/li&gt;<a name="line.1272"></a>
<span class="sourceLineNo">1273</span>     *                              &lt;li&gt;0x04: OFB decryption&lt;/li&gt;<a name="line.1273"></a>
<span class="sourceLineNo">1274</span>     *                              &lt;li&gt;0x05: OFB encryption&lt;/li&gt;<a name="line.1274"></a>
<span class="sourceLineNo">1275</span>     *                          &lt;/ul&gt;<a name="line.1275"></a>
<span class="sourceLineNo">1276</span>     *                      &lt;/td&gt;<a name="line.1276"></a>
<span class="sourceLineNo">1277</span>     *                   &lt;/tr&gt;<a name="line.1277"></a>
<span class="sourceLineNo">1278</span>     *                   &lt;tr&gt;<a name="line.1278"></a>
<span class="sourceLineNo">1279</span>     *                      &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1279"></a>
<span class="sourceLineNo">1280</span>     *                      &lt;td&gt;2&lt;/td&gt;<a name="line.1280"></a>
<span class="sourceLineNo">1281</span>     *                      &lt;td&gt;DATA_LEN&lt;/td&gt;<a name="line.1281"></a>
<span class="sourceLineNo">1282</span>     *                      &lt;td&gt;DATA length, less than or equal to 1024, two bytes, high byte first, low byte last, 8 bytes are divisible&lt;/td&gt;<a name="line.1282"></a>
<span class="sourceLineNo">1283</span>     *                   &lt;/tr&gt;<a name="line.1283"></a>
<span class="sourceLineNo">1284</span>     *                   &lt;tr&gt;<a name="line.1284"></a>
<span class="sourceLineNo">1285</span>     *                      &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1285"></a>
<span class="sourceLineNo">1286</span>     *                      &lt;td&gt;N&lt;/td&gt;<a name="line.1286"></a>
<span class="sourceLineNo">1287</span>     *                      &lt;td&gt;DATA_IN_IN&lt;/td&gt;<a name="line.1287"></a>
<span class="sourceLineNo">1288</span>     *                      &lt;td&gt;DData to be encrypted and decrypted&lt;/td&gt;<a name="line.1288"></a>
<span class="sourceLineNo">1289</span>     *                   &lt;/tr&gt;<a name="line.1289"></a>
<span class="sourceLineNo">1290</span>     *                   &lt;tr&gt;<a name="line.1290"></a>
<span class="sourceLineNo">1291</span>     *                      &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.1291"></a>
<span class="sourceLineNo">1292</span>     *                      &lt;td&gt;8&lt;/td&gt;<a name="line.1292"></a>
<span class="sourceLineNo">1293</span>     *                      &lt;td&gt;aucIV&lt;/td&gt;<a name="line.1293"></a>
<span class="sourceLineNo">1294</span>     *                      &lt;td&gt;Initial vector, not needed for ECB.&lt;/td&gt;<a name="line.1294"></a>
<span class="sourceLineNo">1295</span>     *                   &lt;/tr&gt;<a name="line.1295"></a>
<span class="sourceLineNo">1296</span>     *                   &lt;/table&gt;&lt;/div&gt;<a name="line.1296"></a>
<span class="sourceLineNo">1297</span>     *<a name="line.1297"></a>
<span class="sourceLineNo">1298</span>     * @return  &lt;div class="zh"&gt;运算结果&lt;/div&gt;<a name="line.1298"></a>
<span class="sourceLineNo">1299</span>     *          &lt;div class="en"&gt;Calculation result&lt;/div&gt;<a name="line.1299"></a>
<span class="sourceLineNo">1300</span>     * @throws TypeAException TypeAException<a name="line.1300"></a>
<span class="sourceLineNo">1301</span>     */<a name="line.1301"></a>
<span class="sourceLineNo">1302</span>    byte[] calcExtDes(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.1302"></a>
<span class="sourceLineNo">1303</span><a name="line.1303"></a>
<span class="sourceLineNo">1304</span>    /**<a name="line.1304"></a>
<span class="sourceLineNo">1305</span>     * &lt;div class="zh"&gt;用于重新初始化 DUKPT 密钥。&lt;/div&gt; &lt;div class="en"&gt;Used to reinitialize the DUKPT key.&lt;/div&gt;<a name="line.1305"></a>
<span class="sourceLineNo">1306</span>     *<a name="line.1306"></a>
<span class="sourceLineNo">1307</span>     * @param appNo &lt;div class="zh"&gt;应用标志号，有效值 0-23&lt;/div&gt;<a name="line.1307"></a>
<span class="sourceLineNo">1308</span>     *              &lt;div class="en"&gt;Application mark number, valid value 0-23&lt;/div&gt;<a name="line.1308"></a>
<span class="sourceLineNo">1309</span>     *<a name="line.1309"></a>
<span class="sourceLineNo">1310</span>     * @param groupIndex &lt;div class="zh"&gt;密钥标志号，有效值 1-10。&lt;/div&gt;<a name="line.1310"></a>
<span class="sourceLineNo">1311</span>     *                   &lt;div class="en"&gt;Key mark number, valid value 1-10.&lt;/div&gt;<a name="line.1311"></a>
<span class="sourceLineNo">1312</span>     *<a name="line.1312"></a>
<span class="sourceLineNo">1313</span>     * @param keyValue &lt;div class="zh"&gt;初始 PIN 输入设备密钥，16 字节，由 BDK 和 KSN 通过 DUKPT 密钥初始化 专用设备生成。&lt;/div&gt;<a name="line.1313"></a>
<span class="sourceLineNo">1314</span>     *                 &lt;div class="en&gt;Initial PIN Enter the device key, 16 bytes, which is generated by BDK and KSN through the DUKPT key initialization special device.&lt;/div&gt;<a name="line.1314"></a>
<span class="sourceLineNo">1315</span>     *<a name="line.1315"></a>
<span class="sourceLineNo">1316</span>     * @param ksn &lt;div class="zh"&gt;初始 KSN，长度不足 10 字节时，会自动在左边填充 0xFF 至 10 字节。&lt;/div&gt;<a name="line.1316"></a>
<span class="sourceLineNo">1317</span>     *            &lt;div class="en"&gt;Initial KSN. when ksn is less than 10 bytes in length, 0xFF to 10 bytes will be automatically filled on the left.&lt;/div&gt;<a name="line.1317"></a>
<span class="sourceLineNo">1318</span>     *<a name="line.1318"></a>
<span class="sourceLineNo">1319</span>     * @throws TypeAException TypeAException<a name="line.1319"></a>
<span class="sourceLineNo">1320</span>     */<a name="line.1320"></a>
<span class="sourceLineNo">1321</span>    void writeTIK(byte appNo, byte groupIndex, byte[] keyValue, byte[] ksn) throws TypeAException;<a name="line.1321"></a>
<span class="sourceLineNo">1322</span><a name="line.1322"></a>
<span class="sourceLineNo">1323</span>    /**<a name="line.1323"></a>
<span class="sourceLineNo">1324</span>     * &lt;div class="zh"&gt;提示用户输入 PIN。待输入完毕后，依照所选标准生成和输出 PIN 密文块和当前密钥序号 KSN。<a name="line.1324"></a>
<span class="sourceLineNo">1325</span>     * &lt;br&gt;为防止非法套取密钥，从上一次执行该命令到本次指令之间的间隔应不小于 30 秒（该值可能需要调整）。&lt;/div&gt;<a name="line.1325"></a>
<span class="sourceLineNo">1326</span>     * &lt;div class="en"&gt;Prompt the user to enter a PIN. After the input is completed,<a name="line.1326"></a>
<span class="sourceLineNo">1327</span>     * the PIN ciphertext block and the current key sequence number KSN are generated and output according to the selected standard.<a name="line.1327"></a>
<span class="sourceLineNo">1328</span>     * &lt;br&gt;In order to prevent illegal key acquisition, the interval from the last execution of this command to this command should be no less than 30 seconds (this value may need to be adjusted).&lt;/div&gt;<a name="line.1328"></a>
<span class="sourceLineNo">1329</span>     *<a name="line.1329"></a>
<span class="sourceLineNo">1330</span>     * @param appNo &lt;div class="zh"&gt;应用标志号，有效值 0-23&lt;/div&gt;<a name="line.1330"></a>
<span class="sourceLineNo">1331</span>     *              &lt;div class="en"&gt;Application mark number, valid value 0-23&lt;/div&gt;<a name="line.1331"></a>
<span class="sourceLineNo">1332</span>     *<a name="line.1332"></a>
<span class="sourceLineNo">1333</span>     * @param groupIndex &lt;div class="zh"&gt;密钥标志号，有效值 1-10。&lt;/div&gt;<a name="line.1333"></a>
<span class="sourceLineNo">1334</span>     *                   &lt;div class="en"&gt;Key mark number, valid value 1-10.&lt;/div&gt;<a name="line.1334"></a>
<span class="sourceLineNo">1335</span>     *<a name="line.1335"></a>
<span class="sourceLineNo">1336</span>     * @param min &lt;div class="zh"&gt;允许输入 PIN 的最小长度，应不超过最大允许长度。&lt;/div&gt;<a name="line.1336"></a>
<span class="sourceLineNo">1337</span>     *            &lt;div class="en"&gt;The minimum length allowed to enter the PIN should not exceed the maximum allowed length.&lt;/div&gt;<a name="line.1337"></a>
<span class="sourceLineNo">1338</span>     *<a name="line.1338"></a>
<span class="sourceLineNo">1339</span>     * @param max &lt;div class="zh"&gt;允许输入 PIN 的最大长度，应不超过 12。&lt;/div&gt;<a name="line.1339"></a>
<span class="sourceLineNo">1340</span>     *            &lt;div class="en"&gt;The maximum length of the PIN allowed to be entered should not exceed 12.&lt;/div&gt;<a name="line.1340"></a>
<span class="sourceLineNo">1341</span>     *<a name="line.1341"></a>
<span class="sourceLineNo">1342</span>     * @param dataIn &lt;div class="zh"&gt;当mode = 0x00时，表示持卡人的卡号资料，该卡号应固定为 16 字节，并保证其尾部 12 字节为有效 数据。<a name="line.1342"></a>
<span class="sourceLineNo">1343</span>     *                           &lt;br&gt;当mode = 0x01时，表示交易序号，该序号应固定为 6 字节，有效值 000000-999999。&lt;/div&gt;<a name="line.1343"></a>
<span class="sourceLineNo">1344</span>     *               &lt;div class="en"&gt;When mode = 0x00, it means the card number information of the cardholder. The card number should be fixed to 16 bytes, and the last 12 bytes should be guaranteed to be valid data.<a name="line.1344"></a>
<span class="sourceLineNo">1345</span>     *                           &lt;br&gt;When mode = 0x01, it means the transaction serial number. The serial number should be fixed to 6 bytes and the effective value is 000000-999999.&lt;/div&gt;<a name="line.1345"></a>
<span class="sourceLineNo">1346</span>     *<a name="line.1346"></a>
<span class="sourceLineNo">1347</span>     * @param mode &lt;div class="zh"&gt;0x00: 依照 ANSI X98 标准<a name="line.1347"></a>
<span class="sourceLineNo">1348</span>     *                         &lt;br&gt;0x01: 依照 ANSI X3.92 标准&lt;/div&gt;<a name="line.1348"></a>
<span class="sourceLineNo">1349</span>     *             &lt;div class="en"&gt;0x00: According to ANSI X98 standard<a name="line.1349"></a>
<span class="sourceLineNo">1350</span>     *                         &lt;br&gt;0x01: According to ANSI X3.92 standard&lt;/div&gt;<a name="line.1350"></a>
<span class="sourceLineNo">1351</span>     *<a name="line.1351"></a>
<span class="sourceLineNo">1352</span>     * @param timeoutMs &lt;div class="zh"&gt;超时时间，单位：ms&lt;/div&gt;<a name="line.1352"></a>
<span class="sourceLineNo">1353</span>     *                  &lt;div class="en"&gt;Timeout time(ms）&lt;/div&gt;<a name="line.1353"></a>
<span class="sourceLineNo">1354</span>     *<a name="line.1354"></a>
<span class="sourceLineNo">1355</span>     * @return {@link DUKPTResult}<a name="line.1355"></a>
<span class="sourceLineNo">1356</span>     * @throws TypeAException TypeAException<a name="line.1356"></a>
<span class="sourceLineNo">1357</span>     */<a name="line.1357"></a>
<span class="sourceLineNo">1358</span>    DUKPTResult getDUKPTPin(byte appNo, byte groupIndex, byte min, byte max, byte[] dataIn, byte mode, int timeoutMs) throws TypeAException;<a name="line.1358"></a>
<span class="sourceLineNo">1359</span>    /**<a name="line.1359"></a>
<span class="sourceLineNo">1360</span>     * &lt;div class="zh"&gt;对输入数据报文进行指定算法的验证码运算，并输出生成的 MAC 和当前密钥序号 KSN。&lt;/div&gt;<a name="line.1360"></a>
<span class="sourceLineNo">1361</span>     * &lt;div class="en"&gt;Perform the verification code operation of the specified algorithm on the input data message, and output the generated MAC and the current key sequence number KSN.&lt;/div&gt;<a name="line.1361"></a>
<span class="sourceLineNo">1362</span>     *<a name="line.1362"></a>
<span class="sourceLineNo">1363</span>     * @param appNo &lt;div class="zh"&gt;应用标志号，有效值 0-23&lt;/div&gt;<a name="line.1363"></a>
<span class="sourceLineNo">1364</span>     *              &lt;div class="en"&gt;Application mark number, valid value 0-23&lt;/div&gt;<a name="line.1364"></a>
<span class="sourceLineNo">1365</span>     *<a name="line.1365"></a>
<span class="sourceLineNo">1366</span>     * @param groupIndex &lt;div class="zh"&gt;密钥标志号，有效值 1-10。&lt;/div&gt;<a name="line.1366"></a>
<span class="sourceLineNo">1367</span>     *                   &lt;div class="en"&gt;Key mark number, valid value 1-10.&lt;/div&gt;<a name="line.1367"></a>
<span class="sourceLineNo">1368</span>     *<a name="line.1368"></a>
<span class="sourceLineNo">1369</span>     * @param mode &lt;div class="zh"&gt;指定 MAC 算法<a name="line.1369"></a>
<span class="sourceLineNo">1370</span>     *             &lt;ul&gt;<a name="line.1370"></a>
<span class="sourceLineNo">1371</span>     *              &lt;li&gt;0x00: 依次连续进行 3DES/异或/3DES/异或/…/3DES 的运算 &lt;/li&gt;<a name="line.1371"></a>
<span class="sourceLineNo">1372</span>     *              &lt;li&gt;0x01: 依次连续进行异或/异或/…/异或，最后进行一次 3DES 的运算 &lt;/li&gt;<a name="line.1372"></a>
<span class="sourceLineNo">1373</span>     *              &lt;li&gt;0x02: 依次连续进行 DES/异或/DES/异或/…/3DES 的运算，注意最后一次为 3DES 运算&lt;/li&gt;<a name="line.1373"></a>
<span class="sourceLineNo">1374</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.1374"></a>
<span class="sourceLineNo">1375</span>     *             &lt;div class="en"&gt;Specify MAC algorithm<a name="line.1375"></a>
<span class="sourceLineNo">1376</span>     *             &lt;ul&gt;<a name="line.1376"></a>
<span class="sourceLineNo">1377</span>     *              &lt;li&gt;0x00: Perform 3DES/XOR/3DES/XOR/.../3DES operations in sequence&lt;/li&gt;<a name="line.1377"></a>
<span class="sourceLineNo">1378</span>     *              &lt;li&gt;0x01: XOR/XOR/.../XOR is performed successively, and the 3DES operation is performed last&lt;/li&gt;<a name="line.1378"></a>
<span class="sourceLineNo">1379</span>     *              &lt;li&gt;0x02: DES/XOR/DES/XOR/.../3DES operations are successively performed in sequence, note that the last operation is 3DES operation&lt;/li&gt;<a name="line.1379"></a>
<span class="sourceLineNo">1380</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.1380"></a>
<span class="sourceLineNo">1381</span>     *<a name="line.1381"></a>
<span class="sourceLineNo">1382</span>     * @param dataIn &lt;div class="zh"&gt;输入的数据报文,有效长度为1-250&lt;/div&gt;<a name="line.1382"></a>
<span class="sourceLineNo">1383</span>     *               &lt;div class="en"&gt;The input data message, the effective length is 1-250&lt;/div&gt;<a name="line.1383"></a>
<span class="sourceLineNo">1384</span>     *<a name="line.1384"></a>
<span class="sourceLineNo">1385</span>     * @return {@link DUKPTResult}<a name="line.1385"></a>
<span class="sourceLineNo">1386</span>     * @throws TypeAException TypeAException<a name="line.1386"></a>
<span class="sourceLineNo">1387</span>     */<a name="line.1387"></a>
<span class="sourceLineNo">1388</span>    DUKPTResult getDUKPTMac(byte appNo, byte groupIndex, byte mode, byte[] dataIn) throws TypeAException;<a name="line.1388"></a>
<span class="sourceLineNo">1389</span>    /**<a name="line.1389"></a>
<span class="sourceLineNo">1390</span>     * &lt;div class="zh"&gt;用于清除指定的部分或全部 DUKPT 密钥&lt;/div&gt; &lt;div class="en"&gt;Used to clear some or all of the specified DUKPT key&lt;/div&gt;<a name="line.1390"></a>
<span class="sourceLineNo">1391</span>     *<a name="line.1391"></a>
<span class="sourceLineNo">1392</span>     * @param appNo &lt;div class="zh"&gt;应用标志号，有效值 0-23&lt;/div&gt;<a name="line.1392"></a>
<span class="sourceLineNo">1393</span>     *              &lt;div class="en"&gt;Application mark number, valid value 0-23&lt;/div&gt;<a name="line.1393"></a>
<span class="sourceLineNo">1394</span>     *<a name="line.1394"></a>
<span class="sourceLineNo">1395</span>     * @param keyIndex &lt;div class="zh"&gt;密钥标志号，有效值 1-10。&lt;/div&gt;<a name="line.1395"></a>
<span class="sourceLineNo">1396</span>     *                 &lt;div class="en"&gt;Key mark number, valid value 1-10.&lt;/div&gt;<a name="line.1396"></a>
<span class="sourceLineNo">1397</span>     *<a name="line.1397"></a>
<span class="sourceLineNo">1398</span>     * @param mode &lt;div class="zh"&gt;指定清除方式：<a name="line.1398"></a>
<span class="sourceLineNo">1399</span>     *                           &lt;br&gt;0—清除 AppNo 指定应用中所有 DUKPT 密钥<a name="line.1399"></a>
<span class="sourceLineNo">1400</span>     *                           &lt;br&gt;1—清除 AppNo 指定应用中 KeyId 所对应的 DUKPT 密钥&lt;/div&gt;<a name="line.1400"></a>
<span class="sourceLineNo">1401</span>     *             &lt;div class="en"&gt;Specify the clearing method:<a name="line.1401"></a>
<span class="sourceLineNo">1402</span>     *                           &lt;br&gt;0—Clear all DUKPT keys in AppNo specified application<a name="line.1402"></a>
<span class="sourceLineNo">1403</span>     *                           &lt;br&gt;1—Clear the DUKPT key corresponding to the KeyId in the AppNo specified application&lt;/div&gt;<a name="line.1403"></a>
<span class="sourceLineNo">1404</span>     * @throws TypeAException TypeAException<a name="line.1404"></a>
<span class="sourceLineNo">1405</span>     */<a name="line.1405"></a>
<span class="sourceLineNo">1406</span>    void eraseDUKPTKey(byte appNo, byte keyIndex, byte mode) throws TypeAException;<a name="line.1406"></a>
<span class="sourceLineNo">1407</span><a name="line.1407"></a>
<span class="sourceLineNo">1408</span>    /**<a name="line.1408"></a>
<span class="sourceLineNo">1409</span>     * &lt;div class="zh"&gt;将 SM4 密钥存储在指定位置。&lt;/div&gt; &lt;div class="en"&gt;&lt;/div&gt;<a name="line.1409"></a>
<span class="sourceLineNo">1410</span>     *<a name="line.1410"></a>
<span class="sourceLineNo">1411</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.1411"></a>
<span class="sourceLineNo">1412</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.1412"></a>
<span class="sourceLineNo">1413</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.1413"></a>
<span class="sourceLineNo">1414</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1414"></a>
<span class="sourceLineNo">1415</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.1415"></a>
<span class="sourceLineNo">1416</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.1416"></a>
<span class="sourceLineNo">1417</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.1417"></a>
<span class="sourceLineNo">1418</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1418"></a>
<span class="sourceLineNo">1419</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.1419"></a>
<span class="sourceLineNo">1420</span>     *                 &lt;tr&gt;<a name="line.1420"></a>
<span class="sourceLineNo">1421</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.1421"></a>
<span class="sourceLineNo">1422</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.1422"></a>
<span class="sourceLineNo">1423</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.1423"></a>
<span class="sourceLineNo">1424</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.1424"></a>
<span class="sourceLineNo">1425</span>     *                 &lt;/tr&gt;<a name="line.1425"></a>
<span class="sourceLineNo">1426</span>     *                 &lt;tr&gt;<a name="line.1426"></a>
<span class="sourceLineNo">1427</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1427"></a>
<span class="sourceLineNo">1428</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1428"></a>
<span class="sourceLineNo">1429</span>     *                   &lt;td&gt;MKeyIndex&lt;/td&gt;<a name="line.1429"></a>
<span class="sourceLineNo">1430</span>     *                   &lt;td&gt;1－99 ，该密钥是密钥加解密密钥，当 KeyType 是主密钥时，KeyIndex 无效，Mode 必须为 0x00，即主密钥只能明文注入。&lt;/td&gt;<a name="line.1430"></a>
<span class="sourceLineNo">1431</span>     *                 &lt;/tr&gt;<a name="line.1431"></a>
<span class="sourceLineNo">1432</span>     *                 &lt;tr&gt;<a name="line.1432"></a>
<span class="sourceLineNo">1433</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1433"></a>
<span class="sourceLineNo">1434</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1434"></a>
<span class="sourceLineNo">1435</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.1435"></a>
<span class="sourceLineNo">1436</span>     *                   &lt;td&gt;0x00：不作任何运算。&lt;br&gt;0x01：解密运算。&lt;br&gt;0x02：加密运算。&lt;/td&gt;<a name="line.1436"></a>
<span class="sourceLineNo">1437</span>     *                 &lt;/tr&gt;<a name="line.1437"></a>
<span class="sourceLineNo">1438</span>     *                 &lt;tr&gt;<a name="line.1438"></a>
<span class="sourceLineNo">1439</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1439"></a>
<span class="sourceLineNo">1440</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1440"></a>
<span class="sourceLineNo">1441</span>     *                   &lt;td&gt;KeyType&lt;/td&gt;<a name="line.1441"></a>
<span class="sourceLineNo">1442</span>     *                   &lt;td&gt;0x00：主密钥。&lt;br&gt; 0x01：数据加解密密钥。&lt;br&gt; 0x02：PIN 加密密钥。&lt;br&gt; 0x03：MAC 计算密钥&lt;/td&gt;<a name="line.1442"></a>
<span class="sourceLineNo">1443</span>     *                 &lt;/tr&gt;<a name="line.1443"></a>
<span class="sourceLineNo">1444</span>     *                 &lt;tr&gt;<a name="line.1444"></a>
<span class="sourceLineNo">1445</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1445"></a>
<span class="sourceLineNo">1446</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1446"></a>
<span class="sourceLineNo">1447</span>     *                   &lt;td&gt;KeyIndex&lt;/td&gt;<a name="line.1447"></a>
<span class="sourceLineNo">1448</span>     *                   &lt;td&gt;1－99，传入的密钥值密文经过 Mode 指定的运算后，生成明文，该明文将写该索引号对应的密钥位置。&lt;/td&gt;<a name="line.1448"></a>
<span class="sourceLineNo">1449</span>     *                 &lt;/tr&gt;<a name="line.1449"></a>
<span class="sourceLineNo">1450</span>     *                 &lt;tr&gt;<a name="line.1450"></a>
<span class="sourceLineNo">1451</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.1451"></a>
<span class="sourceLineNo">1452</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1452"></a>
<span class="sourceLineNo">1453</span>     *                   &lt;td&gt;KeyLen&lt;/td&gt;<a name="line.1453"></a>
<span class="sourceLineNo">1454</span>     *                   &lt;td&gt;固定取值 0x10。&lt;/td&gt;<a name="line.1454"></a>
<span class="sourceLineNo">1455</span>     *                 &lt;/tr&gt;<a name="line.1455"></a>
<span class="sourceLineNo">1456</span>     *                 &lt;tr&gt;<a name="line.1456"></a>
<span class="sourceLineNo">1457</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1457"></a>
<span class="sourceLineNo">1458</span>     *                   &lt;td&gt;16&lt;/td&gt;<a name="line.1458"></a>
<span class="sourceLineNo">1459</span>     *                   &lt;td&gt;Key&lt;/td&gt;<a name="line.1459"></a>
<span class="sourceLineNo">1460</span>     *                   &lt;td&gt;传入的密钥值。&lt;/td&gt;<a name="line.1460"></a>
<span class="sourceLineNo">1461</span>     *                 &lt;/tr&gt;<a name="line.1461"></a>
<span class="sourceLineNo">1462</span>     *                 &lt;tr&gt;<a name="line.1462"></a>
<span class="sourceLineNo">1463</span>     *                   &lt;td&gt;0x0006&lt;/td&gt;<a name="line.1463"></a>
<span class="sourceLineNo">1464</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1464"></a>
<span class="sourceLineNo">1465</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1465"></a>
<span class="sourceLineNo">1466</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.1466"></a>
<span class="sourceLineNo">1467</span>     *                 &lt;/tr&gt;<a name="line.1467"></a>
<span class="sourceLineNo">1468</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1468"></a>
<span class="sourceLineNo">1469</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.1469"></a>
<span class="sourceLineNo">1470</span>     *                 &lt;tr&gt;<a name="line.1470"></a>
<span class="sourceLineNo">1471</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.1471"></a>
<span class="sourceLineNo">1472</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.1472"></a>
<span class="sourceLineNo">1473</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.1473"></a>
<span class="sourceLineNo">1474</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.1474"></a>
<span class="sourceLineNo">1475</span>     *                 &lt;/tr&gt;<a name="line.1475"></a>
<span class="sourceLineNo">1476</span>     *                 &lt;tr&gt;<a name="line.1476"></a>
<span class="sourceLineNo">1477</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1477"></a>
<span class="sourceLineNo">1478</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1478"></a>
<span class="sourceLineNo">1479</span>     *                   &lt;td&gt;MKeyIndex&lt;/td&gt;<a name="line.1479"></a>
<span class="sourceLineNo">1480</span>     *                   &lt;td&gt;1-99, the key is the key encryption and decryption key. When the KeyType is the master key,<a name="line.1480"></a>
<span class="sourceLineNo">1481</span>     *                     the KeyIndex is invalid and the Mode must be 0x00, that is, the master key can only be injected in plain text.&lt;/td&gt;<a name="line.1481"></a>
<span class="sourceLineNo">1482</span>     *                 &lt;/tr&gt;<a name="line.1482"></a>
<span class="sourceLineNo">1483</span>     *                 &lt;tr&gt;<a name="line.1483"></a>
<span class="sourceLineNo">1484</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1484"></a>
<span class="sourceLineNo">1485</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1485"></a>
<span class="sourceLineNo">1486</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.1486"></a>
<span class="sourceLineNo">1487</span>     *                   &lt;td&gt;0x00: No operation is performed. &lt;br&gt;0x01: Decryption operation. &lt;br&gt;0x02: Encryption operation.&lt;/td&gt;<a name="line.1487"></a>
<span class="sourceLineNo">1488</span>     *                 &lt;/tr&gt;<a name="line.1488"></a>
<span class="sourceLineNo">1489</span>     *                 &lt;tr&gt;<a name="line.1489"></a>
<span class="sourceLineNo">1490</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1490"></a>
<span class="sourceLineNo">1491</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1491"></a>
<span class="sourceLineNo">1492</span>     *                   &lt;td&gt;KeyType&lt;/td&gt;<a name="line.1492"></a>
<span class="sourceLineNo">1493</span>     *                   &lt;td&gt;0x00: Master key. &lt;br&gt; 0x01: Data encryption and decryption key. &lt;br&gt; 0x02: PIN encryption key. &lt;br&gt; 0x03: MAC calculation key.&lt;/td&gt;<a name="line.1493"></a>
<span class="sourceLineNo">1494</span>     *                 &lt;/tr&gt;<a name="line.1494"></a>
<span class="sourceLineNo">1495</span>     *                 &lt;tr&gt;<a name="line.1495"></a>
<span class="sourceLineNo">1496</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1496"></a>
<span class="sourceLineNo">1497</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1497"></a>
<span class="sourceLineNo">1498</span>     *                   &lt;td&gt;KeyIndex&lt;/td&gt;<a name="line.1498"></a>
<span class="sourceLineNo">1499</span>     *                   &lt;td&gt;1 to 99, after the passed-in key value ciphertext undergoes the operation specified by Mode, a plaintext is generated,<a name="line.1499"></a>
<span class="sourceLineNo">1500</span>     *                     and the plaintext will be written with the key position corresponding to the index number.&lt;/td&gt;<a name="line.1500"></a>
<span class="sourceLineNo">1501</span>     *                 &lt;/tr&gt;<a name="line.1501"></a>
<span class="sourceLineNo">1502</span>     *                 &lt;tr&gt;<a name="line.1502"></a>
<span class="sourceLineNo">1503</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.1503"></a>
<span class="sourceLineNo">1504</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1504"></a>
<span class="sourceLineNo">1505</span>     *                   &lt;td&gt;KeyLen&lt;/td&gt;<a name="line.1505"></a>
<span class="sourceLineNo">1506</span>     *                   &lt;td&gt;The fixed value is 0x10.&lt;/td&gt;<a name="line.1506"></a>
<span class="sourceLineNo">1507</span>     *                 &lt;/tr&gt;<a name="line.1507"></a>
<span class="sourceLineNo">1508</span>     *                 &lt;tr&gt;<a name="line.1508"></a>
<span class="sourceLineNo">1509</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1509"></a>
<span class="sourceLineNo">1510</span>     *                   &lt;td&gt;16&lt;/td&gt;<a name="line.1510"></a>
<span class="sourceLineNo">1511</span>     *                   &lt;td&gt;Key&lt;/td&gt;<a name="line.1511"></a>
<span class="sourceLineNo">1512</span>     *                   &lt;td&gt;The key value.&lt;/td&gt;<a name="line.1512"></a>
<span class="sourceLineNo">1513</span>     *                 &lt;/tr&gt;<a name="line.1513"></a>
<span class="sourceLineNo">1514</span>     *                 &lt;tr&gt;<a name="line.1514"></a>
<span class="sourceLineNo">1515</span>     *                   &lt;td&gt;0x0006&lt;/td&gt;<a name="line.1515"></a>
<span class="sourceLineNo">1516</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1516"></a>
<span class="sourceLineNo">1517</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1517"></a>
<span class="sourceLineNo">1518</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.1518"></a>
<span class="sourceLineNo">1519</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.1519"></a>
<span class="sourceLineNo">1520</span>     *                 &lt;/tr&gt;<a name="line.1520"></a>
<span class="sourceLineNo">1521</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1521"></a>
<span class="sourceLineNo">1522</span>     * @throws TypeAException TypeAException<a name="line.1522"></a>
<span class="sourceLineNo">1523</span>     */<a name="line.1523"></a>
<span class="sourceLineNo">1524</span>        void writeSM4Key(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.1524"></a>
<span class="sourceLineNo">1525</span><a name="line.1525"></a>
<span class="sourceLineNo">1526</span>    /**<a name="line.1526"></a>
<span class="sourceLineNo">1527</span>     * &lt;div class="zh"&gt;生成 SM2 公私钥对。&lt;/div&gt; &lt;div class="en"&gt;Generate SM2 public and private key pair.&lt;/div&gt;<a name="line.1527"></a>
<span class="sourceLineNo">1528</span>     *<a name="line.1528"></a>
<span class="sourceLineNo">1529</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.1529"></a>
<span class="sourceLineNo">1530</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.1530"></a>
<span class="sourceLineNo">1531</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.1531"></a>
<span class="sourceLineNo">1532</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1532"></a>
<span class="sourceLineNo">1533</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.1533"></a>
<span class="sourceLineNo">1534</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.1534"></a>
<span class="sourceLineNo">1535</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.1535"></a>
<span class="sourceLineNo">1536</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1536"></a>
<span class="sourceLineNo">1537</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.1537"></a>
<span class="sourceLineNo">1538</span>     *                 &lt;tr&gt;<a name="line.1538"></a>
<span class="sourceLineNo">1539</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.1539"></a>
<span class="sourceLineNo">1540</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.1540"></a>
<span class="sourceLineNo">1541</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.1541"></a>
<span class="sourceLineNo">1542</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.1542"></a>
<span class="sourceLineNo">1543</span>     *                 &lt;/tr&gt;<a name="line.1543"></a>
<span class="sourceLineNo">1544</span>     *                 &lt;tr&gt;<a name="line.1544"></a>
<span class="sourceLineNo">1545</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1545"></a>
<span class="sourceLineNo">1546</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.1546"></a>
<span class="sourceLineNo">1547</span>     *                   &lt;td&gt;PrvKeyLenBit&lt;/td&gt;<a name="line.1547"></a>
<span class="sourceLineNo">1548</span>     *                   &lt;td&gt;私钥位数，支持256bit。&lt;/td&gt;<a name="line.1548"></a>
<span class="sourceLineNo">1549</span>     *                 &lt;/tr&gt;<a name="line.1549"></a>
<span class="sourceLineNo">1550</span>     *                 &lt;tr&gt;<a name="line.1550"></a>
<span class="sourceLineNo">1551</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1551"></a>
<span class="sourceLineNo">1552</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1552"></a>
<span class="sourceLineNo">1553</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1553"></a>
<span class="sourceLineNo">1554</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.1554"></a>
<span class="sourceLineNo">1555</span>     *                 &lt;/tr&gt;<a name="line.1555"></a>
<span class="sourceLineNo">1556</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1556"></a>
<span class="sourceLineNo">1557</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.1557"></a>
<span class="sourceLineNo">1558</span>     *                 &lt;tr&gt;<a name="line.1558"></a>
<span class="sourceLineNo">1559</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.1559"></a>
<span class="sourceLineNo">1560</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.1560"></a>
<span class="sourceLineNo">1561</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.1561"></a>
<span class="sourceLineNo">1562</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.1562"></a>
<span class="sourceLineNo">1563</span>     *                 &lt;/tr&gt;<a name="line.1563"></a>
<span class="sourceLineNo">1564</span>     *                 &lt;tr&gt;<a name="line.1564"></a>
<span class="sourceLineNo">1565</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1565"></a>
<span class="sourceLineNo">1566</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1566"></a>
<span class="sourceLineNo">1567</span>     *                   &lt;td&gt;PrvKeyLenBit&lt;/td&gt;<a name="line.1567"></a>
<span class="sourceLineNo">1568</span>     *                   &lt;td&gt;The length of private key bits, supports 256bit.&lt;/td&gt;<a name="line.1568"></a>
<span class="sourceLineNo">1569</span>     *                 &lt;/tr&gt;<a name="line.1569"></a>
<span class="sourceLineNo">1570</span>     *                 &lt;tr&gt;<a name="line.1570"></a>
<span class="sourceLineNo">1571</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1571"></a>
<span class="sourceLineNo">1572</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1572"></a>
<span class="sourceLineNo">1573</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1573"></a>
<span class="sourceLineNo">1574</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.1574"></a>
<span class="sourceLineNo">1575</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.1575"></a>
<span class="sourceLineNo">1576</span>     *                 &lt;/tr&gt;<a name="line.1576"></a>
<span class="sourceLineNo">1577</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1577"></a>
<span class="sourceLineNo">1578</span>     * @return {@link SM2KeyPair}<a name="line.1578"></a>
<span class="sourceLineNo">1579</span>     * @throws TypeAException TypeAException<a name="line.1579"></a>
<span class="sourceLineNo">1580</span>     */<a name="line.1580"></a>
<span class="sourceLineNo">1581</span>    SM2KeyPair genSM2Key(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.1581"></a>
<span class="sourceLineNo">1582</span><a name="line.1582"></a>
<span class="sourceLineNo">1583</span>    /**<a name="line.1583"></a>
<span class="sourceLineNo">1584</span>     * &lt;div class="zh"&gt;将SM2密钥存储在PED中。<a name="line.1584"></a>
<span class="sourceLineNo">1585</span>     * &lt;br&gt;注意：SM2 密钥存储于 DES 密钥区域，KeyIndex指示的是 DES 密钥区的存储位置，以 8 字节为单位， 比如 SM2 私钥 32 字节，则占用 4 个存储位置。&lt;/div&gt;<a name="line.1585"></a>
<span class="sourceLineNo">1586</span>     * &lt;div class="en"&gt;Store the SM2 key in the PED.<a name="line.1586"></a>
<span class="sourceLineNo">1587</span>     * &lt;br&gt;Note: The SM2 key is stored in the DES key area. KeyIndex indicates the storage location of the DES key area, in units of 8 bytes.<a name="line.1587"></a>
<span class="sourceLineNo">1588</span>     * For example, if the SM2 private key is 32 bytes, it occupies 4 storage locations.&lt;/div&gt;<a name="line.1588"></a>
<span class="sourceLineNo">1589</span>     *<a name="line.1589"></a>
<span class="sourceLineNo">1590</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.1590"></a>
<span class="sourceLineNo">1591</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.1591"></a>
<span class="sourceLineNo">1592</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.1592"></a>
<span class="sourceLineNo">1593</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1593"></a>
<span class="sourceLineNo">1594</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.1594"></a>
<span class="sourceLineNo">1595</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.1595"></a>
<span class="sourceLineNo">1596</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.1596"></a>
<span class="sourceLineNo">1597</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1597"></a>
<span class="sourceLineNo">1598</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.1598"></a>
<span class="sourceLineNo">1599</span>     *                 &lt;tr&gt;<a name="line.1599"></a>
<span class="sourceLineNo">1600</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.1600"></a>
<span class="sourceLineNo">1601</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.1601"></a>
<span class="sourceLineNo">1602</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.1602"></a>
<span class="sourceLineNo">1603</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.1603"></a>
<span class="sourceLineNo">1604</span>     *                 &lt;/tr&gt;<a name="line.1604"></a>
<span class="sourceLineNo">1605</span>     *                 &lt;tr&gt;<a name="line.1605"></a>
<span class="sourceLineNo">1606</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1606"></a>
<span class="sourceLineNo">1607</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1607"></a>
<span class="sourceLineNo">1608</span>     *                   &lt;td&gt;KeyType&lt;/td&gt;<a name="line.1608"></a>
<span class="sourceLineNo">1609</span>     *                   &lt;td&gt;0x00:SM2 私钥; &lt;br&gt; 0x01: SM2 公钥。&lt;/td&gt;<a name="line.1609"></a>
<span class="sourceLineNo">1610</span>     *                 &lt;/tr&gt;<a name="line.1610"></a>
<span class="sourceLineNo">1611</span>     *                 &lt;tr&gt;<a name="line.1611"></a>
<span class="sourceLineNo">1612</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1612"></a>
<span class="sourceLineNo">1613</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1613"></a>
<span class="sourceLineNo">1614</span>     *                   &lt;td&gt;KeyIndex&lt;/td&gt;<a name="line.1614"></a>
<span class="sourceLineNo">1615</span>     *                   &lt;td&gt;SM2 私钥: 1~97; &lt;br&gt; SM2 公钥：1~93。&lt;/td&gt;<a name="line.1615"></a>
<span class="sourceLineNo">1616</span>     *                 &lt;/tr&gt;<a name="line.1616"></a>
<span class="sourceLineNo">1617</span>     *                 &lt;tr&gt;<a name="line.1617"></a>
<span class="sourceLineNo">1618</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1618"></a>
<span class="sourceLineNo">1619</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.1619"></a>
<span class="sourceLineNo">1620</span>     *                   &lt;td&gt;KeyLenBit&lt;/td&gt;<a name="line.1620"></a>
<span class="sourceLineNo">1621</span>     *                   &lt;td&gt;SM2 私钥固定256bit;&lt;br&gt; SM2 公钥固定512bit。&lt;/td&gt;<a name="line.1621"></a>
<span class="sourceLineNo">1622</span>     *                 &lt;/tr&gt;<a name="line.1622"></a>
<span class="sourceLineNo">1623</span>     *                 &lt;tr&gt;<a name="line.1623"></a>
<span class="sourceLineNo">1624</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.1624"></a>
<span class="sourceLineNo">1625</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1625"></a>
<span class="sourceLineNo">1626</span>     *                   &lt;td&gt;Key&lt;/td&gt;<a name="line.1626"></a>
<span class="sourceLineNo">1627</span>     *                   &lt;td&gt;密钥。&lt;/td&gt;<a name="line.1627"></a>
<span class="sourceLineNo">1628</span>     *                 &lt;/tr&gt;<a name="line.1628"></a>
<span class="sourceLineNo">1629</span>     *                 &lt;tr&gt;<a name="line.1629"></a>
<span class="sourceLineNo">1630</span>     *                   &lt;td&gt;0x0004+N&lt;/td&gt;<a name="line.1630"></a>
<span class="sourceLineNo">1631</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.1631"></a>
<span class="sourceLineNo">1632</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1632"></a>
<span class="sourceLineNo">1633</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.1633"></a>
<span class="sourceLineNo">1634</span>     *                 &lt;/tr&gt;<a name="line.1634"></a>
<span class="sourceLineNo">1635</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1635"></a>
<span class="sourceLineNo">1636</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.1636"></a>
<span class="sourceLineNo">1637</span>     *                 &lt;tr&gt;<a name="line.1637"></a>
<span class="sourceLineNo">1638</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.1638"></a>
<span class="sourceLineNo">1639</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.1639"></a>
<span class="sourceLineNo">1640</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.1640"></a>
<span class="sourceLineNo">1641</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.1641"></a>
<span class="sourceLineNo">1642</span>     *                 &lt;/tr&gt;<a name="line.1642"></a>
<span class="sourceLineNo">1643</span>     *                 &lt;tr&gt;<a name="line.1643"></a>
<span class="sourceLineNo">1644</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1644"></a>
<span class="sourceLineNo">1645</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1645"></a>
<span class="sourceLineNo">1646</span>     *                   &lt;td&gt;KeyType&lt;/td&gt;<a name="line.1646"></a>
<span class="sourceLineNo">1647</span>     *                   &lt;td&gt;0x00: SM2 private key. &lt;br&gt; 0x01: SM2 public key.&lt;/td&gt;<a name="line.1647"></a>
<span class="sourceLineNo">1648</span>     *                 &lt;/tr&gt;<a name="line.1648"></a>
<span class="sourceLineNo">1649</span>     *                 &lt;tr&gt;<a name="line.1649"></a>
<span class="sourceLineNo">1650</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1650"></a>
<span class="sourceLineNo">1651</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1651"></a>
<span class="sourceLineNo">1652</span>     *                   &lt;td&gt;KeyIndex&lt;/td&gt;<a name="line.1652"></a>
<span class="sourceLineNo">1653</span>     *                   &lt;td&gt;SM2 private key: 1~97; &lt;br&gt; SM2 public key: 1~93.&lt;/td&gt;<a name="line.1653"></a>
<span class="sourceLineNo">1654</span>     *                 &lt;/tr&gt;<a name="line.1654"></a>
<span class="sourceLineNo">1655</span>     *                 &lt;tr&gt;<a name="line.1655"></a>
<span class="sourceLineNo">1656</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1656"></a>
<span class="sourceLineNo">1657</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.1657"></a>
<span class="sourceLineNo">1658</span>     *                   &lt;td&gt;KeyLenBit&lt;/td&gt;<a name="line.1658"></a>
<span class="sourceLineNo">1659</span>     *                   &lt;td&gt;SM2 private key is fixed 256bit;&lt;br&gt; The SM2 public key is fixed at 512 bits.&lt;/td&gt;<a name="line.1659"></a>
<span class="sourceLineNo">1660</span>     *                 &lt;/tr&gt;<a name="line.1660"></a>
<span class="sourceLineNo">1661</span>     *                 &lt;tr&gt;<a name="line.1661"></a>
<span class="sourceLineNo">1662</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.1662"></a>
<span class="sourceLineNo">1663</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1663"></a>
<span class="sourceLineNo">1664</span>     *                   &lt;td&gt;Key&lt;/td&gt;<a name="line.1664"></a>
<span class="sourceLineNo">1665</span>     *                   &lt;td&gt;The key value.&lt;/td&gt;<a name="line.1665"></a>
<span class="sourceLineNo">1666</span>     *                 &lt;/tr&gt;<a name="line.1666"></a>
<span class="sourceLineNo">1667</span>     *                 &lt;tr&gt;<a name="line.1667"></a>
<span class="sourceLineNo">1668</span>     *                   &lt;td&gt;0x0004+N&lt;/td&gt;<a name="line.1668"></a>
<span class="sourceLineNo">1669</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.1669"></a>
<span class="sourceLineNo">1670</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1670"></a>
<span class="sourceLineNo">1671</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.1671"></a>
<span class="sourceLineNo">1672</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.1672"></a>
<span class="sourceLineNo">1673</span>     *                 &lt;/tr&gt;<a name="line.1673"></a>
<span class="sourceLineNo">1674</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1674"></a>
<span class="sourceLineNo">1675</span>     * @throws TypeAException TypeAException<a name="line.1675"></a>
<span class="sourceLineNo">1676</span>     */<a name="line.1676"></a>
<span class="sourceLineNo">1677</span>    void writeSM2Key(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.1677"></a>
<span class="sourceLineNo">1678</span><a name="line.1678"></a>
<span class="sourceLineNo">1679</span>    /**<a name="line.1679"></a>
<span class="sourceLineNo">1680</span>     * &lt;div class="zh"&gt;提示用户输入 PIN，输入 PIN 之后按照指定 mode 生成 PINBlock，并使用 SM4 密钥加密。&lt;/div&gt;<a name="line.1680"></a>
<span class="sourceLineNo">1681</span>     * &lt;div class="en"&gt;Prompt the user to enter the PIN. After entering the PIN, a PINBlock is generated<a name="line.1681"></a>
<span class="sourceLineNo">1682</span>     *   according to the specified mode and encrypted with the SM4 key.&lt;/div&gt;<a name="line.1682"></a>
<span class="sourceLineNo">1683</span>     *<a name="line.1683"></a>
<span class="sourceLineNo">1684</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.1684"></a>
<span class="sourceLineNo">1685</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.1685"></a>
<span class="sourceLineNo">1686</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.1686"></a>
<span class="sourceLineNo">1687</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1687"></a>
<span class="sourceLineNo">1688</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.1688"></a>
<span class="sourceLineNo">1689</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.1689"></a>
<span class="sourceLineNo">1690</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.1690"></a>
<span class="sourceLineNo">1691</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1691"></a>
<span class="sourceLineNo">1692</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.1692"></a>
<span class="sourceLineNo">1693</span>     *                 &lt;tr&gt;<a name="line.1693"></a>
<span class="sourceLineNo">1694</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.1694"></a>
<span class="sourceLineNo">1695</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.1695"></a>
<span class="sourceLineNo">1696</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.1696"></a>
<span class="sourceLineNo">1697</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.1697"></a>
<span class="sourceLineNo">1698</span>     *                 &lt;/tr&gt;<a name="line.1698"></a>
<span class="sourceLineNo">1699</span>     *                 &lt;tr&gt;<a name="line.1699"></a>
<span class="sourceLineNo">1700</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1700"></a>
<span class="sourceLineNo">1701</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1701"></a>
<span class="sourceLineNo">1702</span>     *                   &lt;td&gt;WKeyIndex&lt;/td&gt;<a name="line.1702"></a>
<span class="sourceLineNo">1703</span>     *                   &lt;td&gt;1~99。&lt;/td&gt;<a name="line.1703"></a>
<span class="sourceLineNo">1704</span>     *                 &lt;/tr&gt;<a name="line.1704"></a>
<span class="sourceLineNo">1705</span>     *                 &lt;tr&gt;<a name="line.1705"></a>
<span class="sourceLineNo">1706</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1706"></a>
<span class="sourceLineNo">1707</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1707"></a>
<span class="sourceLineNo">1708</span>     *                   &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.1708"></a>
<span class="sourceLineNo">1709</span>     *                   &lt;td&gt;16。&lt;/td&gt;<a name="line.1709"></a>
<span class="sourceLineNo">1710</span>     *                 &lt;/tr&gt;<a name="line.1710"></a>
<span class="sourceLineNo">1711</span>     *                 &lt;tr&gt;<a name="line.1711"></a>
<span class="sourceLineNo">1712</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1712"></a>
<span class="sourceLineNo">1713</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1713"></a>
<span class="sourceLineNo">1714</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.1714"></a>
<span class="sourceLineNo">1715</span>     *                   &lt;td&gt;0x00: 国密格式0。&lt;/td&gt;<a name="line.1715"></a>
<span class="sourceLineNo">1716</span>     *                 &lt;/tr&gt;<a name="line.1716"></a>
<span class="sourceLineNo">1717</span>     *                 &lt;tr&gt;<a name="line.1717"></a>
<span class="sourceLineNo">1718</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1718"></a>
<span class="sourceLineNo">1719</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1719"></a>
<span class="sourceLineNo">1720</span>     *                   &lt;td&gt;InputMode&lt;/td&gt;<a name="line.1720"></a>
<span class="sourceLineNo">1721</span>     *                   &lt;td&gt;0x01: 只输入一次; &lt;br&gt; 0x02: 输入两次密码，两次输入一致后返回PINBlock。&lt;/td&gt;<a name="line.1721"></a>
<span class="sourceLineNo">1722</span>     *                 &lt;/tr&gt;<a name="line.1722"></a>
<span class="sourceLineNo">1723</span>     *                 &lt;tr&gt;<a name="line.1723"></a>
<span class="sourceLineNo">1724</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.1724"></a>
<span class="sourceLineNo">1725</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1725"></a>
<span class="sourceLineNo">1726</span>     *                   &lt;td&gt;Min&lt;/td&gt;<a name="line.1726"></a>
<span class="sourceLineNo">1727</span>     *                   &lt;td&gt;输入最小长度，大于等于0。&lt;/td&gt;<a name="line.1727"></a>
<span class="sourceLineNo">1728</span>     *                 &lt;/tr&gt;<a name="line.1728"></a>
<span class="sourceLineNo">1729</span>     *                 &lt;tr&gt;<a name="line.1729"></a>
<span class="sourceLineNo">1730</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1730"></a>
<span class="sourceLineNo">1731</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1731"></a>
<span class="sourceLineNo">1732</span>     *                   &lt;td&gt;Max&lt;/td&gt;<a name="line.1732"></a>
<span class="sourceLineNo">1733</span>     *                   &lt;td&gt;输入最大长度，小于等于14。&lt;/td&gt;<a name="line.1733"></a>
<span class="sourceLineNo">1734</span>     *                 &lt;/tr&gt;<a name="line.1734"></a>
<span class="sourceLineNo">1735</span>     *                 &lt;tr&gt;<a name="line.1735"></a>
<span class="sourceLineNo">1736</span>     *                   &lt;td&gt;0x0006&lt;/td&gt;<a name="line.1736"></a>
<span class="sourceLineNo">1737</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1737"></a>
<span class="sourceLineNo">1738</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.1738"></a>
<span class="sourceLineNo">1739</span>     *                   &lt;td&gt;DataIn的长度。&lt;/td&gt;<a name="line.1739"></a>
<span class="sourceLineNo">1740</span>     *                 &lt;/tr&gt;<a name="line.1740"></a>
<span class="sourceLineNo">1741</span>     *                 &lt;tr&gt;<a name="line.1741"></a>
<span class="sourceLineNo">1742</span>     *                   &lt;td&gt;0x0007&lt;/td&gt;<a name="line.1742"></a>
<span class="sourceLineNo">1743</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1743"></a>
<span class="sourceLineNo">1744</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.1744"></a>
<span class="sourceLineNo">1745</span>     *                   &lt;td&gt;卡号移位后生成的 16 位主帐号。&lt;/td&gt;<a name="line.1745"></a>
<span class="sourceLineNo">1746</span>     *                 &lt;/tr&gt;<a name="line.1746"></a>
<span class="sourceLineNo">1747</span>     *                 &lt;tr&gt;<a name="line.1747"></a>
<span class="sourceLineNo">1748</span>     *                   &lt;td&gt;0x0007+N&lt;/td&gt;<a name="line.1748"></a>
<span class="sourceLineNo">1749</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.1749"></a>
<span class="sourceLineNo">1750</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1750"></a>
<span class="sourceLineNo">1751</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.1751"></a>
<span class="sourceLineNo">1752</span>     *                 &lt;/tr&gt;<a name="line.1752"></a>
<span class="sourceLineNo">1753</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1753"></a>
<span class="sourceLineNo">1754</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.1754"></a>
<span class="sourceLineNo">1755</span>     *                 &lt;tr&gt;<a name="line.1755"></a>
<span class="sourceLineNo">1756</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.1756"></a>
<span class="sourceLineNo">1757</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.1757"></a>
<span class="sourceLineNo">1758</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.1758"></a>
<span class="sourceLineNo">1759</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.1759"></a>
<span class="sourceLineNo">1760</span>     *                 &lt;/tr&gt;<a name="line.1760"></a>
<span class="sourceLineNo">1761</span>     *                 &lt;tr&gt;<a name="line.1761"></a>
<span class="sourceLineNo">1762</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1762"></a>
<span class="sourceLineNo">1763</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1763"></a>
<span class="sourceLineNo">1764</span>     *                   &lt;td&gt;WKeyIndex&lt;/td&gt;<a name="line.1764"></a>
<span class="sourceLineNo">1765</span>     *                   &lt;td&gt;1~99。&lt;/td&gt;<a name="line.1765"></a>
<span class="sourceLineNo">1766</span>     *                 &lt;/tr&gt;<a name="line.1766"></a>
<span class="sourceLineNo">1767</span>     *                 &lt;tr&gt;<a name="line.1767"></a>
<span class="sourceLineNo">1768</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1768"></a>
<span class="sourceLineNo">1769</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1769"></a>
<span class="sourceLineNo">1770</span>     *                   &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.1770"></a>
<span class="sourceLineNo">1771</span>     *                   &lt;td&gt;16。&lt;/td&gt;<a name="line.1771"></a>
<span class="sourceLineNo">1772</span>     *                 &lt;/tr&gt;<a name="line.1772"></a>
<span class="sourceLineNo">1773</span>     *                 &lt;tr&gt;<a name="line.1773"></a>
<span class="sourceLineNo">1774</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1774"></a>
<span class="sourceLineNo">1775</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1775"></a>
<span class="sourceLineNo">1776</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.1776"></a>
<span class="sourceLineNo">1777</span>     *                   &lt;td&gt;0x00: SM format 0.&lt;/td&gt;<a name="line.1777"></a>
<span class="sourceLineNo">1778</span>     *                 &lt;/tr&gt;<a name="line.1778"></a>
<span class="sourceLineNo">1779</span>     *                 &lt;tr&gt;<a name="line.1779"></a>
<span class="sourceLineNo">1780</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1780"></a>
<span class="sourceLineNo">1781</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1781"></a>
<span class="sourceLineNo">1782</span>     *                   &lt;td&gt;InputMode&lt;/td&gt;<a name="line.1782"></a>
<span class="sourceLineNo">1783</span>     *                   &lt;td&gt;0x01: Enter only once; &lt;br&gt; 0x02: Enter the password twice, and return to PINBlock after the two entries are consistent.&lt;/td&gt;<a name="line.1783"></a>
<span class="sourceLineNo">1784</span>     *                 &lt;/tr&gt;<a name="line.1784"></a>
<span class="sourceLineNo">1785</span>     *                 &lt;tr&gt;<a name="line.1785"></a>
<span class="sourceLineNo">1786</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.1786"></a>
<span class="sourceLineNo">1787</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1787"></a>
<span class="sourceLineNo">1788</span>     *                   &lt;td&gt;Min&lt;/td&gt;<a name="line.1788"></a>
<span class="sourceLineNo">1789</span>     *                   &lt;td&gt;Enter the minimum length, which is greater than or equal to 0.&lt;/td&gt;<a name="line.1789"></a>
<span class="sourceLineNo">1790</span>     *                 &lt;/tr&gt;<a name="line.1790"></a>
<span class="sourceLineNo">1791</span>     *                 &lt;tr&gt;<a name="line.1791"></a>
<span class="sourceLineNo">1792</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1792"></a>
<span class="sourceLineNo">1793</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1793"></a>
<span class="sourceLineNo">1794</span>     *                   &lt;td&gt;Max&lt;/td&gt;<a name="line.1794"></a>
<span class="sourceLineNo">1795</span>     *                   &lt;td&gt;Enter the maximum length, which is less than or equal to 14.&lt;/td&gt;<a name="line.1795"></a>
<span class="sourceLineNo">1796</span>     *                 &lt;/tr&gt;<a name="line.1796"></a>
<span class="sourceLineNo">1797</span>     *                 &lt;tr&gt;<a name="line.1797"></a>
<span class="sourceLineNo">1798</span>     *                   &lt;td&gt;0x0006&lt;/td&gt;<a name="line.1798"></a>
<span class="sourceLineNo">1799</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1799"></a>
<span class="sourceLineNo">1800</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.1800"></a>
<span class="sourceLineNo">1801</span>     *                   &lt;td&gt;The length of DataIn.&lt;/td&gt;<a name="line.1801"></a>
<span class="sourceLineNo">1802</span>     *                 &lt;/tr&gt;<a name="line.1802"></a>
<span class="sourceLineNo">1803</span>     *                 &lt;tr&gt;<a name="line.1803"></a>
<span class="sourceLineNo">1804</span>     *                   &lt;td&gt;0x0007&lt;/td&gt;<a name="line.1804"></a>
<span class="sourceLineNo">1805</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1805"></a>
<span class="sourceLineNo">1806</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.1806"></a>
<span class="sourceLineNo">1807</span>     *                   &lt;td&gt;The 16-digit master account number generated after the card number is shifted.&lt;/td&gt;<a name="line.1807"></a>
<span class="sourceLineNo">1808</span>     *                 &lt;/tr&gt;<a name="line.1808"></a>
<span class="sourceLineNo">1809</span>     *                 &lt;tr&gt;<a name="line.1809"></a>
<span class="sourceLineNo">1810</span>     *                   &lt;td&gt;0x0007+N&lt;/td&gt;<a name="line.1810"></a>
<span class="sourceLineNo">1811</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.1811"></a>
<span class="sourceLineNo">1812</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1812"></a>
<span class="sourceLineNo">1813</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.1813"></a>
<span class="sourceLineNo">1814</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.1814"></a>
<span class="sourceLineNo">1815</span>     *                 &lt;/tr&gt;<a name="line.1815"></a>
<span class="sourceLineNo">1816</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1816"></a>
<span class="sourceLineNo">1817</span>     * @param timeoutMs &lt;div class="zh"&gt;超时时间。单位: 毫秒。&lt;/div&gt; &lt;div class="en"&gt;Timeout. Unit: milliseconds.&lt;/div&gt;<a name="line.1817"></a>
<span class="sourceLineNo">1818</span>     * @return &lt;div class="zh"&gt;16字节的PINBlock。&lt;/div&gt; &lt;div class="en"&gt;16-byte PINBlock.&lt;/div&gt;<a name="line.1818"></a>
<span class="sourceLineNo">1819</span>     * @throws TypeAException TypeAException<a name="line.1819"></a>
<span class="sourceLineNo">1820</span>     */<a name="line.1820"></a>
<span class="sourceLineNo">1821</span>    byte[] getSM4PinBlock(byte cipherFlag, byte[] dataIn, int timeoutMs) throws TypeAException;<a name="line.1821"></a>
<span class="sourceLineNo">1822</span><a name="line.1822"></a>
<span class="sourceLineNo">1823</span>    /**<a name="line.1823"></a>
<span class="sourceLineNo">1824</span>     * &lt;div class="zh"&gt;使用 SM4 算法计算 MAC。&lt;/div&gt; &lt;div class="en"&gt;Use SM4 algorithm to calculate MAC.&lt;/div&gt;<a name="line.1824"></a>
<span class="sourceLineNo">1825</span>     *<a name="line.1825"></a>
<span class="sourceLineNo">1826</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.1826"></a>
<span class="sourceLineNo">1827</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.1827"></a>
<span class="sourceLineNo">1828</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.1828"></a>
<span class="sourceLineNo">1829</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1829"></a>
<span class="sourceLineNo">1830</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.1830"></a>
<span class="sourceLineNo">1831</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.1831"></a>
<span class="sourceLineNo">1832</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.1832"></a>
<span class="sourceLineNo">1833</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1833"></a>
<span class="sourceLineNo">1834</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.1834"></a>
<span class="sourceLineNo">1835</span>     *                 &lt;tr&gt;<a name="line.1835"></a>
<span class="sourceLineNo">1836</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.1836"></a>
<span class="sourceLineNo">1837</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.1837"></a>
<span class="sourceLineNo">1838</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.1838"></a>
<span class="sourceLineNo">1839</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.1839"></a>
<span class="sourceLineNo">1840</span>     *                 &lt;/tr&gt;<a name="line.1840"></a>
<span class="sourceLineNo">1841</span>     *                 &lt;tr&gt;<a name="line.1841"></a>
<span class="sourceLineNo">1842</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1842"></a>
<span class="sourceLineNo">1843</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1843"></a>
<span class="sourceLineNo">1844</span>     *                   &lt;td&gt;WKeyIndex&lt;/td&gt;<a name="line.1844"></a>
<span class="sourceLineNo">1845</span>     *                   &lt;td&gt;1~99。&lt;/td&gt;<a name="line.1845"></a>
<span class="sourceLineNo">1846</span>     *                 &lt;/tr&gt;<a name="line.1846"></a>
<span class="sourceLineNo">1847</span>     *                 &lt;tr&gt;<a name="line.1847"></a>
<span class="sourceLineNo">1848</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1848"></a>
<span class="sourceLineNo">1849</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1849"></a>
<span class="sourceLineNo">1850</span>     *                   &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.1850"></a>
<span class="sourceLineNo">1851</span>     *                   &lt;td&gt;16。&lt;/td&gt;<a name="line.1851"></a>
<span class="sourceLineNo">1852</span>     *                 &lt;/tr&gt;<a name="line.1852"></a>
<span class="sourceLineNo">1853</span>     *                 &lt;tr&gt;<a name="line.1853"></a>
<span class="sourceLineNo">1854</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1854"></a>
<span class="sourceLineNo">1855</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1855"></a>
<span class="sourceLineNo">1856</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.1856"></a>
<span class="sourceLineNo">1857</span>     *                   &lt;td&gt;0x00: 使用SM4 CBC 算法计算MAC 值，首先将初始向量与BLOCK1 进行异或，并用SM4算法使用TAK 对异或的结果进行加密，<a name="line.1857"></a>
<span class="sourceLineNo">1858</span>     *                     然后获得的密文与BLOCK2 异或，用SM4 算法使用TAK 对结果加密，按顺序给出16 字节的加密果。结果为16 字节。&lt;br&gt;<a name="line.1858"></a>
<span class="sourceLineNo">1859</span>     *                     0x01: SM3 HMAC, 结果为32字节。&lt;/td&gt;<a name="line.1859"></a>
<span class="sourceLineNo">1860</span>     *                 &lt;/tr&gt;<a name="line.1860"></a>
<span class="sourceLineNo">1861</span>     *                 &lt;tr&gt;<a name="line.1861"></a>
<span class="sourceLineNo">1862</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1862"></a>
<span class="sourceLineNo">1863</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.1863"></a>
<span class="sourceLineNo">1864</span>     *                   &lt;td&gt;MacDataLen&lt;/td&gt;<a name="line.1864"></a>
<span class="sourceLineNo">1865</span>     *                   &lt;td&gt;MacData的长度。&lt;/td&gt;<a name="line.1865"></a>
<span class="sourceLineNo">1866</span>     *                 &lt;/tr&gt;<a name="line.1866"></a>
<span class="sourceLineNo">1867</span>     *                 &lt;tr&gt;<a name="line.1867"></a>
<span class="sourceLineNo">1868</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1868"></a>
<span class="sourceLineNo">1869</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1869"></a>
<span class="sourceLineNo">1870</span>     *                   &lt;td&gt;MacData&lt;/td&gt;<a name="line.1870"></a>
<span class="sourceLineNo">1871</span>     *                   &lt;td&gt;待计算Mac的数据。&lt;/td&gt;<a name="line.1871"></a>
<span class="sourceLineNo">1872</span>     *                 &lt;/tr&gt;<a name="line.1872"></a>
<span class="sourceLineNo">1873</span>     *                 &lt;tr&gt;<a name="line.1873"></a>
<span class="sourceLineNo">1874</span>     *                   &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.1874"></a>
<span class="sourceLineNo">1875</span>     *                   &lt;td&gt;16&lt;/td&gt;<a name="line.1875"></a>
<span class="sourceLineNo">1876</span>     *                   &lt;td&gt;IV&lt;/td&gt;<a name="line.1876"></a>
<span class="sourceLineNo">1877</span>     *                   &lt;td&gt;16字节初始化向量。&lt;/td&gt;<a name="line.1877"></a>
<span class="sourceLineNo">1878</span>     *                 &lt;/tr&gt;<a name="line.1878"></a>
<span class="sourceLineNo">1879</span>     *                 &lt;tr&gt;<a name="line.1879"></a>
<span class="sourceLineNo">1880</span>     *                   &lt;td&gt;0x0015+N&lt;/td&gt;<a name="line.1880"></a>
<span class="sourceLineNo">1881</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.1881"></a>
<span class="sourceLineNo">1882</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1882"></a>
<span class="sourceLineNo">1883</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.1883"></a>
<span class="sourceLineNo">1884</span>     *                 &lt;/tr&gt;<a name="line.1884"></a>
<span class="sourceLineNo">1885</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1885"></a>
<span class="sourceLineNo">1886</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.1886"></a>
<span class="sourceLineNo">1887</span>     *                 &lt;tr&gt;<a name="line.1887"></a>
<span class="sourceLineNo">1888</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.1888"></a>
<span class="sourceLineNo">1889</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.1889"></a>
<span class="sourceLineNo">1890</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.1890"></a>
<span class="sourceLineNo">1891</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.1891"></a>
<span class="sourceLineNo">1892</span>     *                 &lt;/tr&gt;<a name="line.1892"></a>
<span class="sourceLineNo">1893</span>     *                 &lt;tr&gt;<a name="line.1893"></a>
<span class="sourceLineNo">1894</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1894"></a>
<span class="sourceLineNo">1895</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1895"></a>
<span class="sourceLineNo">1896</span>     *                   &lt;td&gt;WKeyIndex&lt;/td&gt;<a name="line.1896"></a>
<span class="sourceLineNo">1897</span>     *                   &lt;td&gt;1~99。&lt;/td&gt;<a name="line.1897"></a>
<span class="sourceLineNo">1898</span>     *                 &lt;/tr&gt;<a name="line.1898"></a>
<span class="sourceLineNo">1899</span>     *                 &lt;tr&gt;<a name="line.1899"></a>
<span class="sourceLineNo">1900</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1900"></a>
<span class="sourceLineNo">1901</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1901"></a>
<span class="sourceLineNo">1902</span>     *                   &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.1902"></a>
<span class="sourceLineNo">1903</span>     *                   &lt;td&gt;16。&lt;/td&gt;<a name="line.1903"></a>
<span class="sourceLineNo">1904</span>     *                 &lt;/tr&gt;<a name="line.1904"></a>
<span class="sourceLineNo">1905</span>     *                 &lt;tr&gt;<a name="line.1905"></a>
<span class="sourceLineNo">1906</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1906"></a>
<span class="sourceLineNo">1907</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1907"></a>
<span class="sourceLineNo">1908</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.1908"></a>
<span class="sourceLineNo">1909</span>     *                   &lt;td&gt;0x00: Use the SM4 CBC algorithm to calculate the MAC value. First, the initial vector and BLOCK1 are XORed,<a name="line.1909"></a>
<span class="sourceLineNo">1910</span>     *                     and the SM4 algorithm uses TAK to encrypt the XOR result, and then the obtained ciphertext is XORed with BLOCK2,<a name="line.1910"></a>
<span class="sourceLineNo">1911</span>     *                     and the SM4 algorithm uses TAK to encrypt the result. The 16-byte encryption result is given in sequence. The result is 16 bytes.&lt;br&gt;<a name="line.1911"></a>
<span class="sourceLineNo">1912</span>     *                     0x01: SM3 HMAC, the result is 32 bytes.&lt;/td&gt;<a name="line.1912"></a>
<span class="sourceLineNo">1913</span>     *                 &lt;/tr&gt;<a name="line.1913"></a>
<span class="sourceLineNo">1914</span>     *                 &lt;tr&gt;<a name="line.1914"></a>
<span class="sourceLineNo">1915</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1915"></a>
<span class="sourceLineNo">1916</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.1916"></a>
<span class="sourceLineNo">1917</span>     *                   &lt;td&gt;MacDataLen&lt;/td&gt;<a name="line.1917"></a>
<span class="sourceLineNo">1918</span>     *                   &lt;td&gt;The length of MacData.&lt;/td&gt;<a name="line.1918"></a>
<span class="sourceLineNo">1919</span>     *                 &lt;/tr&gt;<a name="line.1919"></a>
<span class="sourceLineNo">1920</span>     *                 &lt;tr&gt;<a name="line.1920"></a>
<span class="sourceLineNo">1921</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1921"></a>
<span class="sourceLineNo">1922</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1922"></a>
<span class="sourceLineNo">1923</span>     *                   &lt;td&gt;MacData&lt;/td&gt;<a name="line.1923"></a>
<span class="sourceLineNo">1924</span>     *                   &lt;td&gt;The data of Mac to be calculated.&lt;/td&gt;<a name="line.1924"></a>
<span class="sourceLineNo">1925</span>     *                 &lt;/tr&gt;<a name="line.1925"></a>
<span class="sourceLineNo">1926</span>     *                 &lt;tr&gt;<a name="line.1926"></a>
<span class="sourceLineNo">1927</span>     *                   &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.1927"></a>
<span class="sourceLineNo">1928</span>     *                   &lt;td&gt;16&lt;/td&gt;<a name="line.1928"></a>
<span class="sourceLineNo">1929</span>     *                   &lt;td&gt;IV&lt;/td&gt;<a name="line.1929"></a>
<span class="sourceLineNo">1930</span>     *                   &lt;td&gt;16-byte initialization vector.&lt;/td&gt;<a name="line.1930"></a>
<span class="sourceLineNo">1931</span>     *                 &lt;/tr&gt;<a name="line.1931"></a>
<span class="sourceLineNo">1932</span>     *                 &lt;tr&gt;<a name="line.1932"></a>
<span class="sourceLineNo">1933</span>     *                   &lt;td&gt;0x0015+N&lt;/td&gt;<a name="line.1933"></a>
<span class="sourceLineNo">1934</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.1934"></a>
<span class="sourceLineNo">1935</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.1935"></a>
<span class="sourceLineNo">1936</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.1936"></a>
<span class="sourceLineNo">1937</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.1937"></a>
<span class="sourceLineNo">1938</span>     *                 &lt;/tr&gt;<a name="line.1938"></a>
<span class="sourceLineNo">1939</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.1939"></a>
<span class="sourceLineNo">1940</span>     * @return &lt;div class="zh"&gt;Mac结果。&lt;/div&gt; &lt;div class="en"&gt;Mac results.&lt;/div&gt;<a name="line.1940"></a>
<span class="sourceLineNo">1941</span>     * @throws TypeAException TypeAException<a name="line.1941"></a>
<span class="sourceLineNo">1942</span>     */<a name="line.1942"></a>
<span class="sourceLineNo">1943</span>    byte[] getSM4Mac(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.1943"></a>
<span class="sourceLineNo">1944</span><a name="line.1944"></a>
<span class="sourceLineNo">1945</span>    /**<a name="line.1945"></a>
<span class="sourceLineNo">1946</span>     * &lt;div class="zh"&gt;使用SM4 算法加解密数据。&lt;/div&gt; &lt;div class="en"&gt;Use SM4 algorithm to encrypt and decrypt data.&lt;/div&gt;<a name="line.1946"></a>
<span class="sourceLineNo">1947</span>     *<a name="line.1947"></a>
<span class="sourceLineNo">1948</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.1948"></a>
<span class="sourceLineNo">1949</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.1949"></a>
<span class="sourceLineNo">1950</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.1950"></a>
<span class="sourceLineNo">1951</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1951"></a>
<span class="sourceLineNo">1952</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.1952"></a>
<span class="sourceLineNo">1953</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.1953"></a>
<span class="sourceLineNo">1954</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.1954"></a>
<span class="sourceLineNo">1955</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.1955"></a>
<span class="sourceLineNo">1956</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.1956"></a>
<span class="sourceLineNo">1957</span>     *                 &lt;tr&gt;<a name="line.1957"></a>
<span class="sourceLineNo">1958</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.1958"></a>
<span class="sourceLineNo">1959</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.1959"></a>
<span class="sourceLineNo">1960</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.1960"></a>
<span class="sourceLineNo">1961</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.1961"></a>
<span class="sourceLineNo">1962</span>     *                 &lt;/tr&gt;<a name="line.1962"></a>
<span class="sourceLineNo">1963</span>     *                 &lt;tr&gt;<a name="line.1963"></a>
<span class="sourceLineNo">1964</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.1964"></a>
<span class="sourceLineNo">1965</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1965"></a>
<span class="sourceLineNo">1966</span>     *                   &lt;td&gt;WKeyIndex&lt;/td&gt;<a name="line.1966"></a>
<span class="sourceLineNo">1967</span>     *                   &lt;td&gt;1~99。&lt;/td&gt;<a name="line.1967"></a>
<span class="sourceLineNo">1968</span>     *                 &lt;/tr&gt;<a name="line.1968"></a>
<span class="sourceLineNo">1969</span>     *                 &lt;tr&gt;<a name="line.1969"></a>
<span class="sourceLineNo">1970</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.1970"></a>
<span class="sourceLineNo">1971</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1971"></a>
<span class="sourceLineNo">1972</span>     *                   &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.1972"></a>
<span class="sourceLineNo">1973</span>     *                   &lt;td&gt;16。&lt;/td&gt;<a name="line.1973"></a>
<span class="sourceLineNo">1974</span>     *                 &lt;/tr&gt;<a name="line.1974"></a>
<span class="sourceLineNo">1975</span>     *                 &lt;tr&gt;<a name="line.1975"></a>
<span class="sourceLineNo">1976</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.1976"></a>
<span class="sourceLineNo">1977</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.1977"></a>
<span class="sourceLineNo">1978</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.1978"></a>
<span class="sourceLineNo">1979</span>     *                   &lt;td&gt;0x00: ECB 解密;&lt;br&gt; 0x01: ECB 加密;&lt;br&gt; 0x02: CBC 解密;&lt;br&gt; 0x03: CBC 加密;&lt;/td&gt;<a name="line.1979"></a>
<span class="sourceLineNo">1980</span>     *                 &lt;/tr&gt;<a name="line.1980"></a>
<span class="sourceLineNo">1981</span>     *                 &lt;tr&gt;<a name="line.1981"></a>
<span class="sourceLineNo">1982</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.1982"></a>
<span class="sourceLineNo">1983</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.1983"></a>
<span class="sourceLineNo">1984</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.1984"></a>
<span class="sourceLineNo">1985</span>     *                   &lt;td&gt;DataIn的长度。&lt;/td&gt;<a name="line.1985"></a>
<span class="sourceLineNo">1986</span>     *                 &lt;/tr&gt;<a name="line.1986"></a>
<span class="sourceLineNo">1987</span>     *                 &lt;tr&gt;<a name="line.1987"></a>
<span class="sourceLineNo">1988</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.1988"></a>
<span class="sourceLineNo">1989</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.1989"></a>
<span class="sourceLineNo">1990</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.1990"></a>
<span class="sourceLineNo">1991</span>     *                   &lt;td&gt;待加解密的数据。&lt;/td&gt;<a name="line.1991"></a>
<span class="sourceLineNo">1992</span>     *                 &lt;/tr&gt;<a name="line.1992"></a>
<span class="sourceLineNo">1993</span>     *                 &lt;tr&gt;<a name="line.1993"></a>
<span class="sourceLineNo">1994</span>     *                   &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.1994"></a>
<span class="sourceLineNo">1995</span>     *                   &lt;td&gt;16&lt;/td&gt;<a name="line.1995"></a>
<span class="sourceLineNo">1996</span>     *                   &lt;td&gt;IV&lt;/td&gt;<a name="line.1996"></a>
<span class="sourceLineNo">1997</span>     *                   &lt;td&gt;16字节初始化向量。ECB时不需要。&lt;/td&gt;<a name="line.1997"></a>
<span class="sourceLineNo">1998</span>     *                 &lt;/tr&gt;<a name="line.1998"></a>
<span class="sourceLineNo">1999</span>     *                 &lt;tr&gt;<a name="line.1999"></a>
<span class="sourceLineNo">2000</span>     *                   &lt;td&gt;0x0015+N&lt;/td&gt;<a name="line.2000"></a>
<span class="sourceLineNo">2001</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2001"></a>
<span class="sourceLineNo">2002</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2002"></a>
<span class="sourceLineNo">2003</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.2003"></a>
<span class="sourceLineNo">2004</span>     *                 &lt;/tr&gt;<a name="line.2004"></a>
<span class="sourceLineNo">2005</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2005"></a>
<span class="sourceLineNo">2006</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.2006"></a>
<span class="sourceLineNo">2007</span>     *                 &lt;tr&gt;<a name="line.2007"></a>
<span class="sourceLineNo">2008</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.2008"></a>
<span class="sourceLineNo">2009</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.2009"></a>
<span class="sourceLineNo">2010</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.2010"></a>
<span class="sourceLineNo">2011</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.2011"></a>
<span class="sourceLineNo">2012</span>     *                 &lt;/tr&gt;<a name="line.2012"></a>
<span class="sourceLineNo">2013</span>     *                 &lt;tr&gt;<a name="line.2013"></a>
<span class="sourceLineNo">2014</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.2014"></a>
<span class="sourceLineNo">2015</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2015"></a>
<span class="sourceLineNo">2016</span>     *                   &lt;td&gt;WKeyIndex&lt;/td&gt;<a name="line.2016"></a>
<span class="sourceLineNo">2017</span>     *                   &lt;td&gt;1~99。&lt;/td&gt;<a name="line.2017"></a>
<span class="sourceLineNo">2018</span>     *                 &lt;/tr&gt;<a name="line.2018"></a>
<span class="sourceLineNo">2019</span>     *                 &lt;tr&gt;<a name="line.2019"></a>
<span class="sourceLineNo">2020</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.2020"></a>
<span class="sourceLineNo">2021</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2021"></a>
<span class="sourceLineNo">2022</span>     *                   &lt;td&gt;WKeyLen&lt;/td&gt;<a name="line.2022"></a>
<span class="sourceLineNo">2023</span>     *                   &lt;td&gt;16。&lt;/td&gt;<a name="line.2023"></a>
<span class="sourceLineNo">2024</span>     *                 &lt;/tr&gt;<a name="line.2024"></a>
<span class="sourceLineNo">2025</span>     *                 &lt;tr&gt;<a name="line.2025"></a>
<span class="sourceLineNo">2026</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.2026"></a>
<span class="sourceLineNo">2027</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2027"></a>
<span class="sourceLineNo">2028</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.2028"></a>
<span class="sourceLineNo">2029</span>     *                   &lt;td&gt;0x00: ECB decryption.;&lt;br&gt; 0x01: ECB encryption;&lt;br&gt; 0x02: CBC decryption;&lt;br&gt; 0x03: CBC encryption;&lt;/td&gt;<a name="line.2029"></a>
<span class="sourceLineNo">2030</span>     *                 &lt;/tr&gt;<a name="line.2030"></a>
<span class="sourceLineNo">2031</span>     *                 &lt;tr&gt;<a name="line.2031"></a>
<span class="sourceLineNo">2032</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.2032"></a>
<span class="sourceLineNo">2033</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2033"></a>
<span class="sourceLineNo">2034</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.2034"></a>
<span class="sourceLineNo">2035</span>     *                   &lt;td&gt;The length of DataIn.&lt;/td&gt;<a name="line.2035"></a>
<span class="sourceLineNo">2036</span>     *                 &lt;/tr&gt;<a name="line.2036"></a>
<span class="sourceLineNo">2037</span>     *                 &lt;tr&gt;<a name="line.2037"></a>
<span class="sourceLineNo">2038</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.2038"></a>
<span class="sourceLineNo">2039</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.2039"></a>
<span class="sourceLineNo">2040</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.2040"></a>
<span class="sourceLineNo">2041</span>     *                   &lt;td&gt;Data to be encrypted and decrypted.&lt;/td&gt;<a name="line.2041"></a>
<span class="sourceLineNo">2042</span>     *                 &lt;/tr&gt;<a name="line.2042"></a>
<span class="sourceLineNo">2043</span>     *                 &lt;tr&gt;<a name="line.2043"></a>
<span class="sourceLineNo">2044</span>     *                   &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.2044"></a>
<span class="sourceLineNo">2045</span>     *                   &lt;td&gt;16&lt;/td&gt;<a name="line.2045"></a>
<span class="sourceLineNo">2046</span>     *                   &lt;td&gt;IV&lt;/td&gt;<a name="line.2046"></a>
<span class="sourceLineNo">2047</span>     *                   &lt;td&gt;16-byte initialization vector. Not required for ECB.&lt;/td&gt;<a name="line.2047"></a>
<span class="sourceLineNo">2048</span>     *                 &lt;/tr&gt;<a name="line.2048"></a>
<span class="sourceLineNo">2049</span>     *                 &lt;tr&gt;<a name="line.2049"></a>
<span class="sourceLineNo">2050</span>     *                   &lt;td&gt;0x0015+N&lt;/td&gt;<a name="line.2050"></a>
<span class="sourceLineNo">2051</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2051"></a>
<span class="sourceLineNo">2052</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2052"></a>
<span class="sourceLineNo">2053</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.2053"></a>
<span class="sourceLineNo">2054</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.2054"></a>
<span class="sourceLineNo">2055</span>     *                 &lt;/tr&gt;<a name="line.2055"></a>
<span class="sourceLineNo">2056</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2056"></a>
<span class="sourceLineNo">2057</span>     * @return &lt;div class="zh"&gt;加解密的结果。&lt;/div&gt; &lt;div class="en"&gt;The result of encryption and decryption.&lt;/div&gt;<a name="line.2057"></a>
<span class="sourceLineNo">2058</span>     * @throws TypeAException TypeAException<a name="line.2058"></a>
<span class="sourceLineNo">2059</span>     */<a name="line.2059"></a>
<span class="sourceLineNo">2060</span>    byte[] calcSM4Data(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.2060"></a>
<span class="sourceLineNo">2061</span><a name="line.2061"></a>
<span class="sourceLineNo">2062</span>    /**<a name="line.2062"></a>
<span class="sourceLineNo">2063</span>     * &lt;div class="zh"&gt;使用 SM2 算法获得签名信息。&lt;/div&gt; &lt;div class="en"&gt;Use SM2 algorithm to obtain signature information.&lt;/div&gt;<a name="line.2063"></a>
<span class="sourceLineNo">2064</span>     *<a name="line.2064"></a>
<span class="sourceLineNo">2065</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2065"></a>
<span class="sourceLineNo">2066</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.2066"></a>
<span class="sourceLineNo">2067</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.2067"></a>
<span class="sourceLineNo">2068</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.2068"></a>
<span class="sourceLineNo">2069</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2069"></a>
<span class="sourceLineNo">2070</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.2070"></a>
<span class="sourceLineNo">2071</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.2071"></a>
<span class="sourceLineNo">2072</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.2072"></a>
<span class="sourceLineNo">2073</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.2073"></a>
<span class="sourceLineNo">2074</span>     *                 &lt;tr&gt;<a name="line.2074"></a>
<span class="sourceLineNo">2075</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.2075"></a>
<span class="sourceLineNo">2076</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.2076"></a>
<span class="sourceLineNo">2077</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.2077"></a>
<span class="sourceLineNo">2078</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.2078"></a>
<span class="sourceLineNo">2079</span>     *                 &lt;/tr&gt;<a name="line.2079"></a>
<span class="sourceLineNo">2080</span>     *                 &lt;tr&gt;<a name="line.2080"></a>
<span class="sourceLineNo">2081</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.2081"></a>
<span class="sourceLineNo">2082</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2082"></a>
<span class="sourceLineNo">2083</span>     *                   &lt;td&gt;PubKeyIndex&lt;/td&gt;<a name="line.2083"></a>
<span class="sourceLineNo">2084</span>     *                   &lt;td&gt;SM2公钥索引: 1~93。&lt;/td&gt;<a name="line.2084"></a>
<span class="sourceLineNo">2085</span>     *                 &lt;/tr&gt;<a name="line.2085"></a>
<span class="sourceLineNo">2086</span>     *                 &lt;tr&gt;<a name="line.2086"></a>
<span class="sourceLineNo">2087</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.2087"></a>
<span class="sourceLineNo">2088</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2088"></a>
<span class="sourceLineNo">2089</span>     *                   &lt;td&gt;PrvKeyIndex&lt;/td&gt;<a name="line.2089"></a>
<span class="sourceLineNo">2090</span>     *                   &lt;td&gt;SM2私钥索引: 1~97。&lt;/td&gt;<a name="line.2090"></a>
<span class="sourceLineNo">2091</span>     *                 &lt;/tr&gt;<a name="line.2091"></a>
<span class="sourceLineNo">2092</span>     *                 &lt;tr&gt;<a name="line.2092"></a>
<span class="sourceLineNo">2093</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.2093"></a>
<span class="sourceLineNo">2094</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2094"></a>
<span class="sourceLineNo">2095</span>     *                   &lt;td&gt;PrvKeyLenBit&lt;/td&gt;<a name="line.2095"></a>
<span class="sourceLineNo">2096</span>     *                   &lt;td&gt;私钥位数。&lt;/td&gt;<a name="line.2096"></a>
<span class="sourceLineNo">2097</span>     *                 &lt;/tr&gt;<a name="line.2097"></a>
<span class="sourceLineNo">2098</span>     *                 &lt;tr&gt;<a name="line.2098"></a>
<span class="sourceLineNo">2099</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.2099"></a>
<span class="sourceLineNo">2100</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2100"></a>
<span class="sourceLineNo">2101</span>     *                   &lt;td&gt;UidLen&lt;/td&gt;<a name="line.2101"></a>
<span class="sourceLineNo">2102</span>     *                   &lt;td&gt;Uid的长度。&lt;/td&gt;<a name="line.2102"></a>
<span class="sourceLineNo">2103</span>     *                 &lt;/tr&gt;<a name="line.2103"></a>
<span class="sourceLineNo">2104</span>     *                 &lt;tr&gt;<a name="line.2104"></a>
<span class="sourceLineNo">2105</span>     *                   &lt;td&gt;0x0006&lt;/td&gt;<a name="line.2105"></a>
<span class="sourceLineNo">2106</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.2106"></a>
<span class="sourceLineNo">2107</span>     *                   &lt;td&gt;Uid&lt;/td&gt;<a name="line.2107"></a>
<span class="sourceLineNo">2108</span>     *                   &lt;td&gt;签名者 ID。&lt;/td&gt;<a name="line.2108"></a>
<span class="sourceLineNo">2109</span>     *                 &lt;/tr&gt;<a name="line.2109"></a>
<span class="sourceLineNo">2110</span>     *                 &lt;tr&gt;<a name="line.2110"></a>
<span class="sourceLineNo">2111</span>     *                   &lt;td&gt;0x0006+N&lt;/td&gt;<a name="line.2111"></a>
<span class="sourceLineNo">2112</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2112"></a>
<span class="sourceLineNo">2113</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.2113"></a>
<span class="sourceLineNo">2114</span>     *                   &lt;td&gt;DataIn长度。&lt;/td&gt;<a name="line.2114"></a>
<span class="sourceLineNo">2115</span>     *                 &lt;/tr&gt;<a name="line.2115"></a>
<span class="sourceLineNo">2116</span>     *                 &lt;tr&gt;<a name="line.2116"></a>
<span class="sourceLineNo">2117</span>     *                   &lt;td&gt;0x0008+N&lt;/td&gt;<a name="line.2117"></a>
<span class="sourceLineNo">2118</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2118"></a>
<span class="sourceLineNo">2119</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.2119"></a>
<span class="sourceLineNo">2120</span>     *                   &lt;td&gt;待签名的数据。&lt;/td&gt;<a name="line.2120"></a>
<span class="sourceLineNo">2121</span>     *                 &lt;/tr&gt;<a name="line.2121"></a>
<span class="sourceLineNo">2122</span>     *                 &lt;tr&gt;<a name="line.2122"></a>
<span class="sourceLineNo">2123</span>     *                   &lt;td&gt;0x0008+N+M&lt;/td&gt;<a name="line.2123"></a>
<span class="sourceLineNo">2124</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2124"></a>
<span class="sourceLineNo">2125</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2125"></a>
<span class="sourceLineNo">2126</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.2126"></a>
<span class="sourceLineNo">2127</span>     *                 &lt;/tr&gt;<a name="line.2127"></a>
<span class="sourceLineNo">2128</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2128"></a>
<span class="sourceLineNo">2129</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.2129"></a>
<span class="sourceLineNo">2130</span>     *                 &lt;tr&gt;<a name="line.2130"></a>
<span class="sourceLineNo">2131</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.2131"></a>
<span class="sourceLineNo">2132</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.2132"></a>
<span class="sourceLineNo">2133</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.2133"></a>
<span class="sourceLineNo">2134</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.2134"></a>
<span class="sourceLineNo">2135</span>     *                 &lt;/tr&gt;<a name="line.2135"></a>
<span class="sourceLineNo">2136</span>     *                 &lt;tr&gt;<a name="line.2136"></a>
<span class="sourceLineNo">2137</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.2137"></a>
<span class="sourceLineNo">2138</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2138"></a>
<span class="sourceLineNo">2139</span>     *                   &lt;td&gt;PubKeyIndex&lt;/td&gt;<a name="line.2139"></a>
<span class="sourceLineNo">2140</span>     *                   &lt;td&gt;SM2 public key index: 1~93。&lt;/td&gt;<a name="line.2140"></a>
<span class="sourceLineNo">2141</span>     *                 &lt;/tr&gt;<a name="line.2141"></a>
<span class="sourceLineNo">2142</span>     *                 &lt;tr&gt;<a name="line.2142"></a>
<span class="sourceLineNo">2143</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.2143"></a>
<span class="sourceLineNo">2144</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2144"></a>
<span class="sourceLineNo">2145</span>     *                   &lt;td&gt;PrvKeyIndex&lt;/td&gt;<a name="line.2145"></a>
<span class="sourceLineNo">2146</span>     *                   &lt;td&gt;SM2 private key index: 1~97。&lt;/td&gt;<a name="line.2146"></a>
<span class="sourceLineNo">2147</span>     *                 &lt;/tr&gt;<a name="line.2147"></a>
<span class="sourceLineNo">2148</span>     *                 &lt;tr&gt;<a name="line.2148"></a>
<span class="sourceLineNo">2149</span>     *                   &lt;td&gt;0x0002&lt;/td&gt;<a name="line.2149"></a>
<span class="sourceLineNo">2150</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2150"></a>
<span class="sourceLineNo">2151</span>     *                   &lt;td&gt;PrvKeyLenBit&lt;/td&gt;<a name="line.2151"></a>
<span class="sourceLineNo">2152</span>     *                   &lt;td&gt;The number of bits of the private key.&lt;/td&gt;<a name="line.2152"></a>
<span class="sourceLineNo">2153</span>     *                 &lt;/tr&gt;<a name="line.2153"></a>
<span class="sourceLineNo">2154</span>     *                 &lt;tr&gt;<a name="line.2154"></a>
<span class="sourceLineNo">2155</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.2155"></a>
<span class="sourceLineNo">2156</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2156"></a>
<span class="sourceLineNo">2157</span>     *                   &lt;td&gt;UidLen&lt;/td&gt;<a name="line.2157"></a>
<span class="sourceLineNo">2158</span>     *                   &lt;td&gt;The length of Uid.&lt;/td&gt;<a name="line.2158"></a>
<span class="sourceLineNo">2159</span>     *                 &lt;/tr&gt;<a name="line.2159"></a>
<span class="sourceLineNo">2160</span>     *                 &lt;tr&gt;<a name="line.2160"></a>
<span class="sourceLineNo">2161</span>     *                   &lt;td&gt;0x0006&lt;/td&gt;<a name="line.2161"></a>
<span class="sourceLineNo">2162</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.2162"></a>
<span class="sourceLineNo">2163</span>     *                   &lt;td&gt;Uid&lt;/td&gt;<a name="line.2163"></a>
<span class="sourceLineNo">2164</span>     *                   &lt;td&gt;Signer ID.&lt;/td&gt;<a name="line.2164"></a>
<span class="sourceLineNo">2165</span>     *                 &lt;/tr&gt;<a name="line.2165"></a>
<span class="sourceLineNo">2166</span>     *                 &lt;tr&gt;<a name="line.2166"></a>
<span class="sourceLineNo">2167</span>     *                   &lt;td&gt;0x0006+N&lt;/td&gt;<a name="line.2167"></a>
<span class="sourceLineNo">2168</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2168"></a>
<span class="sourceLineNo">2169</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.2169"></a>
<span class="sourceLineNo">2170</span>     *                   &lt;td&gt;The length of DataIn.&lt;/td&gt;<a name="line.2170"></a>
<span class="sourceLineNo">2171</span>     *                 &lt;/tr&gt;<a name="line.2171"></a>
<span class="sourceLineNo">2172</span>     *                 &lt;tr&gt;<a name="line.2172"></a>
<span class="sourceLineNo">2173</span>     *                   &lt;td&gt;0x0008+N&lt;/td&gt;<a name="line.2173"></a>
<span class="sourceLineNo">2174</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2174"></a>
<span class="sourceLineNo">2175</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.2175"></a>
<span class="sourceLineNo">2176</span>     *                   &lt;td&gt;The data to be signed.&lt;/td&gt;<a name="line.2176"></a>
<span class="sourceLineNo">2177</span>     *                 &lt;/tr&gt;<a name="line.2177"></a>
<span class="sourceLineNo">2178</span>     *                 &lt;tr&gt;<a name="line.2178"></a>
<span class="sourceLineNo">2179</span>     *                   &lt;td&gt;0x0015+N&lt;/td&gt;<a name="line.2179"></a>
<span class="sourceLineNo">2180</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2180"></a>
<span class="sourceLineNo">2181</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2181"></a>
<span class="sourceLineNo">2182</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.2182"></a>
<span class="sourceLineNo">2183</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.2183"></a>
<span class="sourceLineNo">2184</span>     *                 &lt;/tr&gt;<a name="line.2184"></a>
<span class="sourceLineNo">2185</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2185"></a>
<span class="sourceLineNo">2186</span>     * @return &lt;div class="zh"&gt;64字节的签名数据。&lt;/div&gt; &lt;div class="en"&gt;64 bytes of signature data.&lt;/div&gt;<a name="line.2186"></a>
<span class="sourceLineNo">2187</span>     * @throws TypeAException TypeAException<a name="line.2187"></a>
<span class="sourceLineNo">2188</span>     */<a name="line.2188"></a>
<span class="sourceLineNo">2189</span>    byte[] SM2Sign(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.2189"></a>
<span class="sourceLineNo">2190</span><a name="line.2190"></a>
<span class="sourceLineNo">2191</span>    /**<a name="line.2191"></a>
<span class="sourceLineNo">2192</span>     * &lt;div class="zh"&gt;使用 SM2 公钥验证签名。&lt;/div&gt; &lt;div class="en"&gt;Use the SM2 public key to verify the signature.&lt;/div&gt;<a name="line.2192"></a>
<span class="sourceLineNo">2193</span>     *<a name="line.2193"></a>
<span class="sourceLineNo">2194</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2194"></a>
<span class="sourceLineNo">2195</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.2195"></a>
<span class="sourceLineNo">2196</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.2196"></a>
<span class="sourceLineNo">2197</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.2197"></a>
<span class="sourceLineNo">2198</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2198"></a>
<span class="sourceLineNo">2199</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.2199"></a>
<span class="sourceLineNo">2200</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.2200"></a>
<span class="sourceLineNo">2201</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.2201"></a>
<span class="sourceLineNo">2202</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.2202"></a>
<span class="sourceLineNo">2203</span>     *                 &lt;tr&gt;<a name="line.2203"></a>
<span class="sourceLineNo">2204</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.2204"></a>
<span class="sourceLineNo">2205</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.2205"></a>
<span class="sourceLineNo">2206</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.2206"></a>
<span class="sourceLineNo">2207</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.2207"></a>
<span class="sourceLineNo">2208</span>     *                 &lt;/tr&gt;<a name="line.2208"></a>
<span class="sourceLineNo">2209</span>     *                 &lt;tr&gt;<a name="line.2209"></a>
<span class="sourceLineNo">2210</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.2210"></a>
<span class="sourceLineNo">2211</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2211"></a>
<span class="sourceLineNo">2212</span>     *                   &lt;td&gt;PubKeyIndex&lt;/td&gt;<a name="line.2212"></a>
<span class="sourceLineNo">2213</span>     *                   &lt;td&gt;SM2公钥索引: 1~93。&lt;/td&gt;<a name="line.2213"></a>
<span class="sourceLineNo">2214</span>     *                 &lt;/tr&gt;<a name="line.2214"></a>
<span class="sourceLineNo">2215</span>     *                 &lt;tr&gt;<a name="line.2215"></a>
<span class="sourceLineNo">2216</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.2216"></a>
<span class="sourceLineNo">2217</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2217"></a>
<span class="sourceLineNo">2218</span>     *                   &lt;td&gt;PubKeyLenBit&lt;/td&gt;<a name="line.2218"></a>
<span class="sourceLineNo">2219</span>     *                   &lt;td&gt;公钥位数。&lt;/td&gt;<a name="line.2219"></a>
<span class="sourceLineNo">2220</span>     *                 &lt;/tr&gt;<a name="line.2220"></a>
<span class="sourceLineNo">2221</span>     *                 &lt;tr&gt;<a name="line.2221"></a>
<span class="sourceLineNo">2222</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.2222"></a>
<span class="sourceLineNo">2223</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2223"></a>
<span class="sourceLineNo">2224</span>     *                   &lt;td&gt;UidLen&lt;/td&gt;<a name="line.2224"></a>
<span class="sourceLineNo">2225</span>     *                   &lt;td&gt;Uid的长度。&lt;/td&gt;<a name="line.2225"></a>
<span class="sourceLineNo">2226</span>     *                 &lt;/tr&gt;<a name="line.2226"></a>
<span class="sourceLineNo">2227</span>     *                 &lt;tr&gt;<a name="line.2227"></a>
<span class="sourceLineNo">2228</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.2228"></a>
<span class="sourceLineNo">2229</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.2229"></a>
<span class="sourceLineNo">2230</span>     *                   &lt;td&gt;Uid&lt;/td&gt;<a name="line.2230"></a>
<span class="sourceLineNo">2231</span>     *                   &lt;td&gt;签名者 ID。&lt;/td&gt;<a name="line.2231"></a>
<span class="sourceLineNo">2232</span>     *                 &lt;/tr&gt;<a name="line.2232"></a>
<span class="sourceLineNo">2233</span>     *                 &lt;tr&gt;<a name="line.2233"></a>
<span class="sourceLineNo">2234</span>     *                   &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.2234"></a>
<span class="sourceLineNo">2235</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2235"></a>
<span class="sourceLineNo">2236</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.2236"></a>
<span class="sourceLineNo">2237</span>     *                   &lt;td&gt;DataIn长度。小于等于1024。&lt;/td&gt;<a name="line.2237"></a>
<span class="sourceLineNo">2238</span>     *                 &lt;/tr&gt;<a name="line.2238"></a>
<span class="sourceLineNo">2239</span>     *                 &lt;tr&gt;<a name="line.2239"></a>
<span class="sourceLineNo">2240</span>     *                   &lt;td&gt;0x0007+N&lt;/td&gt;<a name="line.2240"></a>
<span class="sourceLineNo">2241</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2241"></a>
<span class="sourceLineNo">2242</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.2242"></a>
<span class="sourceLineNo">2243</span>     *                   &lt;td&gt;待签名的数据。&lt;/td&gt;<a name="line.2243"></a>
<span class="sourceLineNo">2244</span>     *                 &lt;/tr&gt;<a name="line.2244"></a>
<span class="sourceLineNo">2245</span>     *                 &lt;tr&gt;<a name="line.2245"></a>
<span class="sourceLineNo">2246</span>     *                   &lt;td&gt;0x0007+N+M&lt;/td&gt;<a name="line.2246"></a>
<span class="sourceLineNo">2247</span>     *                   &lt;td&gt;64&lt;/td&gt;<a name="line.2247"></a>
<span class="sourceLineNo">2248</span>     *                   &lt;td&gt;Signature&lt;/td&gt;<a name="line.2248"></a>
<span class="sourceLineNo">2249</span>     *                   &lt;td&gt;签名值，固定为 64 字节。&lt;/td&gt;<a name="line.2249"></a>
<span class="sourceLineNo">2250</span>     *                 &lt;/tr&gt;<a name="line.2250"></a>
<span class="sourceLineNo">2251</span>     *                 &lt;tr&gt;<a name="line.2251"></a>
<span class="sourceLineNo">2252</span>     *                   &lt;td&gt;0x0047+N+M&lt;/td&gt;<a name="line.2252"></a>
<span class="sourceLineNo">2253</span>     *                   &lt;td&gt;L&lt;/td&gt;<a name="line.2253"></a>
<span class="sourceLineNo">2254</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2254"></a>
<span class="sourceLineNo">2255</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.2255"></a>
<span class="sourceLineNo">2256</span>     *                 &lt;/tr&gt;<a name="line.2256"></a>
<span class="sourceLineNo">2257</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2257"></a>
<span class="sourceLineNo">2258</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.2258"></a>
<span class="sourceLineNo">2259</span>     *                 &lt;tr&gt;<a name="line.2259"></a>
<span class="sourceLineNo">2260</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.2260"></a>
<span class="sourceLineNo">2261</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.2261"></a>
<span class="sourceLineNo">2262</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.2262"></a>
<span class="sourceLineNo">2263</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.2263"></a>
<span class="sourceLineNo">2264</span>     *                 &lt;/tr&gt;<a name="line.2264"></a>
<span class="sourceLineNo">2265</span>     *                 &lt;tr&gt;<a name="line.2265"></a>
<span class="sourceLineNo">2266</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.2266"></a>
<span class="sourceLineNo">2267</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2267"></a>
<span class="sourceLineNo">2268</span>     *                   &lt;td&gt;PubKeyIndex&lt;/td&gt;<a name="line.2268"></a>
<span class="sourceLineNo">2269</span>     *                   &lt;td&gt;SM2 public key index: 1~93。&lt;/td&gt;<a name="line.2269"></a>
<span class="sourceLineNo">2270</span>     *                 &lt;/tr&gt;<a name="line.2270"></a>
<span class="sourceLineNo">2271</span>     *                 &lt;tr&gt;<a name="line.2271"></a>
<span class="sourceLineNo">2272</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.2272"></a>
<span class="sourceLineNo">2273</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2273"></a>
<span class="sourceLineNo">2274</span>     *                   &lt;td&gt;PubKeyLenBit&lt;/td&gt;<a name="line.2274"></a>
<span class="sourceLineNo">2275</span>     *                   &lt;td&gt;The number of bits of the public key.&lt;/td&gt;<a name="line.2275"></a>
<span class="sourceLineNo">2276</span>     *                 &lt;/tr&gt;<a name="line.2276"></a>
<span class="sourceLineNo">2277</span>     *                 &lt;tr&gt;<a name="line.2277"></a>
<span class="sourceLineNo">2278</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.2278"></a>
<span class="sourceLineNo">2279</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2279"></a>
<span class="sourceLineNo">2280</span>     *                   &lt;td&gt;UidLen&lt;/td&gt;<a name="line.2280"></a>
<span class="sourceLineNo">2281</span>     *                   &lt;td&gt;The length of Uid.&lt;/td&gt;<a name="line.2281"></a>
<span class="sourceLineNo">2282</span>     *                 &lt;/tr&gt;<a name="line.2282"></a>
<span class="sourceLineNo">2283</span>     *                 &lt;tr&gt;<a name="line.2283"></a>
<span class="sourceLineNo">2284</span>     *                   &lt;td&gt;0x0005&lt;/td&gt;<a name="line.2284"></a>
<span class="sourceLineNo">2285</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.2285"></a>
<span class="sourceLineNo">2286</span>     *                   &lt;td&gt;Uid&lt;/td&gt;<a name="line.2286"></a>
<span class="sourceLineNo">2287</span>     *                   &lt;td&gt;Signer ID.&lt;/td&gt;<a name="line.2287"></a>
<span class="sourceLineNo">2288</span>     *                 &lt;/tr&gt;<a name="line.2288"></a>
<span class="sourceLineNo">2289</span>     *                 &lt;tr&gt;<a name="line.2289"></a>
<span class="sourceLineNo">2290</span>     *                   &lt;td&gt;0x0005+N&lt;/td&gt;<a name="line.2290"></a>
<span class="sourceLineNo">2291</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2291"></a>
<span class="sourceLineNo">2292</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.2292"></a>
<span class="sourceLineNo">2293</span>     *                   &lt;td&gt;The length of DataIn.&lt;/td&gt;<a name="line.2293"></a>
<span class="sourceLineNo">2294</span>     *                 &lt;/tr&gt;<a name="line.2294"></a>
<span class="sourceLineNo">2295</span>     *                 &lt;tr&gt;<a name="line.2295"></a>
<span class="sourceLineNo">2296</span>     *                   &lt;td&gt;0x0007+N&lt;/td&gt;<a name="line.2296"></a>
<span class="sourceLineNo">2297</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2297"></a>
<span class="sourceLineNo">2298</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.2298"></a>
<span class="sourceLineNo">2299</span>     *                   &lt;td&gt;The data to be signed.&lt;/td&gt;<a name="line.2299"></a>
<span class="sourceLineNo">2300</span>     *                 &lt;/tr&gt;<a name="line.2300"></a>
<span class="sourceLineNo">2301</span>     *                 &lt;tr&gt;<a name="line.2301"></a>
<span class="sourceLineNo">2302</span>     *                   &lt;td&gt;0x0007+N+M&lt;/td&gt;<a name="line.2302"></a>
<span class="sourceLineNo">2303</span>     *                   &lt;td&gt;64&lt;/td&gt;<a name="line.2303"></a>
<span class="sourceLineNo">2304</span>     *                   &lt;td&gt;Signature&lt;/td&gt;<a name="line.2304"></a>
<span class="sourceLineNo">2305</span>     *                   &lt;td&gt;The signature value is fixed at 64 bytes.&lt;/td&gt;<a name="line.2305"></a>
<span class="sourceLineNo">2306</span>     *                 &lt;/tr&gt;<a name="line.2306"></a>
<span class="sourceLineNo">2307</span>     *                 &lt;tr&gt;<a name="line.2307"></a>
<span class="sourceLineNo">2308</span>     *                   &lt;td&gt;0x0047+N+M&lt;/td&gt;<a name="line.2308"></a>
<span class="sourceLineNo">2309</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2309"></a>
<span class="sourceLineNo">2310</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2310"></a>
<span class="sourceLineNo">2311</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.2311"></a>
<span class="sourceLineNo">2312</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.2312"></a>
<span class="sourceLineNo">2313</span>     *                 &lt;/tr&gt;<a name="line.2313"></a>
<span class="sourceLineNo">2314</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2314"></a>
<span class="sourceLineNo">2315</span>     * @throws TypeAException TypeAException<a name="line.2315"></a>
<span class="sourceLineNo">2316</span>     */<a name="line.2316"></a>
<span class="sourceLineNo">2317</span>    void SM2Verify(byte cipherFlag, byte[] dataIn) throws  TypeAException;<a name="line.2317"></a>
<span class="sourceLineNo">2318</span><a name="line.2318"></a>
<span class="sourceLineNo">2319</span>    /**<a name="line.2319"></a>
<span class="sourceLineNo">2320</span>     * &lt;div class="zh"&gt;使用 SM2 公钥加密数据或私钥解密数据。&lt;/div&gt;<a name="line.2320"></a>
<span class="sourceLineNo">2321</span>     * &lt;div class="en"&gt;Use SM2 public key to encrypt data or private key to decrypt data.&lt;/div&gt;<a name="line.2321"></a>
<span class="sourceLineNo">2322</span>     *<a name="line.2322"></a>
<span class="sourceLineNo">2323</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2323"></a>
<span class="sourceLineNo">2324</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.2324"></a>
<span class="sourceLineNo">2325</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.2325"></a>
<span class="sourceLineNo">2326</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.2326"></a>
<span class="sourceLineNo">2327</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2327"></a>
<span class="sourceLineNo">2328</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.2328"></a>
<span class="sourceLineNo">2329</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.2329"></a>
<span class="sourceLineNo">2330</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.2330"></a>
<span class="sourceLineNo">2331</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.2331"></a>
<span class="sourceLineNo">2332</span>     *                 &lt;tr&gt;<a name="line.2332"></a>
<span class="sourceLineNo">2333</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.2333"></a>
<span class="sourceLineNo">2334</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.2334"></a>
<span class="sourceLineNo">2335</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.2335"></a>
<span class="sourceLineNo">2336</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.2336"></a>
<span class="sourceLineNo">2337</span>     *                 &lt;/tr&gt;<a name="line.2337"></a>
<span class="sourceLineNo">2338</span>     *                 &lt;tr&gt;<a name="line.2338"></a>
<span class="sourceLineNo">2339</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.2339"></a>
<span class="sourceLineNo">2340</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2340"></a>
<span class="sourceLineNo">2341</span>     *                   &lt;td&gt;KeyIndex&lt;/td&gt;<a name="line.2341"></a>
<span class="sourceLineNo">2342</span>     *                   &lt;td&gt;SM2公钥索引: 1~93; &lt;br&gt; SM2私钥索引: 1~97。&lt;/td&gt;<a name="line.2342"></a>
<span class="sourceLineNo">2343</span>     *                 &lt;/tr&gt;<a name="line.2343"></a>
<span class="sourceLineNo">2344</span>     *                 &lt;tr&gt;<a name="line.2344"></a>
<span class="sourceLineNo">2345</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.2345"></a>
<span class="sourceLineNo">2346</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2346"></a>
<span class="sourceLineNo">2347</span>     *                   &lt;td&gt;KeyLenBit&lt;/td&gt;<a name="line.2347"></a>
<span class="sourceLineNo">2348</span>     *                   &lt;td&gt;SM2密钥位数。&lt;/td&gt;<a name="line.2348"></a>
<span class="sourceLineNo">2349</span>     *                 &lt;/tr&gt;<a name="line.2349"></a>
<span class="sourceLineNo">2350</span>     *                 &lt;tr&gt;<a name="line.2350"></a>
<span class="sourceLineNo">2351</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.2351"></a>
<span class="sourceLineNo">2352</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2352"></a>
<span class="sourceLineNo">2353</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.2353"></a>
<span class="sourceLineNo">2354</span>     *                   &lt;td&gt;0x00: 使用SM2私钥解密数据; &lt;br&gt; 0x01: 使用SM2公钥加密数据。&lt;/td&gt;<a name="line.2354"></a>
<span class="sourceLineNo">2355</span>     *                 &lt;/tr&gt;<a name="line.2355"></a>
<span class="sourceLineNo">2356</span>     *                 &lt;tr&gt;<a name="line.2356"></a>
<span class="sourceLineNo">2357</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.2357"></a>
<span class="sourceLineNo">2358</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2358"></a>
<span class="sourceLineNo">2359</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.2359"></a>
<span class="sourceLineNo">2360</span>     *                   &lt;td&gt;DataIn长度。小于等于1024。&lt;/td&gt;<a name="line.2360"></a>
<span class="sourceLineNo">2361</span>     *                 &lt;/tr&gt;<a name="line.2361"></a>
<span class="sourceLineNo">2362</span>     *                 &lt;tr&gt;<a name="line.2362"></a>
<span class="sourceLineNo">2363</span>     *                   &lt;td&gt;0x0006&lt;/td&gt;<a name="line.2363"></a>
<span class="sourceLineNo">2364</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.2364"></a>
<span class="sourceLineNo">2365</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.2365"></a>
<span class="sourceLineNo">2366</span>     *                   &lt;td&gt;待加密或者解密的数据。&lt;/td&gt;<a name="line.2366"></a>
<span class="sourceLineNo">2367</span>     *                 &lt;/tr&gt;<a name="line.2367"></a>
<span class="sourceLineNo">2368</span>     *                 &lt;tr&gt;<a name="line.2368"></a>
<span class="sourceLineNo">2369</span>     *                   &lt;td&gt;0x0006+N&lt;/td&gt;<a name="line.2369"></a>
<span class="sourceLineNo">2370</span>     *                   &lt;td&gt;L&lt;/td&gt;<a name="line.2370"></a>
<span class="sourceLineNo">2371</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2371"></a>
<span class="sourceLineNo">2372</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.2372"></a>
<span class="sourceLineNo">2373</span>     *                 &lt;/tr&gt;<a name="line.2373"></a>
<span class="sourceLineNo">2374</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2374"></a>
<span class="sourceLineNo">2375</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.2375"></a>
<span class="sourceLineNo">2376</span>     *                 &lt;tr&gt;<a name="line.2376"></a>
<span class="sourceLineNo">2377</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.2377"></a>
<span class="sourceLineNo">2378</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.2378"></a>
<span class="sourceLineNo">2379</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.2379"></a>
<span class="sourceLineNo">2380</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.2380"></a>
<span class="sourceLineNo">2381</span>     *                 &lt;/tr&gt;<a name="line.2381"></a>
<span class="sourceLineNo">2382</span>     *                 &lt;tr&gt;<a name="line.2382"></a>
<span class="sourceLineNo">2383</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.2383"></a>
<span class="sourceLineNo">2384</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2384"></a>
<span class="sourceLineNo">2385</span>     *                   &lt;td&gt;KeyIndex&lt;/td&gt;<a name="line.2385"></a>
<span class="sourceLineNo">2386</span>     *                   &lt;td&gt;SM2 public key index: 1~93; &lt;br&gt; SM2 private key index: 1~97。&lt;/td&gt;<a name="line.2386"></a>
<span class="sourceLineNo">2387</span>     *                 &lt;/tr&gt;<a name="line.2387"></a>
<span class="sourceLineNo">2388</span>     *                 &lt;tr&gt;<a name="line.2388"></a>
<span class="sourceLineNo">2389</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.2389"></a>
<span class="sourceLineNo">2390</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2390"></a>
<span class="sourceLineNo">2391</span>     *                   &lt;td&gt;KeyLenBit&lt;/td&gt;<a name="line.2391"></a>
<span class="sourceLineNo">2392</span>     *                   &lt;td&gt;SM2密钥位数。&lt;/td&gt;<a name="line.2392"></a>
<span class="sourceLineNo">2393</span>     *                 &lt;/tr&gt;<a name="line.2393"></a>
<span class="sourceLineNo">2394</span>     *                 &lt;tr&gt;<a name="line.2394"></a>
<span class="sourceLineNo">2395</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.2395"></a>
<span class="sourceLineNo">2396</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2396"></a>
<span class="sourceLineNo">2397</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.2397"></a>
<span class="sourceLineNo">2398</span>     *                   &lt;td&gt;0x00: Use SM2 private key to decrypt data; &lt;br&gt; 0x01: Use SM2 public key to encrypt data.&lt;/td&gt;<a name="line.2398"></a>
<span class="sourceLineNo">2399</span>     *                 &lt;/tr&gt;<a name="line.2399"></a>
<span class="sourceLineNo">2400</span>     *                 &lt;tr&gt;<a name="line.2400"></a>
<span class="sourceLineNo">2401</span>     *                   &lt;td&gt;0x0004&lt;/td&gt;<a name="line.2401"></a>
<span class="sourceLineNo">2402</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2402"></a>
<span class="sourceLineNo">2403</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.2403"></a>
<span class="sourceLineNo">2404</span>     *                   &lt;td&gt;DataIn length. Less than or equal to 1024.&lt;/td&gt;<a name="line.2404"></a>
<span class="sourceLineNo">2405</span>     *                 &lt;/tr&gt;<a name="line.2405"></a>
<span class="sourceLineNo">2406</span>     *                 &lt;tr&gt;<a name="line.2406"></a>
<span class="sourceLineNo">2407</span>     *                   &lt;td&gt;0x0006&lt;/td&gt;<a name="line.2407"></a>
<span class="sourceLineNo">2408</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.2408"></a>
<span class="sourceLineNo">2409</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.2409"></a>
<span class="sourceLineNo">2410</span>     *                   &lt;td&gt;The data to be encrypted or decrypted.&lt;/td&gt;<a name="line.2410"></a>
<span class="sourceLineNo">2411</span>     *                 &lt;/tr&gt;<a name="line.2411"></a>
<span class="sourceLineNo">2412</span>     *                 &lt;tr&gt;<a name="line.2412"></a>
<span class="sourceLineNo">2413</span>     *                   &lt;td&gt;0x0006+N&lt;/td&gt;<a name="line.2413"></a>
<span class="sourceLineNo">2414</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2414"></a>
<span class="sourceLineNo">2415</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2415"></a>
<span class="sourceLineNo">2416</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.2416"></a>
<span class="sourceLineNo">2417</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.2417"></a>
<span class="sourceLineNo">2418</span>     *                 &lt;/tr&gt;<a name="line.2418"></a>
<span class="sourceLineNo">2419</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2419"></a>
<span class="sourceLineNo">2420</span>     * @return &lt;div class="zh"&gt;计算结果。数据长度：加密时为源数据长度加96字节; 解密时为源数据长度减96字节。&lt;/div&gt;<a name="line.2420"></a>
<span class="sourceLineNo">2421</span>     *         &lt;div class="en"&gt;Calculation results. Data length: When encrypting, the length of the source data plus 96 bytes;<a name="line.2421"></a>
<span class="sourceLineNo">2422</span>     *           when decrypting, the length of the source data minus 96 bytes.&lt;/div&gt;<a name="line.2422"></a>
<span class="sourceLineNo">2423</span>     * @throws TypeAException TypeAException<a name="line.2423"></a>
<span class="sourceLineNo">2424</span>     */<a name="line.2424"></a>
<span class="sourceLineNo">2425</span>    byte[] calcSM2Data(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.2425"></a>
<span class="sourceLineNo">2426</span><a name="line.2426"></a>
<span class="sourceLineNo">2427</span>    /**<a name="line.2427"></a>
<span class="sourceLineNo">2428</span>     * &lt;div class="zh"&gt;使用 SM3 算法计算杂凑值。&lt;/div&gt; &lt;div class="en"&gt;The SM3 algorithm is used to calculate the hash value.&lt;/div&gt;<a name="line.2428"></a>
<span class="sourceLineNo">2429</span>     * @param cipherFlag &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2429"></a>
<span class="sourceLineNo">2430</span>     *                     &lt;li&gt;0x00: dataIn 是明文。&lt;/li&gt;<a name="line.2430"></a>
<span class="sourceLineNo">2431</span>     *                     &lt;li&gt;0x01: dataIn 是由传输密钥(TXK)加密。&lt;/li&gt;<a name="line.2431"></a>
<span class="sourceLineNo">2432</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.2432"></a>
<span class="sourceLineNo">2433</span>     *                   &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2433"></a>
<span class="sourceLineNo">2434</span>     *                     &lt;li&gt;0x00: dataIn is plain text.&lt;/li&gt;<a name="line.2434"></a>
<span class="sourceLineNo">2435</span>     *                     &lt;li&gt;0x01: dataIn is encrypted by the exchange key(TXK).&lt;/li&gt;<a name="line.2435"></a>
<span class="sourceLineNo">2436</span>     *                   &lt;/ul&gt;&lt;/div&gt;<a name="line.2436"></a>
<span class="sourceLineNo">2437</span>     * @param dataIn &lt;div class="zh"&gt;&lt;table border="1"&gt;<a name="line.2437"></a>
<span class="sourceLineNo">2438</span>     *                 &lt;tr&gt;<a name="line.2438"></a>
<span class="sourceLineNo">2439</span>     *                   &lt;th&gt;偏移位置&lt;/th&gt;<a name="line.2439"></a>
<span class="sourceLineNo">2440</span>     *                   &lt;th&gt;长度(byte)&lt;/th&gt;<a name="line.2440"></a>
<span class="sourceLineNo">2441</span>     *                   &lt;th&gt;变量名称&lt;/th&gt;<a name="line.2441"></a>
<span class="sourceLineNo">2442</span>     *                   &lt;th&gt;意义&lt;/th&gt;<a name="line.2442"></a>
<span class="sourceLineNo">2443</span>     *                 &lt;/tr&gt;<a name="line.2443"></a>
<span class="sourceLineNo">2444</span>     *                 &lt;tr&gt;<a name="line.2444"></a>
<span class="sourceLineNo">2445</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.2445"></a>
<span class="sourceLineNo">2446</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2446"></a>
<span class="sourceLineNo">2447</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.2447"></a>
<span class="sourceLineNo">2448</span>     *                   &lt;td&gt;0x00: 目前只支持0x00; &lt;br&gt;其他值保留。&lt;/td&gt;<a name="line.2448"></a>
<span class="sourceLineNo">2449</span>     *                 &lt;/tr&gt;<a name="line.2449"></a>
<span class="sourceLineNo">2450</span>     *                 &lt;tr&gt;<a name="line.2450"></a>
<span class="sourceLineNo">2451</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.2451"></a>
<span class="sourceLineNo">2452</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2452"></a>
<span class="sourceLineNo">2453</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.2453"></a>
<span class="sourceLineNo">2454</span>     *                   &lt;td&gt;DataIn长度。小于等于1024。&lt;/td&gt;<a name="line.2454"></a>
<span class="sourceLineNo">2455</span>     *                 &lt;/tr&gt;<a name="line.2455"></a>
<span class="sourceLineNo">2456</span>     *                 &lt;tr&gt;<a name="line.2456"></a>
<span class="sourceLineNo">2457</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.2457"></a>
<span class="sourceLineNo">2458</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.2458"></a>
<span class="sourceLineNo">2459</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.2459"></a>
<span class="sourceLineNo">2460</span>     *                   &lt;td&gt;待计算的数据。&lt;/td&gt;<a name="line.2460"></a>
<span class="sourceLineNo">2461</span>     *                 &lt;/tr&gt;<a name="line.2461"></a>
<span class="sourceLineNo">2462</span>     *                 &lt;tr&gt;<a name="line.2462"></a>
<span class="sourceLineNo">2463</span>     *                   &lt;td&gt;0x0003+N&lt;/td&gt;<a name="line.2463"></a>
<span class="sourceLineNo">2464</span>     *                   &lt;td&gt;L&lt;/td&gt;<a name="line.2464"></a>
<span class="sourceLineNo">2465</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2465"></a>
<span class="sourceLineNo">2466</span>     *                   &lt;td&gt;加密传输时的填充字节，以上数据长度不被8 字节整除时，填充至 8 字节整除的个数，明文传输时没有该域。&lt;/td&gt;<a name="line.2466"></a>
<span class="sourceLineNo">2467</span>     *                 &lt;/tr&gt;<a name="line.2467"></a>
<span class="sourceLineNo">2468</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2468"></a>
<span class="sourceLineNo">2469</span>     *               &lt;div class="en"&gt;&lt;table border="1"&gt;<a name="line.2469"></a>
<span class="sourceLineNo">2470</span>     *                 &lt;tr&gt;<a name="line.2470"></a>
<span class="sourceLineNo">2471</span>     *                   &lt;th&gt;Offset &lt;/th&gt;<a name="line.2471"></a>
<span class="sourceLineNo">2472</span>     *                   &lt;th&gt;Length(byte)&lt;/th&gt;<a name="line.2472"></a>
<span class="sourceLineNo">2473</span>     *                   &lt;th&gt;Variable name&lt;/th&gt;<a name="line.2473"></a>
<span class="sourceLineNo">2474</span>     *                   &lt;th&gt;Description&lt;/th&gt;<a name="line.2474"></a>
<span class="sourceLineNo">2475</span>     *                 &lt;/tr&gt;<a name="line.2475"></a>
<span class="sourceLineNo">2476</span>     *                 &lt;tr&gt;<a name="line.2476"></a>
<span class="sourceLineNo">2477</span>     *                   &lt;td&gt;0x0000&lt;/td&gt;<a name="line.2477"></a>
<span class="sourceLineNo">2478</span>     *                   &lt;td&gt;1&lt;/td&gt;<a name="line.2478"></a>
<span class="sourceLineNo">2479</span>     *                   &lt;td&gt;Mode&lt;/td&gt;<a name="line.2479"></a>
<span class="sourceLineNo">2480</span>     *                   &lt;td&gt;0x00: Currently only 0x00 is supported; &lt;br&gt;Other values are reserved.&lt;/td&gt;<a name="line.2480"></a>
<span class="sourceLineNo">2481</span>     *                 &lt;/tr&gt;<a name="line.2481"></a>
<span class="sourceLineNo">2482</span>     *                 &lt;tr&gt;<a name="line.2482"></a>
<span class="sourceLineNo">2483</span>     *                   &lt;td&gt;0x0001&lt;/td&gt;<a name="line.2483"></a>
<span class="sourceLineNo">2484</span>     *                   &lt;td&gt;2&lt;/td&gt;<a name="line.2484"></a>
<span class="sourceLineNo">2485</span>     *                   &lt;td&gt;DataInLen&lt;/td&gt;<a name="line.2485"></a>
<span class="sourceLineNo">2486</span>     *                   &lt;td&gt;DataIn length. Less than or equal to 1024.&lt;/td&gt;<a name="line.2486"></a>
<span class="sourceLineNo">2487</span>     *                 &lt;/tr&gt;<a name="line.2487"></a>
<span class="sourceLineNo">2488</span>     *                 &lt;tr&gt;<a name="line.2488"></a>
<span class="sourceLineNo">2489</span>     *                   &lt;td&gt;0x0003&lt;/td&gt;<a name="line.2489"></a>
<span class="sourceLineNo">2490</span>     *                   &lt;td&gt;N&lt;/td&gt;<a name="line.2490"></a>
<span class="sourceLineNo">2491</span>     *                   &lt;td&gt;DataIn&lt;/td&gt;<a name="line.2491"></a>
<span class="sourceLineNo">2492</span>     *                   &lt;td&gt;The data to be calculated.&lt;/td&gt;<a name="line.2492"></a>
<span class="sourceLineNo">2493</span>     *                 &lt;/tr&gt;<a name="line.2493"></a>
<span class="sourceLineNo">2494</span>     *                 &lt;tr&gt;<a name="line.2494"></a>
<span class="sourceLineNo">2495</span>     *                   &lt;td&gt;0x0003+N&lt;/td&gt;<a name="line.2495"></a>
<span class="sourceLineNo">2496</span>     *                   &lt;td&gt;M&lt;/td&gt;<a name="line.2496"></a>
<span class="sourceLineNo">2497</span>     *                   &lt;td&gt;Fill&lt;/td&gt;<a name="line.2497"></a>
<span class="sourceLineNo">2498</span>     *                   &lt;td&gt;The padding byte during encrypted transmission. When the above data length is not divisible by 8 bytes,<a name="line.2498"></a>
<span class="sourceLineNo">2499</span>     *                     it is filled to the number evenly divisible by 8 bytes. There is no such field in plaintext transmission.&lt;/td&gt;<a name="line.2499"></a>
<span class="sourceLineNo">2500</span>     *                 &lt;/tr&gt;<a name="line.2500"></a>
<span class="sourceLineNo">2501</span>     *               &lt;/table&gt;&lt;/div&gt;<a name="line.2501"></a>
<span class="sourceLineNo">2502</span>     * @return &lt;div class="zh"&gt;&lt;/div&gt; &lt;div class="en"&gt;&lt;/div&gt;<a name="line.2502"></a>
<span class="sourceLineNo">2503</span>     * @throws TypeAException TypeAException<a name="line.2503"></a>
<span class="sourceLineNo">2504</span>     */<a name="line.2504"></a>
<span class="sourceLineNo">2505</span>    byte[] getSM3Hash(byte cipherFlag, byte[] dataIn) throws TypeAException;<a name="line.2505"></a>
<span class="sourceLineNo">2506</span><a name="line.2506"></a>
<span class="sourceLineNo">2507</span>    /**<a name="line.2507"></a>
<span class="sourceLineNo">2508</span>     * &lt;div class="zh"&gt;按所选序号播放语音。必须支持语音芯片&lt;/div&gt;<a name="line.2508"></a>
<span class="sourceLineNo">2509</span>     * &lt;div class="en"&gt;Play the voice according to the selected sequence number. Must support voice chip&lt;/div&gt;<a name="line.2509"></a>
<span class="sourceLineNo">2510</span>     *<a name="line.2510"></a>
<span class="sourceLineNo">2511</span>     * @param type &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2511"></a>
<span class="sourceLineNo">2512</span>     *               &lt;li&gt;0x01: "请拍卡。&lt;/li&gt;<a name="line.2512"></a>
<span class="sourceLineNo">2513</span>     *               &lt;li&gt;0x02: "请重新拍卡"。&lt;/li&gt;<a name="line.2513"></a>
<span class="sourceLineNo">2514</span>     *               &lt;li&gt;0x03: "请输入密码"。&lt;/li&gt;<a name="line.2514"></a>
<span class="sourceLineNo">2515</span>     *               &lt;li&gt;0x04: "请输入信息"。&lt;/li&gt;<a name="line.2515"></a>
<span class="sourceLineNo">2516</span>     *               &lt;li&gt;0x05: "请重新输入"。&lt;/li&gt;<a name="line.2516"></a>
<span class="sourceLineNo">2517</span>     *               &lt;li&gt;0x06: "嘀"。&lt;/li&gt;<a name="line.2517"></a>
<span class="sourceLineNo">2518</span>     *               &lt;li&gt;0x07: "Please tap the card"。&lt;/li&gt;<a name="line.2518"></a>
<span class="sourceLineNo">2519</span>     *               &lt;li&gt;0x08: "Please re-tap the card"。&lt;/li&gt;<a name="line.2519"></a>
<span class="sourceLineNo">2520</span>     *               &lt;li&gt;0x09: "Please enter password"。&lt;/li&gt;<a name="line.2520"></a>
<span class="sourceLineNo">2521</span>     *               &lt;li&gt;0x0A: "Please input information"。&lt;/li&gt;<a name="line.2521"></a>
<span class="sourceLineNo">2522</span>     *               &lt;li&gt;0x0B: "Please re-input"。&lt;/li&gt;<a name="line.2522"></a>
<span class="sourceLineNo">2523</span>     *               &lt;li&gt;0x0C: 音效 1。&lt;/li&gt;<a name="line.2523"></a>
<span class="sourceLineNo">2524</span>     *               &lt;li&gt;0x0D: 音效 2。&lt;/li&gt;<a name="line.2524"></a>
<span class="sourceLineNo">2525</span>     *               &lt;li&gt;0x0E: 音效 3。&lt;/li&gt;<a name="line.2525"></a>
<span class="sourceLineNo">2526</span>     *               &lt;li&gt;0x0F: 音效 4。&lt;/li&gt;<a name="line.2526"></a>
<span class="sourceLineNo">2527</span>     *               &lt;li&gt;0x10: 音效 5。&lt;/li&gt;<a name="line.2527"></a>
<span class="sourceLineNo">2528</span>     *               &lt;li&gt;0x11: 音效 6。&lt;/li&gt;<a name="line.2528"></a>
<span class="sourceLineNo">2529</span>     *               &lt;li&gt;0x12: 音效 7。&lt;/li&gt;<a name="line.2529"></a>
<span class="sourceLineNo">2530</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.2530"></a>
<span class="sourceLineNo">2531</span>     *             &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2531"></a>
<span class="sourceLineNo">2532</span>     *               &lt;li&gt;0x01: "请拍卡".&lt;/li&gt;<a name="line.2532"></a>
<span class="sourceLineNo">2533</span>     *               &lt;li&gt;0x02: "请重新拍卡".&lt;/li&gt;<a name="line.2533"></a>
<span class="sourceLineNo">2534</span>     *               &lt;li&gt;0x03: "请输入密码".&lt;/li&gt;<a name="line.2534"></a>
<span class="sourceLineNo">2535</span>     *               &lt;li&gt;0x04: "请输入信息".&lt;/li&gt;<a name="line.2535"></a>
<span class="sourceLineNo">2536</span>     *               &lt;li&gt;0x05: "请重新输入".&lt;/li&gt;<a name="line.2536"></a>
<span class="sourceLineNo">2537</span>     *               &lt;li&gt;0x06: "Beep".&lt;/li&gt;<a name="line.2537"></a>
<span class="sourceLineNo">2538</span>     *               &lt;li&gt;0x07: "Please tap the card".&lt;/li&gt;<a name="line.2538"></a>
<span class="sourceLineNo">2539</span>     *               &lt;li&gt;0x08: "Please re-tap the card".&lt;/li&gt;<a name="line.2539"></a>
<span class="sourceLineNo">2540</span>     *               &lt;li&gt;0x09: "Please enter password".&lt;/li&gt;<a name="line.2540"></a>
<span class="sourceLineNo">2541</span>     *               &lt;li&gt;0x0A: "Please input information".&lt;/li&gt;<a name="line.2541"></a>
<span class="sourceLineNo">2542</span>     *               &lt;li&gt;0x0B: "Please re-input".&lt;/li&gt;<a name="line.2542"></a>
<span class="sourceLineNo">2543</span>     *               &lt;li&gt;0x0C: Sound effect 1.&lt;/li&gt;<a name="line.2543"></a>
<span class="sourceLineNo">2544</span>     *               &lt;li&gt;0x0D: Sound effect 2.&lt;/li&gt;<a name="line.2544"></a>
<span class="sourceLineNo">2545</span>     *               &lt;li&gt;0x0E: Sound effect 3.&lt;/li&gt;<a name="line.2545"></a>
<span class="sourceLineNo">2546</span>     *               &lt;li&gt;0x0F: Sound effect 4.&lt;/li&gt;<a name="line.2546"></a>
<span class="sourceLineNo">2547</span>     *               &lt;li&gt;0x10: Sound effect 5.&lt;/li&gt;<a name="line.2547"></a>
<span class="sourceLineNo">2548</span>     *               &lt;li&gt;0x11: Sound effect 6.&lt;/li&gt;<a name="line.2548"></a>
<span class="sourceLineNo">2549</span>     *               &lt;li&gt;0x12: Sound effect 7.&lt;/li&gt;<a name="line.2549"></a>
<span class="sourceLineNo">2550</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.2550"></a>
<span class="sourceLineNo">2551</span>     * @throws TypeAException TypeAException<a name="line.2551"></a>
<span class="sourceLineNo">2552</span>     */<a name="line.2552"></a>
<span class="sourceLineNo">2553</span>    void playVoice(byte type) throws TypeAException;<a name="line.2553"></a>
<span class="sourceLineNo">2554</span><a name="line.2554"></a>
<span class="sourceLineNo">2555</span>    /**<a name="line.2555"></a>
<span class="sourceLineNo">2556</span>     * &lt;div class="zh"&gt;调节音量等级。必须支持语音芯片&lt;/div&gt; &lt;div class="en"&gt;Adjust the volume level. Must support voice chip&lt;/div&gt;<a name="line.2556"></a>
<span class="sourceLineNo">2557</span>     *<a name="line.2557"></a>
<span class="sourceLineNo">2558</span>     * @param level &lt;div class="zh"&gt;范围为 0 至 7 档。 0 档对应静音。&lt;/div&gt;<a name="line.2558"></a>
<span class="sourceLineNo">2559</span>     *              &lt;div class="en"&gt;The range is from 0 to 7 level。Level 0 corresponds to mute.&lt;/div&gt;<a name="line.2559"></a>
<span class="sourceLineNo">2560</span>     * @throws TypeAException TypeAException<a name="line.2560"></a>
<span class="sourceLineNo">2561</span>     */<a name="line.2561"></a>
<span class="sourceLineNo">2562</span>    void setVolumeLevel(byte level) throws TypeAException;<a name="line.2562"></a>
<span class="sourceLineNo">2563</span><a name="line.2563"></a>
<span class="sourceLineNo">2564</span>    /**<a name="line.2564"></a>
<span class="sourceLineNo">2565</span>     * &lt;div class="zh"&gt;EPS 专用接口。&lt;/div&gt; &lt;div class="en"&gt;EPS dedicated interface.&lt;/div&gt;<a name="line.2565"></a>
<span class="sourceLineNo">2566</span>     *<a name="line.2566"></a>
<span class="sourceLineNo">2567</span>     * @param option &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2567"></a>
<span class="sourceLineNo">2568</span>     *                 &lt;li&gt;0x01: 下载初始 TMK，方式一。由 POS 产生临时 KEY，上传主机，取回密文 TMK1 和临时加密参考值，由临时 KEY 对密文 TMK1 解密，得 TMK，<a name="line.2568"></a>
<span class="sourceLineNo">2569</span>     *                   明文 TMK 应符合奇校验；TMK 对"\x12\x34\x56\x78\x90\x12\x34\x56"加密，加密后的结 果前四字节应与加密参考值相等，之后将明文 TMK<a name="line.2569"></a>
<span class="sourceLineNo">2570</span>     *                   写入 WKeyID1 低 7 位所指定的工作密钥区位置。&lt;/li&gt;<a name="line.2570"></a>
<span class="sourceLineNo">2571</span>     *                 &lt;li&gt;0x02: 更新 TMK 或 下载 TPK。用WKeyID1处的TMK对主机下传的新的密文解密，明文应符合奇校验，之后将明文结果写入WKeyID2 位置。<a name="line.2571"></a>
<span class="sourceLineNo">2572</span>     *                   更新 TMK：主机下传新的密文 TMK2，用明文 TMK1 对 TMK2 解密，明文 TMK2 应符合奇校验， 之后将明文 TMK2 写入 WKeyID2 位置。<a name="line.2572"></a>
<span class="sourceLineNo">2573</span>     *                   当 WKeyID1 与 WKeyID2 相等时，即覆盖明文 TMK1。<a name="line.2573"></a>
<span class="sourceLineNo">2574</span>     *                   下载 TPK：主机下传新的密文 TPK，用 WKeyID1 处的 TMK 对其解密，明文 TPK 应符合奇校验，之后将明文 TPK 写入 WKeyID2 位置。&lt;/li&gt;<a name="line.2574"></a>
<span class="sourceLineNo">2575</span>     *                 &lt;li&gt;0x03: 计算出输出 TAK 的密文。POS 送入 8 字节随机数（输出 TAK 的明文）, 其应符合奇校验，用 MKeyID 处的 TMK 对其加密，返回其结果。&lt;/li&gt;<a name="line.2575"></a>
<span class="sourceLineNo">2576</span>     *                 &lt;li&gt;0x04: 冲正时重算 PIN-BLOCK 和更新 TPK。POS 送入 8 bytes pin_block,新的 ISN,新的 TPK,原 TPK WKeyID2，TMK WKeyID1，<a name="line.2576"></a>
<span class="sourceLineNo">2577</span>     *                   PINPAD 用原 TPK 对 pin_block 按 X3.92 解密得到明文 PIN，再将新 TPK 用 TMK 解密，明文 TPK 应符合奇校验，新 TPK 替 换原 TPK，<a name="line.2577"></a>
<span class="sourceLineNo">2578</span>     *                   之后用明文 TPK，ISN 对 PIN 按 X3.92 加密，返回新的 pin_block.&lt;/li&gt;<a name="line.2578"></a>
<span class="sourceLineNo">2579</span>     *                 &lt;li&gt;0x05: 交换输入 TAK。用 WKeyID1 处的 TMK 对主机下传的新的密文解密得到输入 TAK，明文应符合奇校验，对输入的数据 以输入 TAK 为密钥做 MAC 运算，<a name="line.2579"></a>
<span class="sourceLineNo">2580</span>     *                   其结果与输入的 MAC 运算值（ASCII）相等(前 4 bytes)，之后将明文结果 TAK 写入 WKeyID2 位置。&lt;/li&gt;<a name="line.2580"></a>
<span class="sourceLineNo">2581</span>     *                 &lt;li&gt;0x06: 校验 TMK。用原 TMK 对"\x12\x34\x56\x78\x90\x12\x34\x56"加密，并返回结果。&lt;/li&gt;<a name="line.2581"></a>
<span class="sourceLineNo">2582</span>     *                 &lt;li&gt;0x08: 下载初始 TMK，方式二。 由 POS 产生临时 KEY，上传主机，取回密文 TMK1 和临时加密参考值，由临时 KEY 对密文 TMK1 解密，得 TMK，<a name="line.2582"></a>
<span class="sourceLineNo">2583</span>     *                   明文 TMK 应符合奇校验；TMK 对"\x12\x34\x56\x78\x90\x12\x34\x56"加密，加密后的结果前四字节应与加密参考值相等；之后将明文 TMK 写入<a name="line.2583"></a>
<span class="sourceLineNo">2584</span>     *                   MWKeyID1 低 7 位所指定的主密钥或工作密钥区域。MWKeyID1 最高位为 0 时，表示 TMK 存入主密钥区域，为 1 时表示 TMK 存入工作密钥区域。&lt;/li&gt;<a name="line.2584"></a>
<span class="sourceLineNo">2585</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2585"></a>
<span class="sourceLineNo">2586</span>     *               &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2586"></a>
<span class="sourceLineNo">2587</span>     *                 &lt;li&gt;0x01: Download the initial TMK, method one. The POS generates a temporary KEY, uploads it to the host, retrieves the ciphertext TMK1<a name="line.2587"></a>
<span class="sourceLineNo">2588</span>     *                   and the temporary encryption reference value, and decrypts the ciphertext TMK1 by the temporary KEY to obtain TMK,The plaintext TMK<a name="line.2588"></a>
<span class="sourceLineNo">2589</span>     *                   should meet odd parity; TMK encrypts "\x12\x34\x56\x78\x90\x12\x34\x56", the first four bytes of the encrypted result should be equal<a name="line.2589"></a>
<span class="sourceLineNo">2590</span>     *                   to the encryption reference value, and then write the plaintext TMK Enter the working key area location specified by the lower 7 bits of WKeyID1.&lt;/li&gt;<a name="line.2590"></a>
<span class="sourceLineNo">2591</span>     *                 &lt;li&gt;0x02: Update TMK or download TPK. Use the TMK at WKeyID1 to decrypt the new ciphertext downloaded from the host. The plaintext should<a name="line.2591"></a>
<span class="sourceLineNo">2592</span>     *                   meet odd parity, and then write the plaintext result into the WKeyID2 location.<a name="line.2592"></a>
<span class="sourceLineNo">2593</span>     *                   Update TMK: The host downloads the new ciphertext TMK2, decrypts TMK2 with the plaintext TMK1, the plaintext TMK2 should meet odd parity,<a name="line.2593"></a>
<span class="sourceLineNo">2594</span>     *                   and then writes the plaintext TMK2 into the WKeyID2 location. When WKeyID1 and WKeyID2 are equal, the plaintext TMK1 is overwritten.<a name="line.2594"></a>
<span class="sourceLineNo">2595</span>     *                   Download TPK: The host downloads the new ciphertext TPK, decrypts it with the TMK at WKeyID1, the plaintext TPK should meet odd parity,<a name="line.2595"></a>
<span class="sourceLineNo">2596</span>     *                   and then writes the plaintext TPK into the WKeyID2 location.&lt;/li&gt;<a name="line.2596"></a>
<span class="sourceLineNo">2597</span>     *                 &lt;li&gt;0x03: Calculate the ciphertext of the output TAK. POS sends an 8-byte random number (the plaintext of TAK output), which should meet<a name="line.2597"></a>
<span class="sourceLineNo">2598</span>     *                   odd parity, encrypt it with TMK at MKeyID, and return the result.&lt;/li&gt;<a name="line.2598"></a>
<span class="sourceLineNo">2599</span>     *                 &lt;li&gt;0x04: Recalculate PIN-BLOCK and update TPK during timing. POS sends 8 bytes pin_block, new ISN, new TPK, original TPK WKeyID2, TMK WKeyID1,<a name="line.2599"></a>
<span class="sourceLineNo">2600</span>     *                   PINPAD uses the original TPK to decrypt the pin_block by X3.92 to obtain the plaintext PIN, and then decrypts the new TPK with TMK.<a name="line.2600"></a>
<span class="sourceLineNo">2601</span>     *                   The plaintext TPK should conform to the odd Verify, replace the original TPK with the new TPK, then use the plain text TPK and ISN<a name="line.2601"></a>
<span class="sourceLineNo">2602</span>     *                   to encrypt the PIN by X3.92, and return the new pin_block.&lt;/li&gt;<a name="line.2602"></a>
<span class="sourceLineNo">2603</span>     *                 &lt;li&gt;0x05: Exchange input TAK. Use the TMK at WKeyID1 to decrypt the new ciphertext downloaded from the host to obtain the input TAK.<a name="line.2603"></a>
<span class="sourceLineNo">2604</span>     *                   The plaintext should meet odd parity. The input data is used to perform MAC operations with the input TAK as the key. The result<a name="line.2604"></a>
<span class="sourceLineNo">2605</span>     *                   is the same as the input MAC operation value (ASCII ) Are equal (the first 4 bytes), and then write the plaintext result TAK into<a name="line.2605"></a>
<span class="sourceLineNo">2606</span>     *                   the WKeyID2 position.&lt;/li&gt;<a name="line.2606"></a>
<span class="sourceLineNo">2607</span>     *                 &lt;li&gt;0x06: Verify TMK. Use the original TMK to encrypt "\x12\x34\x56\x78\x90\x12\x34\x56" and return the result.&lt;/li&gt;<a name="line.2607"></a>
<span class="sourceLineNo">2608</span>     *                 &lt;li&gt;0x08: Download the initial TMK, method two. The POS generates a temporary KEY, uploads it to the host, retrieves the ciphertext TMK1<a name="line.2608"></a>
<span class="sourceLineNo">2609</span>     *                   and the temporary encryption reference value, and decrypts the ciphertext TMK1 by the temporary KEY to obtain TMK. The plaintext TMK<a name="line.2609"></a>
<span class="sourceLineNo">2610</span>     *                   should meet odd parity; TMK pairs "\x12\x34\x56\" x78\x90\x12\x34\x56" encryption, the first four bytes of the encrypted result should<a name="line.2610"></a>
<span class="sourceLineNo">2611</span>     *                   be equal to the encrypted reference value; then the plaintext TMK is written into the master key or work key area specified by the lower<a name="line.2611"></a>
<span class="sourceLineNo">2612</span>     *                   7 bits of MWKeyID1. When the highest bit of MWKeyID1 is 0, it means that TMK is stored in the master key area; when it is 1, it means<a name="line.2612"></a>
<span class="sourceLineNo">2613</span>     *                   that TMK is stored in the working key area.&lt;/li&gt;<a name="line.2613"></a>
<span class="sourceLineNo">2614</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2614"></a>
<span class="sourceLineNo">2615</span>     * @param dataIn &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2615"></a>
<span class="sourceLineNo">2616</span>     *                 &lt;li&gt;当option = 0x01时，dataIn = WKeyID1(1byte) + 临时 KEY(8bytes)+密文 TMK1(8bytes)+加密参考值(8bytes)。&lt;/li&gt;<a name="line.2616"></a>
<span class="sourceLineNo">2617</span>     *                 &lt;li&gt;当option = 0x02时, dataIn = WKeyID1(1byte) + WKeyID2(1byte)+密文 TMK2(8bytes)。&lt;/li&gt;<a name="line.2617"></a>
<span class="sourceLineNo">2618</span>     *                 &lt;li&gt;当option = 0x03时, dataIn = MKeyID(1byte) + 明文 Random(8bytes)。&lt;/li&gt;<a name="line.2618"></a>
<span class="sourceLineNo">2619</span>     *                 &lt;li&gt;当option = 0x04时, dataIn = WKeyID1 + WKeyID2 + pin_block(8byte) + ISN(6byte) + new_TPK(8bytes)。&lt;/li&gt;<a name="line.2619"></a>
<span class="sourceLineNo">2620</span>     *                 &lt;li&gt;当option = 0x05时, dataIn = WKeyID1(1byte) + WKeyID2(1byte) + rsp_len(1byte) + TAK 密文 (8bytes) +<a name="line.2620"></a>
<span class="sourceLineNo">2621</span>     *                   rsp_data(rsp_len) + rsp_MAC(8byte, 将 MAC 码的前 4 字节进行值串转换后传入，如 0x123456AB 转换为“123456AB”)。&lt;/li&gt;<a name="line.2621"></a>
<span class="sourceLineNo">2622</span>     *                 &lt;li&gt;当option = 0x06时, dataIn = WKeyID1(1byte)。&lt;/li&gt;<a name="line.2622"></a>
<span class="sourceLineNo">2623</span>     *                 &lt;li&gt;当option = 0x08时, dataIn = MWKeyID1(1byte) + 临时 KEY(8bytes) + 密文 TMK1(8bytes) + 加密参考值(8bytes)。&lt;/li&gt;<a name="line.2623"></a>
<span class="sourceLineNo">2624</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2624"></a>
<span class="sourceLineNo">2625</span>     *               &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2625"></a>
<span class="sourceLineNo">2626</span>     *                 &lt;li&gt;When option = 0x01, dataIn = WKeyID1(1byte) + temporary KEY(8bytes) + ciphertext TMK1(8bytes) + encrypted reference value (8bytes).&lt;/li&gt;<a name="line.2626"></a>
<span class="sourceLineNo">2627</span>     *                 &lt;li&gt;When option = 0x02, dataIn = WKeyID1(1byte) + WKeyID2(1byte) + cipher text TMK2(8bytes).&lt;/li&gt;<a name="line.2627"></a>
<span class="sourceLineNo">2628</span>     *                 &lt;li&gt;When option = 0x03, dataIn = MKeyID(1byte) + plaintext Random(8bytes).&lt;/li&gt;<a name="line.2628"></a>
<span class="sourceLineNo">2629</span>     *                 &lt;li&gt;When option = 0x04, dataIn = WKeyID1 + WKeyID2 + pin_block(8byte) + ISN(6byte) + new_TPK(8bytes).&lt;/li&gt;<a name="line.2629"></a>
<span class="sourceLineNo">2630</span>     *                 &lt;li&gt;When option = 0x05, dataIn = WKeyID1(1byte) + WKeyID2(1byte) + rsp_len(1byte) + TAK ciphertext (8bytes) + rsp_data(rsp_len) +<a name="line.2630"></a>
<span class="sourceLineNo">2631</span>     *                   rsp_MAC(8byte, convert the first 4 bytes of the MAC code to the value string and then pass in, such as 0x123456AB converted to "123456AB").&lt;/li&gt;<a name="line.2631"></a>
<span class="sourceLineNo">2632</span>     *                 &lt;li&gt;When option = 0x06, dataIn = WKeyID1(1byte).&lt;/li&gt;<a name="line.2632"></a>
<span class="sourceLineNo">2633</span>     *                 &lt;li&gt;When option = 0x08, dataIn = MWKeyID1(1byte) + temporary KEY(8bytes) + ciphertext TMK1(8bytes) + encrypted reference value (8bytes).&lt;/li&gt;<a name="line.2633"></a>
<span class="sourceLineNo">2634</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2634"></a>
<span class="sourceLineNo">2635</span>     * @return &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2635"></a>
<span class="sourceLineNo">2636</span>     *           &lt;li&gt;当option = 0x01时，无返回结果。&lt;/li&gt;<a name="line.2636"></a>
<span class="sourceLineNo">2637</span>     *           &lt;li&gt;当option = 0x02时, 无返回结果。&lt;/li&gt;<a name="line.2637"></a>
<span class="sourceLineNo">2638</span>     *           &lt;li&gt;当option = 0x03时, 随机数密文(8bytes)。&lt;/li&gt;<a name="line.2638"></a>
<span class="sourceLineNo">2639</span>     *           &lt;li&gt;当option = 0x04时, 新的 pin_block(8bytes)。&lt;/li&gt;<a name="line.2639"></a>
<span class="sourceLineNo">2640</span>     *           &lt;li&gt;当option = 0x05时, 无返回结果。&lt;/li&gt;<a name="line.2640"></a>
<span class="sourceLineNo">2641</span>     *           &lt;li&gt;当option = 0x06时, 加密结果（8byte）。&lt;/li&gt;<a name="line.2641"></a>
<span class="sourceLineNo">2642</span>     *           &lt;li&gt;当option = 0x08时, 无返回结果。&lt;/li&gt;<a name="line.2642"></a>
<span class="sourceLineNo">2643</span>     *         &lt;/ul&gt;&lt;/div&gt;<a name="line.2643"></a>
<span class="sourceLineNo">2644</span>     *         &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2644"></a>
<span class="sourceLineNo">2645</span>     *           &lt;li&gt;When option = 0x01, no result is returned.&lt;/li&gt;<a name="line.2645"></a>
<span class="sourceLineNo">2646</span>     *           &lt;li&gt;When option = 0x02, no result is returned.&lt;/li&gt;<a name="line.2646"></a>
<span class="sourceLineNo">2647</span>     *           &lt;li&gt;When option = 0x03, random number ciphertext (8bytes).&lt;/li&gt;<a name="line.2647"></a>
<span class="sourceLineNo">2648</span>     *           &lt;li&gt;When option = 0x04, new pin_block(8bytes).&lt;/li&gt;<a name="line.2648"></a>
<span class="sourceLineNo">2649</span>     *           &lt;li&gt;When option = 0x05, no result is returned.&lt;/li&gt;<a name="line.2649"></a>
<span class="sourceLineNo">2650</span>     *           &lt;li&gt;When option = 0x06, the encryption result (8byte).&lt;/li&gt;<a name="line.2650"></a>
<span class="sourceLineNo">2651</span>     *           &lt;li&gt;When option = 0x08, no result is returned.&lt;/li&gt;<a name="line.2651"></a>
<span class="sourceLineNo">2652</span>     *         &lt;/ul&gt;&lt;/div&gt;<a name="line.2652"></a>
<span class="sourceLineNo">2653</span>     * @throws TypeAException TypeAException<a name="line.2653"></a>
<span class="sourceLineNo">2654</span>     */<a name="line.2654"></a>
<span class="sourceLineNo">2655</span>    byte[] EPS(byte option, byte[] dataIn) throws TypeAException;<a name="line.2655"></a>
<span class="sourceLineNo">2656</span><a name="line.2656"></a>
<span class="sourceLineNo">2657</span>    /**<a name="line.2657"></a>
<span class="sourceLineNo">2658</span>     * &lt;div class="zh"&gt;扩展的 EPS 专用接口。&lt;/div&gt; &lt;div class="en"&gt;Extended EPS dedicated interface.&lt;/div&gt;<a name="line.2658"></a>
<span class="sourceLineNo">2659</span>     *<a name="line.2659"></a>
<span class="sourceLineNo">2660</span>     * @param option &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2660"></a>
<span class="sourceLineNo">2661</span>     *                 &lt;li&gt;0x01: 下载初始 TMK，方式一。由 POS 产生临时 KEY，上传主机，取回密文 TMK1 和临时加密参考值，由临时 KEY 对密文 TMK1 解密，得 TMK，<a name="line.2661"></a>
<span class="sourceLineNo">2662</span>     *                   明文 TMK 应符合奇校验；TMK 对"\x12\x34\x56\x78\x90\x12\x34\x56"加密，加密后的结 果前四字节应与加密参考值相等，之后将明文 TMK<a name="line.2662"></a>
<span class="sourceLineNo">2663</span>     *                   写入 WKeyID1 低 7 位所指定的工作密钥区位置。&lt;/li&gt;<a name="line.2663"></a>
<span class="sourceLineNo">2664</span>     *                 &lt;li&gt;0x02: 更新 TMK 或 下载 TPK。用WKeyID1处的TMK对主机下传的新的密文解密，明文应符合奇校验，之后将明文结果写入WKeyID2 位置。<a name="line.2664"></a>
<span class="sourceLineNo">2665</span>     *                   更新 TMK：主机下传新的密文 TMK2，用明文 TMK1 对 TMK2 解密，明文 TMK2 应符合奇校验， 之后将明文 TMK2 写入 WKeyID2 位置。<a name="line.2665"></a>
<span class="sourceLineNo">2666</span>     *                   当 WKeyID1 与 WKeyID2 相等时，即覆盖明文 TMK1。<a name="line.2666"></a>
<span class="sourceLineNo">2667</span>     *                   下载 TPK：主机下传新的密文 TPK，用 WKeyID1 处的 TMK 对其解密，明文 TPK 应符合奇校验，之后将明文 TPK 写入 WKeyID2 位置。&lt;/li&gt;<a name="line.2667"></a>
<span class="sourceLineNo">2668</span>     *                 &lt;li&gt;0x03: 计算出输出 TAK 的密文。POS 送入 8 或者 16 或者 24 字节随机数（输出 TAK 的明文）, 其应符合奇校验，用 MKeyID 处的 TMK 对其加密，返回其结果。&lt;/li&gt;<a name="line.2668"></a>
<span class="sourceLineNo">2669</span>     *                 &lt;li&gt;0x04: 冲正时重算 PIN-BLOCK 和更新 TPK。POS 送入 8 bytes pin_block,新的 ISN,新的 TPK,原 TPK WKeyID2，TMK WKeyID1<a name="line.2669"></a>
<span class="sourceLineNo">2670</span>     *                   PINPAD 用原 TPK 对 pin_block 按 X3.92 解密得到明文 PIN，再将新 TPK 用 TMK 解密，明文 TPK 应符合奇校验，新 TPK 替 换原 TPK，<a name="line.2670"></a>
<span class="sourceLineNo">2671</span>     *                   之后用明文 TPK，ISN 对 PIN 按 X3.92 加密，返回新的 pin_block.&lt;/li&gt;<a name="line.2671"></a>
<span class="sourceLineNo">2672</span>     *                 &lt;li&gt;0x05: 交换输入 TAK。用 WKeyID1 处的 TMK 对主机下传的新的密文解密得到输入 TAK，明文应符合奇校验，对输入的数据 以输入 TAK 为密钥做 MAC 运算，<a name="line.2672"></a>
<span class="sourceLineNo">2673</span>     *                   其结果与输入的 MAC 运算值（ASCII）相等(前 4 bytes)，之后将明文结果 TAK 写入 WKeyID2 位置。进行的 MAC 运算共有算法 1 和算法 2 两种，由 Mode 来指定。<a name="line.2673"></a>
<span class="sourceLineNo">2674</span>     *                   MAC 算法 1: 若密钥为 8 字节，则依次连续进行 DES/异或/DES/异或/…/DES；若密钥为 16 字节或 24 字节，则依次连续进行 3DES/异或/3DES/异或/…/3DES 的运算。<a name="line.2674"></a>
<span class="sourceLineNo">2675</span>     *                   MAC 算法 2：若密钥为 8 字节，则依次连续进行 DES/异或/DES/异或/…/DES 的运算；若密钥为 16 字节或 24 字节，则依次连续进行 DES/异或/DES/异或/…/3DES 的运算，注意最后一次为 3DES 运算。<a name="line.2675"></a>
<span class="sourceLineNo">2676</span>     *                   如果密钥为 8 字节，则算法 1 和算法 2 是相同的。&lt;/li&gt;<a name="line.2676"></a>
<span class="sourceLineNo">2677</span>     *                 &lt;li&gt;0x06: 校验 TMK。用原 TMK 对"\x12\x34\x56\x78\x90\x12\x34\x56"加密，并返回结果。&lt;/li&gt;<a name="line.2677"></a>
<span class="sourceLineNo">2678</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2678"></a>
<span class="sourceLineNo">2679</span>     *               &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2679"></a>
<span class="sourceLineNo">2680</span>     *               &lt;li&gt;0x01: Download the initial TMK, method one. The POS generates a temporary KEY, uploads it to the host, retrieves the ciphertext TMK1<a name="line.2680"></a>
<span class="sourceLineNo">2681</span>     *                  and the temporary encryption reference value, and decrypts the ciphertext TMK1 by the temporary KEY to obtain TMK,The plaintext TMK<a name="line.2681"></a>
<span class="sourceLineNo">2682</span>     *                  should meet odd parity; TMK encrypts "\x12\x34\x56\x78\x90\x12\x34\x56", the first four bytes of the encrypted result should be equal<a name="line.2682"></a>
<span class="sourceLineNo">2683</span>     *                  to the encryption reference value, and then write the plaintext TMK Enter the working key area location specified by the lower 7 bits of WkeyID<a name="line.2683"></a>
<span class="sourceLineNo">2684</span>     *                &lt;li&gt;0x02: Update TMK or download TPK. Use the TMK at WKeyID1 to decrypt the new ciphertext downloaded from the host. The plaintext should<a name="line.2684"></a>
<span class="sourceLineNo">2685</span>     *                  meet odd parity, and then write the plaintext result into the WKeyID2 location.<a name="line.2685"></a>
<span class="sourceLineNo">2686</span>     *                  Update TMK: The host downloads the new ciphertext TMK2, decrypts TMK2 with the plaintext TMK1, the plaintext TMK2 should meet odd parity,<a name="line.2686"></a>
<span class="sourceLineNo">2687</span>     *                  and then writes the plaintext TMK2 into the WKeyID2 location. When WKeyID1 and WKeyID2 are equal, the plaintext TMK1 is overwritten.<a name="line.2687"></a>
<span class="sourceLineNo">2688</span>     *                  Download TPK: The host downloads the new ciphertext TPK, decrypts it with the TMK at WKeyID1, the plaintext TPK should meet odd parity,<a name="line.2688"></a>
<span class="sourceLineNo">2689</span>     *                  and then writes the plaintext TPK into the WKeyID2 location.&lt;/li&gt;<a name="line.2689"></a>
<span class="sourceLineNo">2690</span>     *                &lt;li&gt;0x03: Calculate the ciphertext of the output TAK. POS sends an 8 or 16 or 24-byte random number (the plaintext of TAK output),<a name="line.2690"></a>
<span class="sourceLineNo">2691</span>     *                  which should meet odd parity, encrypt it with TMK at MKeyID, and return the result.&lt;/li&gt;<a name="line.2691"></a>
<span class="sourceLineNo">2692</span>     *                &lt;li&gt;0x04: Recalculate PIN-BLOCK and update TPK during timing. POS sends 8 bytes pin_block, new ISN, new TPK, original TPK WKeyID2, TMK WKeyID1,<a name="line.2692"></a>
<span class="sourceLineNo">2693</span>     *                  PINPAD uses the original TPK to decrypt the pin_block by X3.92 to obtain the plaintext PIN, and then decrypts the new TPK with TMK.<a name="line.2693"></a>
<span class="sourceLineNo">2694</span>     *                  The plaintext TPK should conform to the odd Verify, replace the original TPK with the new TPK, then use the plain text TPK and ISN<a name="line.2694"></a>
<span class="sourceLineNo">2695</span>     *                  to encrypt the PIN by X3.92, and return the new pin_block.There are two types of MAC operations: Algorithm 1 and Algorithm 2, which are specified by Mode. <a name="line.2695"></a>
<span class="sourceLineNo">2696</span>     *                  MAC algorithm 1: If the key is 8 bytes, DES/XOR/DES/XOR/.../DES will be performed successively; if the key is 16 bytes or 24 bytes, <a name="line.2696"></a>
<span class="sourceLineNo">2697</span>     *                  then 3DES/XOR will be successively performed /3DES/XOR/.../3DES operation. <a name="line.2697"></a>
<span class="sourceLineNo">2698</span>     *                  MAC algorithm 2: If the key is 8 bytes, the DES/XOR/DES/XOR/.../DES operations will be performed successively; if the key is 16 bytes or 24 bytes, <a name="line.2698"></a>
<span class="sourceLineNo">2699</span>     *                  the DES/ will be successively performed successively. XOR/DES/XOR/.../3DES operation, note that the last operation is 3DES operation. <a name="line.2699"></a>
<span class="sourceLineNo">2700</span>     *                  If the key is 8 bytes, then Algorithm 1 and Algorithm 2 are the same.&lt;/li&gt;<a name="line.2700"></a>
<span class="sourceLineNo">2701</span>     *                &lt;li&gt;0x05: Exchange input TAK. Use the TMK at WKeyID1 to decrypt the new ciphertext downloaded from the host to obtain the input TAK.<a name="line.2701"></a>
<span class="sourceLineNo">2702</span>     *                  The plaintext should meet odd parity. The input data is used to perform MAC operations with the input TAK as the key. The result<a name="line.2702"></a>
<span class="sourceLineNo">2703</span>     *                  is the same as the input MAC operation value (ASCII ) Are equal (the first 4 bytes), and then write the plaintext result TAK into<a name="line.2703"></a>
<span class="sourceLineNo">2704</span>     *                  the WKeyID2 position.&lt;/li&gt;<a name="line.2704"></a>
<span class="sourceLineNo">2705</span>     *                &lt;li&gt;0x06: Verify TMK. Use the original TMK to encrypt "\x12\x34\x56\x78\x90\x12\x34\x56" and return the result.&lt;/li&gt;<a name="line.2705"></a>
<span class="sourceLineNo">2706</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2706"></a>
<span class="sourceLineNo">2707</span>     * @param mode &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2707"></a>
<span class="sourceLineNo">2708</span>     *                 &lt;li&gt;0x01: DES 加密方式。&lt;/li&gt;<a name="line.2708"></a>
<span class="sourceLineNo">2709</span>     *                 &lt;li&gt;0x03: 3DES 加密方式。&lt;/li&gt;<a name="line.2709"></a>
<span class="sourceLineNo">2710</span>     *                 &lt;li&gt;0x07: 3DES 加密方式。&lt;/li&gt;<a name="line.2710"></a>
<span class="sourceLineNo">2711</span>     *                 &lt;li&gt;0x31: 3DES 加密方式。&lt;/li&gt;<a name="line.2711"></a>
<span class="sourceLineNo">2712</span>     *                 &lt;li&gt;0x33: 3DES 加密方式。&lt;/li&gt;<a name="line.2712"></a>
<span class="sourceLineNo">2713</span>     *                 &lt;li&gt;0x71: 3DES 加密方式。&lt;/li&gt;<a name="line.2713"></a>
<span class="sourceLineNo">2714</span>     *                 &lt;li&gt;0x73: 3DES 加密方式。&lt;/li&gt;<a name="line.2714"></a>
<span class="sourceLineNo">2715</span>     *                 &lt;li&gt;0x77: 3DES 加密方式。&lt;/li&gt;<a name="line.2715"></a>
<span class="sourceLineNo">2716</span>     *                 &lt;li&gt;0x81: 8 字节 DES 密钥方式; DES 解密方式; &lt;/li&gt;<a name="line.2716"></a>
<span class="sourceLineNo">2717</span>     *                 &lt;li&gt;0x83: 3DES 解密方式。&lt;/li&gt;<a name="line.2717"></a>
<span class="sourceLineNo">2718</span>     *                 &lt;li&gt;0x87: 3DES 解密方式。&lt;/li&gt;<a name="line.2718"></a>
<span class="sourceLineNo">2719</span>     *                 &lt;li&gt;0x89: DES 解密方式。&lt;/li&gt;<a name="line.2719"></a>
<span class="sourceLineNo">2720</span>     *                 &lt;li&gt;0x8B: 3DES 解密方式。&lt;/li&gt;<a name="line.2720"></a>
<span class="sourceLineNo">2721</span>     *                 &lt;li&gt;0x8F: 3DES 解密方式。&lt;/li&gt;<a name="line.2721"></a>
<span class="sourceLineNo">2722</span>     *                 &lt;li&gt;0xB1: 3DES 解密方式。&lt;/li&gt;<a name="line.2722"></a>
<span class="sourceLineNo">2723</span>     *                 &lt;li&gt;0xB3: 16 字节 3DES 密钥方式; 3DES 解密方式;&lt;/li&gt;<a name="line.2723"></a>
<span class="sourceLineNo">2724</span>     *                 &lt;li&gt;0xB9: 3DES 解密方式。&lt;/li&gt;<a name="line.2724"></a>
<span class="sourceLineNo">2725</span>     *                 &lt;li&gt;0xBB: 3DES 解密方式。&lt;/li&gt;<a name="line.2725"></a>
<span class="sourceLineNo">2726</span>     *                 &lt;li&gt;0xF1: 3DES 解密方式。&lt;/li&gt;<a name="line.2726"></a>
<span class="sourceLineNo">2727</span>     *                 &lt;li&gt;0xF3: 3DES 解密方式。&lt;/li&gt;<a name="line.2727"></a>
<span class="sourceLineNo">2728</span>     *                 &lt;li&gt;0xF7: 24 字节 3DES 密钥方式; 3DES 解密方式;&lt;/li&gt;<a name="line.2728"></a>
<span class="sourceLineNo">2729</span>     *                 &lt;li&gt;0xF9: 3DES 解密方式。&lt;/li&gt;<a name="line.2729"></a>
<span class="sourceLineNo">2730</span>     *                 &lt;li&gt;0xFB: 3DES 解密方式。&lt;/li&gt;<a name="line.2730"></a>
<span class="sourceLineNo">2731</span>     *                 &lt;li&gt;0xFF: 3DES 解密方式。&lt;/li&gt;<a name="line.2731"></a>
<span class="sourceLineNo">2732</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2732"></a>
<span class="sourceLineNo">2733</span>     *               &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2733"></a>
<span class="sourceLineNo">2734</span>     *                 &lt;li&gt;0x01: DES encryption method.&lt;/li&gt;<a name="line.2734"></a>
<span class="sourceLineNo">2735</span>     *                 &lt;li&gt;0x03: 3DES encryption method.&lt;/li&gt;<a name="line.2735"></a>
<span class="sourceLineNo">2736</span>     *                 &lt;li&gt;0x07: 3DES encryption method.&lt;/li&gt;<a name="line.2736"></a>
<span class="sourceLineNo">2737</span>     *                 &lt;li&gt;0x31: 3DES encryption method.&lt;/li&gt;<a name="line.2737"></a>
<span class="sourceLineNo">2738</span>     *                 &lt;li&gt;0x33: 3DES encryption method.&lt;/li&gt;<a name="line.2738"></a>
<span class="sourceLineNo">2739</span>     *                 &lt;li&gt;0x71: 3DES encryption method.&lt;/li&gt;<a name="line.2739"></a>
<span class="sourceLineNo">2740</span>     *                 &lt;li&gt;0x73: 3DES encryption method.&lt;/li&gt;<a name="line.2740"></a>
<span class="sourceLineNo">2741</span>     *                 &lt;li&gt;0x77: 3DES encryption method.&lt;/li&gt;<a name="line.2741"></a>
<span class="sourceLineNo">2742</span>     *                 &lt;li&gt;0x81: 8-byte DES key mode; DES encryption method; &lt;/li&gt;<a name="line.2742"></a>
<span class="sourceLineNo">2743</span>     *                 &lt;li&gt;0x83: 3DES decryption method.&lt;/li&gt;<a name="line.2743"></a>
<span class="sourceLineNo">2744</span>     *                 &lt;li&gt;0x87: 3DES decryption method.&lt;/li&gt;<a name="line.2744"></a>
<span class="sourceLineNo">2745</span>     *                 &lt;li&gt;0x89: DES decryption method.&lt;/li&gt;<a name="line.2745"></a>
<span class="sourceLineNo">2746</span>     *                 &lt;li&gt;0x8B: 3DES decryption method.&lt;/li&gt;<a name="line.2746"></a>
<span class="sourceLineNo">2747</span>     *                 &lt;li&gt;0x8F: 3DES decryption method.&lt;/li&gt;<a name="line.2747"></a>
<span class="sourceLineNo">2748</span>     *                 &lt;li&gt;0xB1: 3DES decryption method.&lt;/li&gt;<a name="line.2748"></a>
<span class="sourceLineNo">2749</span>     *                 &lt;li&gt;0xB3: 16-byte DES key mode; 3DES decryption method;&lt;/li&gt;<a name="line.2749"></a>
<span class="sourceLineNo">2750</span>     *                 &lt;li&gt;0xB9: 3DES decryption method.&lt;/li&gt;<a name="line.2750"></a>
<span class="sourceLineNo">2751</span>     *                 &lt;li&gt;0xBB: 3DES decryption method.&lt;/li&gt;<a name="line.2751"></a>
<span class="sourceLineNo">2752</span>     *                 &lt;li&gt;0xF1: 3DES decryption method.&lt;/li&gt;<a name="line.2752"></a>
<span class="sourceLineNo">2753</span>     *                 &lt;li&gt;0xF3: 3DES decryption method.&lt;/li&gt;<a name="line.2753"></a>
<span class="sourceLineNo">2754</span>     *                 &lt;li&gt;0xF7: 24-byte DES key mode; 3DES decryption method;&lt;/li&gt;<a name="line.2754"></a>
<span class="sourceLineNo">2755</span>     *                 &lt;li&gt;0xF9: 3DES decryption method.&lt;/li&gt;<a name="line.2755"></a>
<span class="sourceLineNo">2756</span>     *                 &lt;li&gt;0xFB: 3DES decryption method.&lt;/li&gt;<a name="line.2756"></a>
<span class="sourceLineNo">2757</span>     *                 &lt;li&gt;0xFF: 3DES decryption method.&lt;/li&gt;<a name="line.2757"></a>
<span class="sourceLineNo">2758</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2758"></a>
<span class="sourceLineNo">2759</span>     * @param dataIn &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2759"></a>
<span class="sourceLineNo">2760</span>     *                 &lt;li&gt;当 option = 0x01 时，dataIn = WKeyID1(1byte) + 临时 KEY + 密文 TMK1 + 加密参考值(8bytes)。<a name="line.2760"></a>
<span class="sourceLineNo">2761</span>     *                   &lt;ul&gt;<a name="line.2761"></a>
<span class="sourceLineNo">2762</span>     *                     &lt;li&gt;当mode = 0x81 时，临时 KEY 与 密文 TMK1 均为 8 字节 DES 密钥。&lt;/li&gt;<a name="line.2762"></a>
<span class="sourceLineNo">2763</span>     *                     &lt;li&gt;当mode = 0xB3 时，临时 KEY 与 密文 TMK1 均为 16 字节 3DES 密钥。&lt;/li&gt;<a name="line.2763"></a>
<span class="sourceLineNo">2764</span>     *                     &lt;li&gt;当mode = 0xF7 时，临时 KEY 与 密文 TMK1 均为 24 字节 3DES 密钥。&lt;/li&gt;<a name="line.2764"></a>
<span class="sourceLineNo">2765</span>     *                   &lt;/ul&gt;<a name="line.2765"></a>
<span class="sourceLineNo">2766</span>     *                 &lt;/li&gt;<a name="line.2766"></a>
<span class="sourceLineNo">2767</span>     *                 &lt;li&gt;当 option = 0x02 时，dataIn = WKeyID1(1byte) + WKeyID2(1byte) + 密文 TMK2。<a name="line.2767"></a>
<span class="sourceLineNo">2768</span>     *                   &lt;ul&gt;<a name="line.2768"></a>
<span class="sourceLineNo">2769</span>     *                     &lt;li&gt;当 mode = 0x81 时，DES 解密方式，WKeyID1 密钥 8 字节，WKeyID2 密钥 8 字节 ，密文 TMK2 为 8 字节。&lt;/li&gt;<a name="line.2769"></a>
<span class="sourceLineNo">2770</span>     *                     &lt;li&gt;当 mode = 0x83 时，3DES 解密方式，WKeyID1 密钥 16 字节，WKeyID2 密钥 8 字节，密文 TMK2 为 8 字节。&lt;/li&gt;<a name="line.2770"></a>
<span class="sourceLineNo">2771</span>     *                     &lt;li&gt;当 mode = 0x87 时，3DES 解密方式，WKeyID1 密钥 24 字节, WKeyID2 密钥 8 字节，密文 TMK2 为 8 字节。&lt;/li&gt;<a name="line.2771"></a>
<span class="sourceLineNo">2772</span>     *                     &lt;li&gt;当 mode = 0xB1 时，3DES 解密方式，WKeyID1 密钥 16 字节，WKeyID2 密钥 8 字节，密文 TMK2 为 8 字节。&lt;/li&gt;<a name="line.2772"></a>
<span class="sourceLineNo">2773</span>     *                     &lt;li&gt;当 mode = 0xB3 时，3DES 解密方式，WKeyID1 密钥 16 字节，WKeyID2 密钥 16 字节，密文 TMK2 为 16 字节。&lt;/li&gt;<a name="line.2773"></a>
<span class="sourceLineNo">2774</span>     *                     &lt;li&gt;当 mode = 0xF1 时，3DES 解密方式，WKeyID1 密钥 24 字节，WKeyID2 密钥 8 字节，密文 TMK2 为 8 字节。&lt;/li&gt;<a name="line.2774"></a>
<span class="sourceLineNo">2775</span>     *                     &lt;li&gt;当 mode = 0xF3 时，3DES 解密方式，WKeyID1 密钥 24 字节，WKeyID2 密钥 16 字节，密文 TMK2 为 16 字节。&lt;/li&gt;<a name="line.2775"></a>
<span class="sourceLineNo">2776</span>     *                     &lt;li&gt;当 mode = 0xF7 时，3DES 解密方式，WKeyID1 密钥 24 字节，WKeyID2 密钥 24 字节，密文 TMK2 为 24 字节。&lt;/li&gt;<a name="line.2776"></a>
<span class="sourceLineNo">2777</span>     *                   &lt;/ul&gt;<a name="line.2777"></a>
<span class="sourceLineNo">2778</span>     *                 &lt;/li&gt;<a name="line.2778"></a>
<span class="sourceLineNo">2779</span>     *                 &lt;li&gt;当 option = 0x03 时，dataIn = MKeyID(1byte) + 明文 Random。<a name="line.2779"></a>
<span class="sourceLineNo">2780</span>     *                   &lt;ul&gt;<a name="line.2780"></a>
<span class="sourceLineNo">2781</span>     *                     &lt;li&gt;当 mode = 0x01 时，DES 加密方式，MKeyID 密钥 8 字节，Random 8 字节。&lt;/li&gt;<a name="line.2781"></a>
<span class="sourceLineNo">2782</span>     *                     &lt;li&gt;当 mode = 0x03 时，3DES 加密方式，MKeyID 密钥 16 字节，Random 8 字节。&lt;/li&gt;<a name="line.2782"></a>
<span class="sourceLineNo">2783</span>     *                     &lt;li&gt;当 mode = 0x31 时，3DES 加密方式，MKeyID 密钥 16 字节，Random 8 字节。&lt;/li&gt;<a name="line.2783"></a>
<span class="sourceLineNo">2784</span>     *                     &lt;li&gt;当 mode = 0x07 时，3DES 加密方式，MKeyID 密钥 24 字节，Random 8 字节。&lt;/li&gt;<a name="line.2784"></a>
<span class="sourceLineNo">2785</span>     *                     &lt;li&gt;当 mode = 0x71 时，3DES 加密方式，MKeyID 密钥 24 字节，Random 8 字节。&lt;/li&gt;<a name="line.2785"></a>
<span class="sourceLineNo">2786</span>     *                     &lt;li&gt;当 mode = 0x33 时，3DES 加密方式，MKeyID 密钥 16 字节，Random 16 字节。&lt;/li&gt;<a name="line.2786"></a>
<span class="sourceLineNo">2787</span>     *                     &lt;li&gt;当 mode = 0x73 时，3DES 加密方式，MKeyID 密钥 16 字节，Random 16 字节。&lt;/li&gt;<a name="line.2787"></a>
<span class="sourceLineNo">2788</span>     *                     &lt;li&gt;当 mode = 0x77 时，3DES 加密方式，MKeyID 密钥 24 字节，Random 24 字节。&lt;/li&gt;<a name="line.2788"></a>
<span class="sourceLineNo">2789</span>     *                   &lt;/ul&gt;<a name="line.2789"></a>
<span class="sourceLineNo">2790</span>     *                 &lt;/li&gt;<a name="line.2790"></a>
<span class="sourceLineNo">2791</span>     *                 &lt;li&gt;当 option = 0x04 时，dataIn = WKeyID1 + WKeyID2 + pin_block(8byte) + ISN(6byte) + new_TPK(8bytes)。<a name="line.2791"></a>
<span class="sourceLineNo">2792</span>     *                   &lt;ul&gt;<a name="line.2792"></a>
<span class="sourceLineNo">2793</span>     *                     &lt;li&gt;当 mode = 0x81 时，DES 解密方式，WKeyID1 密钥 8 字节，WKeyID2 密钥 8 字节。&lt;/li&gt;<a name="line.2793"></a>
<span class="sourceLineNo">2794</span>     *                     &lt;li&gt;当 mode = 0x83 时，3DES 解密方式，WKeyID1 密钥 16 字节，WKeyID2 密钥 8 字节。&lt;/li&gt;<a name="line.2794"></a>
<span class="sourceLineNo">2795</span>     *                     &lt;li&gt;当 mode = 0x87 时，3DES 解密方式，WKeyID1 密钥 24 字节，WKeyID2 密钥 8 字节。&lt;/li&gt;<a name="line.2795"></a>
<span class="sourceLineNo">2796</span>     *                     &lt;li&gt;当 mode = 0xB1 时，3DES 解密方式，WKeyID1 密钥 16 字节，WKeyID2 密钥 8 字节。&lt;/li&gt;<a name="line.2796"></a>
<span class="sourceLineNo">2797</span>     *                     &lt;li&gt;当 mode = 0xF1 时，3DES 解密方式，WKeyID1 密钥 24 字节，WKeyID2 密钥 8 字节。&lt;/li&gt;<a name="line.2797"></a>
<span class="sourceLineNo">2798</span>     *                     &lt;li&gt;当 mode = 0xB3 时，3DES 解密方式，WKeyID1 密钥 16 字节，WKeyID2 密钥 16 字节。&lt;/li&gt;<a name="line.2798"></a>
<span class="sourceLineNo">2799</span>     *                     &lt;li&gt;当 mode = 0xF3 时，3DES 解密方式，WKeyID1 密钥 24 字节，WKeyID2 密钥 16 字节。&lt;/li&gt;<a name="line.2799"></a>
<span class="sourceLineNo">2800</span>     *                     &lt;li&gt;当 mode = 0xF7 时，3DES 解密方式，WKeyID1 密钥 24 字节，WKeyID2 密钥 24 字节。&lt;/li&gt;<a name="line.2800"></a>
<span class="sourceLineNo">2801</span>     *                   &lt;/ul&gt;<a name="line.2801"></a>
<span class="sourceLineNo">2802</span>     *                 &lt;/li&gt;<a name="line.2802"></a>
<span class="sourceLineNo">2803</span>     *                 &lt;li&gt;当 option = 0x05 时，dataIn = WKeyID1(1byte) + WKeyID2(1byte) + rsp_len(1byte) + TAK 密文 +<a name="line.2803"></a>
<span class="sourceLineNo">2804</span>     *                   rsp_data(rsp_len) + rsp_MAC(8byte, 将 MAC 码的前 4 字节进行值串转换后传入，如 0x123456AB 转换为“123456AB”)。<a name="line.2804"></a>
<span class="sourceLineNo">2805</span>     *                   &lt;ul&gt;<a name="line.2805"></a>
<span class="sourceLineNo">2806</span>     *                     &lt;p&gt;MAC算法1：&lt;/p&gt;<a name="line.2806"></a>
<span class="sourceLineNo">2807</span>     *                     &lt;li&gt;当 mode = 0x81 时，DES 解密方式，WKeyID1 密钥 8 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2807"></a>
<span class="sourceLineNo">2808</span>     *                     &lt;li&gt;当 mode = 0x83 时，3DES 解密方式，WKeyID1 密钥 16 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2808"></a>
<span class="sourceLineNo">2809</span>     *                     &lt;li&gt;当 mode = 0xB1 时，3DES 解密方式，WKeyID1 密钥 16 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2809"></a>
<span class="sourceLineNo">2810</span>     *                     &lt;li&gt;当 mode = 0x87 时，3DES 解密方式，WKeyID1 密钥 24 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2810"></a>
<span class="sourceLineNo">2811</span>     *                     &lt;li&gt;当 mode = 0xF1 时，3DES 解密方式，WKeyID1 密钥 24 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2811"></a>
<span class="sourceLineNo">2812</span>     *                     &lt;li&gt;当 mode = 0xB3 时，3DES 解密方式，WKeyID1 密钥 16 字节，TAK 与 WKeyID2 密钥均为 16 字节。&lt;/li&gt;<a name="line.2812"></a>
<span class="sourceLineNo">2813</span>     *                     &lt;li&gt;当 mode = 0xF3 时，3DES 解密方式，WKeyID1 密钥 24 字节，TAK 与 WKeyID2 密钥均为 16 字节。&lt;/li&gt;<a name="line.2813"></a>
<span class="sourceLineNo">2814</span>     *                     &lt;li&gt;当 mode = 0xF7 时，3DES 解密方式，WKeyID1 密钥 24 字节，TAK 与 WKeyID2 密钥均为 24 字节。&lt;/li&gt;<a name="line.2814"></a>
<span class="sourceLineNo">2815</span>     *                     &lt;li&gt;当 mode = 0x89 时，DES 解密方式，WKeyID1 密钥 8 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2815"></a>
<span class="sourceLineNo">2816</span>     *                     &lt;li&gt;当 mode = 0x8B 时，3DES 解密方式，WKeyID1 密钥 16 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2816"></a>
<span class="sourceLineNo">2817</span>     *                     &lt;li&gt;当 mode = 0xB9 时，3DES 解密方式，WKeyID1 密钥 16 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2817"></a>
<span class="sourceLineNo">2818</span>     *                     &lt;li&gt;当 mode = 0x8F 时，3DES 解密方式，WKeyID1 密钥 24 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2818"></a>
<span class="sourceLineNo">2819</span>     *                     &lt;li&gt;当 mode = 0xF9 时，3DES 解密方式，WKeyID1 密钥 24 字节，TAK 与 WKeyID2 密钥均为 8 字节。&lt;/li&gt;<a name="line.2819"></a>
<span class="sourceLineNo">2820</span>     *                     &lt;p&gt;MAC算法2：&lt;/p&gt;<a name="line.2820"></a>
<span class="sourceLineNo">2821</span>     *                     &lt;li&gt;当 mode = 0xBB 时，3DES 解密方式，WKeyID1 密钥 16 字节，TAK 与 WKeyID2 密钥均为 16 字节。&lt;/li&gt;<a name="line.2821"></a>
<span class="sourceLineNo">2822</span>     *                     &lt;li&gt;当 mode = 0xFB 时，3DES 解密方式，WKeyID1 密钥 24 字节，TAK 与 WKeyID2 密钥均为 16 字节。&lt;/li&gt;<a name="line.2822"></a>
<span class="sourceLineNo">2823</span>     *                     &lt;li&gt;当 mode = 0xFF 时，3DES 解密方式，WKeyID1 密钥 24 字节，TAK 与 WKeyID2 密钥均为 24 字节。&lt;/li&gt;<a name="line.2823"></a>
<span class="sourceLineNo">2824</span>     *                   &lt;/ul&gt;<a name="line.2824"></a>
<span class="sourceLineNo">2825</span>     *                 &lt;/li&gt;<a name="line.2825"></a>
<span class="sourceLineNo">2826</span>     *                 &lt;li&gt;当 option = 0x06 时，dataIn = WKeyID1(1byte)。<a name="line.2826"></a>
<span class="sourceLineNo">2827</span>     *                   &lt;ul&gt;<a name="line.2827"></a>
<span class="sourceLineNo">2828</span>     *                     &lt;li&gt;当 mode = 0x01 时，DES 加密方式，WKeyID1 密钥 8 字节。&lt;/li&gt;<a name="line.2828"></a>
<span class="sourceLineNo">2829</span>     *                     &lt;li&gt;当 mode = 0x03 时，3DES 加密方式，WKeyID1 密钥 16 字节。&lt;/li&gt;<a name="line.2829"></a>
<span class="sourceLineNo">2830</span>     *                     &lt;li&gt;当 mode = 0x07 时，3DES 加密方式，WKeyID1 密钥 24 字节。&lt;/li&gt;<a name="line.2830"></a>
<span class="sourceLineNo">2831</span>     *                   &lt;/ul&gt;<a name="line.2831"></a>
<span class="sourceLineNo">2832</span>     *                 &lt;/li&gt;<a name="line.2832"></a>
<span class="sourceLineNo">2833</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2833"></a>
<span class="sourceLineNo">2834</span>     *               &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2834"></a>
<span class="sourceLineNo">2835</span>     *                 &lt;li&gt;When option = 0x01, dataIn = WKeyID1(1byte) + temporary KEY(8bytes) + ciphertext TMK1 + encrypted reference value (8bytes).<a name="line.2835"></a>
<span class="sourceLineNo">2836</span>     *                   &lt;ul&gt;<a name="line.2836"></a>
<span class="sourceLineNo">2837</span>     *                     &lt;li&gt;When mode = 0x81, both temporary KEY and ciphertext TMK1 are 8-byte DES keys.&lt;/li&gt;<a name="line.2837"></a>
<span class="sourceLineNo">2838</span>     *                     &lt;li&gt;When mode = 0xB3, both temporary KEY and ciphertext TMK1 are 16-byte 3DES keys.&lt;/li&gt;<a name="line.2838"></a>
<span class="sourceLineNo">2839</span>     *                     &lt;li&gt;When mode = 0xF7, both temporary KEY and ciphertext TMK1 are 24byte 3DES keys.&lt;/li&gt;<a name="line.2839"></a>
<span class="sourceLineNo">2840</span>     *                   &lt;/ul&gt;<a name="line.2840"></a>
<span class="sourceLineNo">2841</span>     *                 &lt;/li&gt;<a name="line.2841"></a>
<span class="sourceLineNo">2842</span>     *                 &lt;li&gt;When option = 0x02, dataIn = WKeyID1(1byte) + WKeyID2(1byte) + cipher text TMK2.<a name="line.2842"></a>
<span class="sourceLineNo">2843</span>     *                   &lt;ul&gt;<a name="line.2843"></a>
<span class="sourceLineNo">2844</span>     *                     &lt;li&gt;When mode = 0x81, DES decryption mode, WKeyID1 key is 8 bytes, WKeyID2 key is 8 bytes, and cipher text TMK2 is 8 bytes.&lt;/li&gt;<a name="line.2844"></a>
<span class="sourceLineNo">2845</span>     *                     &lt;li&gt;When mode = 0x83, 3DES decryption mode, WKeyID1 key is 16 bytes, WKeyID2 key is 8 bytes, and cipher text TMK2 is 8 bytes.&lt;/li&gt;<a name="line.2845"></a>
<span class="sourceLineNo">2846</span>     *                     &lt;li&gt;When mode = 0x87, 3DES decryption mode, WKeyID1 key is 24 bytes, WKeyID2 key is 8 bytes, and cipher text TMK2 is 8 bytes.&lt;/li&gt;<a name="line.2846"></a>
<span class="sourceLineNo">2847</span>     *                     &lt;li&gt;When mode = 0xB1, 3DES decryption mode, WKeyID1 key is 16 bytes, WKeyID2 key is 8 bytes, and cipher text TMK2 is 8 bytes.&lt;/li&gt;<a name="line.2847"></a>
<span class="sourceLineNo">2848</span>     *                     &lt;li&gt;When mode = 0xB3, 3DES decryption mode, WKeyID1 key is 16 bytes, WKeyID2 key is 16 bytes, and cipher text TMK2 is 16 bytes.&lt;/li&gt;<a name="line.2848"></a>
<span class="sourceLineNo">2849</span>     *                     &lt;li&gt;When mode = 0xF1, 3DES decryption mode, WKeyID1 key is 24 bytes, WKeyID2 key is 8 bytes, and cipher text TMK2 is 8 bytes.&lt;/li&gt;<a name="line.2849"></a>
<span class="sourceLineNo">2850</span>     *                     &lt;li&gt;When mode = 0xF3, 3DES decryption mode, WKeyID1 key is 24 bytes, WKeyID2 key is 16 bytes, and cipher text TMK2 is 16 bytes.&lt;/li&gt;<a name="line.2850"></a>
<span class="sourceLineNo">2851</span>     *                     &lt;li&gt;When mode = 0xF7, 3DES decryption mode, WKeyID1 key is 24 bytes, WKeyID2 key is 24 bytes, and cipher text TMK2 is 24 bytes.&lt;/li&gt;<a name="line.2851"></a>
<span class="sourceLineNo">2852</span>     *                   &lt;/ul&gt;<a name="line.2852"></a>
<span class="sourceLineNo">2853</span>     *                 &lt;/li&gt;<a name="line.2853"></a>
<span class="sourceLineNo">2854</span>     *                 &lt;li&gt;When option = 0x03, dataIn = MKeyID(1byte) + plaintext Random.<a name="line.2854"></a>
<span class="sourceLineNo">2855</span>     *                   &lt;ul&gt;<a name="line.2855"></a>
<span class="sourceLineNo">2856</span>     *                     &lt;li&gt;When mode = 0x01, DES encryption mode, MKeyID key 8 bytes, Random 8 bytes.&lt;/li&gt;<a name="line.2856"></a>
<span class="sourceLineNo">2857</span>     *                     &lt;li&gt;When mode = 0x03, 3DES encryption mode, MKeyID key 16 bytes, Random 8 bytes.&lt;/li&gt;<a name="line.2857"></a>
<span class="sourceLineNo">2858</span>     *                     &lt;li&gt;When mode = 0x31, 3DES encryption mode, MKeyID key 16 bytes, Random 8 bytes.&lt;/li&gt;<a name="line.2858"></a>
<span class="sourceLineNo">2859</span>     *                     &lt;li&gt;When mode = 0x07, 3DES encryption mode, MKeyID key 24 bytes, Random 8 bytes.&lt;/li&gt;<a name="line.2859"></a>
<span class="sourceLineNo">2860</span>     *                     &lt;li&gt;When mode = 0x71, 3DES encryption mode, MKeyID key 24 bytes, Random 8 bytes.&lt;/li&gt;<a name="line.2860"></a>
<span class="sourceLineNo">2861</span>     *                     &lt;li&gt;When mode = 0x33, 3DES encryption mode, MKeyID key 16 bytes, Random 16 bytes.&lt;/li&gt;<a name="line.2861"></a>
<span class="sourceLineNo">2862</span>     *                     &lt;li&gt;When mode = 0x73, 3DES encryption mode, MKeyID key 16 bytes, Random 16 bytes.&lt;/li&gt;<a name="line.2862"></a>
<span class="sourceLineNo">2863</span>     *                     &lt;li&gt;When mode = 0x77, 3DES encryption mode, MKeyID key 24 bytes, Random 24 bytes.&lt;/li&gt;<a name="line.2863"></a>
<span class="sourceLineNo">2864</span>     *                   &lt;/ul&gt;<a name="line.2864"></a>
<span class="sourceLineNo">2865</span>     *                 &lt;/li&gt;<a name="line.2865"></a>
<span class="sourceLineNo">2866</span>     *                 &lt;li&gt;When option = 0x04, dataIn = WKeyID1 + WKeyID2 + pin_block(8byte) + ISN(6byte) + new_TPK(8bytes).<a name="line.2866"></a>
<span class="sourceLineNo">2867</span>     *                   &lt;ul&gt;<a name="line.2867"></a>
<span class="sourceLineNo">2868</span>     *                     &lt;li&gt;When mode = 0x81, DES decryption mode, WKeyID1 key 8 bytes, WKeyID2 key 8 bytes.&lt;/li&gt;<a name="line.2868"></a>
<span class="sourceLineNo">2869</span>     *                     &lt;li&gt;When mode = 0x83, 3DES decryption mode, WKeyID1 key 16 bytes, WKeyID2 key 8 bytes.&lt;/li&gt;<a name="line.2869"></a>
<span class="sourceLineNo">2870</span>     *                     &lt;li&gt;When mode = 0x87, 3DES decryption mode, WKeyID1 key 24 bytes, WKeyID2 key 8 bytes.&lt;/li&gt;<a name="line.2870"></a>
<span class="sourceLineNo">2871</span>     *                     &lt;li&gt;When mode = 0xB1, 3DES decryption mode, WKeyID1 key 16 bytes, WKeyID2 key 8 bytes.&lt;/li&gt;<a name="line.2871"></a>
<span class="sourceLineNo">2872</span>     *                     &lt;li&gt;When mode = 0xF1, 3DES decryption mode, WKeyID1 key 24 bytes, WKeyID2 key 8 bytes.&lt;/li&gt;<a name="line.2872"></a>
<span class="sourceLineNo">2873</span>     *                     &lt;li&gt;When mode = 0xB3, 3DES decryption mode, WKeyID1 key 16 bytes, WKeyID2 key 16 bytes.&lt;/li&gt;<a name="line.2873"></a>
<span class="sourceLineNo">2874</span>     *                     &lt;li&gt;When mode = 0xF3, 3DES decryption mode, WKeyID1 key 24 bytes, WKeyID2 key 16 bytes.&lt;/li&gt;<a name="line.2874"></a>
<span class="sourceLineNo">2875</span>     *                     &lt;li&gt;When mode = 0xF7, 3DES decryption mode, WKeyID1 key 24 bytes, WKeyID2 key 24 bytes.&lt;/li&gt;<a name="line.2875"></a>
<span class="sourceLineNo">2876</span>     *                   &lt;/ul&gt;<a name="line.2876"></a>
<span class="sourceLineNo">2877</span>     *                 &lt;/li&gt;<a name="line.2877"></a>
<span class="sourceLineNo">2878</span>     *                 &lt;li&gt;When option = 0x05, dataIn = WKeyID1(1byte) + WKeyID2(1byte) + rsp_len(1byte) + TAK ciphertext + rsp_data(rsp_len) +<a name="line.2878"></a>
<span class="sourceLineNo">2879</span>     *                   rsp_MAC(8byte, convert the first 4 bytes of the MAC code to the value string and then pass in, such as 0x123456AB converted to "123456AB").<a name="line.2879"></a>
<span class="sourceLineNo">2880</span>     *                   &lt;ul&gt;<a name="line.2880"></a>
<span class="sourceLineNo">2881</span>     *                     &lt;p&gt;MAC algorithm 1:&lt;/p&gt;<a name="line.2881"></a>
<span class="sourceLineNo">2882</span>     *                     &lt;li&gt;When mode = 0x81, DES decryption mode, WKeyID1 key is 8 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2882"></a>
<span class="sourceLineNo">2883</span>     *                     &lt;li&gt;When mode = 0x83, 3DES decryption mode, WKeyID1 key is 16 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2883"></a>
<span class="sourceLineNo">2884</span>     *                     &lt;li&gt;When mode = 0xB1, 3DES decryption mode, WKeyID1 key is 16 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2884"></a>
<span class="sourceLineNo">2885</span>     *                     &lt;li&gt;When mode = 0x87, 3DES decryption mode, WKeyID1 key is 24 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2885"></a>
<span class="sourceLineNo">2886</span>     *                     &lt;li&gt;When mode = 0xF1, 3DES decryption mode, WKeyID1 key is 24 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2886"></a>
<span class="sourceLineNo">2887</span>     *                     &lt;li&gt;When mode = 0xB3, 3DES decryption mode, WKeyID1 key is 16 bytes, TAK and WKeyID2 keys are both 16 bytes.&lt;/li&gt;<a name="line.2887"></a>
<span class="sourceLineNo">2888</span>     *                     &lt;li&gt;When mode = 0xF3, 3DES decryption mode, WKeyID1 key is 24 bytes, TAK and WKeyID2 keys are both 16 bytes.&lt;/li&gt;<a name="line.2888"></a>
<span class="sourceLineNo">2889</span>     *                     &lt;li&gt;When mode = 0xF7, 3DES decryption mode, WKeyID1 key is 24 bytes, TAK and WKeyID2 keys are both 24 bytes.&lt;/li&gt;<a name="line.2889"></a>
<span class="sourceLineNo">2890</span>     *                     &lt;li&gt;When mode = 0x89, DES decryption mode, WKeyID1 key is 8 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2890"></a>
<span class="sourceLineNo">2891</span>     *                     &lt;li&gt;When mode = 0x8B, 3DES decryption mode, WKeyID1 key is 16 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2891"></a>
<span class="sourceLineNo">2892</span>     *                     &lt;li&gt;When mode = 0xB9, 3DES decryption mode, WKeyID1 key is 16 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2892"></a>
<span class="sourceLineNo">2893</span>     *                     &lt;li&gt;When mode = 0x8F, 3DES decryption mode, WKeyID1 key is 24 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2893"></a>
<span class="sourceLineNo">2894</span>     *                     &lt;li&gt;When mode = 0xF9, 3DES decryption mode, WKeyID1 key is 24 bytes, TAK and WKeyID2 keys are both 8 bytes.&lt;/li&gt;<a name="line.2894"></a>
<span class="sourceLineNo">2895</span>     *                     &lt;p&gt;MAC algorithm 2:&lt;/p&gt;<a name="line.2895"></a>
<span class="sourceLineNo">2896</span>     *                     &lt;li&gt;When mode = 0xBB, 3DES decryption mode, WKeyID1 key is 16 bytes, TAK and WKeyID2 keys are both 16 bytes.&lt;/li&gt;<a name="line.2896"></a>
<span class="sourceLineNo">2897</span>     *                     &lt;li&gt;When mode = 0xFB, 3DES decryption mode, WKeyID1 key is 24 bytes, TAK and WKeyID2 keys are both 16 bytes.&lt;/li&gt;<a name="line.2897"></a>
<span class="sourceLineNo">2898</span>     *                     &lt;li&gt;When mode = 0xFF, 3DES decryption mode, WKeyID1 key is 24 bytes, TAK and WKeyID2 keys are both 24 bytes.&lt;/li&gt;<a name="line.2898"></a>
<span class="sourceLineNo">2899</span>     *                   &lt;/ul&gt;<a name="line.2899"></a>
<span class="sourceLineNo">2900</span>     *                 &lt;/li&gt;<a name="line.2900"></a>
<span class="sourceLineNo">2901</span>     *                 &lt;li&gt;When option = 0x06, dataIn = WKeyID1(1byte).<a name="line.2901"></a>
<span class="sourceLineNo">2902</span>     *                   &lt;ul&gt;<a name="line.2902"></a>
<span class="sourceLineNo">2903</span>     *                     &lt;li&gt;When mode = 0x01, DES encryption mode, WKeyID1 key is 8 bytes.&lt;/li&gt;<a name="line.2903"></a>
<span class="sourceLineNo">2904</span>     *                     &lt;li&gt;When mode = 0x03, 3DES encryption mode, WKeyID1 key is 16 bytes.&lt;/li&gt;<a name="line.2904"></a>
<span class="sourceLineNo">2905</span>     *                     &lt;li&gt;When mode = 0x07, 3DES encryption mode, WKeyID1 key is 24 bytes.&lt;/li&gt;<a name="line.2905"></a>
<span class="sourceLineNo">2906</span>     *                   &lt;/ul&gt;<a name="line.2906"></a>
<span class="sourceLineNo">2907</span>     *                 &lt;/li&gt;<a name="line.2907"></a>
<span class="sourceLineNo">2908</span>     *               &lt;/ul&gt;&lt;/div&gt;<a name="line.2908"></a>
<span class="sourceLineNo">2909</span>     * @return &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2909"></a>
<span class="sourceLineNo">2910</span>     *           &lt;li&gt;当option = 0x01时，无返回结果。&lt;/li&gt;<a name="line.2910"></a>
<span class="sourceLineNo">2911</span>     *           &lt;li&gt;当option = 0x02时, 无返回结果。&lt;/li&gt;<a name="line.2911"></a>
<span class="sourceLineNo">2912</span>     *           &lt;li&gt;当option = 0x03时, 随机数密文(8bytes)。&lt;/li&gt;<a name="line.2912"></a>
<span class="sourceLineNo">2913</span>     *           &lt;li&gt;当option = 0x04时, 新的 pin_block(8bytes)。&lt;/li&gt;<a name="line.2913"></a>
<span class="sourceLineNo">2914</span>     *           &lt;li&gt;当option = 0x05时, 无返回结果。&lt;/li&gt;<a name="line.2914"></a>
<span class="sourceLineNo">2915</span>     *           &lt;li&gt;当option = 0x06时, 加密结果（8byte）。&lt;/li&gt;<a name="line.2915"></a>
<span class="sourceLineNo">2916</span>     *         &lt;/ul&gt;&lt;/div&gt;<a name="line.2916"></a>
<span class="sourceLineNo">2917</span>     *         &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2917"></a>
<span class="sourceLineNo">2918</span>     *           &lt;li&gt;When option = 0x01, no result is returned.&lt;/li&gt;<a name="line.2918"></a>
<span class="sourceLineNo">2919</span>     *           &lt;li&gt;When option = 0x02, no result is returned.&lt;/li&gt;<a name="line.2919"></a>
<span class="sourceLineNo">2920</span>     *           &lt;li&gt;When option = 0x03, random number ciphertext (8bytes).&lt;/li&gt;<a name="line.2920"></a>
<span class="sourceLineNo">2921</span>     *           &lt;li&gt;When option = 0x04, new pin_block(8bytes).&lt;/li&gt;<a name="line.2921"></a>
<span class="sourceLineNo">2922</span>     *           &lt;li&gt;When option = 0x05, no result is returned.&lt;/li&gt;<a name="line.2922"></a>
<span class="sourceLineNo">2923</span>     *           &lt;li&gt;When option = 0x06, the encryption result (8byte).&lt;/li&gt;<a name="line.2923"></a>
<span class="sourceLineNo">2924</span>     *         &lt;/ul&gt;&lt;/div&gt;<a name="line.2924"></a>
<span class="sourceLineNo">2925</span>     * @throws TypeAException TypeAException<a name="line.2925"></a>
<span class="sourceLineNo">2926</span>     */<a name="line.2926"></a>
<span class="sourceLineNo">2927</span>    byte[] extEPS(byte option, byte mode, byte[] dataIn) throws TypeAException;<a name="line.2927"></a>
<span class="sourceLineNo">2928</span><a name="line.2928"></a>
<span class="sourceLineNo">2929</span>    /**<a name="line.2929"></a>
<span class="sourceLineNo">2930</span>     * &lt;div class="zh"&gt;非接模块上电。&lt;/div&gt; &lt;div class="en"&gt;Power on contactless module.&lt;/div&gt;<a name="line.2930"></a>
<span class="sourceLineNo">2931</span>     *<a name="line.2931"></a>
<span class="sourceLineNo">2932</span>     * @throws TypeAException TypeAException<a name="line.2932"></a>
<span class="sourceLineNo">2933</span>     */<a name="line.2933"></a>
<span class="sourceLineNo">2934</span>    void piccOpen() throws TypeAException;<a name="line.2934"></a>
<span class="sourceLineNo">2935</span><a name="line.2935"></a>
<span class="sourceLineNo">2936</span>    /**<a name="line.2936"></a>
<span class="sourceLineNo">2937</span>     * &lt;div class="zh"&gt;读取非接读卡器参数。 只有在{@link #piccOpen()}函数之后，{@link #detect(byte)}及{@link #initFelica(byte, byte)}之前调用才有效。&lt;/div&gt;<a name="line.2937"></a>
<span class="sourceLineNo">2938</span>     * &lt;div class="en"&gt;Read the parameters of the contactless card reader. Only after {@link #piccOpen()} function,<a name="line.2938"></a>
<span class="sourceLineNo">2939</span>     *  {@link #detect(byte)} and {@link #initFelica(byte, byte)} are called before it is valid.&lt;/div&gt;<a name="line.2939"></a>
<span class="sourceLineNo">2940</span>     *<a name="line.2940"></a>
<span class="sourceLineNo">2941</span>     * @return {@link PiccPara}<a name="line.2941"></a>
<span class="sourceLineNo">2942</span>     * @throws TypeAException TypeAException<a name="line.2942"></a>
<span class="sourceLineNo">2943</span>     */<a name="line.2943"></a>
<span class="sourceLineNo">2944</span>    PiccPara readParam() throws TypeAException;<a name="line.2944"></a>
<span class="sourceLineNo">2945</span><a name="line.2945"></a>
<span class="sourceLineNo">2946</span>    /**<a name="line.2946"></a>
<span class="sourceLineNo">2947</span>     * &lt;div class="zh"&gt;设置非接读卡器参数。 只有在{@link #piccOpen()}函数之后，{@link #detect(byte)}及{@link #initFelica(byte, byte)}之前调用才有效。&lt;/div&gt;<a name="line.2947"></a>
<span class="sourceLineNo">2948</span>     * &lt;div class="en"&gt;Set the parameters of the contactless card reader. Only after {@link #piccOpen()} function,<a name="line.2948"></a>
<span class="sourceLineNo">2949</span>     *  {@link #detect(byte)} and {@link #initFelica(byte, byte)} are called before it is valid.&lt;/div&gt;<a name="line.2949"></a>
<span class="sourceLineNo">2950</span>     *<a name="line.2950"></a>
<span class="sourceLineNo">2951</span>     * @param para {@link PiccPara}<a name="line.2951"></a>
<span class="sourceLineNo">2952</span>     * @throws TypeAException TypeAException<a name="line.2952"></a>
<span class="sourceLineNo">2953</span>     */<a name="line.2953"></a>
<span class="sourceLineNo">2954</span>    void setParam(PiccPara para) throws TypeAException;<a name="line.2954"></a>
<span class="sourceLineNo">2955</span><a name="line.2955"></a>
<span class="sourceLineNo">2956</span>    /**<a name="line.2956"></a>
<span class="sourceLineNo">2957</span>     * &lt;div class="zh"&gt;按指定的模式搜寻PICC卡片，搜到卡片后，将其选中并激活。感应区内不允许多张卡存在。&lt;/div&gt;<a name="line.2957"></a>
<span class="sourceLineNo">2958</span>     * &lt;div class="en"&gt;Search for PICC cards according to the specified mode. After the card is found,<a name="line.2958"></a>
<span class="sourceLineNo">2959</span>     *  select and activate it. Multiple cards are not allowed in the induction area.&lt;/div&gt;<a name="line.2959"></a>
<span class="sourceLineNo">2960</span>     *<a name="line.2960"></a>
<span class="sourceLineNo">2961</span>     * @param mode &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.2961"></a>
<span class="sourceLineNo">2962</span>     *               &lt;li&gt;0x00: 搜寻 A 型卡和 B 型卡一次，此模式适用于需要增强多卡检测功能的场合。该模式是符合 ISO14443 规范的寻卡模式。&lt;/li&gt;<a name="line.2962"></a>
<span class="sourceLineNo">2963</span>     *               &lt;li&gt;0x01: 搜寻 A 型卡和 B 型卡一次，此模式为EMV寻卡模式，通常使用该模式。&lt;/li&gt;<a name="line.2963"></a>
<span class="sourceLineNo">2964</span>     *               &lt;li&gt;0x10: 搜寻 A 型卡和 B 型卡一次，发送 VAS 指令（Terminal in VAS App OR PaymentMode）。此模式用于 apply pay。&lt;/li&gt;<a name="line.2964"></a>
<span class="sourceLineNo">2965</span>     *               &lt;li&gt;0x11: 搜寻 A 型卡和 B 型卡一次，发送 VAS 指令（Terminal in VAS App AND PaymentMode）。此模式用于 apply pay。&lt;/li&gt;<a name="line.2965"></a>
<span class="sourceLineNo">2966</span>     *               &lt;li&gt;0x12: 搜寻 A 型卡和 B 型卡一次，发送 VAS 指令（Terminal in VAS App Only Mode）。此模式用于 apply pay。&lt;/li&gt;<a name="line.2966"></a>
<span class="sourceLineNo">2967</span>     *               &lt;li&gt;0x13: 搜寻 A 型卡和 B 型卡一次，发送 VAS 指令（Terminal in Payment Mode Only）。&lt;/li&gt;<a name="line.2967"></a>
<span class="sourceLineNo">2968</span>     *               &lt;li&gt;'a'或'A': 只搜寻 A 型卡一次。&lt;/li&gt;<a name="line.2968"></a>
<span class="sourceLineNo">2969</span>     *               &lt;li&gt;'b'或'B': 只搜寻 B 型卡一次。&lt;/li&gt;<a name="line.2969"></a>
<span class="sourceLineNo">2970</span>     *               &lt;li&gt;'m'或'M': 只搜寻 M1 卡一次。&lt;/li&gt;<a name="line.2970"></a>
<span class="sourceLineNo">2971</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.2971"></a>
<span class="sourceLineNo">2972</span>     *             &lt;div class="en"&gt;&lt;ul&gt;<a name="line.2972"></a>
<span class="sourceLineNo">2973</span>     *               &lt;li&gt;0x00: Search for type A card and type B card once. This mode is suitable for occasions that need to<a name="line.2973"></a>
<span class="sourceLineNo">2974</span>     *                 enhance the multi-card detection function. This mode is a card detection mode that conforms to the ISO14443 specification.&lt;/li&gt;<a name="line.2974"></a>
<span class="sourceLineNo">2975</span>     *               &lt;li&gt;0x01: Search for type A card and type B card once, this mode is EMV search card mode, usually use this mode.&lt;/li&gt;<a name="line.2975"></a>
<span class="sourceLineNo">2976</span>     *               &lt;li&gt;0x10: Search for Type A and Type B cards once, and send the VAS command (Terminal in VAS App OR Payment Mode).<a name="line.2976"></a>
<span class="sourceLineNo">2977</span>     *                 This mode is used for apply pay.&lt;/li&gt;<a name="line.2977"></a>
<span class="sourceLineNo">2978</span>     *               &lt;li&gt;0x11: Search for Type A and Type B cards once, and send the VAS command (Terminal in VAS App AND Payment Mode).<a name="line.2978"></a>
<span class="sourceLineNo">2979</span>     *                 This mode is used for apply pay.&lt;/li&gt;<a name="line.2979"></a>
<span class="sourceLineNo">2980</span>     *               &lt;li&gt;0x12: Search for Type A and Type B cards once, and send the VAS command (Terminal in VAS App Only Mode).<a name="line.2980"></a>
<span class="sourceLineNo">2981</span>     *                 This mode is used for apply pay.&lt;/li&gt;<a name="line.2981"></a>
<span class="sourceLineNo">2982</span>     *               &lt;li&gt;0x13: Search for Type A and Type B cards once, and send the VAS command (Terminal in Payment Mode Only).&lt;/li&gt;<a name="line.2982"></a>
<span class="sourceLineNo">2983</span>     *               &lt;li&gt;'a'or'A': Only search for Type A cards once.&lt;/li&gt;<a name="line.2983"></a>
<span class="sourceLineNo">2984</span>     *               &lt;li&gt;'b'or'B': Only search for type B cards once.&lt;/li&gt;<a name="line.2984"></a>
<span class="sourceLineNo">2985</span>     *               &lt;li&gt;'m'or'M': Only search for M1 card once.&lt;/li&gt;<a name="line.2985"></a>
<span class="sourceLineNo">2986</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.2986"></a>
<span class="sourceLineNo">2987</span>     * @return {@link PiccCardInfo}<a name="line.2987"></a>
<span class="sourceLineNo">2988</span>     * @throws TypeAException TypeAException<a name="line.2988"></a>
<span class="sourceLineNo">2989</span>     */<a name="line.2989"></a>
<span class="sourceLineNo">2990</span>    PiccCardInfo detect(byte mode) throws TypeAException;<a name="line.2990"></a>
<span class="sourceLineNo">2991</span><a name="line.2991"></a>
<span class="sourceLineNo">2992</span>    /**<a name="line.2992"></a>
<span class="sourceLineNo">2993</span>     * &lt;div class="zh"&gt;在指定的通道上，向卡片发送 APDU 格式的数据，并接收响应。&lt;/div&gt;<a name="line.2993"></a>
<span class="sourceLineNo">2994</span>     * &lt;div class="en"&gt;On the designated channel, send data in APDU format to the card and receive the response.&lt;/div&gt;<a name="line.2994"></a>
<span class="sourceLineNo">2995</span>     *<a name="line.2995"></a>
<span class="sourceLineNo">2996</span>     * @param cid &lt;div class="zh"&gt;用于指定卡片逻辑通道号；该通道号由{@link PiccCardInfo#getCID()} 获取，其取值范围 0-14，目前取值均为 0。&lt;/div&gt;<a name="line.2996"></a>
<span class="sourceLineNo">2997</span>     *            &lt;div class="en"&gt;Used to specify the card logical channel number; the channel number is obtained by {@link PiccCardInfo#getCID()},<a name="line.2997"></a>
<span class="sourceLineNo">2998</span>     *              and its value range is 0-14, and the current value is 0.&lt;/div&gt;<a name="line.2998"></a>
<span class="sourceLineNo">2999</span>     * @param sendInfo {@link ApduSendInfo}<a name="line.2999"></a>
<span class="sourceLineNo">3000</span>     * @return {@link ApduRespInfo}<a name="line.3000"></a>
<span class="sourceLineNo">3001</span>     *<a name="line.3001"></a>
<span class="sourceLineNo">3002</span>     * @throws TypeAException TypeAException<a name="line.3002"></a>
<span class="sourceLineNo">3003</span>     */<a name="line.3003"></a>
<span class="sourceLineNo">3004</span>    ApduRespInfo isoCommand(byte cid, ApduSendInfo sendInfo) throws TypeAException;<a name="line.3004"></a>
<span class="sourceLineNo">3005</span><a name="line.3005"></a>
<span class="sourceLineNo">3006</span>    /**<a name="line.3006"></a>
<span class="sourceLineNo">3007</span>     * &lt;div class="zh"&gt;依据指定的模式，向卡片发送停机指令；或者发送停活指令；或者复位载波，并判断卡片是否已经移开感应区。&lt;/div&gt;<a name="line.3007"></a>
<span class="sourceLineNo">3008</span>     * &lt;div class="en"&gt;According to the specified mode, send a stop instruction to the card; or send a deactivation instruction;<a name="line.3008"></a>
<span class="sourceLineNo">3009</span>     * or reset the carrier, and determine whether the card has moved out of the sensing area.&lt;/div&gt;<a name="line.3009"></a>
<span class="sourceLineNo">3010</span>     *<a name="line.3010"></a>
<span class="sourceLineNo">3011</span>     * @param mode &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.3011"></a>
<span class="sourceLineNo">3012</span>     *               &lt;li&gt;'h'或'H': 意为 HALT，仅向卡片发送停活指令后就退出。该过程不执行卡移开检测。&lt;/li&gt;<a name="line.3012"></a>
<span class="sourceLineNo">3013</span>     *               &lt;li&gt;'r'或'R': 意为 REMOVE，向卡片发送停活指令，并执行卡移开检测。&lt;/li&gt;<a name="line.3013"></a>
<span class="sourceLineNo">3014</span>     *               &lt;li&gt;'e'或'E': 符合 EMV 非接规范的移卡模式。复位载波，并执行卡移开检测。&lt;/li&gt;<a name="line.3014"></a>
<span class="sourceLineNo">3015</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3015"></a>
<span class="sourceLineNo">3016</span>     *             &lt;div class="en"&gt;&lt;ul&gt;<a name="line.3016"></a>
<span class="sourceLineNo">3017</span>     *               &lt;li&gt;'h'or'H': It means HALT, and it will exit after sending a deactivation command to the card.<a name="line.3017"></a>
<span class="sourceLineNo">3018</span>     *                 This process does not perform card removal detection.&lt;/li&gt;<a name="line.3018"></a>
<span class="sourceLineNo">3019</span>     *               &lt;li&gt;'r'or'R': It means REMOVE, sending a deactivation command to the card and executing the card removal detection.&lt;/li&gt;<a name="line.3019"></a>
<span class="sourceLineNo">3020</span>     *               &lt;li&gt;'e'or'E': Shift card mode conforming to EMV contactless specification. Reset the carrier and perform card removal detection.&lt;/li&gt;<a name="line.3020"></a>
<span class="sourceLineNo">3021</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3021"></a>
<span class="sourceLineNo">3022</span>     * @param cid &lt;div class="zh"&gt;用于指定卡片逻辑通道号；该通道号由{@link PiccCardInfo#getCID()} 获取，其取值范围 0-14，目前取值均为 0。&lt;/div&gt;<a name="line.3022"></a>
<span class="sourceLineNo">3023</span>     *            &lt;div class="en"&gt;Used to specify the card logical channel number; the channel number is obtained by {@link PiccCardInfo#getCID()},<a name="line.3023"></a>
<span class="sourceLineNo">3024</span>     *              and its value range is 0-14, and the current value is 0.&lt;/div&gt;<a name="line.3024"></a>
<span class="sourceLineNo">3025</span>     * @throws TypeAException TypeAException<a name="line.3025"></a>
<span class="sourceLineNo">3026</span>     */<a name="line.3026"></a>
<span class="sourceLineNo">3027</span>    void remove(byte mode, byte cid) throws TypeAException;<a name="line.3027"></a>
<span class="sourceLineNo">3028</span><a name="line.3028"></a>
<span class="sourceLineNo">3029</span>    /**<a name="line.3029"></a>
<span class="sourceLineNo">3030</span>     * &lt;div class="zh"&gt;关闭非接模块，使该模块处于下电状态。&lt;/div&gt;<a name="line.3030"></a>
<span class="sourceLineNo">3031</span>     * &lt;div class="en"&gt;Turn off the contactless module and make the module in the power-off state.&lt;/div&gt;<a name="line.3031"></a>
<span class="sourceLineNo">3032</span>     *<a name="line.3032"></a>
<span class="sourceLineNo">3033</span>     * @throws TypeAException TypeAException<a name="line.3033"></a>
<span class="sourceLineNo">3034</span>     */<a name="line.3034"></a>
<span class="sourceLineNo">3035</span>    void piccClose() throws TypeAException;<a name="line.3035"></a>
<span class="sourceLineNo">3036</span><a name="line.3036"></a>
<span class="sourceLineNo">3037</span>    /**<a name="line.3037"></a>
<span class="sourceLineNo">3038</span>     * &lt;div class="zh"&gt;验证访问M1卡时读写相应块需要提交的 A 密码或 B 密码。&lt;/div&gt;<a name="line.3038"></a>
<span class="sourceLineNo">3039</span>     * &lt;div class="en"&gt;Verify the A password or B password that needs to be submitted<a name="line.3039"></a>
<span class="sourceLineNo">3040</span>     *   when reading and writing the corresponding block when accessing the M1 card.&lt;/div&gt;<a name="line.3040"></a>
<span class="sourceLineNo">3041</span>     *<a name="line.3041"></a>
<span class="sourceLineNo">3042</span>     * @param type {@link EM1KeyType}<a name="line.3042"></a>
<span class="sourceLineNo">3043</span>     * @param blkNo &lt;div class="zh"&gt;指定访问的块号。&lt;/div&gt; &lt;div class="en"&gt;Specify the block number to be accessed.&lt;/div&gt;<a name="line.3043"></a>
<span class="sourceLineNo">3044</span>     * @param pwd &lt;div class="zh"&gt;提交的密码。&lt;/div&gt; &lt;div class="en"&gt;Password submitted.&lt;/div&gt;<a name="line.3044"></a>
<span class="sourceLineNo">3045</span>     * @param serialNo &lt;div class="zh"&gt;卡片序列号。由{@link PiccCardInfo#getSerialInfo()}} 获取。&lt;/div&gt;<a name="line.3045"></a>
<span class="sourceLineNo">3046</span>     *                 &lt;div class="en"&gt;Card serial number. Obtained by {@link PiccCardInfo#getSerialInfo()}}.&lt;/div&gt;<a name="line.3046"></a>
<span class="sourceLineNo">3047</span>     * @throws TypeAException TypeAException<a name="line.3047"></a>
<span class="sourceLineNo">3048</span>     */<a name="line.3048"></a>
<span class="sourceLineNo">3049</span>    void m1Auth(EM1KeyType type, byte blkNo, byte[] pwd, byte[] serialNo) throws TypeAException;<a name="line.3049"></a>
<span class="sourceLineNo">3050</span><a name="line.3050"></a>
<span class="sourceLineNo">3051</span>    /**<a name="line.3051"></a>
<span class="sourceLineNo">3052</span>     * &lt;div class="zh"&gt;读取M1卡指定块的内容。共16字节。&lt;/div&gt;<a name="line.3052"></a>
<span class="sourceLineNo">3053</span>     * &lt;div class="en"&gt;Read the contents of the specified block of the M1 card. A total of 16 bytes..&lt;/div&gt;<a name="line.3053"></a>
<span class="sourceLineNo">3054</span>     *<a name="line.3054"></a>
<span class="sourceLineNo">3055</span>     * @param blkNo &lt;div class="zh"&gt;指定访问的块号。&lt;/div&gt; &lt;div class="en"&gt;Specify the block number to be accessed.&lt;/div&gt;<a name="line.3055"></a>
<span class="sourceLineNo">3056</span>     * @return &lt;div class="zh"&gt;块内数据。16字节。&lt;/div&gt; &lt;div class="en"&gt;Data in the block. 16 bytes.&lt;/div&gt;<a name="line.3056"></a>
<span class="sourceLineNo">3057</span>     * @throws TypeAException TypeAException<a name="line.3057"></a>
<span class="sourceLineNo">3058</span>     */<a name="line.3058"></a>
<span class="sourceLineNo">3059</span>    byte[] m1Read(byte blkNo) throws TypeAException;<a name="line.3059"></a>
<span class="sourceLineNo">3060</span><a name="line.3060"></a>
<span class="sourceLineNo">3061</span>    /**<a name="line.3061"></a>
<span class="sourceLineNo">3062</span>     * &lt;div class="zh"&gt;向M1卡指定块写入指定的内容。共16字节。&lt;/div&gt;<a name="line.3062"></a>
<span class="sourceLineNo">3063</span>     * &lt;div class="en"&gt;Write the specified content to the specified block of the M1 card. A total of 16 bytes.&lt;/div&gt;<a name="line.3063"></a>
<span class="sourceLineNo">3064</span>     *<a name="line.3064"></a>
<span class="sourceLineNo">3065</span>     * @param blkNo &lt;div class="zh"&gt;指定访问的块号。&lt;/div&gt; &lt;div class="en"&gt;Specify the block number to be accessed.&lt;/div&gt;<a name="line.3065"></a>
<span class="sourceLineNo">3066</span>     * @param blkValue &lt;div class="zh"&gt;要写入块中的数据。16字节。&lt;/div&gt; &lt;div class="en"&gt;The data to be written in the block. 16 bytes.&lt;/div&gt;<a name="line.3066"></a>
<span class="sourceLineNo">3067</span>     * @throws TypeAException TypeAException<a name="line.3067"></a>
<span class="sourceLineNo">3068</span>     */<a name="line.3068"></a>
<span class="sourceLineNo">3069</span>    void m1Write(byte blkNo, byte[] blkValue) throws TypeAException;<a name="line.3069"></a>
<span class="sourceLineNo">3070</span><a name="line.3070"></a>
<span class="sourceLineNo">3071</span>    /**<a name="line.3071"></a>
<span class="sourceLineNo">3072</span>     * &lt;div class="zh"&gt;对 M1 卡的指定数据块 blkNo 进行充/减值/备份操作，将操作后的值更新到另一个指定的数据块 updateBlkNo。&lt;/div&gt; &lt;div class="en"&gt;&lt;/div&gt;<a name="line.3072"></a>
<span class="sourceLineNo">3073</span>     *<a name="line.3073"></a>
<span class="sourceLineNo">3074</span>     * @param type {@link EM1OperateType}<a name="line.3074"></a>
<span class="sourceLineNo">3075</span>     * @param blkNo &lt;div class="zh"&gt;指定访问的块号。&lt;/div&gt; &lt;div class="en"&gt;Specify the block number to be accessed.&lt;/div&gt;<a name="line.3075"></a>
<span class="sourceLineNo">3076</span>     * @param blkValue &lt;div class="zh"&gt;待充值或减值的金额数。共4字节。M1卡通常都有两个钱包：主钱包和备用钱包。 为了在对主钱包进行操作时，可以从出现的异常错误中恢复， 主钱包的操作结果通常会写入备用钱包。&lt;/div&gt;<a name="line.3076"></a>
<span class="sourceLineNo">3077</span>     *                 &lt;div class="en"&gt;The amount of money to be recharged or devalued. A total of 4 bytes. M1 cards usually have two wallets: the main wallet and the backup wallet.<a name="line.3077"></a>
<span class="sourceLineNo">3078</span>     *                   In order to recover from abnormal errors when operating on the main wallet, the operation result of the main wallet is usually written into the backup wallet.&lt;/div&gt;<a name="line.3078"></a>
<span class="sourceLineNo">3079</span>     * @param updateBlkNo &lt;div class="zh"&gt;指定操作结果最终写入到的块号。&lt;/div&gt; &lt;div class="en"&gt;Specify the block number to which the operation result is finally written.&lt;/div&gt;<a name="line.3079"></a>
<span class="sourceLineNo">3080</span>     * @throws TypeAException TypeAException<a name="line.3080"></a>
<span class="sourceLineNo">3081</span>     */<a name="line.3081"></a>
<span class="sourceLineNo">3082</span>    void m1Operate(EM1OperateType type, byte blkNo, byte[] blkValue, byte updateBlkNo) throws TypeAException;<a name="line.3082"></a>
<span class="sourceLineNo">3083</span><a name="line.3083"></a>
<span class="sourceLineNo">3084</span>    /**<a name="line.3084"></a>
<span class="sourceLineNo">3085</span>     * &lt;div class="zh"&gt;控制射频卡指示灯点亮或熄灭。&lt;/div&gt; &lt;div class="en"&gt;Control the radio frequency card indicator to turn on or off.&lt;/div&gt;<a name="line.3085"></a>
<span class="sourceLineNo">3086</span>     *<a name="line.3086"></a>
<span class="sourceLineNo">3087</span>     * @param led &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.3087"></a>
<span class="sourceLineNo">3088</span>     *              &lt;li&gt;bit0: 红灯。&lt;/li&gt;<a name="line.3088"></a>
<span class="sourceLineNo">3089</span>     *              &lt;li&gt;bit1: 绿灯。&lt;/li&gt;<a name="line.3089"></a>
<span class="sourceLineNo">3090</span>     *              &lt;li&gt;bit2: 黄灯&lt;/li&gt;<a name="line.3090"></a>
<span class="sourceLineNo">3091</span>     *              &lt;li&gt;bit3: 蓝灯。&lt;/li&gt;<a name="line.3091"></a>
<span class="sourceLineNo">3092</span>     *              &lt;li&gt;bit4-7: 保留。&lt;/li&gt;<a name="line.3092"></a>
<span class="sourceLineNo">3093</span>     *            &lt;/ul&gt;&lt;/div&gt;<a name="line.3093"></a>
<span class="sourceLineNo">3094</span>     *            &lt;div class="en"&gt;&lt;ul&gt;<a name="line.3094"></a>
<span class="sourceLineNo">3095</span>     *              &lt;li&gt;bit0: Red.&lt;/li&gt;<a name="line.3095"></a>
<span class="sourceLineNo">3096</span>     *              &lt;li&gt;bit1: Green.&lt;/li&gt;<a name="line.3096"></a>
<span class="sourceLineNo">3097</span>     *              &lt;li&gt;bit2: Yellow.&lt;/li&gt;<a name="line.3097"></a>
<span class="sourceLineNo">3098</span>     *              &lt;li&gt;bit3: Blue.&lt;/li&gt;<a name="line.3098"></a>
<span class="sourceLineNo">3099</span>     *              &lt;li&gt;bit4-7: Reserve.&lt;/li&gt;<a name="line.3099"></a>
<span class="sourceLineNo">3100</span>     *            &lt;/ul&gt;&lt;/div&gt;<a name="line.3100"></a>
<span class="sourceLineNo">3101</span>     * @param mode &lt;div class="zh"&gt;&lt;ul&gt;<a name="line.3101"></a>
<span class="sourceLineNo">3102</span>     *               &lt;li&gt;0x00:熄灭。&lt;/li&gt;<a name="line.3102"></a>
<span class="sourceLineNo">3103</span>     *               &lt;li&gt;0x01:点亮。&lt;/li&gt;<a name="line.3103"></a>
<span class="sourceLineNo">3104</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3104"></a>
<span class="sourceLineNo">3105</span>     *             &lt;div class="en"&gt;&lt;ul&gt;<a name="line.3105"></a>
<span class="sourceLineNo">3106</span>     *               &lt;li&gt;0x00:Turn off.&lt;/li&gt;<a name="line.3106"></a>
<span class="sourceLineNo">3107</span>     *               &lt;li&gt;0x01:Turn on.&lt;/li&gt;<a name="line.3107"></a>
<span class="sourceLineNo">3108</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3108"></a>
<span class="sourceLineNo">3109</span>     * @throws TypeAException TypeAException<a name="line.3109"></a>
<span class="sourceLineNo">3110</span>     */<a name="line.3110"></a>
<span class="sourceLineNo">3111</span>    void setLed(byte led, byte mode) throws TypeAException;<a name="line.3111"></a>
<span class="sourceLineNo">3112</span><a name="line.3112"></a>
<span class="sourceLineNo">3113</span>    /**<a name="line.3113"></a>
<span class="sourceLineNo">3114</span>     * &lt;div class="zh"&gt;初始化 Felica 卡片。&lt;/div&gt; &lt;div class="en"&gt;Initialize the Felica card.&lt;/div&gt;<a name="line.3114"></a>
<span class="sourceLineNo">3115</span>     *<a name="line.3115"></a>
<span class="sourceLineNo">3116</span>     * @param rate &lt;div class="zh"&gt;与卡片交互的传输速率。&lt;ul&gt;<a name="line.3116"></a>
<span class="sourceLineNo">3117</span>     *               &lt;li&gt;0x00: 212Kbps。&lt;/li&gt;<a name="line.3117"></a>
<span class="sourceLineNo">3118</span>     *               &lt;li&gt;0x01: 424Kbps。&lt;/li&gt;<a name="line.3118"></a>
<span class="sourceLineNo">3119</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3119"></a>
<span class="sourceLineNo">3120</span>     *             &lt;div class="en"&gt;The transfer rate of interaction with the card.&lt;ul&gt;<a name="line.3120"></a>
<span class="sourceLineNo">3121</span>     *               &lt;li&gt;0x00: 212Kbps.&lt;/li&gt;<a name="line.3121"></a>
<span class="sourceLineNo">3122</span>     *               &lt;li&gt;0x01: 424Kbps.&lt;/li&gt;<a name="line.3122"></a>
<span class="sourceLineNo">3123</span>     *             &lt;/ul&gt;&lt;/div&gt;<a name="line.3123"></a>
<span class="sourceLineNo">3124</span>     * @param pol &lt;div class="zh"&gt;FeliCa卡调制方式。&lt;ul&gt;<a name="line.3124"></a>
<span class="sourceLineNo">3125</span>     *              &lt;li&gt;0x00: 正向调制输出。&lt;/li&gt;<a name="line.3125"></a>
<span class="sourceLineNo">3126</span>     *              &lt;li&gt;0x01: 反向调制输出。&lt;/li&gt;<a name="line.3126"></a>
<span class="sourceLineNo">3127</span>     *            &lt;/ul&gt;&lt;/div&gt;<a name="line.3127"></a>
<span class="sourceLineNo">3128</span>     *            &lt;div class="en"&gt;FeliCa card modulation method. &lt;ul&gt;<a name="line.3128"></a>
<span class="sourceLineNo">3129</span>     *              &lt;li&gt;0x00: Forward modulation output.&lt;/li&gt;<a name="line.3129"></a>
<span class="sourceLineNo">3130</span>     *              &lt;li&gt;0x01: Reverse modulation output.&lt;/li&gt;<a name="line.3130"></a>
<span class="sourceLineNo">3131</span>     *            &lt;/ul&gt;&lt;/div&gt;<a name="line.3131"></a>
<span class="sourceLineNo">3132</span>     * @throws TypeAException TypeAException<a name="line.3132"></a>
<span class="sourceLineNo">3133</span>     */<a name="line.3133"></a>
<span class="sourceLineNo">3134</span>    void initFelica(byte rate, byte pol) throws TypeAException;<a name="line.3134"></a>
<span class="sourceLineNo">3135</span><a name="line.3135"></a>
<span class="sourceLineNo">3136</span>    /**<a name="line.3136"></a>
<span class="sourceLineNo">3137</span>     * &lt;div class="zh"&gt;与卡片进行APDU数据交互。将数据直接发送给卡片，并接收卡片的应答数据。&lt;/div&gt;<a name="line.3137"></a>
<span class="sourceLineNo">3138</span>     * &lt;div class="en"&gt;APDU data exchange with the card. Send the data directly to the card and receive the response data from the card.&lt;/div&gt;<a name="line.3138"></a>
<span class="sourceLineNo">3139</span>     *<a name="line.3139"></a>
<span class="sourceLineNo">3140</span>     * @param dataIn &lt;div class="zh"&gt;待发送的命令数据。&lt;/div&gt; &lt;div class="en"&gt;The command data to be sent.&lt;/div&gt;<a name="line.3140"></a>
<span class="sourceLineNo">3141</span>     * @return &lt;div class="zh"&gt;接收到的卡片数据。&lt;/div&gt; &lt;div class="en"&gt;The received card data.&lt;/div&gt;<a name="line.3141"></a>
<span class="sourceLineNo">3142</span>     * @throws TypeAException TypeAException<a name="line.3142"></a>
<span class="sourceLineNo">3143</span>     */<a name="line.3143"></a>
<span class="sourceLineNo">3144</span>    byte[] cmdExchange(byte[] dataIn) throws TypeAException;<a name="line.3144"></a>
<span class="sourceLineNo">3145</span><a name="line.3145"></a>
<span class="sourceLineNo">3146</span>    /**<a name="line.3146"></a>
<span class="sourceLineNo">3147</span>     * &lt;div class="zh"&gt;更改外置密码键盘通信波特率。&lt;/div&gt;<a name="line.3147"></a>
<span class="sourceLineNo">3148</span>     * &lt;div class="en"&gt;Change the external PINPAD communication Baud rate.&lt;/div&gt;<a name="line.3148"></a>
<span class="sourceLineNo">3149</span>     *<a name="line.3149"></a>
<span class="sourceLineNo">3150</span>     * @param bps &lt;div class="zh"&gt;波特率。<a name="line.3150"></a>
<span class="sourceLineNo">3151</span>     *              &lt;ul&gt;<a name="line.3151"></a>
<span class="sourceLineNo">3152</span>     *                   &lt;li&gt;0x00: 9600,8,E,1&lt;/li&gt;<a name="line.3152"></a>
<span class="sourceLineNo">3153</span>     *                   &lt;li&gt;0x01: 115200,8,N,1&lt;/li&gt;<a name="line.3153"></a>
<span class="sourceLineNo">3154</span>     *              &lt;/ul&gt;<a name="line.3154"></a>
<span class="sourceLineNo">3155</span>     *            &lt;/div&gt;<a name="line.3155"></a>
<span class="sourceLineNo">3156</span>     *            &lt;div class="en"&gt;Baud rate.<a name="line.3156"></a>
<span class="sourceLineNo">3157</span>     *              &lt;ul&gt;<a name="line.3157"></a>
<span class="sourceLineNo">3158</span>     *                  &lt;li&gt;0x00: 9600,8,E,1&lt;/li&gt;<a name="line.3158"></a>
<span class="sourceLineNo">3159</span>     *                  &lt;li&gt;0x01: 115200,8,N,1&lt;/li&gt;<a name="line.3159"></a>
<span class="sourceLineNo">3160</span>     *              &lt;/ul&gt;<a name="line.3160"></a>
<span class="sourceLineNo">3161</span>     *            &lt;/div&gt;<a name="line.3161"></a>
<span class="sourceLineNo">3162</span>     * @throws TypeAException TypeAException<a name="line.3162"></a>
<span class="sourceLineNo">3163</span>     */<a name="line.3163"></a>
<span class="sourceLineNo">3164</span>    void changeBaudRate(byte bps) throws TypeAException;<a name="line.3164"></a>
<span class="sourceLineNo">3165</span><a name="line.3165"></a>
<span class="sourceLineNo">3166</span>    /**<a name="line.3166"></a>
<span class="sourceLineNo">3167</span>     * &lt;div class="zh"&gt;创建并显示二维码。&lt;/div&gt; &lt;div class="en"&gt;Create and show a QR code.&lt;/div&gt;<a name="line.3167"></a>
<span class="sourceLineNo">3168</span>     *<a name="line.3168"></a>
<span class="sourceLineNo">3169</span>     * @param content &lt;div class="zh"&gt;二维码内容。最大不超过255字节。&lt;/div&gt; &lt;div class="en"&gt;QR code content. The maximum is not more than 255 bytes.&lt;/div&gt;<a name="line.3169"></a>
<span class="sourceLineNo">3170</span>     * @param sizeLevel &lt;div class="zh"&gt;最小可是别的模块大小。取值(2, 4, 8)。&lt;/div&gt; &lt;div class="en"&gt;The smallest but other module size. Take the value (2, 4, 8).&lt;/div&gt;<a name="line.3170"></a>
<span class="sourceLineNo">3171</span>     * @param type &lt;div class="zh"&gt;二维码类型。0x00: QR; 0x01: GM。&lt;/div&gt; &lt;div class="en"&gt;QR code type. 0x00: QR; 0x01: GM.&lt;/div&gt;<a name="line.3171"></a>
<span class="sourceLineNo">3172</span>     * @param correctionLevel &lt;div class="zh"&gt;纠错能力级别。取值0~4。当type为0x00时有效。&lt;/div&gt;<a name="line.3172"></a>
<span class="sourceLineNo">3173</span>     *                        &lt;div class="en"&gt;The level of error correction capability. The value ranges from 0 to 4. It is valid when type is 0x00.&lt;/div&gt;<a name="line.3173"></a>
<span class="sourceLineNo">3174</span>     * @param x &lt;div class="zh"&gt;横坐标。&lt;/div&gt; &lt;div class="en"&gt;The abscissa.&lt;/div&gt;<a name="line.3174"></a>
<span class="sourceLineNo">3175</span>     * @param y &lt;div class="zh"&gt;纵坐标。&lt;/div&gt; &lt;div class="en"&gt;The ordinate.&lt;/div&gt;<a name="line.3175"></a>
<span class="sourceLineNo">3176</span>     * @throws TypeAException TypeAException<a name="line.3176"></a>
<span class="sourceLineNo">3177</span>     */<a name="line.3177"></a>
<span class="sourceLineNo">3178</span>    void showQRCode(byte[] content, short sizeLevel, byte type, byte correctionLevel, short x, short y) throws TypeAException;<a name="line.3178"></a>
<span class="sourceLineNo">3179</span><a name="line.3179"></a>
<span class="sourceLineNo">3180</span>    /**<a name="line.3180"></a>
<span class="sourceLineNo">3181</span>     * &lt;div class="zh"&gt;打开扫描模块。&lt;/div&gt; &lt;div class="en"&gt;Open the scan module.&lt;/div&gt;<a name="line.3181"></a>
<span class="sourceLineNo">3182</span>     *<a name="line.3182"></a>
<span class="sourceLineNo">3183</span>     * @throws TypeAException TypeAException<a name="line.3183"></a>
<span class="sourceLineNo">3184</span>     */<a name="line.3184"></a>
<span class="sourceLineNo">3185</span>    void scanOpen() throws TypeAException;<a name="line.3185"></a>
<span class="sourceLineNo">3186</span><a name="line.3186"></a>
<span class="sourceLineNo">3187</span>    /**<a name="line.3187"></a>
<span class="sourceLineNo">3188</span>     * &lt;div class="zh"&gt;读取扫描数据。&lt;/div&gt; &lt;div class="en"&gt;Read scan data.&lt;/div&gt;<a name="line.3188"></a>
<span class="sourceLineNo">3189</span>     *<a name="line.3189"></a>
<span class="sourceLineNo">3190</span>     * @return &lt;div class="zh"&gt;&lt;/div&gt; &lt;div class="en"&gt;&lt;/div&gt;<a name="line.3190"></a>
<span class="sourceLineNo">3191</span>     * @throws TypeAException TypeAException<a name="line.3191"></a>
<span class="sourceLineNo">3192</span>     */<a name="line.3192"></a>
<span class="sourceLineNo">3193</span>    String scanRead() throws TypeAException;<a name="line.3193"></a>
<span class="sourceLineNo">3194</span><a name="line.3194"></a>
<span class="sourceLineNo">3195</span>    /**<a name="line.3195"></a>
<span class="sourceLineNo">3196</span>     * &lt;div class="zh"&gt;关闭扫描模块。&lt;/div&gt; &lt;div class="en"&gt;Close the scan module.&lt;/div&gt;<a name="line.3196"></a>
<span class="sourceLineNo">3197</span>     *<a name="line.3197"></a>
<span class="sourceLineNo">3198</span>     * @throws TypeAException TypeAException<a name="line.3198"></a>
<span class="sourceLineNo">3199</span>     */<a name="line.3199"></a>
<span class="sourceLineNo">3200</span>    void scanClose()throws TypeAException;<a name="line.3200"></a>
<span class="sourceLineNo">3201</span><a name="line.3201"></a>
<span class="sourceLineNo">3202</span>    /**<a name="line.3202"></a>
<span class="sourceLineNo">3203</span>     * &lt;div class="zh"&gt; 获取接收超时时间，默认20000ms。 &lt;/div&gt; &lt;div class="en"&gt; get receive timeout, default is 20000ms &lt;/div&gt;<a name="line.3203"></a>
<span class="sourceLineNo">3204</span>     *<a name="line.3204"></a>
<span class="sourceLineNo">3205</span>     * @return &lt;div class="zh"&gt; 接收超时，单位ms &lt;/div&gt; &lt;div class="en"&gt; receive timeout, in ms &lt;/div&gt;<a name="line.3205"></a>
<span class="sourceLineNo">3206</span>     *<a name="line.3206"></a>
<span class="sourceLineNo">3207</span>     */<a name="line.3207"></a>
<span class="sourceLineNo">3208</span>    public int getRecvTimeout();<a name="line.3208"></a>
<span class="sourceLineNo">3209</span><a name="line.3209"></a>
<span class="sourceLineNo">3210</span>    /**<a name="line.3210"></a>
<span class="sourceLineNo">3211</span>     * &lt;div class="zh"&gt; 设置接收超时时间 ，默认20000ms。&lt;/div&gt; &lt;div class="en"&gt; set receive timeout, default is 20000ms &lt;/div&gt;<a name="line.3211"></a>
<span class="sourceLineNo">3212</span>     *<a name="line.3212"></a>
<span class="sourceLineNo">3213</span>     * @param timeoutMs<a name="line.3213"></a>
<span class="sourceLineNo">3214</span>     *            &lt;div class="zh"&gt; 接收超时，单位ms &lt;/div&gt; &lt;div class="en"&gt; receive timeout, in ms &lt;/div&gt;<a name="line.3214"></a>
<span class="sourceLineNo">3215</span>     *<a name="line.3215"></a>
<span class="sourceLineNo">3216</span>     */<a name="line.3216"></a>
<span class="sourceLineNo">3217</span>    public void setRecvTimeout(int timeoutMs);<a name="line.3217"></a>
<span class="sourceLineNo">3218</span>}<a name="line.3218"></a>




























































</pre>
</div>
</body>
</html>
